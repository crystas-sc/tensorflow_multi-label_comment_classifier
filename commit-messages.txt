Make @ConstructorBinding implict for config prop records
Stabilize socketChannelClosedTriggersTunnelClose
See gh-27476,Merge branch '2.5.x',Merge branch '2.4.x' into 2.5.x,Update copyright header in changed files,Merge branch '2.5.x'
Rework spring-boot-server-tests to avoid using Maven
Increase response timeout for server-bound WebTestClients
Fix race condition in Jetty graceful shutdown tests
Some of the Jetty graceful shutdown tests were flaky due to the way
in which Jetty behaves when it is stopped.
Stopping the Jetty web server interrupts the thread that's handling
the active request. This initiates a race between the request-handling
thread which will decrement the number of active requests and the
main thread which expects an active request to cause the shutdown
result to be REQUESTS_ACTIVE. The test passes when the main thread
wins and fails as a request is active which it's checked. When the
request-handling thread wins the test fails as the count of active
requests has been deprecated before it is checked.
The blocking servlet that's used to stall a request and keep it
active needs to be updated to ignore the thread being interrupted
and continue waiting. This will ensure that a request remains active
until the main thread has checked the active request count and
determine the result of the shutdown.
Upgrade to Artifactory Resource 0.0.17
Upgrade to artifactory-resource 0.0.16
See gh-27465,Update copyright year of changed files,Polish,Merge branch '2.5.x'
Fix problems with gradle-plugin-publishing
Trigger publish-gradle-plugin automatically
Correct path in publish-gradle-plugin script
Fixes gh-27456,Merge branch '2.5.x'
Merge pull request #27453 from saraswathy-krish
* gh-27453:
  Polish "Fix deriving DataSources from custom type"
  Fix deriving DataSources from custom type
Polish "Fix deriving DataSources from custom type"
See gh-27453,Fix deriving DataSources from custom type
Eliminate the unsupported datasource property exception thrown
when trying to derive a datasource from an unknown datasource type.
See gh-27453,Merge branch '2.5.x',Merge branch '2.4.x' into 2.5.x,Next development version (v2.4.10-SNAPSHOT),Merge branch '2.5.x',Upgrade to Undertow 2.2.9.Final
Upgrade to SLF4J 1.7.32
Upgrade to MySQL 8.0.26
Upgrade to Logback 1.2.4
Upgrade to Jedis 3.6.3
Upgrade to SLF4J 1.7.32
Upgrade to MySQL 8.0.26
Configure a mirror for registry-image image_resources
Upgrade to artifactory-resource 0.0.15
Polish
Polish
Merge pull request #27418 from izeye
* gh-27418:
  Polish
Polish
See gh-27418,Polishing
Merge pull request #27417 from dreis2211
* gh-27417:
  Polishing
Polishing
See gh-27417,Merge branch '2.5.x'
Upgrade to Gradle Enterprise Conventions 0.0.8
Instantiate detectors with ClassLoader that discovered them
Fixes gh-27422,Merge branch '2.5.x'
Upgrade to Spring Integration 5.5.2
Use ClassLoader that will load Yaml to check if it's present
Fixes gh-27133,Merge branch '2.5.x'
Merge pull request #26769 from dreis2211
* gh-26769:
  Add Java 17 to JavaVersion enum
Add Java 17 to JavaVersion enum
See gh-26769,Merge pull request #27376 from bono007
* gh-27376:
  Polish "Make RabbitTemplateConfigurer's setters public"
  Make RabbitTemplateConfigurer's setters public
Polish "Make RabbitTemplateConfigurer's setters public"
See gh-27376,Make RabbitTemplateConfigurer's setters public
See gh-27376,Remove redundant deprecation suppressions
Merge pull request #27409 from dreis2211
* gh-27409:
  Remove redundant deprecation suppressions
Remove redundant deprecation suppressions
See gh-27409,Merge branch '2.5.x',Upgrade to Spring AMQP 2.3.10
Upgrade to Spring Kafka 2.7.4
Adjust fat jar central directory to account for launch script
An upgrade to Apache Commons Compress allows the build plugins to write
the launch script to the fat jar as a proper preamble, making the file
compatible with more jar and zip tooling.
Fixes gh-22336,Merge branch '2.5.x'
Configure initializer dependencies grouped by detector
Previously, database initializers were detected and were configured
with dependencies based on their detection order. For example, if
detectors a, b, and c detected initializers a1, b1, b2, and c1,
c1 would depend on b2, b2 on b1, and b1 on a1:
------     ------     ------     ------
| c1 | --> | b2 | --> | b1 | --> | a1 |
------     ------     ------     ------
This could cause a dependency cycle in certain situations, for
example because the user had already configured b1 to depend on b2.
This commit reduces the risk of a cycle being created by batching
the initializers by their detector, with dependencies being
configured between each batch rather than between every initializer.
In the example above, this results in c1 depending on b1 and b2,
and b1 and b2 depending on a1:
           ------
------     | b1 |     ------
| c1 | --> |    | --> | a1 |
------     | b2 |     ------
           ------
As b1 and b2 were detected by the same detector, no dependency
between those initializers is defined.
Merge pull request #17924 from scottmf
* gh-17924:
  Polish "Make dev tools' home directory configurable"
  Make dev tools' home directory configurable
Polish "Make dev tools' home directory configurable"
See gh-17924,Make dev tools' home directory configurable
This allows separate projects to keep their own settings where common
settings such as spring.* or server.* don't conflict.
See gh-17924,Upgrade to Spring Kafka 2.8.0-M1
Upgrade to Spring AMQP 2.4.0-M1
Upgrade to Spring Security 5.6.0-M1
Upgrade to Logback 1.2.4
Upgrade to Spring AMQP 2.3.10
Upgrade to Spring Data 2021.1.0-M1
See gh-27170,Merge pull request #27371 from saraswathy-krish
* gh-27371:
  Polish "Add idle timeout property for Reactor Netty"
  Add idle timeout property for Reactor Netty
Polish "Add idle timeout property for Reactor Netty"
See gh-27371,Add idle timeout property for Reactor Netty
See gh-27371,Merge pull request #27405 from izeye
* gh-27405:
  Polish
Polish
See gh-27405,Reinstate support for Hibernate < 5.5
See gh-27352,Revert "Add support for InfluxDB 2.x"
This reverts commit 52fedb2bb4da081a9c1750f0fea214b50a0db96b.
See gh-25891,Adopt Hiberate's CamelCaseToUnderscoresNamingStrategy
Upgrade to Rabbit AMQP Client 5.13.0
Upgrade to Netty 4.1.66.Final
Upgrade to jOOQ 3.14.13
Upgrade to Jedis 3.6.2
Upgrade to Infinispan 12.1.7.Final
Upgrade to Hibernate 5.5.4.Final
Upgrade to Git Commit ID Plugin 4.9.9
Upgrade to Flyway 7.11.2
Upgrade to Dropwizard Metrics 4.2.3
Upgrade to Byte Buddy 1.11.8
Upgrade to AppEngine SDK 1.9.90
Make ConnectionNameStrategy publicly settable
See gh-26982,Fix deprecation warnings
See gh-27383,Merge branch '2.5.x',Upgrade to Spring Data 2021.0.3
Upgrade to Netty 4.1.66.Final
Upgrade to jOOQ 3.14.13
Upgrade to Jetty Reactive HTTPClient 1.1.10
Upgrade to Jedis 3.6.2
Upgrade to Infinispan 12.1.7.Final
Upgrade to Dropwizard Metrics 4.1.25
Upgrade to AppEngine SDK 1.9.90
Rework Jetty10Http2OverTlsTests so they compile with Java 8
Upgrade to Netty 4.1.66.Final
Upgrade to jOOQ 3.14.13
Upgrade to Dropwizard Metrics 4.1.25
Upgrade to AppEngine SDK 1.9.90
Split gradle test support into a separate module
See gh-25824,Merge pull request #26258 from pirgeo
* gh-26258:
  Polish "Refine documentation"
  Refine documentation
  Polish "Add properties for Dynatrace metrics API v2 ingest with Micrometer"
  Add properties for Dynatrace metrics API v2 ingest with Micrometer
Polish "Refine documentation"
See gh-26258,Refine documentation
See gh-26258,Drop JDK 17 system tests until Gradle supports Java 17
See gh-27367,Merge branch '2.5.x'
Use a 10s init query timeout in Cassandra tests
Polish
See gh-27367,Correct the CI image used by JDK 17 system tests
See gh-27367,Merge branch '2.5.x'
Merge pull request #27366 from dreis2211
* gh-27366:
  Add CI pipeline for JDK 17
Add CI pipeline for JDK 17
See gh-27366,Merge branch '2.5.x'
Merge pull request #27328 from dreis2211
* gh-27328:
  Disable Gradle plugin tests that fail on JDK 17
Disable Gradle plugin tests that fail on JDK 17
See gh-27328,Merge pull request #27091 from RazorNd
* gh-27091:
  Polish "Add @WebServiceServerTest slice test support"
  Add @WebServiceServerTest slice test support
Polish "Add @WebServiceServerTest slice test support"
See gh-27091,Add @WebServiceServerTest slice test support
Add `@WebServiceServerTest` and related test auto-configuration to
allow slice testing of Spring Web Service server applications.
See gh-27091,Merge branch '2.5.x'
Add Gson converter immediately before default Jackson converter
Previously, when the preferred json mapper was set to Gson, the Gson
HTTP message converter was added before any other converters. This
changed the form of String responses that were already valid. When
Jackson is in use, a string converter is used as it appears earlier
in the list than the Jackson converter. When the mapper is switched
to Gson, the Gson converter is added first in the list of converters
and the Strong converter is no longer used. This results in the
String, that was already valid JSON, being converted again. This
changes its form as quotes are escaped, etc.
This commit updates HttpMessageConverters so that the Gson converter
is added to the list immediately before the default Jackson
converter. This is done by considering the Gson converter to be an
equivalent of the Jackson converter.
Fixes gh-27354,Merge branch '2.5.x' into main
Merge pull request #27357 from anvithabs
* pr/27357:
  Fix reference to a configuration property in cloud.adoc
Fix reference to a configuration property in cloud.adoc
See gh-27357,Merge pull request #27355 from saraswathy-krish
* pr/27355:
  Polish "Support comma-separated basePackage values in EntityScan"
  Support comma-separated basePackage values in EntityScan
Polish "Support comma-separated basePackage values in EntityScan"
See gh-27355,Support comma-separated basePackage values in EntityScan
See gh-27355,Merge branch '2.5.x',Merge branch '2.4.x' into 2.5.x,Merge pull request #27348 from izeye
* gh-27348:
  Remove Flyway references from DependsOn BFPPs for Liquibase
Remove Flyway references from DependsOn BFPPs for Liquibase
See gh-27348,Merge branch '2.5.x'
Allow @SpyBean to be used to spy on a Spring Data repository
Fixes gh-7033,Update version property for Prometheus to reflect its scope
Provide complete dependency management for Prometheus's Pushgateway
Fixes gh-27349,Upgrade to Spring HATEOAS 1.4.0-M1
Remove dependency management for org.webjars:hal-browser
Polish "Add properties for Dynatrace metrics API v2 ingest with Micrometer",Add properties for Dynatrace metrics API v2 ingest with Micrometer,Merge branch '2.5.x'
Fix configprops endpoint's handling of config tree values
Fixes gh-27327,Merge branch '2.5.x',Upgrade Ubuntu version in CI images
Upgrade Ubuntu version in CI images
Upgrade to MongoDB 4.3.0
Upgrade to Lettuce 6.1.4.RELEASE
Upgrade to Micrometer 1.7.2
\gh-27342
Upgrade to Lettuce 6.1.4.RELEASE
Upgrade to Spring HATEOAS 1.2.8
Upgrade to Micrometer 1.6.9
Upgrade to Lettuce 6.0.7.RELEASE
Avoid retrieving values from Record beyond session boundary
See gh-27294,Work around compile warnings from Data Neo4j's use of API Guardian
See gh-27170,Polish restoration of ConfigFileApplicationListener
See gh-27303,Merge pull request #27294 from meistermeier
* gh-27294:
  Polish "Use server version from database in Neo4j health details"
  Use server version from database in Neo4j health details
Polish "Use server version from database in Neo4j health details"
See gh-27294,Use server version from database in Neo4j health details
See gh-27294,Merge branch '2.5.x'
Rename test classes to match our naming conventions
Restore ConfigFileApplicationListener in deprecated form
Restore `ConfigFileApplicationListener` in a deprecated form since
Spring Cloud need it. Scheduled removal is now in 3.0.0.
See gh-27303,Add ERROR-level metadata for removed properties
See gh-27303,Initiate layers-2.6
See gh-27326,Merge branch '2.5.x'
Deprecate AbstractDataSourceInitializer
\gh-27206
Co-authored-by: Phillip Webb <pwebb@vmware.com>,Add missing XSD version for layers configuration
Upgrade to Spring Framework 5.3.9
Remove deprecated code flagged for removal
Upgrade to Kotlin Coroutines 1.5.1
Upgrade to Kotlin 1.5.21
Pass required settings into Rabbit LCF configurer's constructor
Merge pull request #26982 from bono007
* gh-26982:
  Polish "Add Rabbit connection factory configurers"
  Add Rabbit connection factory configurers
Polish "Add Rabbit connection factory configurers"
See gh-26982,Add Rabbit connection factory configurers
See gh-26982,Merge branch '2.5.x'
Merge pull request #27310 from dreis2211
* gh-27310:
  Fix JDK 16 pipeline
Fix JDK 16 pipeline
See gh-27310,Merge branch '2.5.x'
Merge pull request #27089 from dreis2211
* gh-27089:
  Polish "Allow additional JVM args when running tests via toolchain"
  Allow additional JVM args when running tests via toolchain
Polish "Allow additional JVM args when running tests via toolchain"
See gh-27089,Allow additional JVM args when running tests via toolchain
See gh-27089,Merge pull request #26961 from mikouaj
* gh-26961:
  Polish "Add resource labels to Stackdriver metrics configuration properties"
  Add resource labels to Stackdriver metrics configuration properties
Polish "Add resource labels to Stackdriver metrics configuration properties"
See gh-26961,Add resource labels to Stackdriver metrics configuration properties
Using resource labels is mandatory for most Stackdriver resources other
than 'Global', i.e. k8s_pod. Configuring valid resource type along with
related labels makes it possible to use given metric in a wider set of
GCP solutions, i.e. custom metric based GKE pod horizontal autoscaler.
See gh-26961,Merge branch '2.5.x'
Merge pull request #27300 from hoanvh
* gh-27300:
  Polish "Mark Redis as down when cluster_state is fail"
  Mark Redis as down when cluster_state is fail
Polish "Mark Redis as down when cluster_state is fail"
See gh-27300,Mark Redis as down when cluster_state is fail
See gh-27300,Merge pull request #26418 from bono007
* gh-26418:
  Polish "Auto-configure Jetty connection and SSL metrics"
  Auto-configure Jetty connection and SSL metrics
Polish "Auto-configure Jetty connection and SSL metrics"
See gh-26418,Auto-configure Jetty connection and SSL metrics
See gh-26418,Merge branch '2.5.x'
Upgrade to Reactor 2020.0.9
See gh-27168,Merge branch '2.4.x' into 2.5.x
See gh-27163,Align with Framework's deprecation of getLastModified
See gh-27160,Merge branch '2.5.x'
\gh- '2.4.x' into 2.5.x
Include Jetty metrics in list of supported metrics
Upgrade to Hibernate 5.5.3.Final
Merge pull request #27108 from bono007
* gh-27108:
  Polish "Remove default spring.mongodb.embedded.version"
  Remove default spring.mongodb.embedded.version
Polish "Remove default spring.mongodb.embedded.version"
See gh-27108,Remove default spring.mongodb.embedded.version
See gh-27108,Merge branch '2.5.x',Polish,Add additional bomr metadata,Upgrade to REST Assured 4.4.0
Add a note for Pooled JMS 2.x as it requires Java 11,Upgrade to Liquibase 4.4.1
Upgrade to Flyway 7.11.1
Upgrade to WebJars Locator Core 0.47
Upgrade to Tomcat 9.0.50
Upgrade to SQLite JDBC 3.36.0.1
Upgrade to Spring Session Bom 2021.0.1
Upgrade to SnakeYAML 1.29
Upgrade to SLF4J 1.7.31
Upgrade to Selenium HtmlUnit 2.51.0
Upgrade to Prometheus PushGateway 0.11.0
Upgrade to Postgresql 42.2.23
Upgrade to Netty tcNative 2.0.40.Final
Upgrade to Neo4j Java Driver 4.3.3
Upgrade to Mockito 3.11.2
Upgrade to Maven Javadoc Plugin 3.3.0
Upgrade to Maven Dependency Plugin 3.2.0
Upgrade to Lettuce 6.1.3.RELEASE
Upgrade to Kotlin Coroutines 1.5.0-native-mt
Upgrade to Json Path 2.6.0
Upgrade to jOOQ 3.14.12
Upgrade to Johnzon 1.2.14
Upgrade to Jetty 9.4.43.v20210629
Upgrade to Jetty Reactive HTTPClient 1.1.10
Upgrade to Jetty EL 9.0.48
Upgrade to Jersey 2.34
Upgrade to Jedis 3.6.1
Upgrade to Jackson Bom 2.12.4
\gh-27264
Upgrade to Infinispan 12.1.6.Final
Upgrade to HttpClient5 5.1
Upgrade to HtmlUnit 2.51.0
Upgrade to Hazelcast 4.2.1
Upgrade to Elasticsearch 7.13.3
Upgrade to Dropwizard Metrics 4.2.2
Upgrade to DB2 JDBC 11.5.6.0
Upgrade to Commons Pool2 2.10.0
Upgrade to Cassandra Driver 4.12.0
Upgrade to Caffeine 2.9.2
Upgrade to Byte Buddy 1.11.6
Upgrade to Awaitility 4.1.0
Upgrade to AssertJ 3.20.2
Upgrade to AspectJ 1.9.7
Switch bomr to any policy,Upgrade to Kafka 2.8.0
As part of the upgrade, a switch to Spring Kafka 2.8.0-SNAPSHOT is
required, see gh-27177
Upgrade to Postgresql 42.2.23
Upgrade to jOOQ 3.14.12
Upgrade to Johnzon 1.2.14
Upgrade to Jetty 9.4.43.v20210629
Upgrade to Jetty Reactive HTTPClient 1.1.10
Upgrade to DB2 JDBC 11.5.6.0
Upgrade to AspectJ 1.9.7
Merge pull request #27229 from dreis2211
* pr/27229:
  Fix tests for multi-release JARs on JDK 17
Fix tests for multi-release JARs on JDK 17
See gh-27229,Upgrade to Querydsl 5.0.0.M1
Switch s-b-server-tests from libs-snapshot to snapshot and milestone
See gh-27232,Fix system test runtime classpath and build scan notification
See gh-25824,Merge branch '2.5.x'
Rework Quartz DB init dependencies to use a detector
Detect JdbcIndexedSessionRepository as depending on DB init
Fixes gh-27220,Merge branch '2.5.x'
Start building against Spring Security 5.6.0-M1 snapshots
See gh-27173,Start building against Micrometer 1.8.0-M1 snapshots
See gh-27169,Start building against Spring Integration 5.5.2 snapshots
See gh-27174,Start building against Spring AMQP 2.4.0-M1 snapshots
See gh-27171,Start building against Spring Data 2021.1.0-M1 snapshots
See gh-27170,Start building against Spring HATEOAS 1.4.0 snapshots
See gh-27185,Start building against Spring Framework 5.3.9 snapshots
See gh-27168,Start building against Reactor 2020.0.9 snapshots
See gh-27167,Merge branch 'gh-27221' into 2.5.x
Polish "Detect JobRepository as depending on DB init"
See gh-27221,Detect JobRepository as depending on DB init
See gh-27221,Merge branch '2.5.x'
Merge pull request #27215 from hpoettker
* gh-27215:
  Polish "Detect AbstractDataSourceInitializers as DB initializers"
  Detect AbstractDataSourceInitializers as DB initializers
Polish "Detect AbstractDataSourceInitializers as DB initializers"
See gh-27215,Detect AbstractDataSourceInitializers as DB initializers
See gh-27215,Merge branch '2.5.x',Merge branch '2.4.x' into 2.5.x,Ensure that Session JDBC schema is in place before DB is accessed
Fixes gh-27208,Merge branch '2.5.x',Merge branch '2.4.x' into 2.5.x,Consider Flyway and Liquibase as possible Batch DB initializers
This is a follow-on from 3fec4110 which only considered
BatchDataSourceInitializer as a possible initializer of Batch's
database schema. Flyway and Liquibase are now also considered.
Fixes gh-27193,Merge branch '2.5.x'
Fix visibility of a type exposed as a bean
Fix checkstyle violations
See gh-25824,Add Paketo image building system tests
A new system test plugin is being made available for running test
suites that should be run less frequently than with every commit, such
as tests that verify Spring Boot compatibility with external
projects. CI pipeline configuration for running system tests is also
provided.
The first system tests verify the behavior of the Spring Boot image
building plugins when building images using Paketo buildpacks.
\gh-27212
\gh-27210
Handle file with name matching an optional wildcard location
Previously, the presence of a file with the same name
as an optional wildcard location would cause a failure. With
this change the pattern is resolved only if the resource is a
directory.
Additionally, if an optional wildcard search location that was a file
would also fail with an exception. This commit fixes that so that those
locations are not resolved.
Fixes gh-27120
Fixes gh-27209,Merge branch '2.5.x'
Don't change case of 'Sec-WebSocket-Key'
Polish commit 5ca687c9a6b5 had an accidental side-effect of changing
the 'Sec-WebSocket-Key' header value to lowercase. This breaks
connections since the value needs to be echoed unchanged in the
"Sec-WebSocket-Accept" header.
Fixes gh-27147,Merge branch '2.5.x',Upgrade to Tomcat 9.0.50
Upgrade to Postgresql 42.2.23
Upgrade to jOOQ 3.14.12
Upgrade to Johnzon 1.2.14
Upgrade to Jetty 9.4.43.v20210629
Upgrade to Jackson Bom 2.12.4
Upgrade to Infinispan 12.1.6.Final
Upgrade to DB2 JDBC 11.5.6.0
Upgrade to Caffeine 2.9.2
Upgrade to AspectJ 1.9.7
Merge pull request #27100 from dreis2211
* gh-27100:
  Avoid illegal reflective access on ZipEntry.xdostime
Avoid illegal reflective access on ZipEntry.xdostime
See gh-27100,Merge branch '2.5.x'
Avoid using deprecated API to get Kotlin Plugin's version
Improve error message for non-options-capable ConnectionFactory
Fixes gh-26977,Merge branch '2.5.x',Merge branch '2.4.x' into 2.5.x,Start building against Spring Integration 5.5.2 snapshots
See gh-27166,Start building against Spring Kafka 2.7.4 snapshots
See gh-27165,Start building against Spring Data 2021.0.3 snapshots
See gh-27164,Start building against Spring HATEOAS 1.3.3 snapshots
See gh-27184
Start building against Spring Framework 5.3.9 snapshots
See gh-27163,Start building against Reactor 2020.0.9 snapshots
See gh-27162,Start building against Spring Data 2020.0.11 snapshots
See gh-27161,Start building against Spring HATEOAS 1.2.8 snapshots
See gh-27183,Start building against Spring Framework 5.3.9 snapshots
See gh-27160,Start building against Reactor 2020.0.9 snapshots
See gh-27159,Merge branch '2.5.x'
Test our Gradle plugin against Gradle 7.1.1
Merge pull request #27149 from marckchr
* pr/27149:
  Polish "Fix duration to microseconds conversion"
  Fix duration to microseconds conversion
Polish "Fix duration to microseconds conversion"
See gh-27149,Fix duration to microseconds conversion
See gh-27149,Merge branch '2.5.x' into main
See gh-27140,Merge branch '2.4.x' into 2.5.x
See gh-27139,Clarify that HATEOAS can be used with Webflux without starter
Document spring hateoas is spring mvc specific
Add clarification on when @DevaultValue is used during binding
Split spring boot features into multiple sections
See gh-27132,Merge branch '2.5.x' into main
Automate publication of gradle plugin
Merge pull request #27085 from dreis2211
* pr/27085:
  Update copyright year of updated file
  Avoid reflection in tests
Update copyright year of updated file
See gh-27085,Avoid reflection in tests
See gh-27085,Merge branch '2.5.x'
Merge pull request #27103 from temnur
* pr/27103:
  Remove unnecessary unit for spring.datasource.tomcat.max-active
Remove unnecessary unit for spring.datasource.tomcat.max-active
See gh-27103,Merge branch '2.5.x'
Merge pull request #27107 from biergit
* pr/27107:
  Fix anchor rewrites containing a question mark
Fix anchor rewrites containing a question mark
See gh-27107,Merge branch '2.5.x'
Merge pull request #27102 from cordin
* pr/27102:
  Fix typo in section title
Fix typo in section title
See gh-27102,Merge branch '2.5.x'
Fix spring.netty.leak-detection metadata
Fixes gh-27104,Merge branch '2.5.x'
Protect against NPE in isAlreadyPromoted
Fixes gh-27094,Next development version (v2.5.3-SNAPSHOT),Merge branch '2.5.x',Fix Kotlin 1.5.20 classpath issues
See gh-27086,Merge branch '2.5.x',Suppress Kotlin 1.5.20 deprecation warning
See gh-27086,Merge branch '2.5.x'
Upgrade to Kotlin 1.5.20
Do not publish to Sonatype when already published
Only close context that is active
Previously, SpringApplicationShutdownHook would call close() on any
registered application context even if it wasn't active as it had
already been closed. This could lead to deadlock if the context was
closed and System.exit was called during application context refresh.
This commit updates SpringApplicationShutdownHook so that it only
calls close() on active contexts. This prevents deadlock as it avoids
trying to sychronize on the context's startupShutdownMonitor on
the shutdown hook thread while it's still held on the main thread
which called System.exit and is waiting for all of the shutdown hooks
to complete.
Fixes gh-27049,Merge branch '2.5.x',Merge branch '2.4.x' into 2.5.x,Next development version (v2.4.9-SNAPSHOT),Merge branch '2.5.x'
See gh-27050,Use reflection to extract Netty's default level
See gh-27046,Merge branch '2.5.x'
See gh-27047,Merge branch '2.4.x' into 2.5.x
See gh-27045,Don't offer upgrade for version that is already aligned
See gh-27044,Merge branch '2.5.x'
See gh-27073,Merge branch '2.4.x' into 2.5.x
See gh-27072,Minimize Instantiator's public API
See gh-27043,Merge branch '2.5.x'
Pass ResourceLoader.getClassLoader() to Instantiator
Update calls to `Instantiator` to that they also include
`ResourceLoader.getClassLoader()`.
Fixes gh-27072,Pass ClassLoader to Instantiator
Update `Instantiator` so that it can accept a `ClassLoader` when
creating instances and rework `EnvironmentPostProcessorsFactory` to
use the new methods.
Prior to this commit we would use the `ClassLoader` to get the class
names from `SpringFactories` but not when actually creating the
instances.
Fixes gh-27043,Merge branch '2.5.x'
See gh-27065,Polish
See gh-26978,Merge branch '2.5.x',Merge branch '2.4.x' into 2.5.x,Upgrade to Netty tcNative 2.0.40.Final
Upgrade to Hazelcast 4.1.4
Upgrade to Nimbus JOSE JWT 8.22
Upgrade to OAuth2 OIDC SDK 8.36.2
Upgrade to Netty tcNative 2.0.40.Final
Polish startup endpoint description in reference doc
Upgrade to Spring Kafka 2.7.3
Upgrade to Spring AMQP 2.3.9
Upgrade to Spring Integration 5.4.8
Upgrade to Spring AMQP 2.3.9
Merge pull request #26930 from dreis2211
* pr/26930:
  Avoid illegal reflective access in CLI tests
Avoid illegal reflective access in CLI tests
See gh-26930,Merge branch '2.5.x'
\gh-27063
Fix 'spring.datasource.name' property description
Improve "reason" message in BindFailureAnalyzer
Update `BindFailureAnalyzer` so that the "Reason" message includes
the root cause exception type and message.
Rethrow ConverterNotFoundException when possible
Update `BindConverter` to throw the first `ConversionFailedException`
rather than always throwing `ConverterNotFoundException`.
See gh-27028,Merge branch '2.5.x'
Upgrade CI to Ubuntu Focal 20210609
Merge pull request #27017 from limo520
* pr/27017:
  Add additional ConfigDataProperties tests
  Fix typo in ConfigDataPropertiesTests
Add additional ConfigDataProperties tests
Add more `isActive` tests to cover negative cases.
See gh-27017,Fix typo in ConfigDataPropertiesTests
See gh-27017,Merge branch '2.5.x',Merge branch '2.4.x' into 2.5.x,Restore simple Library constructor
See gh-15808,Merge branch '2.5.x'
Apply exclusions to existing war entries
Update `RepackageMojo` and supporting classes so that `exclusions`
on the repackage goal apply to both the contributed libraries and any
existing jar entries already contained in the original war.
Prior to this commit, exclusions would apply to contributed jars (for
example, those in `WEB-INF/lib-provided`) but not jars that were
packaged directly into `WEB-INF/lib` by the war plugin
Fixes gh-15808
Co-authored-by: Phillip Webb <pwebb@vmware.com>,Merge branch '2.5.x'
See gh-27047,Merge branch '2.4.x' into 2.5.x
See gh-27045,Fix bom plugin management versions
See gh-27044,Merge branch '2.5.x'
Align NettyProperties with Netty's defaults
Prior to this commit, `NettyProperties` would use `DISABLED` as the
default level for leak detection in Netty. This is not the default value
enforced by Netty, which is `SIMPLE`.
This commit changes the default configuration property value and ensures
that both stay in sync.
Fixes gh-27046,Merge branch '2.5.x',Merge branch '2.4.x' into 2.5.x
Align Nimbus dependency versions with Spring Security
Add dependency lock and constraint version alignment to Bomr
Upgrade to Micrometer 1.6.8
Upgrade to Spring Session 2020.0.5
Upgrade to OAuth2 OIDC SDK 9.9
Upgrade to Lettuce 6.1.3.RELEASE
Upgrade to Dropwizard Metrics 4.1.24
Upgrade to OAuth2 OIDC SDK 8.36.2
Upgrade to Neo4j Java Driver 4.1.4
Upgrade to Lettuce 6.0.6.RELEASE
Upgrade to Dropwizard Metrics 4.1.24
Upgrade to Spring HATEOAS 1.3.2
Upgrade to Spring HATEOAS 1.2.7
Upgrade to Reactor 2020.0.8
Merge pull request #26937 from quaff
* gh-26937:
  Polish "Update docs to use @SpringBootConfiguration not @Configuration"
  Update docs to use @SpringBootConfiguration not @Configuration
Polish "Update docs to use @SpringBootConfiguration not @Configuration"
See gh-26937,Update docs to use @SpringBootConfiguration not @Configuration
See gh-26937,Merge branch '2.5.x'
Disable Log4j2's shutdown hook by default
Previously, Log4j2's own shutdown hook was only disabled when Log4j2
detected javax.servlet.Servlet on the classpath and, therefore,
determined that it was running in a web application. In an application
without Servlet on the classpath, this could lead to both Log4j2's shut
down hook and and logging system's shutdown handler both stopping
Log4j2. This could result in a failure as the second attempt at stopping
would result in reinitialization which would fail as the JVM is already
shutting down.
This commit introduces a new Log4j2 PropertySource implementation,
registered via META-INF/services, that sets the
log4j.shutdownHookEnabled property to false. This will ensure that
Log4j2's own shutdown hook is disabled by default whenever Spring Boot
is on the classpath and not just in Servlet-based web applications.
Fixes gh-26953,Merge branch '2.5.x',Start building against Micrometer 1.7.1 snapshots
See gh-27015,Merge branch '2.4.x' into 2.5.x,Start building against Micrometer 1.6.8 snapshots
See gh-27014,Start building against Spring HATEOAS 1.2.7 snapshots
See gh-27013,Merge branch '2.5.x'
Merge pull request #26954 from dreis2211
* pr/26954:
  Avoid illegal reflective access in RabbitAutoConfigurationTests
Avoid illegal reflective access in RabbitAutoConfigurationTests
See gh-26954,Merge branch '2.5.x'
Merge pull request #26975 from hrybs
* pr/26975:
  Document uuid support in RandomValuePropertySource
Document uuid support in RandomValuePropertySource
See gh-26975,Merge branch '2.5.x'
Revert "Avoid duplicate crypto classes when depending on spring-security-core"
Revert "Avoid dependency on Kotlin when depending on spring-security-config"
Revert "Avoid duplicate crypto classes when depending on spring-security-core"
Upgrade to Spring Security 5.5.1
Allow nested profile-specific resolution
Effectively revert commit 0da0d2d46 so that the `resolveProfileSpecific`
method of `ConfigDataLocationResolver` is again called when resolving
imports declared in a profile-specific file.
Fixes gh-26960,Merge branch '2.5.x'
Include 6.9.x in version requirements message
Fixes gh-26952,Merge branch '2.5.x',Merge branch '2.4.x' into 2.5.x
Revert "Upgrade to Dropwizard Metrics 4.1.23"
This reverts commit ce242702712539d5be353220e71533f26ae7a3d3.
See gh-26983,Upgrade to Tomcat 9.0.48
Upgrade to SLF4J 1.7.31
Upgrade to Postgresql 42.2.22
Upgrade to Jetty EL 9.0.48
Upgrade to Jedis 3.6.1
Upgrade to Cassandra Driver 4.11.2
Fix additional metadata locations with config cache
Previously, a project with a dependency on Spring Boot's configuration
processor would fail to build when the configuration cache is enabled
due to it accessing the Project during task execution.
Instead of accessing the project during task execution, this commit
updates the code to retrieve the resource locations from the matching
source set in advance. The locations are then stored in the action
that configures the compile task when needed.
See gh-26974,Start building against Spring Kafka 2.7.3 snapshots
See gh-26973,Start building against Spring Session 2021.0.1 snapshots
See gh-26971,Start building against Spring Data 2021.0.2 snapshots
See gh-26970,Start building against Spring HATEOAS 1.3.2 snapshots
See gh-26969,Merge branch '2.5.x'
Fix HTTP/2 over TLS with Jetty 10
Fixes gh-26988,Merge branch '2.5.x',Merge branch '2.4.x' into 2.5.x,Upgrade to Tomcat 9.0.48
Upgrade to SLF4J 1.7.31
Upgrade to Postgresql 42.2.22
Upgrade to Jetty EL 8.5.68
Upgrade to Dropwizard Metrics 4.1.23
See gh-26967,Start building against Spring AMQP 2.3.9 snapshots
See gh-26966,Start building against Spring Security 5.4.7 snapshots
See gh-26965,Start building against Spring Session 2020.0.5 snapshots
See gh-26964,Start building against Spring Data 2020.0.10 snapshots
See gh-26963,Start building against Reactor 2020.0.8 snapshots
See gh-26962,Merge branch '2.5.x'
Merge pull request #26955 from quaff
* pr/26955:
  Add missing space for asciidoc ordered list
Add missing space for asciidoc ordered list
See gh-26955,Include caller info in NoSuchMethodError failure analysis
Fixes gh-26895,Merge branch '2.5.x'
Allow BFPP to modify database initialization ordering
Fixes gh-26899,Merge branch '2.5.x'
Only get Kotlin plugin's version once we know we need it
Fixes gh-26946,Merge branch '2.5.x'
See gh-26936,Merge branch '2.4.x' into 2.5.x
See gh-26935,Fix test on Windows
See gh-26821,Merge branch '2.5.x'
Catch isEmbedded failure and treat database as not embedded
Fixes gh-26926,Merge branch '2.5.x'
Only check database's type when there are scripts to apply
Fixes gh-26925,Merge branch '2.5.x',Fix asciidoctor anchor references
See gh-26939,Merge branch '2.5.x'
Allow indirect standard profile-specific imports
Effectively revert commit d1b256a16936 so that profile-specific imports
can again be used with or without a parent import.
Fixes gh-26858,Merge branch '2.5.x'
Improve BeanNotOfRequiredTypeFailureAnalyzer output
This commit modifies the output of BeanNotOfRequiredTypeFailureAnalyzer
to include type information for both the actual and the required types
and to remove ambiguity.
Fixes gh-26821,Merge branch '2.5.x'
See gh-26934,Merge branch '2.4.x' into 2.5.x
See gh-26933,Tune config of source and target compatilility with toolchain
See gh-26932,Merge branch '2.5.x'
See gh-26929,Correct directory names in Jetty 10 smoke tests
See gh-26847,Merge branch '2.5.x'
Allow Eclipse to properly detect source and target compatibility
Previously, our conventions configured the source and target
compatibility on the project's JavaCompile tasks. This causes the
settings to be missed when importing the projects into Eclipse [1].
This commit updates the conventions to set the source and target
compatibility on the project-wide JavaPluginExtension. This allows
the Eclipse import to correctly detect and honour the settings.
\gh-26932
[1] https://github.com/eclipse/buildship/issues/978,Merge branch '2.5.x'
Fix WebSocket support with Jetty 10.0.x
Fixes gh-26847,Stop using ConfigureUtil in BomExtension
While we're building with Gradle 6.9 at the moment and ConfigureUtil
has only been deprecated in Gradle 7.1, it doesn't do any harm to
stop using it now.
Avoid capturing URI template when interceptor won't use it
Previously, the URI template handler installed by the client metrics
interceptor would always capture the URI template and push it onto the
deque, irrespective of whether auto timing was enabled. When
auto-timing is disabled the deque is never polled so this led to its
unrestricted growth.
This commit updates the URI template handler so that a URI template is
only pushed onto the deque when the auto timing configuration enables
the interceptor.
Fixes gh-26915,Merge branch '2.5.x'
Merge pull request #26813 from francislavoie
* pr/26813:
  Polish 'Make livereload websocket headers case insensitive'
  Make livereload websocket headers case insensitive
Polish 'Make livereload websocket headers case insensitive'
See gh-26813
Make livereload websocket headers case insensitive
Update livereload `Connection` handling code so that websocket headers
are no longer case sensitive.
See gh-26813,Merge branch '2.5.x'
Make Flyway and Liquibase auto-config back off without spring-jdbc
The auto-config requires Spring JDBC for DataSource creation from
spring.flyway.url or spring.liquibase.url, checking Flyway migrations
exist, etc. Without it, the application fails to start due to missing
spring-jdbc classes.
This commit updates the auto-config so that it backs off in the
absence of spring-jdbc.
See gh-26902,Merge branch '2.4.x' into 2.5.x
See gh-26901,Prevent RestarterTests.testRestart from triggering unwanted restarts
See gh-26900,Merge branch '2.5.x'
Merge pull request #26910 from aclement
* pr/26910:
  Polish "Add Azure info to the cloud deployment docs"
  Add Azure info to the cloud deployment docs
Polish "Add Azure info to the cloud deployment docs"
See gh-26910,Add Azure info to the cloud deployment docs
See gh-26910,Merge branch '2.5.x'
Merge pull request #26907 from izeye
* pr/26907:
  Fix Javadoc deprecated since
Fix Javadoc deprecated since
See gh-26907,Add support for InfluxDB 2.x
Test our Gradle plugin against Gradle 7.1
Try to stabilize RestarterTests.testRestart
The documentation overview sections is supposed to provide a map
for the rest of the reference document. The getting help and upgrading
sections were moved to align with that.,Reorder documentation overview section
The documentation overview sections is supposed to provide a map
for the rest of the reference document. The getting help and upgrading
sections were moved to align with that.,Merge branch '2.5.x',Merge branch '2.4.x' into 2.5.x
Polish authors separators,Merge branch '2.5.x'
Use Asciidoctor's revision line to provide document's version
Using the revision line means that the revision number is automatically
set. The revision number is then included by the HTML and PDF backends
in the standard location. In the HTML backend that's alongside the
list of authors. In the PDF backend that's on the title page.
Try to stabilize httpConnectionsAreClosedAfterLongPollTimeout
Try to stabilize TunnelClientTests.addListener()
Remove dependency management for Nimbus
Add support for customizing the auto-configured ClientResources
Add metrics for task execution and scheduling
Merge pull request #22610 from scordio
* pr/22610:
  Polish "Add auto-configuration for Spring Data Envers"
  Add auto-configuration for Spring Data Envers
Polish "Add auto-configuration for Spring Data Envers"
See gh-22610,Add auto-configuration for Spring Data Envers
See gh-22610,Merge pull request #26326 from weixsun
* pr/26326:
  Polish "Enable Redis connection pool if commons-pool2 is available"
  Enable Redis connection pool if commons-pool2 is available
Polish "Enable Redis connection pool if commons-pool2 is available"
See gh-26326,Enable Redis connection pool if commons-pool2 is available
See gh-26326,Merge pull request #26456 from kedar-joshi
* pr/26456:
  Polish "Upgrade to Flyway 7.9.2"
  Upgrade to Flyway 7.9.2
Polish "Upgrade to Flyway 7.9.2"
See gh-26456,Upgrade to Flyway 7.9.2
See gh-26456,Merge pull request #26690 from jaminh
* pr/26690:
  Polish "Allow SpringApplicationBuilder to specify a ResourceLoader"
  Allow SpringApplicationBuilder to specify a ResourceLoader
Polish "Allow SpringApplicationBuilder to specify a ResourceLoader"
See gh-26690,Allow SpringApplicationBuilder to specify a ResourceLoader
See gh-26690,Merge pull request #26437 from weixsun
* pr/26437:
  Polish "Allow direct use of exposed WebSessionIdResolver bean"
  Allow direct use of exposed WebSessionIdResolver bean
Polish "Allow direct use of exposed WebSessionIdResolver bean"
See gh-26437,Allow direct use of exposed WebSessionIdResolver bean
See gh-26437,Merge pull request #26422 from marcus-nl
* pr/26422:
  Update copyright year of change file
  Improve configuration of Start and Stop goals
Update copyright year of change file
See gh-26422,Improve configuration of Start and Stop goals
See gh-26422,Merge pull request #26341 from nguyensach
* pr/26341:
  Polish "Apply RSocketConnectorConfigurer beans to RSocketRequester.Builder"
  Apply RSocketConnectorConfigurer beans to RSocketRequester.Builder
Polish "Apply RSocketConnectorConfigurer beans to RSocketRequester.Builder"
See gh-26341,Apply RSocketConnectorConfigurer beans to RSocketRequester.Builder
See gh-26341,Merge pull request #26337 from mjeffrey
* pr/26337:
  Polish "Add support for @Value annotation"
  Add support for @Value annotation
Polish "Add support for @Value annotation"
See gh-26337,Add support for @Value annotation
This commit adds support for `@Value` from project Lombok for metadata
generation. This is very similar to the existing `@Data` support.
See gh-26337,Merge pull request #26311 from dbyron-sf
* pr/26311:
  Polish "Add configuration property for Tomcat's rejectIllegalHeader"
  Add configuration property for Tomcat's rejectIllegalHeader
Polish "Add configuration property for Tomcat's rejectIllegalHeader"
See gh-26311,Add configuration property for Tomcat's rejectIllegalHeader
See gh-26311,Merge pull request #26221 from slawekjaranowski
* pr/26221:
  Polish "Reproducible build for spring-boot-maven-plugin:build-info"
  Reproducible build for spring-boot-maven-plugin:build-info
Polish "Reproducible build for spring-boot-maven-plugin:build-info"
See gh-26221,Reproducible build for spring-boot-maven-plugin:build-info
See gh-26221,Merge branch '2.5.x'
Always use 8 threads when getting from Artifactory
Try to stabilize flaky MetricsWebClientFilterFunction test
Merge pull request #26001 from bono007
* pr/26001:
  Polish "Add auto-configuration for DiskSpaceMetrics"
  Add auto-configuration for DiskSpaceMetrics
Polish "Add auto-configuration for DiskSpaceMetrics"
See gh-26001,Add auto-configuration for DiskSpaceMetrics
See gh-26001,Merge branch '2.5.x'
Try to stabilise SocketTargetServerConnectionTests
Attempt to stabilize stopTriggersTunnelClose
Allow to chain ContextConsumer implementations
Merge pull request #26861 from dreis2211
* gh-26861:
  Update some more references to 2.5.x
Update some more references to 2.5.x
See gh-26861,Configure CI pipeline for Spring Boot 2.6.x,Initiate Spring Boot 2.6.x,Merge branch '2.5.x',Update CI parameters for 2.5.x branch,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Next development version (v2.5.2-SNAPSHOT),Don't shutdown logging system before contexts
Add `SpringApplicationShutdownHook` to manage orderly application
shutdown, specifically around the `LoggingSystem`. `SpringApplication`
now offers a `getShutdownHandlers()` method that can be used to add
handlers that are guaranteed to only run after the `ApplicationContext`
has been closed and is inactive.
Fixes gh-26660,Next development version (v2.4.8-SNAPSHOT),Make DB init back off without DatabasePopulator
Fixes gh-26850,Next development version (v2.3.13.BUILD-SNAPSHOT),Polish,Upgrade to spring-asciidoctor-backends 0.0.2
Upgrade to Spring AMQP 2.3.8
Merge pull request #26816 from ge0ffrey
* pr/26816:
  Polish "Fix Optaplanner starter url"
  Fix Optaplanner starter url
Polish "Fix Optaplanner starter url"
See gh-26816,Fix Optaplanner starter url
See gh-26816,Upgrade CI to Docker 20.10.7
Upgrade to RSocket 1.1.1
Upgrade to Jetty 9.4.42.v20210604
Upgrade to Jetty Reactive HTTPClient 1.1.9
Upgrade to Spring AMQP 2.2.18.RELEASE
Upgrade to Spring Kafka 2.7.2
\gh-26765
Lower spring.sql.init.enabled's deprecation level to warning
See gh-26682,Merge branch '2.4.x'
Move common Asciidoctor configuration into our conventions
Upgrade to Neo4j Java Driver 4.1.3
Upgrade to Jetty 9.4.42.v20210604
Upgrade to Jetty Reactive HTTPClient 1.1.9
Upgrade to RSocket 1.0.5
Upgrade to Neo4j OGM 3.2.24
Upgrade to Jetty 9.4.42.v20210604
Upgrade to Jetty Reactive HTTPClient 1.1.9
Polish
See gh-26682,Merge branch '2.4.x',Upgrade to Spring Framework 5.3.8
Upgrade to Spring Framework 5.3.8
Test our Gradle plugin against 7.1-rc-2
Consider overridden getRootUri() when getting root URI
Fixes gh-26812,Merge branch '2.4.x'
Make CompositeHealth.getDetails() public
Change `CompositeHealth.getDetails()` to public so that it serializes
correctly when `MapperFeature.CAN_OVERRIDE_ACCESS_MODIFIERS` is
disabled.
Fixes gh-26797,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Update copyright year of changed files,Remove main class configuration fallback
Remove fallback code since we now require Gradle 6.8 and can depend
on the `getMainClass` method being present.
Rename derivefrom to align with DataSourceBuilder
Rename the `derivefrom` method in `ConnectionFactoryBuilder` to
`derivedFrom` to align with `DataSourceBuilder`.
Fixes gh-26810,Respect custom username/password properties
Fix a bug in `DataSourceInitializationConfiguration` and in
`R2dbcInitializationConfiguration` that was stopping
custom username/password properties from being applied.
Fixes gh-26676,Rework build-image-customization table in docs
Collapse parameter name and user property into a single column to give
a little more room for the description and default value.
Order DataSourceScriptDatabaseInitializer last
Change the order of `DataSourceScriptDatabaseInitializerDetector` so
that it always runs last. This update allows script initialization to
be combined with a high-level migration tool such as Flyway.
Support DatabaseInitializerDetector ordering
Update `DatabaseInitializationDependencyConfigurer` so that depends-on
ordering is applied based on the `DatabaseInitializerDetector` order.
Prior to this commit, if multiple DatabaseInitializer beans were
detected the order in which they were initialized was not defined.
See gh-26692,Fix FilePermissionsTests on Windows
See gh-26658,Polish
The use of the file's absolute path caused test failures on Windows.
See gh-26682,Reinstate mode for controlling DB initialization
Prevent Netty tcNative from loading classes with wrong class loader
In our tests, the JNI code in Netty tcNative can cause some of its
classes to be loaded using a ModifiedClassPathClassLoader. When the
wrong class loader is used, SSL-related tests fail, for example due
to the same Netty tcNative classes being loaded by two different
ClassLoders and no longer being the same. This appears to be
dependent upon the order in which tests are executed and results in
intermittent test failures.
It looks like this should be addressed in Netty tcNative 2.0.40 which
preloads all of its classes. In the meantime, this commit updates
ModifiedClassPathClassLodaer to ignore Netty tcNative classes so that
they're only ever loaded by the system class loader.
Polish,Upgrade to Undertow 2.2.8.Final
Upgrade to Neo4j Java Driver 4.2.6
Upgrade to jOOQ 3.14.11
Upgrade to Johnzon 1.2.13
Upgrade to JBoss Logging 3.4.2.Final
Upgrade to Infinispan 12.1.4.Final
Upgrade to Hibernate 5.4.32.Final
Upgrade to Gson 2.8.7
Upgrade to Ehcache3 3.9.4
Upgrade to Dropwizard Metrics 4.1.22
Upgrade to Couchbase Client 3.1.6
Upgrade to AppEngine SDK 1.9.89
Fix conversion failures when using DefaultResolver
Update `ConfigurationPropertySourcesPropertyResolver` so that calls to
the `DefaultResolver` do not attempt conversion.
Prior to this commit, the delegate resolver was accidentally called
with the target type which could cause a `ConversionFailedException`
to be thrown. We should have always used `Object.class` and let the
`convertValueIfNecessary` method perform conversion.
Fixes gh-26732,Polish,Test our Gradle plugin against 7.1-rc-1
7.1-rc-1 deprecates JavaExec's main property in favor of mainClass
which was introduced in Gradle 6.4. This commit updates some tests
to use mainClass rather than main that would otherwise have failed
due to deprecation warnings in their output.
Upgrade to jOOQ 3.14.11
Upgrade to Johnzon 1.2.13
Upgrade to JBoss Logging 3.4.2.Final
Upgrade to Hibernate 5.4.32.Final
Upgrade to Gson 2.8.7
Upgrade to Ehcache3 3.9.4
Upgrade to Dropwizard Metrics 4.1.22
Upgrade to AppEngine SDK 1.9.89
Fix property ordering within '.' and '/config'
Allow groups to be used with standard locations so that order of
profile-specific files is consistent.
Prior to this commit, the default search locations considered for
application properties/yaml files was the following:
 optional:classpath:/
 optional:classpath:/config/
 optional:file:./
 optional:file:./config/
 optional:file:./config/*/
Each of these locations was independent which could cause confusion
if certain combinations were used. For example, if profile-specific
files were added to `classpath:/` and `classpath:/config/` then the
latter would always override the former regardless of the profile
ordering.
This commit updates `StandardConfigDataLocationResolver` so that a
group of locations can be specified for each item. This allows us to
define the following set of search locations which provide more logical
ordering for profile-specific files
 optional:classpath:/;optional:classpath:/config/
 optional:file:./;optional:file:./config/;optional:file:./config/*/
Upgrade to JBoss Logging 3.4.2.Final
Upgrade to Hibernate 5.4.32.Final
Upgrade to Gson 2.8.7
Upgrade to Dropwizard Metrics 4.1.22
Upgrade to AppEngine SDK 1.9.89
Start building against Spring Kafka 2.7.2 snapshots
See gh-26765,Start building against Spring AMQP 2.3.8
See gh-26764,Start building against Spring Framework 5.3.8 snapshots
See gh-26761,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Start building against Spring Integration 5.3.8 snapshots
See gh-26772,Start building against Spring Kafka 2.5.14 snapshots
See gh-26771,Start building against Spring AMQP 2.2.18 snapshots
See gh-26770,Merge branch '2.4.x',Start building against Spring Kafka 2.6.9 snapshots
See gh-26763,Start building against Spring AMQP 2.3.8 snapshots
See gh-26762,Start building against Spring Framework 5.3.8 snapshots
See gh-26760,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Polish,Merge pull request #26751 from abelsromero
* pr/26751:
  Polish "Fix typo in 'Reacting to the Maven plugin' title"
  Fix typo in 'Reacting to the Maven plugin' title
Polish "Fix typo in 'Reacting to the Maven plugin' title"
See gh-26751,Fix typo in 'Reacting to the Maven plugin' title
See gh-26751,Merge branch '2.4.x'
Prevent nested profile-specific resolution
Update the `ConfigDataEnvironment` so that the `resolveProfileSpecific`
method of `ConfigDataLocationResolver` is no longer called when
resolving imports declared in a profile-specific file.
Fixes gh-26753,Merge branch '2.4.x'
Prevent indirect standard profile-specific imports
Update `StandardConfigDataLocationResolver` so that profile-specific
imports can only be used when there is no parent import.
Prior to this commit, given the following application.properties file:
 spring.profiles.active=p1,p2
 spring.config.import=other.properties
We would attempt to import `other.properties`, `other-p1.properties`
and `other-p2.properties`. This seems quite confusing and when we really
only need to support profile-specific properties for the initial root
set of locations.
Fixes gh-26752
Merge pull request #26737 from dreis2211
* pr/26737:
  Remove reference to surefirebooter JAR
Remove reference to surefirebooter JAR
See gh-26737,Merge branch '2.4.x'
Don't close early when SecurityManager present
Update `JarFile` and `JarFileWrapper` classes so that they no longer
close the `JarFile` early if a `SecurityManager` is in use.
Prior to this commit, the closed `JarFile` would cause (an ultimately
swallowed) NPE in `ZipFile` which manifested itself as a
`ClassNotFoundException` when starting the app.
Fix link to Spring Data JPA docs
Fixes gh-26736,Write buildpack directories to builder layer
When a custom buildpack is provided for image building, the contents
of the buildpack directory, tgz file, or image are copied as tar
entries to a new layer in the ephemeral builder image. Prior to this
commit, only file entries from the buildpack source were copied as
builder layer tar entries; intermediate directory entries from the
source were not copied. This results in directories being created in
the builder container using default permissions. This worked on most
Linux-like OSs where the default permissions allow others-read
access. On some OSs like Arch Linux where the default directory
permissions do not allow others-read, this prevented the lifecycle
processes from reading the buildpack files.
This commit explicitly creates all intermediate directory tar entries
in the builder image layer to ensure that the buildpack directories
and files can be read by the lifecycle processes.
Fixes gh-26658,Merge branch '2.4.x' into main
Align int and long in RandomValuePropertySource
This commit aligns int and long so that a random number is generated
by delegating to ints/longs in the JDK's Random API. In the case of a
single bound value, it needs to be greater than 0 because 0 is used as
the lower bound.
Fixes gh-26628,Polish,Merge branch '2.4.x'
Clarify when a connection pool is created for Redis
Avoid dependency on Kotlin when depending on spring-security-config
Properly guard LogbackLoggingSystem
Previously, LoggingSystem#get would chose Logback by the sole presence
of a class in logback-core, with the assumption that logback-classic is
also on the classpath. An app that only had the former would therefore
fail.
This commit updates the condition to check for a class in
logback-classic instead.
Merge pull request #26713 from weixsun
* pr/26713:
  Remove redudant space
Remove redudant space
See gh-26713,Merge branch '2.4.x'
Improve ImageName/ImageReference parse performance
Update `ImageName` and `ImageReference` to use distinct regex patterns
to parse specific parts of the value. Prior to this commit a single
regex pattern was used which could hang given certain input strings.
Fixes gh-23115,Merge branch '2.4.x' into main
Add note about Kubernetes termination grace period
Document spring.profiles.default in the reference guide
Add missing static on JerseyInfrastructureConfiguration
Rename the now public constant for consistency with the JavaPlugin.
See gh-26686,Merge branch '2.4.x'
Make PRODUCTION_RUNTIME_CLASSPATH_NAME public
Change `SpringBootPlugin.PRODUCTION_RUNTIME_CLASSPATH_NAME` from package
private to public so that it can be accessed in user build scripts.
Fixes gh-26686,Merge branch '2.4.x',Revert "Test optional directories without sub-directories"
This reverts commit 3f858ed8a4b4f190885f7c4a5eff1c423f8546a9
since the test already existed.,Merge branch '2.4.x'
Merge pull request #26677 from izeye
* pr/26677:
  Test optional directories without sub-directories
  Fix "Allow optional directories without sub-directories"
Test optional directories without sub-directories
Add an additional test to ensure that optional wildcard
directory patterns do not fail.
See gh-26677,Fix "Allow optional directories without sub-directories"
Fix the update to `resolvePatternEmptyDirectories` introduced in
commit 01dd68e29edc which was incorrectly checking `isOptional`.
See gh-26677,Change state change logging to DEBUG
Update `ApplicationAvailabilityBean` so that state change logging is
at DEBUG rather than INFO.
Fixes gh-26624,Polish,Use correct type for deriveFromProperties
Fix `DataSourceBuilder` so that the type used to access `deriveFrom`
properties is based on the actual instance type rather than the
user-defined type which could have been changed.
Fixes gh-26644,Allow `driverClassName` to be optional
Update `DataSourceBuilder` so that the `driverClassName` may be optional
and silently ignored if it set but the underlying type does not have
a getter/setter.
This restores Spring Boot 2.4 behavior.
Fixes gh-26631
Co-authored-by: Phillip Webb <pwebb@vmware.com>,Don't attempt to set null values
Update `DataSourceBuilder` so that setters are not longer called for
`null` values. This restores Spring Boot 2.4 behavior.
Fixes gh-26633
Co-authored-by: Phillip Webb <pwebb@vmware.com>,Support fallback URL properties
Update `DataSourceBuilder` so that the url property attempts both
`getUrl()` / `setUrl(...)` and `getURL()`/`setURL(...)`.
Fixes gh-26647
Co-authored-by: Phillip Webb <pwebb@vmware.com>,Respect custom username/password properties
Fix a bug in `DataSourceInitializationConfiguration` that was stopping
custom username/password properties from being applied.
Fixes gh-26676,Polish,Merge branch '2.4.x'
See gh-26654,Merge branch '2.3.x' into 2.4.x
See gh-26653,Document spring.profiles.default in the reference guide
Allow optional directories without sub-directories
Update `StandardConfigDataLocationResolver` so that directory resources
are only required when the location is not optional.
\gh-26627
Co-authored-by: Phillip Webb <pwebb@vmware.com>,Merge branch '2.4.x'
Force Eclipse to use JavaSE-1.8 runtime
Add `EclipseConventions` to force the JavaSE-1.8 runtime to be applied
to the imported projects.
Polish,Merge branch '2.4.x'
Merge pull request #26421 from lower-case
* pr/26421:
  Polish "Clarify Kotlin version requirements in documentation"
  Clarify Kotlin version requirements in documentation
Polish "Clarify Kotlin version requirements in documentation"
See gh-26421,Clarify Kotlin version requirements in documentation
See gh-26421,Merge branch '2.4.x'
Document spring.profiles.default
Upgrade to Kotlin 1.5.10
Use Sso Binding from SAML metadata uri if present
If the property is explicitly configured, that gets used.
If none are present, we rely on Spring Security's default value of
REDIRECT.
Fixes gh-26454,Merge branch '2.4.x'
Merge pull request #26632 from dreis2211
* pr/26632:
  Remove workaround for SUREFIRE-1679
Remove workaround for SUREFIRE-1679
See gh-26632,Merge pull request #26635 from obfischer
* pr/26635:
  Add link to Maven Git Commit Id Plugin
Add link to Maven Git Commit Id Plugin
See gh-26635,Avoid eager initialization when configuring Data repository metrics
Fixes gh-26630,Next development version (v2.5.1-SNAPSHOT),Set LATEST_GA flag to true,Merge branch '2.4.x' into main,Set LATEST_GA flag to false,Merge branch '2.4.x'
Use WebMvcConfigurer to add resource handlers
Move resource handler auto-configuration logic back to the
`WebMvcConfigurer` so that they also get applied to child contexts.
Update `repositories` declaration to include the
'io.spring.asciidoctor.backends' group.
See gh-26293,Upgrade to spring-asciidoctor-backends 0.0.1
Rework title anchors for maven docs
Rework title anchors for gradle docs
Rework title anchors for actuator docs
Polish asciidoc formatting,Merge branch '2.4.x' into main
\gh-26614
Configure filter to process preflight requests for webflux actuator endpoints
Fixes gh-24541,Merge branch '2.4.x' into main,Fix rawtypes,Merge branch '2.4.x' into main
Configure CORS in default security configuration for MVC
Fixes gh-11987,Merge branch '2.4.x' into main
Restore order of additional and active profiles
This commit restores the order of additional and active profiles
so that active profiles now take precedence.
Fixes gh-26189,Set Asciidoctor attribute-missing to warn
Upgrade to Spring Session 2021.0.0
Prevent Jetty from delaying shutdown beyond grace period
Fixes gh-22689,Merge branch '2.4.x'
Merge pull request #26591 from weixsun
* pr/26591:
  Fix outdated defaults for Info endpoint
Fix outdated defaults for Info endpoint
See gh-26591,Exclude SmartInitializingSingletones from lazy initialization
Fixes gh-26470,Upgrade to Netty 4.1.65.Final
Upgrade to Jetty 9.4.41.v20210516
Upgrade to Spring WS 3.1.1
Upgrade to Jetty 9.4.41.v20210516
Upgrade to Netty 4.1.65.Final
Upgrade to Neo4j OGM 3.2.23
Upgrade to Json-smart 2.3.1
Upgrade to Jetty 9.4.41.v20210516
Upgrade to Spring Batch 4.2.7
Prevent metrics failures from adversely affecting web responses
Fixes gh-24151,Upgrade to Spring Integration 5.5.0
Add prefix to appendix property anchor links
Refactor property appendix generator code so that the complete section
is generated and anchors follow the expected naming.
Simplify anchor-rewrite.properties,Upgrade to Spring Asciidoctor Extensions 0.6.0
Reorder a few how-to sections
Move "Use Jedis Instead of Lettuce" How-to
See gh-26262,Move "Testcontainers" How-to
See gh-26262,Move "Testing With Spring Security" How-to
See gh-26262,Polish,Merge pull request #26586 from dreis2211
* gh-26586:
  Polish "Update docs and internal dep mgmt following Spock 2.0's release"
  Update docs and internal dep mgmt following Spock 2.0's release
See gh-26586,Update docs and internal dep mgmt following Spock 2.0's release
See gh-26586,Start building against Spring Integration 5.4.7 snapshots
See gh-26587,Upgrade to Spring Security 5.5.0
Avoid duplicate crypto classes when depending on spring-security-core
See gh-26387,Upgrade to Spring AMQP 2.3.7
Upgrade to Spring Kafka 2.7.1
Upgrade to Spring Kafka 2.6.8
Allow optional ConfigDataLocationResolver results
Update `ConfigData` so that it signal if is considered optional. This
update allows `ConfigDataLocationResolvers` to return results that
behave in the same way as `optional:` prefixed locations without the
user themselves needing to prefix the location string.
Merge pull request #25868 from hatefpalizgar
* pr/25868:
  Polish 'Allow remote devtools access with Spring Security'
  Allow remote devtools access with Spring Security
Polish 'Allow remote devtools access with Spring Security'
See gh-25868,Allow remote devtools access with Spring Security
Update `ManagementWebSecurityAutoConfiguration` so that the
`managementSecurityFilterChain` bean has an explicit order.
Prior to this commit, the `managementSecurityFilterChain` would override
the `securityFilterChain` in `RemoteDevtoolsSecurityConfiguration` which
would prevent the remote devtools endpoint from being accessed.
See gh-25868,Merge branch '2.4.x'
\gh-26581
\gh-26582
Handle empty locations from patterns
Update `StandardConfigDataLocationResolver` to deal with patterns when
resolving empty directories. This update also fixes the handling of
mandatory pattern locations which would previously throw an exception.
The error message returned when a location with a pattern does not
contain any subdirectories has also been improved.
Fixes gh-26468
Fixes gh-26577
Fixes gh-26415,Restore hasProgrammaticallySetProfiles code
Restore code lost on merge.
See gh-26580,Merge branch '2.4.x'
Merge programmatically set active profiles
Update `Profiles` so that any profiles set programmatically on the
`Environment` are merged with `spring.profiles.active` properties.
Fixes gh-26151
Co-authored-by: Phillip Webb <pwebb@vmware.com>,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Upgrade to Spring AMQP 2.2.17.RELEASE
Polish
See gh-26576,Merge branch '2.4.x'
Merge pull request #26478 from weixsun
* pr/26478:
  Update copyright year of changed files
  Polish AbstractServletWebServerFactory
Update copyright year of changed files
See gh-26478,Polish AbstractServletWebServerFactory
See gh-26478,Compile Kotlin code will all warnings treated as errors
Merge pull request #26205 from LichKing-lee
* gh-26205:
  Polish "Detect use of spring.profiles.include as a YAML list"
  Detect use of spring.profiles.include as a YAML list
Polish "Detect use of spring.profiles.include as a YAML list"
See gh-26205,Detect use of spring.profiles.include as a YAML list
See gh-26205,Merge branch '2.4.x'
Remove stale jboss-transaction-spi dependencies
Upgrade to Kotlin Coroutines 1.5.0
Upgrade to Tomcat 9.0.46
Upgrade to Thymeleaf Layout Dialect 2.5.3
Upgrade to Solr 8.8.2
Upgrade to SAAJ Impl 1.5.3
Upgrade to R2DBC Bom Arabba-SR10
Upgrade to Postgresql 42.2.20
Upgrade to Pooled JMS 1.2.2
Upgrade to Netty tcNative 2.0.39.Final
Upgrade to Netty 4.1.64.Final
\gh-26559
Upgrade to Neo4j Java Driver 4.2.5
Upgrade to MySQL 8.0.25
Upgrade to MariaDB 2.7.3
Upgrade to Liquibase 4.3.5
Upgrade to Lettuce 6.1.2.RELEASE
Upgrade to Kotlin 1.5.0
Upgrade to Kafka 2.7.1
Upgrade to JUnit Jupiter 5.7.2
Upgrade to Json-smart 2.4.7
Upgrade to jOOQ 3.14.9
Upgrade to Johnzon 1.2.11
Upgrade to Jetty 9.4.40.v20210413
Upgrade to Jetty Reactive HTTPClient 1.1.8
Upgrade to Jedis 3.6.0
Upgrade to JBoss Transaction SPI 7.6.1.Final
Upgrade to Janino 3.1.4
Upgrade to Infinispan 12.1.3.Final
Upgrade to HttpCore5 5.1.1
Upgrade to HttpClient5 5.0.4
Upgrade to Hibernate 5.4.31.Final
Upgrade to Hazelcast 4.1.3
Upgrade to Groovy 3.0.8
Upgrade to Glassfish JAXB 2.3.4
Upgrade to Elasticsearch 7.12.1
Upgrade to Ehcache3 3.9.3
Upgrade to Ehcache 2.10.9.2
Upgrade to Dropwizard Metrics 4.1.21
Upgrade to Couchbase Client 3.1.5
Upgrade to Cassandra Driver 4.11.1
Upgrade to Caffeine 2.9.1
Upgrade to ActiveMQ 5.16.2
Update upgrade policy following release of RC1
Configure SessionCookieConfig in MockServletWebServer
Merge pull request #25944 from xenoterracide
* gh-25944:
  Polish "Document use of module replacements to swap dependencies"
  Document use of module replacements to swap dependencies
Polish "Document use of module replacements to swap dependencies"
See gh-25944,Document use of module replacements to swap dependencies
See gh-25944
Signed-off-by: Caleb Cushing <xenoterracide@gmail.com>,Merge branch '2.4.x'
Merge pull request #26446 from weixsun
* gh-26446:
  Remove unnecessary semicolon
Remove unnecessary semicolon
See gh-26446,Merge branch '2.4.x'
Merge pull request #26227 from crocarneiro
* gh-26227:
  Polish "Improve documentation of TestRestTemplate's fault tolerance"
  Improve documentation of TestRestTemplate's fault tolerance
Polish "Improve documentation of TestRestTemplate's fault tolerance"
See gh-26227,Improve documentation of TestRestTemplate's fault tolerance
See gh-26227,Merge branch '2.4.x'
Merge pull request #26465 from dreis2211
* gh-26465:
  Remove add-opens workaround in ToolchainPlugin
Remove add-opens workaround in ToolchainPlugin
See gh-26465,Merge pull request #26441 from weixsun
* pr/26441:
  Polish "Remove unnecessary throws declaration in tests"
  Remove unnecessary throws declaration in tests
Polish "Remove unnecessary throws declaration in tests"
See gh-26441,Remove unnecessary throws declaration in tests
See gh-26441,Merge branch '2.4.x',Upgrade to Tomcat 9.0.46
Upgrade to Thymeleaf Layout Dialect 2.5.3
Upgrade to R2DBC Bom Arabba-SR10
Upgrade to Postgresql 42.2.20
Upgrade to Pooled JMS 1.2.2
Upgrade to Netty tcNative 2.0.39.Final
Upgrade to Neo4j Java Driver 4.1.2
Upgrade to MySQL 8.0.25
Upgrade to MariaDB 2.7.3
Upgrade to Lettuce 6.0.5.RELEASE
Upgrade to JUnit Jupiter 5.7.2
Upgrade to Json-smart 2.3.1
Upgrade to jOOQ 3.14.9
Upgrade to Johnzon 1.2.11
Upgrade to Jetty 9.4.40.v20210413
Upgrade to Jetty Reactive HTTPClient 1.1.8
Upgrade to JBoss Transaction SPI 7.6.1.Final
Upgrade to Janino 3.1.4
Upgrade to Infinispan 11.0.11.Final
Upgrade to Hibernate 5.4.31.Final
Upgrade to Ehcache3 3.9.3
Upgrade to Ehcache 2.10.9.2
Upgrade to Dropwizard Metrics 4.1.21
Upgrade to ActiveMQ 5.16.2
Upgrade to R2DBC Bom Arabba-SR10
Upgrade to Postgresql 42.2.20
Upgrade to Netty tcNative 2.0.39.Final
Upgrade to Neo4j OGM 3.2.22
Upgrade to MySQL 8.0.25
Upgrade to Johnzon 1.2.11
Upgrade to Jetty 9.4.40.v20210413
Upgrade to Jetty Reactive HTTPClient 1.1.8
Upgrade to JBoss Transaction SPI 7.6.1.Final
Upgrade to Janino 3.1.4
Upgrade to Hibernate 5.4.31.Final
Upgrade to Ehcache 2.10.9.2
Upgrade to Dropwizard Metrics 4.1.21
Upgrade to ActiveMQ 5.15.15
Merge pull request #26448 from weixsun
* pr/26448:
  Update copyright year of changed files
  Remove redundant suppression
Update copyright year of changed files
See gh-26448,Remove redundant suppression
See gh-26448
Merge pull request #26477 from weixsun
* pr/26477:
  Remove unused imports
Remove unused imports
See gh-26477,Merge branch '2.4.x'
Note that the heapdump endpoint requires a HotSpot JVM
Upgrade to Spring LDAP 2.3.4.RELEASE
Test our Gradle plugin against Gradle 7.0.2
Upgrade to Spring Data 2021.0.1
Index @ConfigurationProperties so they can be found by scanning
Previously, @ConfigurationProperties was not annotated with @Indexed.
This meant that @ConfigurationPropertiesScan would not be able to
find them when the underlying
ClassPathScanningCandidateComponentProvider is using a
CandidateComponentsIndex.
This commit annotated @ConfigurationProperties with @Indexed so that
they can be found by index-based scanning.
Fixes gh-26459,Merge branch '2.4.x'
Configure JTA tests to write logs beneath build/
Make BufferingApplicationStartup thread safe
Update `BufferingApplicationStartup` to use thread safe data structures.
Prior to this commit, it was possible for calls from different threads
(for example due to request scope beans) to cause a
NoSuchElementException to be thrown.
Recommend default Servlet when using Jersey as a Filter
Use resource loader's class loader in config loading
Previously, classes involved in config loading used a variety of
potentially different class loaders when calling SpringFactoriesLoader.
Some classes would use their own class loader and others would use null
which results in SpringFactoriesLoader's class loader being used.
This commit updates the config loading classes to consistently use the
resource loader's class loader.
Fixes gh-26126,Merge branch '2.4.x'
Merge pull request #26449 from weixsun
* gh-26449:
  Polish "Use try-with-resources statement"
  Use try-with-resources statements
Polish "Use try-with-resources statement"
See gh-26449,Use try-with-resources statements
See gh-26449,Handle long file names in buildpack images
Fixes gh-26445,Merge branch '2.4.x'
Use test harness for image building integration tests
This commit modifies the integration tests for the Maven and Gradle
image building goal and task to use a custom builder as a test harness
to verify that the plugins invoke the builder as expected.
Fixes gh-25838,Merge branch '2.4.x',Upgrade to Spring HATEOAS 1.2.6
See gh-25798,Upgrade to Spring HATEOAS 1.3.1
Upgrade to Micrometer 1.7.0
Upgrade to Spring Framework 5.3.7
Upgrade to Spring Framework 5.3.7
Upgrade to Spring Framework 5.2.15.RELEASE
This commit fixes a flawed assertion that was relying on a log message
to validate the TaskExecutor is lazy. The level of the log message has
changed in framework and broke the test. We now rather check the bean
definition.,Merge branch '2.4.x' into main
Fixes gh-26434,Polish "Process additional profiles before config files processing"
See gh-25817,Process additional profiles before config files processing
Additional profiles were being processed after config file processing
when legacy processing was used.
This commit also restores the order in which additional profiles are added
when legacy processing is used.
Active profiles take precedence over additional profiles.
See gh-25817,Merge pull request #25817 from nguyensach
* pr/25817:
  Polish "Process additional profiles before config files processing"
  Process additional profiles before config files processing
Polish "Process additional profiles before config files processing"
See gh-25817,Process additional profiles before config files processing
Additional profiles were being processed after config file processing
when legacy processing was used.
This commit also restores the order in which additional profiles are added
when legacy processing is used.
Active profiles take precedence over additional profiles.
See gh-25817,Merge pull request #26416 from nguyensach
* pr/26416:
  Polish "Polish SpringApplicationAdminJmxAutoConfigurationTests"
  Polish SpringApplicationAdminJmxAutoConfigurationTests
Polish "Polish SpringApplicationAdminJmxAutoConfigurationTests"
See gh-26416,Polish SpringApplicationAdminJmxAutoConfigurationTests
See gh-26416,Properly assert that auto-configured TaskExecutor is lazy
This commit fixes a flawed assertion that was relying on a log message
to validate the TaskExecutor is lazy. The level of the log message has
changed in framework and broke the test. We now rather check the bean
definition.,Remove useless overrides of ConditionalOnProperty#matchIfMissing
Upgrade to Reactor 2020.0.7
See gh-26430,Merge branch '2.3.x' into 2.4.x,Start building against Spring Kafka 2.5.13 snapshots
See gh-26429,Start building against Spring AMQP 2.2.17 snapshots
See gh-26428,Start building against Micrometer 1.5.14 snapshots
See gh-26427,Start building against Spring Batch 4.2.7 snapshots
See gh-26426,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Start building against Spring Framework 5.2.15 snapshots
See gh-26425,Start building against Reactor Dysprosium-SR20 snapshots
See gh-26424,Merge pull request #26420 from dreis2211
* pr/26420:
  Test our Gradle Plugin against Gradle 7.0.1
Test our Gradle Plugin against Gradle 7.0.1
See gh-26420,Use spring-pdf backend for PDF generation
Update `asciidoctorPdf` tasks to use the `spring-pdf` backend so that
chomped elements and @fold:on/@fold:off comments are hidden.
Merge pull request #26417 from nguyensach
* pr/26417:
  Update copyright year of changed file
  Use try-with-resources statement
Update copyright year of changed file
See gh-26417,Use try-with-resources statement
See gh-26417,Start building against Micrometer 1.7.0 snapshots
See gh-26379,Start building against Spring LDAP 2.3.4 snapshots
See gh-26394,Start building against Spring Batch 4.3.3 snapshots
See gh-26392,Start building against Spring WS 3.1.0 snapshots
See gh-26390,Start building against Spring Session 2021.0.0 snapshots
See gh-26389,Start building against Spring Integration 5.5.0 snapshots
See gh-26388,Start building against Spring Security 5.5.0 snapshots
See gh-26387,Start building against Spring Kafka 2.7.1 snapshots
See gh-26386,Start building against Spring AMQP 2.3.7 snapshots
See gh-26384,Start building against Spring Data 2021.0.1 snapshots
See gh-26382,Start building against Spring HATEOAS 1.3.1 snapshots
See gh-26380,Merge branch '2.4.x',Start building against Spring LDAP 2.3.4 snapshots
See gh-26393,Start building against Spring Batch 4.3.3 snapshots
See gh-26391,Start building against Spring Kafka 2.6.8 snapshots
See gh-26385,Start building against Spring AMQP 2.3.7 snapshots
See gh-26383
Start building against Spring Data 2020.0.9 snapshots
See gh-26381,Document support for Gradle 6.9
Upgrade to Gradle 6.9
Merge pull request #26399 from nguyensach
* pr/26399:
  Fix wrong reference to Cassandra in DockerImageNames#couchbase
Fix wrong reference to Cassandra in DockerImageNames#couchbase
See gh-26399,Merge branch '2.4.x'
Refine mandatory location checking logic
Update `ConfigDataEnvironment.checkMandatoryLocations` to use the
actual locations that were imported, including those that were skipped
because the related `ConfigDataResource` had already been imported by a
different location.
Prior to this commit, any location that was skipped because it had
already been imported would throw a `ConfigDataNotFoundException`.
\gh-26147
Co-authored-by: Scott Frederick <sfrederick@vmware.com>
Co-authored-by: Madhura Bhave <mbhave@vmware.com>,Merge branch '2.4.x'
Import profile specific files in correct order
Update `StandardConfigDataLoader` to mark profile specific files with
`Option.PROFILE` so that they are added in the correct order. This is
a variation of the same issue described in commit 5774ea3f0c.
\gh-26400
Co-authored-by: Scott Frederick <sfrederick@vmware.com>
Co-authored-by: Madhura Bhave <mbhave@vmware.com>,Polish,Merge branch '2.4.x'
Test our Gradle plugin against 6.9-rc-2
Make sure the Couchbase's Jackson module is available
When we customize Couchbase's JacksonJsonSerializer with the
auto-configured ObjectMapper, Couchbase's JsonValueModule is lost.
This prevents the storage and retrieval of JSON objects.
This commit updates the Couchbase auto-configuration to use a copy
of the auto-configured ObjectMapper with the JsonValueModule added
to it.
Fixes gh-26363,Merge branch '2.4.x',Start building against Spring Framework 5.3.7 snapshots
See gh-26361,Start building against Reactor 2020.0.7 snapshots
See gh-26359,Start building against Spring Framework 5.3.7 snapshots
See gh-26360,Start building against Reactor 2020.0.7 snapshots
See gh-26358,Polish docs,Merge branch '2.4.x'
Align productionRuntimeClasspath with runtimeClasspath
Fixes gh-25798,Polish,Use consistent asciidoctor subs attribute
Polish source type for Gradle snippets,Delete R2dbcDatabaseInitializationConfiguration
The `R2dbcDatabaseInitializationConfiguration` docs class is not needed
in 2.5.x.
Configure source and target compatibility at the task level
Ensure that server tests pick up latest snapshots
Do not wait indefinitely in initialize test if refresh fails
Use American English spellings,Polish doc code samples
See gh-6313,Extract code samples from docs
See gh-6313,Merge branch '2.4.x'
Ignore empty values in config location properties
This commit updates config data property binding to ignore empty
elements in `spring.config.location` and `spring.config.import`
property values when a value is a comma-delimited string
representing a collection.
Fixes gh-26342,Merge pull request #26320 from agg505
* pr/26320:
  Polish README
Polish README
See gh-26320,Polish docs code
See gh-6313,Align docs package structure with heading IDs
See gh-6313,Merge branch '2.4.x'
Move content from CONTRIBUTING.adoc to the wiki
Test the Gradle plugin against Gradle 6.9-rc-1
Support reactive infrastructure with DataRedisTest
Previously DataRedisTest-annotated test could not use reactive
operations as RedisReactiveAutoConfiguration is not considered. This
commit includes this auto-configuration and adds a test to exercise this
scenario.
Merge pull request #26321 from matthiasstock
* pr/26321:
  Update copyright year of changed file
  Fix typo in NamedContributors Javadoc
Update copyright year of changed file
See gh-26321,Fix typo in NamedContributors Javadoc
See gh-26321,Merge branch '2.4.x'
Merge pull request #26292 from Haarolean
* pr/26292:
  Polish "Improve failure analysis with a single bean cycle"
  Improve failure analysis with a single bean cycle
Polish "Improve failure analysis with a single bean cycle"
See gh-26292,Improve failure analysis with a single bean cycle
See gh-26292,Merge branch '2.4.x'
Mark SpringBootConfiguration as Indexed
Previously, users of the components.index could not use the index in
scenario where Spring Boot needs to locate the SpringBootConfiguration
to use to bootstrap the test context, as AnnotatedClassFinder scans
the classpath for that stereotype specifically and that requires a
dedicated entry for it.
This commit makes sure that a SpringBootConfiguration-annotated type has
a dedicated entry in the components index.
Merge pull request #26316 from dreis2211
* pr/26316:
  Fix link to Webservices reference docs
Fix link to Webservices reference docs
See gh-26316,Split up adoc files
Use layout configuration in Maven build-image goal
This commit changes the Maven build-image goal to honor the `layout` and
`layoutFactory` parameters to ensure that the archive content sent to the
builder is the same as is used by the `repackage` goal to build the
archive file.
Fixes gh-26216,Validate section IDs in the reference documentation
See gh-26307,Merge branch '2.4.x'
Order test tasks to run after Checkstyle and formatting checks
Configure bootBuildImage's targetJavaVersion using a provider
Previously, the targetJavaVersion property of bootBuildImage was set
using the project's target compatibility directly. This meant that
property's value would reflect the configured target compatibility at
the time of the task's creation and any subsequent changes to the
target compatibility would be missed.
This commit updates the registration of the bootBuildImage task to set
the value of the targetJavaVersion property using a provider. This
indirection means that the project's target compatibility isn't read
until the value of the targetJavaVersion is read, allowing any changes
to the target compatibility to be picked up even if they're made after
the bootBuildImage task has been created.
Fixes gh-26297,Merge branch '2.4.x'
Document property names to enable reactive health indicators
Upgrade Ubuntu version in CI images
Upgrade Ubuntu version in CI images
Upgrade Ubuntu version in CI images
Align adoc filename with anchors
See gh-26296,Rationalize reference documentation anchors
Switch to spring-asciidoctor-backends SNAPSHOT
See gh-26293,Merge branch '2.4.x'
See gh-26261,Merge branch '2.3.x' into 2.4.x
See gh-26260,Fix workaround for JDK-8156584
See gh-26252
See gh-26261,Merge branch '2.3.x' into 2.4.x
See gh-26260,Refine workaround for JDK-8156584
The previous workaround worked but prevented caching of every test
task as the value of system property pointing to the custom security
properties file varied from build to build.
This commit refines the workaround to copy the file into the build
directory of the test task's project and reference it using a URL
that's relative to the task's working directory. This ensures that
the value of the system property doesn't change from build to build.
Fix key to datasource health indicator in reference doc
Set path sensitivity when configuring additional task inputs
Previously a number of file- or directory-based task inputs were
configured with specifying their path sensitivity. This meant
that the default absolute path sensitivity was used. For caches
that are cacheable this would result in a cache miss when the
inputs were identical other than being located at a different
absolute path as they are when running a CI build vs a local build.
This commit updates the configuration of additional task inputs
to use relative path sensitivity. A property name for each input has
also been configured. This makes them easier to identify in build
scans.
Merge pull request #26230 from zeldigas
* pr/26230:
  Polish "Fix ordering of metadata entries"
  Fix ordering of metadata entries
Polish "Fix ordering of metadata entries"
See gh-26230,Fix ordering of metadata entries
This commit provides a consistent ordering for groups that share the
same configuration property prefix.
See gh-26230,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Disable incrementalBuildTypeRenamed test
This commit disables a test that does not test what it is supposed to
and improve the Metadata assertions to fail early if more than one
matching item by name and type is found in the metadata.
See gh-26271,Merge branch '2.4.x'
Merge pull request #26264 from dreis2211
* gh-26264:
  Rename nohttp whitelist to allowlist
Rename nohttp whitelist to allowlist
See gh-26264,Merge branch '2.4.x'
Work around https://bugs.openjdk.java.net/browse/JDK-8156584
sun.security.x509.AlgorithmId.get(String) isn't thread-safe and can
lead to null be returned for an algorithm that should be present.
This commit aims to work around this problem by avoiding the call
to AlgorithmId.get(String). It does so by configuring the
PKCS12 key protection algorithm to one that starts with
pbewithhmacsha (case insensitive). This short-circuits the logic
in PKCS12KeyStore.mapPBEAlgorithmToOID(String) and avoids the call to
AlgorithmId.get(String). Thanks again to @dreis2211 for the
suggestion.
The work around is only used when building with Java 8 as the problem
was fixed in Java 9.
Merge pull request #26253 from dreis2211
* gh-26253:
  Fix GitHub tag determination following main branch rename
Fix GitHub tag determination following main branch rename
See gh-26253,Merge branch '2.4.x'
Align documentation with main default branch name
See gh-26248,Merge branch '2.4.x'
Update prepare-forward-merge following master->main rename
See gh-26248,Merge branch '2.3.x' into 2.4.x
Update maformed address to one that should fail on CI
Rename default branch to main
Avoid using yum (which requires http:// access) in launch script tests
Fixes gh-26240,Merge branch '2.4.x'
Fix binding random properties test
See gh-26201,Add missing asciidoctor heading anchors
Restore support for binding random properties
Revert 0588e989af93 so that `@ConfigurationProperties` can again be
bound using values from the `RandomValuePropertySource`.
Fixes gh-26201,Extract code samples from docs
See gh-6313,Merge branch '2.4.x'
Use bean class loader when importing auto-configuration
Fixes gh-26234,Merge branch '2.4.x'
Fix ignored use-last-modified property in Spring MVC
Prior to this commit, the `spring.web.resources.cache.use-last-modified`
configuration property support was lost during a merge operation right
before 2.4.2.
This is due to an invalid test that missed this unintended change. This
commit fixes both problems.
Fixes gh-26212,Extract code samples from docs
See gh-6313,Update copyright year of changed files,Extract code samples from docs
See gh-6313,Extract code samples from docs
See gh-6313,Formatting,Merge pull request #26200 from slawekjaranowski
* pr/26200:
  Test Maven plugin against latest Maven versions
Test Maven plugin against latest Maven versions
See gh-26200,Merge branch '2.4.x'
Merge pull request #26209 from zoosm3
* pr/26209:
  Align Maven version in system requirements with what is actually tested
Align Maven version in system requirements with what is actually tested
See gh-26209,Merge branch '2.4.x',Upgrade to Kafka 2.6.2
Upgrade Java 8 version in CI image
Upgrade Java 8 version in CI image
Upgrade Java 11 version in CI image
Upgrade Java 8 version in CI image
See gh-26188,Polish
Merge pull request #26188 from izeye
* pr/26188:
  Polish
Polish
See gh-26188,Merge branch '2.4.x'
Document that MeterFilters are only applied to a managed registry
Upgrade to Testcontainers 1.15.3
Use main branch when working with Homebrew tap's git repo
Make relative file references in checkstyle.xml more robust
Merge pull request #26167 from k163377
* pr/26167:
  Use new update site for Spring Java Format's Eclipse plugin
Use new update site for Spring Java Format's Eclipse plugin
See gh-26167,Merge branch '2.4.x'
Polish nohttp configuration
\gh-26166
Fix sourceType for spring.profiles.include
Document spring.profiles.group in configuration metadata
Merge pull request #26162 from izeye
* pr/26162:
  Fix broken assertions in tests
Fix broken assertions in tests
This commit also restores the HTTP response body
assertion that has been dropped in 5873ddd.
See gh-26162,Merge branch '2.4.x'
Merge pull request #14928 from nicce
* pr/14928:
  Polish "Enhance multiple entity manager factories how-to"
  Enhance multiple entity manager factories how-to
Polish "Enhance multiple entity manager factories how-to"
See gh-14928,Enhance multiple entity manager factories how-to
See gh-14928,Merge branch '2.4.x'
Exclude beans with scheduled methods from global lazy init
This commit updates TaskSchedulingAutoConfiguration to contribute a
LazyInitializationExcludeFilter that processes beans that have
@Scheduled methods. This lets them be contributed to the context so
that scheduled methods are invoked as expected.
Merge pull request #26149 from vsriram92
* gh-26194:
  Polish "Use ConfigDataLocationResolvers' class loader to load resolver names"
  Use ConfigDataLocationResolvers' class loader to load resolver names
Polish "Use ConfigDataLocationResolvers' class loader to load resolver names"
See gh-26149,Use ConfigDataLocationResolvers' class loader to load resolver names
See gh-26149,Add missing value provider metadata for SQL init resources
Merge pull request #26145 from izeye
* pr/26145:
  Update copyright year of changed file
  Polish
Update copyright year of changed file
See gh-26145,Polish
See gh-26145,Merge pull request #26150 from zuisong
* pr/26150:
  Fix wrong replacements for spring.datasource.[schema|data]
Fix wrong replacements for spring.datasource.[schema|data]
See gh-26150,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Upgrade CI to Docker 20.10.6
Upgrade CI to Docker 20.10.6
Upgrade CI to Docker 20.10.6
Merge pull request #25532 from katielevy1
* pr/25532:
  Polish contribution
  Polish KotlinConstructorParametersBinderTests
Polish contribution
See gh-25532,Polish KotlinConstructorParametersBinderTests
See gh-25532,Fix Windows build failures
See gh-23098,Revert "Switch default MVC path matching strategy"
This reverts commit ab8e599cfedd6d626daaee65fc86d8c0ae470d16.
See gh-24805,Update copyright year of changed files,Improve Log4J log level reset support
Update `Log4J2LoggingSystem` so that call to `setLevel` with a `null`
level with remove the logger if it was previously configured by a
`LoggingSystem` call.
To track which loggers have been configured by us, and which have been
configure directly by the user, a custom `LoggerConfig` subclass is
used. We'll only remove `LevelSetLoggerConfig` classes, for any others
we'll call `setLevel(null)` on the config.
Prior to this commit, it was impossible to set then reset a logger
level using the actuator endpoint. This is because Log4J doesn't provide
a way to get the actual configured level. If the `setLevel(null)` has
been applied, then `getLevel()` will return the value of the parent
logger or a default value of `ERROR`.
Fixes gh-24298,Merge branch '2.4.x'
Add StandardConfigDataResource.getProfile method
Add a `StandardConfigDataResource.getProfile()` method so that it's
possible to tell the profile used when reading a profile specific
resource.
Fixes gh-25940,Fix typo in Initialize a Database using basic SQL scripts
Merge pull request #26135 from izeye
* pr/26135:
  Polish
Polish
See gh-26135,Merge pull request #26134 from izeye
* pr/26134:
  Add RepositoryMetricsAutoConfiguration to spring.factories
Add RepositoryMetricsAutoConfiguration to spring.factories
See gh-26134,Merge branch '2.4.x',Next development version (v2.4.6-SNAPSHOT),Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Next development version (v2.3.11.BUILD-SNAPSHOT),Revert "Attempt to overcome Docker rate limiting on CI"
This reverts commit 51d57e19d092f59ee7389a4423e4988de30bc44d.
See gh-25838,Revert changes to make staging run Docker
See gh-26130,Merge pull request #26129 from dreis2211
* pr/26129:
  Avoid some redirects in docs
Avoid some redirects in docs
See gh-26129,Marking staging tasks as privileged so they can start Docker
See gh-26130,Start Docker before running a staging build
Upgrade to Spring WS 3.1.0-RC1
Upgrade to Spring Session 2021.0.0-RC1
Upgrade to Spring Kafka 2.7.0
Upgrade to Spring Integration 5.5.0-RC1
Merge pull request #25455 from nguyensach
* pr/25455:
  Polish 'Don't detect CloudPlatform when property is set'
  Don't detect CloudPlatform when property is set
Polish 'Don't detect CloudPlatform when property is set'
See gh-25455,Don't detect CloudPlatform when property is set
Update `CloudPlatform.isActive` to back-off from detection when any
`spring.main.cloud-platform` property is set.
See gh-25455,Merge branch '2.4.x'
Include optional shade plugin in published pom
Update `MavenPublishingConventions` to add a new `mavenOptional` feature
that allows us to declare optional dependencies that are also published
in the generated POM.
This change allows us to include the maven-shade-plugin in the
spring-boot-maven-plugin POM which fixes an issue with Eclipse m2e.
Fixes gh-21992,Log ApplicationAvailability state changes
Fixes gh-23098,Merge branch '2.4.x',Upgrade to Spring Integration 5.4.6
Include SQL init auto-config in Data RDBC test slice
Include SQL init auto-config in JDBC-based test slices
Document limitations of using deferred JPA bootstrap
Upgrade to Spring Data 2021.0.0
Harmonize Neo4jContainer startup options
Scan for ElasticSearch's @Document type
Upgrade to Infinispan 12.1.1.Final
Fix class condition on deprecated class
Merge pull request #26085 from rehevkor5
* pr/26085:
  Polish "Document spring.config.additional-location should be used early"
  Document spring.config.additional-location should be used early
Polish "Document spring.config.additional-location should be used early"
See gh-26085,Document spring.config.additional-location should be used early
See gh-26085,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Upgrade to SAAJ Impl 1.5.3
Upgrade to Micrometer 1.6.6
Upgrade to Lettuce 6.0.4.RELEASE
\gh-26102
Upgrade to HSQLDB 2.5.2
Upgrade to Glassfish JAXB 2.3.4
Upgrade to SAAJ Impl 1.5.3
Upgrade to Micrometer 1.5.13
Upgrade to Lettuce 5.3.7.RELEASE
Upgrade to HSQLDB 2.5.2
Upgrade to Glassfish JAXB 2.3.4
Upgrade to Flatten Maven Plugin 1.2.7
Upgrade to Micrometer 1.7.0-RC1
Upgrade to Spring HATEOAS 1.3.0
Merge pull request #26086 from dreis2211
* pr/26086:
  Fix Docker update detection on CI
Fix Docker update detection on CI
See gh-26086,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Increase SampleSessionApplicationTests timeout
Increase timeout in `SampleSessionApplicationTests` to fix flaky local
builds.,Ensure String to RSA key converters can be used
Add tests to ensure that RSA key converters can be used with an
auto-configured security setup.
See gh-26089
Support binding with BeanFactory ConversionService
Update `BindConverter` so that multiple `ConverterServices` can be
specified when binding. This change allows `ConversionServiceDeducer`
to add both the `BeanFactory` conversion service as well as a
custom `ApplicationConversionService` when beans annotated with
`@ConfigurationPropertiesBinding` are found.
Fixes gh-26089,Make getSharedInstance() unmodifiable
Update `ApplicationConversionService.getSharedInstance()` so that the
instance returned is unmodifiable and converters cannot be added or
removed from it.
Align buildSrc's Kotlin version with main project's
See gh-26080,Use a non-deprecated class to identify kotlin-gradle-plugin-api jar
See gh-26080,Merge branch '2.4.x'
Add package-info to o.s.b.test.autoconfigure.data.Cassandra
Polish o.s.b.liquibase package-info,Merge pull request #26078 from dreis2211
* gh-26078:
  Fix Spring Data Elasticsearch deprecations
Fix Spring Data Elasticsearch deprecations
See gh-26078,Upgrade to Kotlin 1.5.0-RC
\gh-26080
Polish indentation,Merge pull request #26041 from chughts
* gh-26041:
  Add reference to IBM MQ Spring Boot starter
Add reference to IBM MQ Spring Boot starter
See gh-26041,Allow the auto-configured RabbitMQ ConnectionFactory to be customized
Upgrade to HSQLDB 2.5.2
Upgrade to Nimbus JOSE JWT 9.8.1
Upgrade to OAuth2 OIDC SDK 9.3.3
Upgrade to Lettuce 6.1.1.RELEASE
Attempt to stabilise web server tests that use h2c
Apache HttpClient 5.1 doesn't cope with Jetty 10 sending
SETTINGS_ENABLE_CONNECT_PROTOCOL in the settings frame. It also appears
to be unstable when using Undertow, resulting in a failure and
"UT005032: Listener not making progress on framed channel, closing
channel to prevent infinite loop" being logged on the server-side.
Local experimentation suggests that Jetty's HTTP/2 client is more
robust and that it does not trigger the problem with Undertow. It also
fixes the problem with SETTINGS_ENABLE_CONNECT_PROTOCOL when testing
against Jetty 10 so this commit updates the tests to use Jetty's client.
Upgrade to Undertow 2.2.7.Final
Upgrade to Tomcat 9.0.45
Upgrade to Sun Mail 1.6.7
Upgrade to Selenium HtmlUnit 2.49.1
Upgrade to Rabbit AMQP Client 5.12.0
Upgrade to Netty tcNative 2.0.38.Final
Upgrade to Netty 4.1.63.Final
Upgrade to Neo4j Java Driver 4.2.4
Upgrade to MongoDB 4.2.3
Upgrade to Mockito 3.9.0
Upgrade to MIMEPull 1.9.14
Upgrade to Maven Invoker Plugin 3.2.2
Upgrade to Lombok 1.18.20
Upgrade to Liquibase 4.3.3
Upgrade to Lettuce 6.1.0.RELEASE
Upgrade to Jetty 9.4.39.v20210325
Upgrade to Jetty Reactive HTTPClient 1.1.7
Upgrade to Jaybird 4.0.3.java8
Upgrade to Jakarta Mail 1.6.7
Upgrade to Jackson Bom 2.12.3
Upgrade to HtmlUnit 2.49.1
Upgrade to Hibernate 5.4.30.Final
Upgrade to Git Commit ID Plugin 4.0.4
Upgrade to Flyway 7.7.3
Upgrade to Elasticsearch 7.12.0
Upgrade to Dropwizard Metrics 4.1.19
Upgrade to Couchbase Client 3.1.4
Upgrade to Cassandra Driver 4.11.0
Upgrade to AppEngine SDK 1.9.88
Upgrade to Spring Framework 5.2.14
Upgrade to Json-smart 2.4.2
Add a config prop for the embedded database connection
Previously, the embedded database connection that would be used
could only be controlled via the classpath. If multiple embedded
database dependencies were present, it wasn't possible to control
the one that the auto-configured would use. It also wasn't possible
to disable auto-configuration of an embedded database.
This commit introduces a new configuration property,
spring.datasource.embedded-database-connection. It can be set to
one of the values of the EmbeddedDatabaseConnection enum to control
the auto-configuration of an embedded database. Setting it to none
will disable the auto-configuration and ensure that an external
database is used instead.
Test JettyReactiveWebServerFactory against Jetty 10
Test that HTTP/1.1 still works when HTTP/2 is enabled
See gh-25856,Temporarily disable h2c tests with Jetty 10
Upgrade to Reactor 2020.0.6
Upgrade to Reactor 2020.0.6
Upgrade to Spring Security 5.3.9
Upgrade to Reactor Dysprosium-SR19
Switch default MVC path matching strategy
Change the default `spring.mvc.pathmatch.matching-strategy` to
`PATH_PATTERN_PARSER`.
Remove @Persistent from MongoDB entity scanning
This commit removes `org.springframework.data.annotation.Persistent`
from the annotation types used for MongoDB entity scanning to align
with Spring Data MongoDB.
Fixes gh-25797,Auto-configure H2C when HTTP/2 is enabled and SSL is disabled,Revert "Work around micrometer-metrics/micrometer#2557"
This reverts commit 5e03612a532fdb314457032867ebb1113d826f71.
Harmonize Elasticsearch converter auto-configuration
This commit harmonizes our auto-configuration so that default converters
are configured the same way ElasticsearchConfigurationSupport does.
Support Gradle 7 and raise minimum supported version to 6.8
Document default behaviour of DataJpaTest#showSql
Fix group IDs of HttpCore v4 and v5 dependency management
See gh-26004,Provide auto-configuration for using Apache HttpClient 5 with WebClient
* pr/25374:
  Polish "Add section to update the Reference Documentation"
  Add section to update the Reference Documentation
\gh-25374
Polish "Add section to update the Reference Documentation"
See gh-25374,Add section to update the Reference Documentation
See gh-25374,Merge pull request #25986 from dreis2211
* pr/25986:
  Update copyright year of changed file
  Remove unused method parameters
Upgrade to Undertow 2.2.7.Final
Upgrade to Tomcat 9.0.45
Upgrade to Sun Mail 1.6.7
Upgrade to Netty tcNative 2.0.38.Final
Upgrade to Netty 4.1.63.Final
Upgrade to MIMEPull 1.9.14
Upgrade to Lombok 1.18.20
Upgrade to Kotlin 1.4.32
Upgrade to Jetty 9.4.39.v20210325
Upgrade to Jetty Reactive HTTPClient 1.1.7
Upgrade to Jaybird 3.0.11
Upgrade to Jakarta Mail 1.6.7
Upgrade to Hibernate 5.4.30.Final
Upgrade to Dropwizard Metrics 4.1.19
Upgrade to AppEngine SDK 1.9.88
Update copyright year of changed file
See gh-25986,Remove unused method parameters
See gh-25986,Merge pull request #25980 from izeye
* pr/25980:
  Polish
Polish
See gh-25980,Work around micrometer-metrics/micrometer#2557
Merge pull request #25708 from bono007
* gh-25708:
  Polish "Provide health for an AbstractRoutingDataSource's resolved targets"
  Provide health for an AbstractRoutingDataSource's resolved targets
Polish "Provide health for an AbstractRoutingDataSource's resolved targets"
See gh-25708,Provide health for an AbstractRoutingDataSource's resolved targets
See gh-25708,Start building against Spring Integration 5.5.0-RC1 snapshots
See gh-25929,Merge pull request #25997 from dreis2211
* pr/25997:
  Test our Gradle Plugin against Gradle 7.0
Test our Gradle Plugin against Gradle 7.0
See gh-25997,Add Spring Data Repository metrics support
Add support for Spring Data Repository metrics by integrating with
Spring Data's new `RepositoryMethodInvocationListener` support.
Rework 'Supported Metrics' reference documentation
Rework the 'Supported Metrics' documentation to improve consistency
access subsections. Details about the `@Timer` annotation have been
pulled into a new section so that they can be referenced rather than
repeated.
See gh-22217,Rework @Timer annotation support
Rework existing `@Timer` annotation support to remove duplicate code
and offer general purpose utilities that can be used in future metrics
support.
See gh-23112
See gh-22217,Polish,Fix title case capitalization,Extract XML example from Maven plugin adoc file
See gh-25993,Merge branch '2.4.x'
Document runtime JVM configuration when building an image
Fixes gh-21478,Merge branch '2.4.x'
Ensure that containers' static resource handling not MVC's is used
See gh-25988,Merge branch '2.3.x' into 2.4.x
See gh-25987,Ensure that classes and resources are in place before documenting
Filter out non-public classes when documenting auto-config classes
Fixes gh-25948,Merge pull request #25943 from theborakompanioni
* pr/25943:
  Polish "Add reference to Bitcoin Spring Boot starter"
  Add reference to Bitcoin Spring Boot starter
Polish "Add reference to Bitcoin Spring Boot starter"
See gh-25943,Add reference to Bitcoin Spring Boot starter
See gh-25943,Merge branch '2.4.x'
See gh-25985,Polish FileSystemWatcherTests
See gh-25982,Merge pull request #25981 from dreis2211
* gh-25981:
  Remove Gradle 5.6.x support from docs
Remove Gradle 5.6.x support from docs
See gh-25981,Merge branch '2.4.x'
Merge pull request #25951 from runningcode
* gh-25951:
  Upgrade to Gradle Enterprise Gradle Plugin 3.6.1
Upgrade to Gradle Enterprise Gradle Plugin 3.6.1
See gh-25951,Merge branch '2.4.x'
Make FileSystemWatcherTests more robust
Previously, several tests in FileSystemWatcherTests assumed that all
of the changes detected by the watcher would be grouped into a single
change set. This assumption breaks down when a test runs slowly (due
to CPU or IO contention, for example), and making changes to the file
system takes long then the watcher's polling interval. When this
happens, the changes will be split across two (or more).
This commit attempts to make the tests more robust. The tests now
tolerate multiple changes sets by combining them and asserting that
across the n change sets, only the expected changes were detected.
* pr/25952:
  Fix MongoMetricsAutoConfigurationTests
Fix MongoMetricsAutoConfigurationTests
See gh-25952,Merge branch '2.4.x'
Merge pull request #25947 from dreis2211
* pr/25947:
  Fix typos in docs
Fix typos in docs
See gh-25947,Upgrade to Undertow 2.1.7.Final
Upgrade to Tomcat 9.0.45
Upgrade to Sun Mail 1.6.7
Upgrade to Spring Kafka 2.5.12.RELEASE
Upgrade to Spring Batch 4.2.6.RELEASE
Upgrade to Spring AMQP 2.2.16.RELEASE
Upgrade to RSocket 1.0.4
Upgrade to R2DBC Bom Arabba-SR9
Upgrade to Postgresql 42.2.19
Upgrade to OAuth2 OIDC SDK 7.1.3
Upgrade to Netty tcNative 2.0.38.Final
Upgrade to Netty 4.1.63.Final
Upgrade to Neo4j OGM 3.2.21
Upgrade to MongoDB 4.0.6
Upgrade to MIMEPull 1.9.14
Upgrade to Micrometer 1.5.12
Upgrade to Maven Invoker Plugin 3.2.2
Upgrade to Lombok 1.18.20
Upgrade to Jetty 9.4.39.v20210325
Upgrade to Jetty Reactive HTTPClient 1.1.7
Upgrade to Jaybird 3.0.11
Upgrade to Jakarta Mail 1.6.7
Upgrade to Hibernate 5.4.30.Final
Upgrade to Dropwizard Metrics 4.1.19
Upgrade to Byte Buddy 1.10.22
Upgrade to AppEngine SDK 1.9.88
Start building against Micrometer 1.7.0-RC1 snapshots
See gh-25934,Start building against Spring WS 3.1.0-RC1 snapshots
See gh-25933,Start building against Spring Session 2021.0.0-RC1 snapshots
See gh-25932,Start building against Spring Security 5.5.0-RC1 snapshots
See gh-25931,Start building against Spring Kafka 2.7.0 snapshots
See gh-25930,Start building against Spring Data 2021.0.0 snapshots
See gh-25928
Upgrade to Jedis 3.6.0-RC1
Start building against Spring HATEOAS 1.3.0 snapshots
See gh-25927,Start building against Spring Framework 5.3.6 snapshots
See gh-25926,Update @Timed WebFlux documentation
Merge pull request #23112 from anshlykov
* pr/23112:
  Polish 'Support @Timed annotation for WebFlux'
  Support @Timed annotation for WebFlux
Polish 'Support @Timed annotation for WebFlux'
Extract common method logic to a `HandlerMethodTimedAnnotations`
utility class and also add some caching. Also move the test code
into a single class.
See gh-23112,Support @Timed annotation for WebFlux
Update `MetricsWebFilter` to support `@Timed` annotations on the WebFlux
handler methods or beans.
See gh-23112,Merge pull request #24490 from mederel
* pr/24490:
  Polish 'Support system-dependent path separators'
  Support system-dependent path separators
Polish 'Support system-dependent path separators'
See gh-24490,Support system-dependent path separators
Update `StandardConfigDataLocationResolver` so that it recognizes
both `/` and `File.separator` suffixes as directories.
Prior to this commit, working with directories on Windows was awkward
since the path separator is `\`. If a directory were specified in the
form `c:\config\`, an exception was raised complaining it did not end
with '/'.
See gh-24490,Short circuit already covered property sources
Add an alternative `PropertySourcesPropertyResolver` that can short
circuit resolution of properties that are already covered by the
`ConfigurationPropertySourcesPropertySource`.
Prior to this commit, calling `getProperty` or `containsProperty` on an
`Environment` that has `ConfigurationPropertySources` attached could
result in two identical calls to the underlying source. The first call
would be via the adapted source, and the second would be direct. Since
we can now plug-in a custom `PropertySourcesPropertyResolver` to the
`Environment`, we can optimize resolution so that calls happen only
once.
Add customer Application Environment subclasses
Add custom `ApplicationEnvironment`, `ApplicationServletEnvironment`
and `ApplicationReactiveWebEnvironment` subclasses for use with
`SpringApplication`. The subclasses all disable the resolution of
active and default profiles using properties since this is handled
directly by the `ConfigDataEnvironmentPostProcessor`.
\gh-24892
See gh-24890,Add with/without methods to ConfigData.Options
Add convenience methods to ConfigData.Options to allow new Options
instances to be created with options excluded or included.
See gh-25766,Merge branch '2.4.x'
Preserve file permissions in images built by Gradle
This commit copies the file mode along with other attributes when
copying files from the source archive to the build container while
building an image using the Gradle plugin. This preserves file
permissions on any resources included in the source archive.
Fixes gh-25915,Merge branch '2.4.x',Link build tools docs version properties section
Start building against Spring Session 2020.0.4 snapshots
See gh-25912,Start building against Spring Security 5.4.6 snapshots
See gh-25911,Start building against Spring Data 2020.0.8 snapshots
See gh-25910,Start building against Spring Framework 5.3.6 snapshots
See gh-25909,Merge branch '2.4.x'
Fix SSL configuration with Reactor Netty
Prior to this commit, the SslServerCustomizer would use a Reactor Netty
API that lets users customize the SSL configuration, but later override
some of the choices with defaults.
This commits moves from the new deprecated Reactor Netty API and instead
uses a new variant that builds the defaults and lets developers override
them if they want to.
Fixes gh-25913,Merge branch '2.4.x'
Merge pull request #25884 from alex-bel-apica
* pr/25884:
  Polish "Properly close input streams when loading key stores"
  Properly close input streams when loading key stores
Polish "Properly close input streams when loading key stores"
See gh-25884,Properly close input streams when loading key stores
See gh-25884,Upgrade Ubuntu version in CI images
Fix package tangle in the actuator endpoint package by relocating a
few classes.
The `Producible` and `ProducibleOperationArgumentResolver` classes have
been moved from `endpoint.annotation` to `endpoint` since they aren't
directly tied to annotations.
The `ApiVersion` class has been moved from `endpoint.http` to
`endpoint` since it needs to implement `Producible` and isn't really
tied to HTTP.
Revert "Switch default MVC path matching strategy"
This reverts commit ab8e599cfedd6d626daaee65fc86d8c0ae470d16.
See gh-24805,Switch default MVC path matching strategy
Change the default `spring.mvc.pathmatch.matching-strategy` to
`PATH_PATTERN_PARSER`.
Allow 'servet.path' with path pattern parser
Remove the restriction previously prevented `spring.mvc.servlet.path`
from being combined with a `spring.mvc.pathmatch.matching-strategy`
of `PATH_PATTERN_PARSER`. Spring Framework supports this combination
as of v5.3.4.
See gh-24805,Start building against Spring Session Dragonfruit-SR3 snapshots
See gh-25907,Start building against Spring Security 5.3.9 snapshots
See gh-25906,Start building against Spring Data Neumann-SR9 snapshots
See gh-25905,Upgrade to Spring HATEOAS 1.1.5
Start building against Spring Framework 5.2.14 snapshots
See gh-25903,Start building against Reactor Reactor Dysprosium-SR19
See gh-25902,Merge pull request #25829 from jdubois
* gh-25829:
  Polish "Add detection of Azure App Service to CloudPlatform"
  Add detection of Azure App Service to CloudPlatform
Polish "Add detection of Azure App Service to CloudPlatform"
See gh-25829,Add detection of Azure App Service to CloudPlatform
See gh-25829,Merge branch '2.4.x'
Configure Kotlin compilation to use 1.3 apiVersion and languageVersion
Revert "Merge branch '2.4.x'"
This reverts commit 97b26b4886d163335b8b749633520d7432b8818e, reversing
changes made to 6f9b1ed6a3b1b219f5254d6923c64c0948e5c9b4.
See gh-25840,Merge branch '2.4.x',Revert "Merge branch '2.3.x' into 2.4.x"
This reverts commit 586ce00e06aad0532b9bb4753baa343b0f9acff7, reversing
changes made to 563b8a8cecb29911828701aa211a9b43663f72c6.
See gh-25839,Merge branch '2.3.x' into 2.4.x,Revert "Use test harness for image building integration tests"
This reverts commit da9d8d6055dd458419e4268a7924f7abd33ee919.
See gh-25838,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Attempt to overcome Docker rate limiting on CI
Update the common build script to pull buildpack images early using the
authenticated CLI.
See gh-25838,Fix WebSessionManager auto-configuration order
Auto-configure `SessionAutoConfiguration` before
`WebFluxAutoConfiguration` to ensure that the correct
`WebSessionManager` bean is created.
See gh-20970,Update copyright year of changed files,Polish,Merge pull request #25815 from parviz-93
* gh-25815:
  Polish "Add config props for keep-alive timeout and max keep-alive reqs"
  Add config props for keep-alive timeout and max keep-alive reqs
Polish "Add config props for keep-alive timeout and max keep-alive reqs"
See gh-25815,Add config props for keep-alive timeout and max keep-alive reqs
See gh-25815,Add SameSite session cookie config property for WebFlux
This commit adds a new `spring.webflux.session.cookie.same-site`
confuguration property that sets the default value for the "SameSite"
attribute in the WebFlux session cookies.
Make Asciidoctor tasks run when Java examples are updated
Merge pull request #23990 from bono007
* gh-23990:
  Polish "Auto-configure Mongo metrics"
  Auto-configure Mongo metrics
Polish "Auto-configure Mongo metrics"
See gh-23990,Auto-configure Mongo metrics
See gh-23990,Polish Quartz endpoint documentation
See gh-10364,Merge pull request #10364 from vpavic
* pr/10364:
  Polish "Add Quartz actuator endpoint"
  Add Quartz actuator endpoint
Polish "Add Quartz actuator endpoint"
This commit reworks the initial proposal so that jobs and triggers are
treated as first class concepts.
`/actuator/quartz` now returns the group names for jobs and triggers.
`actuator/quartz/jobs` returns the job names, keyed by the available
group names, while `/actuator/quartz/triggers` does the same for
triggers.
`/actuator/jobs/{groupName}` provides an overview of a job group. It
provides a map of job names with the class name of the job.
implementation
`/actuator/triggers/{groupName}` provides an overview of a trigger
group. There are five supported trigger implementations: cron, simple,
daily time interval, calendar interval, and custom for any other
implementation. Given that each implementation has specific settings,
triggers are split in five objects.
`/actuator/jobs/{groupName}/{jobName}` provides the full details of a
particular job. This includes a sanitized data map and a list of
triggers ordered by next fire time.
`/actuator/triggers/{groupName}/{triggerName}` provides the full details
of a particular trigger. This includes the state, its type, and a
dedicate object containing implementation-specific settings.
See gh-10364,Add Quartz actuator endpoint
See gh-10364,Test our Gradle plugin against Gradle 7.0-rc-2
See gh-25766,Merge branch '2.4.x'
Support profile specific ConfigData imports
Update the `ConfigData` import support to allow individual property
sources to be imported with a higher precedence than profile specific
imports.
Prior to this commit, imported sources would always have a higher
precedence than the file that imported them, but a lower precedence
than any profile-specific variant of the same file.
For example, given an `application.properties` that imports `myconfig`,
the contributor tree would be as follows:
 ROOT
  +- `application.properties`
  |    +- myconfig
  +- `application-<profile>.properties`
The precedence would be:
 1) `application-<profile>.properties`
 2) myconfig
 3) `application.properties`
This works well for most situations, but can be confusing if import is
for a profile-specific property source. For example:
 ROOT
  +- `application.properties`
  |    +- myconfig
  |    +- myconfig-<profile>
  +- `application-<profile>.properties`
Results in the order precedence of:
 1) `application-<profile>.properties`
 2) myconfig-<profile>
 3) myconfig
 4) `application.properties`
This means that whilst `myconfig` overrides `application.properties`,
`myconfig-profile` does not override `application-<profile>.properties`.
For this specific situation, the preferable order would be:
 1) myconfig-<profile>
 2) `application-<profile>.properties`
 3) myconfig
 4) `application.properties`
To support this alternative ordering a new `PROFILE_SPECIFIC` config
data option has been added. Additionally, options may now be specified
on a per-source basis by using the `PropertySourceOptions` interface.
Fixes gh-25766,Merge branch '2.4.x'
Merge pull request #25882 from shakuzen
* pr/25882:
  Polish HealthIndicators table in docs
Polish HealthIndicators table in docs
`=======` was showing up in the header of the table, which should not
be there.
See gh-25882,Merge branch '2.4.x'
Merge pull request #25875 from izeye
* pr/25875:
  Polish contribution
  Polish
Polish contribution
See gh-25875,Polish
See gh-25875,Allow to manually tag request metrics with exceptions
Prior to this commit, some exceptions handled at the controller or
handler function level would:
* not bubble up to the Spring Boot error handling support
* not be tagged as part of the request metrics
This situation is inconsistent because in general, exceptions handled at
the controller level can be considered as expected behavior.
Also, depending on how the exception is handled, the request metrics
might not be tagged with the exception.
This will be reconsidered in gh-23795.
This commit prepares a transition to the new situation. Developers can
now opt-in and set the handled exception as a request attribute. This
well-known attribute will be later read by the metrics support and used
for tagging the request metrics with the exception provided.
This mechanism is automatically used by the error handling support in
Spring Boot.
Ensure that Cassandra's DriverConfigLoader is only closed once
Fixes gh-25796,Merge branch '2.4.x'
Use main as the branch name in info endpoint example
Merge pull request #25800 from MatejNedic
* gh-25800:
  Polish "Fix no such bean definition with ancestor-defined Validator"
  Fix no such bean definition with ancestor-defined Validator
Polish "Fix no such bean definition with ancestor-defined Validator"
See gh-25800
Fix no such bean definition with ancestor-defined Validator
See gh-25800,Merge branch '2.4.x'
Use ApplicationContextRunner in ValidationAutoConfigurationTests
Upgrade Ubuntu version in CI images
Ensure that class proxying is forced before AutoProxyCreator is created
Previously, using @EnableGlobalMethodSecurity would cause the
AutoProxyCreator to be created before the AOP auto-configuration had
called AopUtils.forceAutoProxyCreatorToUseClassProxying. Forcing
auto proxy creation changes the AutoProxyCreator's bean definition
so it has no effect when attempted after the creator has been created.
This commit updates the AOP auto-configuration to use a
BeanFactoryPostProcessor to force the use of class proxying. This
ensures that the changes to the auto proxy creator's bean definition
are in place before any bean creation has been performed.
Fixes gh-25413,Merge pull request #25534 from robert-smith-911
* pr/25534:
  Polish "Extract XML examples from Maven plugin adoc files"
  Extract XML examples from Maven plugin adoc files
Polish "Extract XML examples from Maven plugin adoc files"
See gh-25534,Extract XML examples from Maven plugin adoc files
See gh-25534,Merge branch '2.4.x'
Align PushGatewayManager's exception handling with PushMeterRegistry's
Previously, would log an error for any exception and also stop
publishing for an UnknownHostException. By constrast, Micrometer's
PushMeterRegistry treats all exceptions the same, logging a warning
and continuing with subsequent push attempts.
This commit updates the push gateway manager's behaviour to match
PushMeterRegistry. UknownHostExceptions no longer receive special
treatment and push (and delete) failures are now logged as warnings
rather than errors.
Fixes gh-25804,Merge branch '2.4.x'
Use test harness for image building integration tests
This commit modifies the integration tests for the Maven and Gradle
image building goal and task to use a custom builder as a test harness
to verify that the plugins invoke the builder as expected.
Fixes gh-25838,Merge branch '2.4.x'
See gh-25837,Merge branch '2.3.x' into 2.4.x
See gh-25836,Ensure that upstream jars have been built
See gh-25835,Merge branch '2.4.x'
Defer processing of zipTree source until execution time
Merge pull request #25621 from robert-smith-911
* gh-25621:
  Polish "Document Failsafe configuration when not using starter parent"
  Document Failsafe configuration when not using starter parent
Polish "Document Failsafe configuration when not using starter parent"
See gh-25621,Document Failsafe configuration when not using starter parent
See gh-25621,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Consistent use of @deprecated since
Restore the patch version number for consistency with `@since`
tags.
See gh-25808,Add Netty memory leak detection config property
This commit adds a new `spring.netty.leak-detection` configuration
property that selects the level of memory leak detection for the Netty
engine.
This configuration is applied statically to Netty; this means all
(non-shaded) Netty usages as client or server will be impacted by this
change.
Developers might use this property during development or tests to find
causes of memory leaks when dealing with Netty buffers.
See gh-25826,Merge branch '2.3.x' into 2.4.x
See gh-25825,Consistent use of @deprecated since
See gh-25808,Restore deprecated JobLauncherCommandLineRunner
Restore the deprecated `JobLauncherCommandLineRunner` class and extend
removal until 2.6. The class is still needed by spring-cloud-task.
Update deprecations with for removal targets
Update all deprecation tags to include a removal target.
Polish
See gh-25818,Record server metrics for cancelled connections
Prior to this commit, the Actuator instrumentation for WebFlux servers
would not record metrics in two cases:
* the client disconnects before the response has been sent
* a server timeout is triggered before the response is sent
This commit improves the existing instrumentation to record metrics in
these cases. Since the causes of timeouts/disconnections can vary a lot,
the chosen "outcome" tag for metrics is "UNKNOWN".
Generalize database initialization detection and include R2DBC
Improve diagnostics of ClassPathFileSystemWatcherTests
See gh-25820,Polish
See gh-25819,Merge branch '2.4.x'
Use constructor injection in SpringBootRepositoryRestConfigurer
Auto-configure script-based R2DBC database initialization
See gh-24741,Generalize script-based DB initialization and add R2DBC initializer
See gh-24741,Derive a ConnectionFactoryBuilder from an existing ConnectionFactory
Merge pull request #25810 from dreis2211
* pr/25810:
  Fix flaky QuartzAutoConfigurationTests
Fix flaky QuartzAutoConfigurationTests
See gh-25810,Merge branch '2.4.x'
Merge pull request #25809 from dreis2211
* gh-25809:
  Increase test coverage on Java 16
Increase test coverage on Java 16
See gh-25809,Fix Maven image building with classifiers
Fixes gh-25736,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Polish,Merge branch '2.4.x'
Support all known endpoint types
Previously, the configuration metadata annotation processor only
declared support for `@Endpoint` and none of the other more
specialized `@…Endpoint` annotations that are meta-annotated with
`@Endpoint` such as `@WebEndpoint` and `@JmxEndpoint. This would
result in missing metadata if a full or incremental build only
compiled classes annotated with one of the more specialized
`@…Endpoint` annotations as the annotation processor would not be
called.
This commit updates the processor's supported annotation types to
include every known `@…Endpoint` annotation. The test processor has
also been similarly updated to align its behaviour with that of the
main processor.
Fixes gh-25388,Polish indentation,Merge branch '2.4.x'
Deprecate Bootstrapper
Deprecate the `Bootstrapper` interface entirely and provide a
`BootstrapRegistryInitializer` alternative so that people can migrate.
Unfortunately our previous attempt to fix the typo in the `Bootstrapper`
interface didn't provide us a way to remove the deprecated method
without impacting users. It was also problematic for people who were
implementing `Bootstrapper` rather than using a lambda since they needed
to introduce the deprecated method.
We unfortunately can't see a way to fix the original typo without
introducing a new interface.
Fixes gh-25735,Merge branch '2.4.x'
Merge pull request #25778 from framon
* pr/25778:
  Polish 'Ignore quality value when removing MediaType.ALL'
  Ignore quality value when removing MediaType.ALL
Polish 'Ignore quality value when removing MediaType.ALL'
See gh-25778,Ignore quality value when removing MediaType.ALL
Update the default reactive exception handler so that `MediaType.ALL`
is removed regardless of any quality setting. Prior to this commit,
the "match-all" media type was not properly ignored if it has a quality
value and would show HTML content if the accept header was
`application/json, */*;q=0.9`.
See gh-25778,Merge branch '2.4.x'
Chain caught InvalidEndpointRequestExceptions
Update `AbstractWebMvcEndpointHandlerMapping` to chain any caught
InvalidEndpointRequestExceptions so that a more complete stacktrace
is available. The exception has also been updated to a
`ResponseStatusException` so that the reason can be propagated.
Fixes gh-25642,Merge branch '2.4.x'
Drop Java 15 build
Move DataSource init auto-config out of DataSourceAutoConfiguration
Previously, the auto-configuration for DataSource initialization and
the properties used to configure it were part of the general
DataSource auto-configuration and properties.
This commit moves the auto-configuration of DataSource initialization
out into a separate top-level auto-configuration class. Similarly,
the properties for configuring DataSource initialization have been
moved from `spring.datasource.*` into `spring.sql.init.*`.
The old initialization-related `spring.datasource.*` properties have
been deprecated but can still be used. When they are used, they new,
separate initialization auto-configuration will back off. In other
words, the initialization related `spring.datasource.*` properties
and the `spring.sql.init.*` properties cannot be used in combination.
Improve testing of optional schema and data scripts
See gh-25487,Rename DDL/DML script location properties
See gh-25756,Merge pull request #25377 from artembilan
* pr/25377:
  Polish "Expose Spring Integration global properties"
  Expose Spring Integration global properties
Polish "Expose Spring Integration global properties"
See gh-25377,Expose Spring Integration global properties
Spring Integration comes with some global properties which can be
configured via `META-INF/spring.integration.properties`. The framework
then provides an `integrationGlobalProperties` bean as an
`org.springframework.integration.context.IntegrationProperties`
instance.
This commit allows users to configure these using regular
`application.properties`. If a `META-INF/spring.integration.properties`
file exists, the values are used as fallback.
See gh-25377,Merge branch '2.4.x'
Delete unpacked jars when the JVM exits
Update `JarFileArchive` so that any unpacked files are now deleted when
the JVM exits.
Align unpack logic with Files.createTempDirectory
Update `JarFileArchive` to align the way that it creates temp files and
folders with the way that `Files.createTempDirectory` works.
Add missing @Deprecated annotations,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Restore tomcat-embed TldPatterns
Restore tomcat-embed-core-* and tomcat-embed-logging-* patterns which
were inadvertently removed in commit 0ec8d281ef.
See gh-25764,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x
Update copyright year of changed files,Merge branch '2.4.x'
Align TldPatterns with Tomcat default
Update `TldPatterns` to align with the latest default shipped by Tomcat.
This commit also introduces a test to ensure that we will remain aligned
going forwards.
Test auto-configured MockRestServiceServer with metrics and a root URI
Add environment prefix support to SpringApplicationBuilder
Apply any root URI to RestTemplate metric's URI tag
Previously, a root URI configured via RestTemplateBuilder's rootUri
method and RootUriTemplateHandler was not taken into account when
generated the URI tag for RestTemplate request metrics.
This commit updates MetricsClientHttpRequestInterceptor to be aware
of RootUriTemplateHandler and capture the URI template once the
root URI has been applied.
Fixes gh-25744,Provide a constant for graceful shutdown's smart lifecyle phase
In order to provide a single constant for graceful shutdown's smart
lifecycle, this commit replaces the package-private reactive and
servlet-specific implementations with a single public implementation
that can be used by both web stacks. This new public implementation
provides a constant for its smart lifecycle phase.
Test our Gradle plugin against Gradle 7.0-rc-1
Relax Micrometer import control for docs examples
See gh-25762,Merge branch '2.4.x'
Prevent import of Micrometer class outside of the Actuator
Move script-based DataSource initializer into spring-boot
\gh-25487
Move DataSource dependency detection into dedicated package
Merge pull request #25129 from bono007
* pr/25129:
  Polish "Take JPA database action into account when setting ddlAuto"
  Take JPA database action into account when setting ddlAuto
Polish "Take JPA database action into account when setting ddlAuto"
See gh-25129,Take JPA database action into account when setting ddlAuto
See gh-25129,Deprecate support for Mustache's Environment fallback
Drop support for Gradle 5.6.x
Test the Gradle plugin against 7.0-milestone-3
Upgrade spring-asciidoctor-backends to 0.0.1-M1
Polish 'Support OpenMetrics text format with Prometheus'
Support OpenMetrics text format with Prometheus
Update `PrometheusScrapeEndpoint` so that it can produce both classic
Prometheus text output as well as Openmetrics output.
See gh-25564,Refine 'Allow operations to produce different output'
Refine the new `Producible` support so that it can also be used with
`@ReadOperation`, `@WriteOperation` and `@DeleteOperation` annotations.
This update allows the same enum to be used both as an argument and as
an indicator of the media-types that an operation may produce.
Allow operations to produce different output
Update the actuator @Enpoint` infrastructure code so that operations
may inject enums that indicate the type of output to produce. A new
`Producible` interface can be implemented by any enum that indicates
the mime-type that an enum value produces.
The new `OperationArgumentResolver` provides a general strategy for
resolving operation arguments with `ProducibleOperationArgumentResolver`
providing support for `Producible` enums. Existing injection support has
been refactored to use the new resolver.
See gh-25738,Update copyright year of changed files,Polish,Fix package tangle and polish prefix support
Polish the prefix support introduced in commit a8592f36d4 and fix a
package tangle between `boot.context.properties.source` and `boot.env`.
The `Prefix` interface has now been moved into a new default method on
`OriginLookup`.
See gh-3450,Merge branch '2.4.x',Next development version (v2.4.5-SNAPSHOT),Polish,Merge branch '2.4.x',Upgrade to Spring Batch 4.3.2
Upgrade to Spring Batch 4.3.2
Upgrade to Spring AMQP 2.3.6
Upgrade to Spring Integration 5.5.0-M3
Upgrade to Spring Integration 5.4.5
Allow DB migrations without DataSourceProperties
Update `FlywayAutoConfiguration`, `LiquibaseAutoConfiguration` and
`DataSourceInitializer` classes so that they no longer depend on
`DataSourceProperties`. DB migrations can now be performed against
a `@Bean` defined primary `DataSource` with an alternative
username/password.
This update also removed using fallback properties when a custom
connection `url` is defined with Flyway or Liquibase. We now assume
that `username`, `password` and `driver-class-name` will be provided
if the default values are unacceptable. Our previous logic was
particularly flawed if a custom URL caused a change of driver type.
Refactor DataSourceBuilder and add derivedFrom
Refactor `DataSourceBuilder` to use direct property mappers rather than
the `Binder` and aliases. Supported DataSource types now include two-way
mappers which allows us to both get and set properties in a uniform way.
A new `derivedFrom` factory method has been added which allows a new
`DataSource` to be derived from an existing one. This update is
primarily to allow Flyway and Liquibase migrations to work against a
`@Bean` configured DataSource rather than assuming that the primary
DataSource was always created via auto-configuration.
See gh-25643,Change Kafka cleanup.on-shutdown default to false
Align our property with the recently changed spring-kafka default.
Fail fast when finalName is misconfigured
When the `finalName` parameter is incorrectly set in the Spring Boot
Maven plugin configuration instead of in the `build` configuration, the
repackaged and original archive files are not named as expected. Prior
to this commit, the image building goal would detect this error
condition and throw an exception late in the process of creating the
build container, leaving the container in an unstable state. This
commit changes the image building goal to detect this condition early,
before attempting to create the container.
Fixes gh-25590,Merge branch '2.4.x',Upgrade to Spring AMQP 2.3.6
Upgrade to Spring Kafka 2.6.7
Update CI to use Artifactory Resource 0.0.14
Promote ConnectionFactoryBuilder to the "spring-boot" module
* pr/25721:
  Polish "Support sending metrics to InfluxDB v2"
  Support sending metrics to InfluxDB v2
Polish "Support sending metrics to InfluxDB v2"
See gh-25721,Support sending metrics to InfluxDB v2
See gh-25721,Fix description of management.metrics.export.influx.db
Fix description of management.metrics.export.influx.db
Close gh-25548,Upgrade to Lettuce 6.1.0.RC1
Upgrade to Spring Data 2020.0.6
Upgrade to Lettuce 6.0.3.RELEASE
Upgrade to Kotlin Coroutines 1.4.3
Polish,Merge branch '2.4.x'
Don't pass null exception translation result into jOOQ
Test spring-boot:build-image when repackage is also invoked
Revert "Merge branch '2.4.x'"
This reverts commit 5488b8cb465b6aa45a1a807f7754ca32132b8ed1, reversing
changes made to dee0df5c53dba81fca08bc64479fc9e54434a9ac.
See gh-25701,Merge branch '2.4.x',Revert "Merge branch '2.3.x' into 2.4.x"
This reverts commit eaa510872a5af5defddca4285bc01c730ae79856, reversing
changes made to 3e69522e2d5fda8f7d019525df6b7f645c28ab49.
See gh-25700,Merge branch '2.3.x' into 2.4.x,Revert "Fail fast when finalName is misconfigured"
This reverts commit 263b7c20e4ad4bdc9bbd5f0e68bcd1d706d8a29c.
See gh-25590,Merge pull request #25707 from jonatan-ivanov
* pr/25707:
  Polish "Upgrade to Micrometer 1.7.0-M1"
  Upgrade to Micrometer 1.7.0-M1
Polish "Upgrade to Micrometer 1.7.0-M1"
See gh-25707,Upgrade to Micrometer 1.7.0-M1
See gh-25707,Merge branch '2.4.x'
Merge pull request #25709 from dreis2211
* pr/25709:
  Upgrade to Java 16 GA builds in CI
Upgrade to Java 16 GA builds in CI
See gh-25709,Merge branch '2.4.x'
Fail fast when finalName is misconfigured
When the `finalName` parameter is incorrectly set in the Spring Boot
Maven plugin configuration instead of in the `build` configuration, the
repackaged and original archive files are not named as expected. Prior
to this commit, the image building goal would detect this error
condition and throw an exception late in the process of creating the
build container, leaving the container in an unstable state. This
commit changes the image building goal to detect this condition early,
before attempting to create the container.
Fixes gh-25590,Merge branch '2.4.x'
Upgrade to Spring Asciidoctor Extensions 0.5.1
Upgrade to Spring WS 3.1.0-M2
Automatically supersede existing upgrade issue when running Bomr
Merge pull request #25620 from uc4w6c
* gh-25620:
  Polish "Improve error message when no resources exist at a script location"
  Improve error message when no resources exist at a script location
Polish "Improve error message when no resources exist at a script location"
See gh-25620,Improve error message when no resources exist at a script location
See gh-25620,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Create exception reporters when needed so they pick up current state
Fixes gh-25691,Upgrade to Undertow 2.2.5.Final
Upgrade to Tomcat 9.0.44
Upgrade to Sun Mail 1.6.6
Upgrade to Spring WS 3.1.0-M1
Upgrade to Solr 8.8.1
Upgrade to SnakeYAML 1.28
Upgrade to SendGrid 4.7.2
Upgrade to Rabbit AMQP Client 5.11.0
Upgrade to R2DBC Bom Arabba-SR9
Upgrade to Postgresql 42.2.19
Upgrade to Netty 4.1.60.Final
Upgrade to Neo4j Java Driver 4.2.3
Upgrade to MSSQL JDBC 9.2.1.jre8
Upgrade to MongoDB 4.2.2
Upgrade to Mockito 3.8.0
Upgrade to Micrometer 1.6.5
Upgrade to Log4j2 2.14.1
Upgrade to Kotlin Coroutines 1.4.3
Upgrade to Kotlin 1.4.31
Upgrade to jOOQ 3.14.8
Upgrade to Jetty Reactive HTTPClient 1.1.6
Upgrade to Jedis 3.5.2
Upgrade to Jakarta Mail 1.6.6
Upgrade to Jackson Bom 2.12.2
Upgrade to Infinispan 12.0.2.Final
Upgrade to HikariCP 4.0.3
Upgrade to Hibernate 5.4.29.Final
Upgrade to Hazelcast 4.1.2
Upgrade to Flyway 7.7.0
Upgrade to Ehcache3 3.9.2
Upgrade to Dropwizard Metrics 4.1.18
Upgrade to Couchbase Client 3.1.3
Upgrade to Commons Lang3 3.12.0
Upgrade to Byte Buddy 1.10.22
Upgrade to AppEngine SDK 1.9.87
Upgrade to Nimbus JOSE JWT 9.7
Upgrade to OAuth2 OIDC SDK 9.2.2
Upgrade to Spring Security 5.5.0-M3
Upgrade to Spring HATEOAS 1.3.0-M3
Upgrade to Spring HATEOAS 1.2.5
Leave jar and war tasks enabled but configured with a classifier
Upgrade to Spring Framework 5.3.5
Upgrade to Reactor 2020.0.5
Simplify JettyWebServer.getLocalPort
Document that Java 16 is supported
Document DataSource implementations supported by DataSourceBuilder
Add support for external configuration for Cassandra
Upgrade to Tomcat 9.0.44
Upgrade to Sun Mail 1.6.6
Upgrade to R2DBC Bom Arabba-SR9
Upgrade to Postgresql 42.2.19
Upgrade to OAuth2 OIDC SDK 8.36.1
Upgrade to Netty 4.1.60.Final
Upgrade to MongoDB 4.1.2
Upgrade to Maven Invoker Plugin 3.2.2
Upgrade to Kotlin 1.4.31
Upgrade to jOOQ 3.14.8
Upgrade to Jetty Reactive HTTPClient 1.1.6
Upgrade to Jakarta Mail 1.6.6
Upgrade to Infinispan 11.0.10.Final
Upgrade to Hibernate 5.4.29.Final
Upgrade to Ehcache3 3.9.2
Upgrade to Dropwizard Metrics 4.1.18
Upgrade to Byte Buddy 1.10.22
Upgrade to AppEngine SDK 1.9.87
See gh-25581,Start building against Spring Batch 4.3.2 snapshots
See gh-25580,Start building against Spring Kafka 2.7.0 snapshots
See gh-25582,Start building against Spring Integration 5.5.0-M3 snapshots
See gh-25577,Start building against Spring Batch 4.3.2 snapshots
See gh-25579,Start building against Spring Kafka 2.6.7 snapshots
See gh-25578,Start building against Micrometer 1.6.5 snapshots
See gh-25543,Merge branch '2.4.x'
Merge pull request #25617 from izeye
* pr/25617:
  Polish
Polish
See gh-25617
Extract code samples from docs
See gh-6313,Merge branch '2.4.x'
Fallback to BeanPropertyBindingResult for unbound property validation
gh-17424 updated `ValidationBindHandler` so that it would
only look at bound values when validating. This commit updates
`ValidationBindHandler` to use Spring Framework's `BeanPropertyBindingResult`.
This means that for fields that are not bound, JavaBean accessor methods can
be used to get the value to validate.
Fixes gh-25356,Fix LocalCacheVerifier include tags
Fixes gh-25567,Merge branch '2.4.x',Close ClassLoader so jar it references can be deleted on Windows
Polishes 952ac7b8,Start building against Spring Data 2021.0.0-M5 snapshots
See gh-25548,Merge branch '2.4.x'
Merge pull request #25480 from maruoovv
* gh-25480:
  Correct javadoc for ON_PARAM
Correct javadoc for ON_PARAM
See gh-25480,Merge pull request #25571 from Jurrie
* gh-25571:
  Support Maven's reproducible build feature for war repackaging
Support Maven's reproducible build feature for war repackaging
See gh-25571,Merge branch '2.4.x'
Upgrade CI images to ubuntu:focal-20210217
Upgrade Java 16 CI image to 2021-03-09-12-41
Merge pull request #25597 from bal360
* gh-25597:
  Fix typos in README
Fix typos in README
See gh-25597,Merge branch '2.4.x'
Merge pull request #25596 from izeye
* gh-25596:
  Add Javadoc since tag to Bootstrapper.initialize()
Add Javadoc since tag to Bootstrapper.initialize()
See gh-25596,Merge branch '2.4.x'
Create issue for each forward merge found in commit message
\gh-25584
Fixes gh-25367 in 2.5.x,Don't use RestartClassLoader when proxying classes it did not load
Fixes gh-19010
Fixes gh-25367,Merge branch '2.4.x'
Try to stabilize SampleSessionWebFluxApplicationTests
userDefinedMappingsSecureByDefault in
SampleSessionWebFluxApplicationTests may fail with an NPE if the
session times out before the initial response is sent due to the absence
of a SESSION cookie in the response. The test uses a short session
timeout (2 seconds) and we've seen the problem occur on CI when,
presumably, a noisy neighbour has caused some CPU starvation.
This commit increases the timeout to 5 seconds to reduce the chance of
a short period of CPU starvation causing the test to fail.
Properly subscribe to CloseableConnectionFactory#close
Remove host name in R2DBC's embedded H2 url
Simplify code that makes hal the default json media type
See gh-25546,Start building against Spring HATEOAS 1.3.0-RC1 snapshots
See gh-25546,Start building against Spring Framework 5.3.5 snapshots
See gh-25542,Start building against Reactor 2020.0.5 snapshots
See gh-25540,Merge branch '2.4.x',Start building against Spring Data 2020.0.6 snapshots
See gh-25547,Start building against Spring HATEOAS 1.2.5 snapshots
See gh-25545,Start building against Spring Framework 5.3.5 snapshots
See gh-25541,Start building against Reactor 2020.0.5 snapshots
See gh-25539,Use new backend features for extracted samples
Update extracted samples to make use of code folding and chomping.
See gh-6313,Merge pull request #25562 from dreis2211
* gh-25562:
  Deprecate FlywayMigrationScriptMissingFailureAnalyzer
Deprecate FlywayMigrationScriptMissingFailureAnalyzer
See gh-25562,Migrate to spring-asciidoctor-backends
Migrate to the renamed spring-asciidoctor-backends project.
See gh-25553,Deprecate support for checking Flyway locations
Provide more pluggable way to indicate DataSource init dependencies
\gh-17619
See gh-25558,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Polish RSocketServerAutoConfiguration,Merge branch '2.4.x'
Make embedded RSocket server back off without spring-web
Fixes gh-25551,Migrate to asciidoctor-spring-backends
Migrate to the snapshot version of asciidoctor-spring-backends.
See gh-25553,Polish asciidoc markup,Merge pull request #25550 from dreis2211
* gh-25550:
  Run spring-boot-cli tasks on Java 16
Run spring-boot-cli tasks on Java 16
See gh-25550,Merge branch '2.4.x'
Merge pull request #25531 from dreis2211
* pr/25531:
  Suppress rawtypes warning
  Fix some illegal reflective access warnings
Suppress rawtypes warning
See gh-25531,Fix some illegal reflective access warnings
See gh-25531,Merge branch '2.4.x',Polish,Merge branch '2.4.x'
Tag build scans with JDK-${toolchainVersion}
Merge pull request #25523 from dreis2211
* pr/25523:
  Exclude GradleBuild tasks on JDK 16 for now
Exclude GradleBuild tasks on JDK 16 for now
See gh-25523,Merge branch '2.4.x'
Merge pull request #25519 from dreis2211
* gh-25519:
  Polish "Add Java 16 CI pipeline"
  Add Java 16 CI pipeline
Polish "Add Java 16 CI pipeline"
See gh-25519,Add Java 16 CI pipeline
See gh-25519,Merge branch '2.4.x'
Try to stabilize tests that use Neo4jContainer
Increase socket timeout for communicating with Elasticsearch
Allow JMX endpoint ObjectNames to be customized
Merge pull request #25400 from cprayer
* gh-25400:
  Polish "Add Bootstrapper initialize method to fix typo"
  Add Bootstrapper initialize method to fix typo
Polish "Add Bootstrapper initialize method to fix typo"
See gh-25400,Add Bootstrapper initialize method to fix typo
See gh-25400,Merge branch '2.4.x'
Merge pull request #25507 from brenuart
* pr/25507:
  Polish "Include properties in source merge algorithm"
  Include properties in source merge algorithm
Polish "Include properties in source merge algorithm"
See gh-25507,Include properties in source merge algorithm
This commit improves SimpleConfigurationMetadataRepository to include
properties that are contributed to an existing configuration metadata
source.
See gh-25507,Merge branch '2.4.x'
Merge pull request #25375 from cdalexndr
* gh-25375:
  Polish "Improve documentaion of Mockito test execution listeners"
  Improve documentaion of Mockito test execution listeners
Polish "Improve documentaion of Mockito test execution listeners"
See gh-25375
Improve documentaion of Mockito test execution listeners
See gh-25375,Merge branch '2.4.x'
Merge pull request #25486 from cdalexndr
* gh-25486:
  Polish "Make link to Actuator API docs more prominent"
  Make link to Actuator API docs more prominent
Polish "Make link to Actuator API docs more prominent"
See gh-25486,Make link to Actuator API docs more prominent
See gh-25486,Merge branch '2.4.x'
Merge pull request #25505 from trungPa
* gh-25505:
  Polish "Prevent extracting zip entries outside of destination path"
  Prevent extracting zip entries outside of destination path
Polish "Prevent extracting zip entries outside of destination path"
See gh-25505,Prevent extracting zip entries outside of destination path
See gh-25505,Merge branch '2.4.x'
Merge pull request #25499 from dreis2211
* pr/25499:
  Fix some assertions
Fix some assertions
See gh-25499,Merge branch '2.4.x'
Warn against using multi-document files with TestPropertySource
Document configtree support for Docker secrets
Merge pull request #25171 from dreis2211
* gh-25171:
  Polish "Allow the project to be built with Java 16"
  Allow the project to be built with Java 16
Polish "Allow the project to be built with Java 16"
See gh-25171,Allow the project to be built with Java 16
See gh-25171,Merge branch '2.4.x'
Merge default property sources
Fixes gh-25408,Merge branch '2.4.x'
Reinstate support for placeholders in @EntityScan
Fixes gh-25436,Merge branch '2.4.x'
See gh-25482,Merge branch '2.3.x' into 2.4.x
See gh-25481,Wait for process to exit to avoid race with file deletion
See gh-25457,Merge branch '2.4.x'
See gh-25482,Merge branch '2.3.x' into 2.4.x
See gh-25481,Delete files after destroying processes that may be accessing them
Fix fallback fork value for spring-boot:stop
This commit harmonizes the fallback value that spring-boot:stop goal
should use if no information is available in the current context.
Merge pull request #25457 from dreis2211
* gh-25457:
  Speed up spring-boot-server-tests
Speed up spring-boot-server-tests
See gh-25457,Merge branch '2.4.x'
Add tests for Gradle examples used in plugin docs
Fixes gh-25468,Merge branch '2.4.x'
Merge pull request #25300 from robert-smith-911
* pr/25300:
  Polish "Document precedence between properties and yaml"
  Document precedence between properties and yaml
Polish "Document precedence between properties and yaml"
See gh-25300,Document precedence between properties and yaml
See gh-25300,Merge branch '2.4.x'
Merge pull request #25454 from jnizet
* pr/25454:
  Update copyright year of changed file
  Fix property name in gradle plugin documentation
Update copyright year of changed file
See gh-25454,Fix property name in gradle plugin documentation
See gh-25454,Polish,Merge pull request #25456 from bono007
* pr/25456:
  Polish contribution
  Add configuration properties for Flyway's Vault and Conjur support
Polish contribution
See gh-25456,Add configuration properties for Flyway's Vault and Conjur support
See gh-25456,Upgrade to Jetty 9.4.38.v20210224
Merge pull request #25443 from JohnNiang
* pr/25443:
  Polish "Allow to configure PersistenceUnitPostProcessor"
  Allow to configure PersistenceUnitPostProcessor
Polish "Allow to configure PersistenceUnitPostProcessor"
This commit updates EntityManagerFactoryBuilder so that persistence unit
post processors can be registered and applied when creating an
EntityManagerFactory.
See gh-25443,Allow to configure PersistenceUnitPostProcessor
This commit updates EntityManagerFactoryBuilder so that persistence unit
post processors can be registered and applied when creating an
EntityManagerFactory.
See gh-25443,Merge pull request #25451 from izeye
* pr/25451:
  Upgrade copyright year of changed files
  Polish
Upgrade copyright year of changed files
See gh-25451,Polish
See gh-25451,Merge branch '2.4.x'
See gh-25450,Ensure that Jersey's filter has a servlet at the end of its chain
See gh-25449,Merge branch '2.4.x'
Use ResourceConfig customization to register endpoints with Jersey
Previously, actuator endpoints were registered with Jersey upon
injection of the ResourceConfig bean into a registrar class rather than
using a ResourceConfigCustomizer. This was done to fix a problem
when running the Actuator on a separate port where the main application
context's customizers were also applied to the management context,
breaking the singleton contract for those resources. This approach
meant that the registration could be performed at any point after the
ResourceConfig had been created. When Jersey's configured as a Filter
this resulted in the registration failing as the attempt was being made
after the Filter lifecyle callbacks which make the ResourceConfig
immutable.
This commit reworks the endpoint registration to be performed using a
ManagementContextResourceConfigCustomizer, a resource config customizer
that's only applied to the ResourceConfig that's used by the Actuator.
When there's a separate management context, this ResourceConfig is
created by the Actuator's auto-configuration and the management context
resource config customizers are applied to it during its creation. The
main application's customizers are not applied. When the actuator is
using the same context as the main application, this ResourceConfig is
created by the main application. In this case a
ResourceConfigCustomizer is defined that delegates to all
ManagementContextResourceConfigCustomizers, allowing them to register
the actuator endpoints with the main ResourceConfig.
Fixes gh-25262,Merge branch '2.4.x'
Merge pull request #25446 from dreis2211
* gh-25446:
  Split DeploymentIntegrationTests by container
  Rename DeploymentIntegrationTests
Split DeploymentIntegrationTests by container
Prior to this commit, every test started a new testcontainer. By splitting the
tests apart we can make use of static containers that are only instantiated once
per application (TomEE, Wildfly etc.)
See gh-25446,Rename DeploymentIntegrationTests
See gh-25446,Enable the logging shutdown hook by default
This commit updates LoggingApplicationListener to register the logging
shutdown hook by default.
The hook is detrimental in a war deployment as it may pin parts of an
application in memory after it has been undeployed. For this reason,
the hook is still disabled by default in war deployments. This is
achieved by setting an attribute on the servlet context in
SpringBootServletInitializer that is then consumed via the Environment
by LoggingApplicationListener.
Merge pull request #25445 from dreis2211
* gh-25445:
  Ignore empty prefixes in new PrefixedConfigurationPropertySource
Ignore empty prefixes in new PrefixedConfigurationPropertySource
See gh-25445,Add prefix support for property source
We configure the `SystemEnvironmentPropertySource` as a `Prefixed` property
source. When adapting this to a `ConfigurationPropertySource, a
`PrefixedConfigurationPropertySource` will be created for it.
A `PrefixedConfigurationPropertySource` will resolve property
such as `foo.bar` to `my.foo.bar` for a prefix of `my`.
Merge pull request #25434 from dreis2211
* gh-25434:
  Remove spring-boot-smoke-test-jta-jndi
Remove spring-boot-smoke-test-jta-jndi
See gh-25434,Merge branch '2.4.x'
Merge pull request #25409 from wolfs
* gh-25409:
  Enable stricter validation for Gradle plugin
Enable stricter validation for Gradle plugin
See gh-25409,Merge branch '2.4.x'
Merge pull request #25411 from jxblum
* pr/25411:
  Fix grammatical error in documentation
Fix grammatical error in documentation
See gh-25411,Merge branch '2.4.x'
Merge pull request #25412 from dreis2211
* gh-25412:
  Update Testcontainers image versions
Update Testcontainers image versions
See gh-25412,Upgrade to Testcontainers 1.15.2
Upgrade to MockK 1.10.6
Upgrade to Maven Resolver 1.6.1
Upgrade to Maven Invoker 3.1.0
Upgrade to Maven Common Artifact Filters 3.2.0
Upgrade to JNA 5.7.0
Upgrade to Testcontainers 1.15.2
Upgrade to MockK 1.10.6
Upgrade to Maven Common Artifact Filters 3.1.1
Upgrade to Maven Common Artifact Filters 3.1.1
Support image building with Maven and war packaging
This commit updates the Maven image building goal to support building
images from executable and non-executable war files.
Fixes gh-23823,Support image building with Gradle and war packaging
This commit updates the Gradle image building task to support building
images from executable and non-executable war files.
Fixes gh-23825,Allow additional keys to be configured for value sanitization
Sanitize sensitive portion of the value of url and urls keys
Make TestFailuresPlugin compatible with Gradle's configuration cache
Test the Gradle plugin against 7.0-milestone-2
Allow user's WebFluxConfigurers to be ordered after auto-config's
Previously, WebFluxAutoConfiguration's WebFluxConfigurer was unordered.
This mean that it had lowest precedence so it was not possible for a
user to provide their own configurer that was guaranteed to run after
the auto-configuration's configurer.
This commit updates the auto-configuration to order its configurer at
0. Any unordered user-defined configurer will now run after the
auto-configuration's configurer.
Correct grouping of custom buildpacks
This commit corrects the order.toml file that is generated and added
to the builder when building an image using custom buildpacks with the
Maven or Gradle plugin in order to support buildpacks that depend on
detection as a group.
Fixes gh-25378,Polish,Merge pull request #25319 from eddumelendez
* pr/25319:
  Polish "Add more customization options for InfluxDB"
  Add more customization options for InfluxDB
Polish "Add more customization options for InfluxDB"
See gh-25319,Add more customization options for InfluxDB
This commit augments the configuration properties that are exposed for
InfluxDB, alongside an `InfluxDbCustomizer` that gives more control.
See gh-25319,Add bindings option for image building
This commit adds configuration to the Maven and Gradle plugins to
allow a list of volume mount bindings to be provided to the image
building goal and task. This enables service bindings to be mounted
in the builder image that are recognized by buildpacks to support
custom certificates, build tool configuration, APM integration, and
other buildpack features.
Fixes gh-23518,Include all non-snapshot repositories when checking for upgrades
Upgrade to Gradle 6.8.3
Merge pull request #25382 from mustafau
* pr/25382:
  Update copyright year of changed file
  Fix wording error in build-info goal description
Update copyright year of changed file
See gh-25382,Fix wording error in build-info goal description
See gh-25382,Merge pull request #24981 from vladdoster
* pr/24981:
  Polish contribution
  Polish README
Polish contribution
See gh-24981,Polish README
See gh-24981,Deprecate support for Gradle's maven plugin
Merge pull request #25353 from shakuzen
* pr/25353:
  Polish HTTP client metrics documentation wording
Polish HTTP client metrics documentation wording
See gh-25353,Update copyright year of changed files,Protect against bad paths and URLs
See gh-21722,Fix Maven buildpacks example in docs
See gh-21722,Remove unused import
See gh-21722,Add buildpack option for image building
This commit adds configuration to the Maven and Gradle plugins to
allow a list of buildpacks to be provided to the image building
goal and task.
Fixes gh-21722,Merge branch '2.4.x',Next development version (v2.4.4-SNAPSHOT),Merge branch '2.4.x'
Add username alias for Postgres's PGSimpleDataSource
Upgrade to Spring Kafka 2.7.0-M2
Upgrade to Spring Integration 5.5.0-M2
Upgrade to Spring AMQP 2.3.5
Upgrade to MongoDB 4.2.0-beta1
Upgrade to Lettuce 6.1.0.M1
Upgrade to Elasticsearch 7.11.1
Upgrade to Spring Data 2021.0.0-M4
This commit also downgrade JOSE JWT to address an incompatibility with
the OIDC SDK 8.x. The OIDC SDK has also been upgraded to the latest 8.x
release to align with the version used by Spring Security.
\gh-25221
Fixes gh-25070,Upgrade to Spring Kafka 2.6.6
Upgrade to Spring Integration 5.4.4
Upgrade to Spring AMQP 2.3.5
Upgrade to Spring Data 2020.0.5
Upgrade to 0.0.6 of the changelog generator
Start using 0.0.6 snapshots of the changelog generator
See gh-25355,Merge branch '2.4.x'
See gh-25344,Merge branch '2.3.x' into 2.4.x
See gh-25343,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Correct the version input for changelog generation
See gh-25107,Revert "Update code for Spring Data 2021.0.0-M3"
This reverts commit 4b0ef67e8e8e61a1bbe91e1f0749fbcf98f1a5ab.
See gh-25004,Next development version (v2.3.10.BUILD-SNAPSHOT),Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Merge branch '2.4.x',Start building against Spring Data 2020.0.5 snapshots
See gh-25002,Update Sonatype credentials used to publish to Central,Merge branch '2.4.x'
Merge pull request #25321 from sdeleuze
* pr/25321:
  Refactor CacheConfigurations to avoid storing configuration classes
Refactor CacheConfigurations to avoid storing configuration classes
This commit refactors CacheConfigurations implementation to make
it more native friendly by storing strings instead of classes in
order to avoid loading the configuration classes
when CacheConfigurations is initialized at build time.
See gh-25321,Merge branch '2.4.x'
Make devtools securityFilterChain back-off in presence of WebSecurityConfigurerAdapter
Fixes gh-25147,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Upgrade to Spring Integration 5.3.6.RELEASE
Throw or warn for invalid config properties with list syntax
Fixes gh-25309,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Upgrade to Spring AMQP 2.2.15.RELEASE
Support Jetty 10
Don't scan for `@Persistent` types as they may not be meant for Neo4j
Merge pull request #24620 from friscoMad
* pr/24620:
  Polish "Remove old documentation relating to yaml and profiles"
  Remove old documentation relating to yaml and profiles
Polish "Remove old documentation relating to yaml and profiles"
See gh-24620,Remove old documentation relating to yaml and profiles
See gh-24620,Merge branch '2.4.x'
Stop using Bintray to publish to Maven Central
This commit reworks the CI pipeline to remove the use of Bintray for
publishing to Maven Central. In its place it adds a new
publishToCentral command to the release scripts. This command can be
used to publish a directory tree of artifacts to the Maven Central
gateway hosted by Sonatype.
Publishing consists of 4 steps:
1. Create the staging repository
2. Deploy artifacts to the repository
3. Close the repository
4. Release the repository
The command requires 3 arguments:
1. The type of release being performed
2. Location of a build info JSON file that describes the release
   that is to be deployed
3. Root of a directory structure, in Maven repository layout, that
   contains the artifacts to be deployed
\gh-25342
Add username alias for H2's JdbcDataSource
Upgrade to RxJava2 2.2.21
Upgrade to JUnit 4.13.2
Upgrade to FreeMarker 2.3.31
Upgrade to Spring HATEOAS 1.1.4.RELEASE
Upgrade to RxJava2 2.2.21
Upgrade to JUnit 4.13.2
Upgrade to FreeMarker 2.3.31
Upgrade to RxJava2 2.2.21
Upgrade to Micrometer 1.6.4
Upgrade to Liquibase 4.3.1
Upgrade to JUnit 4.13.2
Upgrade to Infinispan 12.0.1.Final
Upgrade to HikariCP 4.0.2
Upgrade to FreeMarker 2.3.31
Upgrade to Caffeine 2.9.0
Upgrade to Artemis 2.17.0
See gh-25002,Merge branch '2.4.x',Upgrade to Micrometer 1.6.4
Rework DataSource initialization
Previously, DataSource initialization was triggered via a
BeanPostProcessor or a schema created event from JPA. This caused
numerous problems with circular dependencies, bean lifecycle, etc and
added significant complexity.
This commit reworks DataSource initialization to remove the use of a
BeanPostProcessor entirely. In its place, DataSource initialization is
now driven by an InitializingBean with dependency relationships
between beans ensuring that initialization has been performed before
the DataSource is used. This aligns with the approach that's worked
well with Flyway and Liquibase.
More changes are planned to further simplify DataSource initialization.
The changes in this commit are a foundation for those changes. Any new
public API in this commit is highly likely to change before the next
GA.
Fixes gh-13042
Fixes gh-23736,Merge pull request #25316 from chaundhyan
* pr/25316:
  Polish "Group jdbc-related batch properties beneath spring.batch.jdbc"
  Group jdbc-related batch properties beneath spring.batch.jdbc
Polish "Group jdbc-related batch properties beneath spring.batch.jdbc"
See gh-25316,Group jdbc-related batch properties beneath spring.batch.jdbc
See gh-25316,Align with breaking change in Spring Data MongoDB
See gh-25004,Upgrade to Spring Framework 5.3.4
Align default values for Cassandra's throttling properties
Merge pull request #25314 from izeye
* pr/25314:
  Fix Javadoc since tag for ConfigurationPropertiesReportEndpointWebExtension
Fix Javadoc since tag for ConfigurationPropertiesReportEndpointWebExtension
See gh-25314,Polish,Merge branch '2.4.x'
Merge pull request #25265 from melburne
* pr/25265:
  Update copyright of changed files
  Fix incorrect detection of Amazon Redshift
Update copyright of changed files
See gh-25265,Fix incorrect detection of Amazon Redshift
See gh-25265,Merge branch '2.4.x'
Merge pull request #25279 from eddumelendez
* gh-25279:
  Polish "Ensure that Flyway/Liquibase run before jOOQ's DSLContext is used"
  Ensure that Flyway/Liquibase run before jOOQ's DSLContext is used
Polish "Ensure that Flyway/Liquibase run before jOOQ's DSLContext is used"
See gh-25279,Ensure that Flyway/Liquibase run before jOOQ's DSLContext is used
See gh-25279,Merge branch '2.4.x'
Merge pull request #25299 from robert-smith-911
* gh-25299:
  Polish "Encourage use of maven-publish plugin in Gradle docs"
  Encourage use of maven-publish plugin in Gradle docs
Polish "Encourage use of maven-publish plugin in Gradle docs"
See gh-25299,Encourage use of maven-publish plugin in Gradle docs
See gh-25299,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Add dependency management for new hibernate-micrometer module
Fixes gh-25277,Merge branch '2.4.x'
Add dependency management for new hibernate-micrometer module
Fixes gh-25277,Merge branch '2.4.x'
Replace native image system property with call to NativeDetector
Upgrade to Reactor 2020.0.4
Merge pull request #25173 from anudeepg
* pr/25173:
  Polish "Fix database name detection logic for MariaDB"
  Fix database name detection logic for MariaDB
Polish "Fix database name detection logic for MariaDB"
See gh-25173,Fix database name detection logic for MariaDB
See gh-25173,Merge branch '2.4.x'
Merge pull request #25272 from izeye
* pr/25272:
  Polish "Document Kafka Streams metrics support"
  Document Kafka Streams metrics support
Polish "Document Kafka Streams metrics support"
See gh-25272,Document Kafka Streams metrics support
See gh-25272,Merge pull request #25278 from eddumelendez
* pr/25278:
  Polish "Add support to auto-configure javax.jms.ExceptionListener"
  Add support to auto-configure javax.jms.ExceptionListener
Polish "Add support to auto-configure javax.jms.ExceptionListener"
See gh-25278,Add support to auto-configure javax.jms.ExceptionListener
See gh-25278,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Polish "Start building against Spring Data Neumann-SR7 snapshots"
See gh-25282,Merge branch '2.4.x'
Associate application classloader to auto-configured Hazelcast instance
Start building against Spring Kafka 2.7.0-M2 snapshots
See gh-25295,Start building against Spring Integration 5.5.0-M2 snapshots
See gh-25294,Merge branch '2.4.x',Start building against Spring Kafka 2.6.6 snapshots
See gh-25292,Start building against Micrometer 1.6.4 snapshots
See gh-25291,Start building against Spring AMQP 2.3.5 snapshots
See gh-25290,Start building against Spring Integration 5.4.4 snapshots
See gh-25289,Start building against Reactor 2020.0.4 snapshots
See gh-25286,Merge branch '2.3.x' into 2.4.x,Start building against Micrometer 1.5.11 snapshots
See gh-25285,Start building against Spring AMQP 2.2.15 snapshots
See gh-25284,Start building against Spring Integration 5.3.6 snapshots
See gh-25283,Start building against Spring Data Neumann-SR7 snapshots
See gh-25282
Start building against Spring Framework 5.2.13 snapshots
See gh-25281,Start building against Reactor Dysprosium-SR17 snapshots
See gh-25280,Merge branch '2.4.x'
Merge pull request #25266 from izeye
* pr/25266:
  Update copyright of changes files
  Polish
Update copyright of changes files
See gh-25266,Polish,Merge branch '2.3.x' into 2.4.x,Polish
See gh-25266,Merge branch '2.4.x'
Apply Logback system properties and not just common properties to context
Upgrade to Undertow 2.2.4.Final
Upgrade to Tomcat 9.0.43
Upgrade to Solr 8.8.0
Upgrade to Selenium HtmlUnit 2.47.1
Upgrade to Prometheus PushGateway 0.10.0
Upgrade to Spring Security 5.5.0-M2
Upgrade to Nimbus JOSE JWT 9.5
Truncate files before writing new content to them
Previously, UpgradeApplicator would open build.gradle
using open options that left the fields existing content intact. It
would then write the new content at the beginning of the file. If
the new content was n bytes shorter than the existing content, this
would leave n bytes of the existing content at the end of the file.
This commit updates UpgradeApplicator to truncate the existing file
when it opens it. This ensures that the existing content is
completely replaced by the new content, irrespective of their lengths.
Upgrade to OAuth2 OIDC SDK 9.1
Upgrade to Netty 4.1.59.Final
Upgrade to MSSQL JDBC 9.2.0.jre8
Upgrade to MariaDB 2.7.2
Upgrade to Lombok 1.18.18
Upgrade to Liquibase 4.3.0
Upgrade to Kotlin 1.4.30
Upgrade to JUnit Jupiter 5.7.1
Upgrade to jOOQ 3.14.7
Upgrade to Johnzon 1.2.10
Upgrade to Jedis 3.5.1
Upgrade to Janino 3.1.3
Upgrade to Infinispan 12.0.0.Final
Upgrade to HtmlUnit 2.47.1
Upgrade to HikariCP 4.0.1
Upgrade to Hibernate 5.4.28.Final
Upgrade to Flyway 7.5.3
Upgrade to Couchbase Client 3.1.2
Upgrade to Byte Buddy 1.10.20
Upgrade to AssertJ 3.19.0
Upgrade to AppEngine SDK 1.9.86
Require a milestone when upgrading dependencies
Upgrade to Tomcat 9.0.43
Upgrade to Spring Session Bom 2020.0.3
Upgrade to Netty 4.1.59.Final
Upgrade to MySQL 8.0.23
Upgrade to MariaDB 2.7.2
Upgrade to Lombok 1.18.18
Upgrade to Kotlin 1.4.30
Upgrade to JUnit Jupiter 5.7.1
Upgrade to jOOQ 3.14.7
Upgrade to Johnzon 1.2.10
Upgrade to Jetty 9.4.36.v20210114
Upgrade to Jaybird 3.0.10
Upgrade to Janino 3.1.3
Upgrade to Infinispan 11.0.9.Final
Upgrade to Hibernate 5.4.28.Final
Upgrade to Byte Buddy 1.10.20
Upgrade to AppEngine SDK 1.9.86
Upgrade to ActiveMQ 5.16.1
Upgrade to Tomcat 9.0.43
Upgrade to Spring Session Bom Dragonfruit-SR2
Upgrade to Spring Security 5.3.8.RELEASE
Upgrade to Netty 4.1.59.Final
Upgrade to Neo4j OGM 3.2.20
Upgrade to MySQL 8.0.23
Upgrade to Lombok 1.18.18
Upgrade to Johnzon 1.2.10
Upgrade to Jetty 9.4.36.v20210114
Upgrade to Jaybird 3.0.10
Upgrade to Janino 3.1.3
Upgrade to Hibernate 5.4.28.Final
Upgrade to Hazelcast 3.12.12
Upgrade to Byte Buddy 1.10.20
Upgrade to AppEngine SDK 1.9.86
Instrument AMQP AbstractCF when defined as a ConnectionFactory
Fixes gh-25138,Merge branch '2.4.x'
Avoid Illegal reflective access warnings with devtools
This commit improves RestartClassLoader to use a method introduced in
SmartClassLoader to avoid triggering a warning on Java 11 and later.
See https://github.com/spring-projects/spring-framework/issues/26403
Select specific CLI distribution in CLI's integration tests
Previously, CommandLineInvoker would use the first -bin.zip file found
in build/distributions. If this directory contained multiple zips from
building different versions of Spring Boot, this could result in the
tests being run against the wrong version of the CLI.
This commit updates CommandLineInvoker look for a specific zip in
build/distributions, using the version from gradle.properties to
identify it.
Merge pull request #25178 from rand0m86
* gh-25178:
  Polish "Remove duplicate declaration of jackson-databind"
  Remove duplicate declaration of jackson-databind
Polish "Remove duplicate declaration of jackson-databind"
See gh-25178,Remove duplicate declaration of jackson-databind
See gh-25178,Merge branch '2.4.x'
Stop integer default values from becoming decimals
Fixes gh-25172
Merge pull request #24718 from bono007
* pr/24718:
  Polish "Filter properties with a particular prefix"
  Filter properties with a particular prefix
Polish "Filter properties with a particular prefix"
See gh-24718,Ignore events from other contexts when waiting for DS init to complete
Fixes gh-24966,Filter properties with a particular prefix
This commit improves the configprops endpoint to allow filtering
properties based on a particular prefix
See gh-24718,Fix formatting,Merge branch '2.4.x'
Fix use of deprecated Cassandra properties in integration tests
Consider transitives when identifying project dependencies
Previously, when building a layered jar, the Gradle plugin only
considered a configuration's direct dependencies when identifying
project dependencies. This resulted in transitive project dependencies
being missed when deciding which dependencies belong in the
application layer.
This commit updates ResolvedDependencies to consider all projects
from the root project when collecting the IDs of local projects. This
ensures that any project dependency, no matter where it appears in the
dependency graph, is successfully identified.
Fixes gh-25163,Merge branch '2.4.x'
Merge pull request #25130 from bono007
* pr/25130:
  Polish "Validate Cassandra defaults"
  Validate Cassandra defaults
Polish "Validate Cassandra defaults"
See gh-25130,Validate Cassandra defaults
See gh-25130,Merge branch '2.4.x'
Merge pull request #25150 from bono007
* pr/25150:
  Update copyright of changed file
  Fix defaults for Cassandra's initQueryTimeout and idleTimeout
Update copyright of changed file
See gh-25150,Fix defaults for Cassandra's initQueryTimeout and idleTimeout
See gh-25150,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Merge branch '2.2.x' into 2.3.x,Drop registry mirror from CI
Remove the registry mirror since it causes oci-build-task to fail.
See gh-25135,Merge branch '2.4.x'
Upgrade CI to github-pr-resource v0.23.0
Upgrade CI to artifactory-resource 0.0.13
Fix raw types error,Add a property to disable the `/actuator` discovery page
Always use SimpleDriverDataSource when creating Liquibase DataSource
Merge pull request #25109 from artembilan
* pr/25109:
  Polish "Make Scheduler consistent for Spring Integration"
  Make Scheduler consistent for Spring Integration
Polish "Make Scheduler consistent for Spring Integration"
See gh-25109,Make Scheduler consistent for Spring Integration
Currently Spring Integration creates its own `TaskScheduler` bean if one
does not exist in the context yet. When we add `@EnableScheduling`,
Spring Boot auto-configures one for us, but this one comes with slightly
different options than the default in Spring Integration.
This commit makes sure that Spring Integration reuses the
auto-configured TaskScheduler if possible, regardless of the user
opting-in for `@EnabledScheduling`.
See gh-25109,Try to stabilise Cassandra tests by increasing request timeout
Merge pull request #25120 from dreis2211
* pr/25120:
  Upgrade to Gradle Enterprise Gradle Plugin 3.5.2
Upgrade to Gradle Enterprise Gradle Plugin 3.5.2
See gh-25120,Merge branch '2.4.x'
Remove duplicate publication from spring-boot-docs
Fixes gh-25132,Merge branch '2.4.x'
Merge pull request #25116 from dreis2211
* pr/25116:
  Fix build deprecation warnings about duplicate jar entries
Fix build deprecation warnings about duplicate jar entries
See gh-25116,Merge branch '2.4.x'
Merge pull request #25093 from izeye
* pr/25093:
  Polish
Polish
See gh-25093,Merge branch '2.4.x'
Merge pull request #25075 from oleg-sukhov
* pr/25075:
  Polish "Clarify usage of BufferingApplicationStartup"
  Clarify usage of BufferingApplicationStartup
Polish "Clarify usage of BufferingApplicationStartup"
See gh-25075,Clarify usage of BufferingApplicationStartup
See gh-25075,Merge pull request #25006 from dreis2211
* pr/25006:
  Polish contribution
  Migrate from deprecated methods in AbstractWebFluxEndpointHandlerMapping
Polish contribution
See gh-25006,Migrate from deprecated methods in AbstractWebFluxEndpointHandlerMapping
See gh-25006,Merge branch '2.4.x'
Upgrade to Gradle 6.8.2
Extract code samples from docs
See gh-6313,Merge branch '2.4.x'
Fix handling of UriTemplateRequestEntity in TestRestTemplate
A change [1] in Spring Framework 5.3 means that getUrl() on a
RequestEntity will throw an UnsupportedOperationException if the
entity was created using a template.
This commit updates TestRestTemplate to check for instances of
UriTemplateRequestEntity and to resolve the URI using the
entity's UriTemplateHandler instead of calling getUrl() directly.
Fixes gh-25097
[1] https://github.com/spring-projects/spring-framework/commit/a0f4d81db76cb100b8f0da3a3cc8a945a012a2c0,Test the Gradle Plugin against 7.0-milestone-1
Extract some code samples from docs
See gh-6313,Add additional dependencies for example code
Add additional dependencies useful for the example code.
See gh-6313,Polish documented application logged output
Update the documented application output based on the latest version.,Polish asciidoctor formatting,Add pending-extract attribute to source
Add `pending-extract=true` to source blocks to help us identify
those that need to be extracted to a real source file.
See gh-6313,Polish spring-boot-docs
See gh-25089,Refine spring-boot-docs package restructure
Refine the package restructure started in 91ccc23462 to help provide
a solid foundation for code snippets. This commit renames many of the
classes so that they no longer end in `Example`. It also removes some
of the inner types that were previously used. Many tag comments have
also been moved to ensure that `import` statements are available in
the docs.
Restructure spring-boot-docs packages
Restructure the packages in `spring-boot-docs` so that they mirror
the documentation sections. There are now three main packages:
`springbootfeatures`, `productionreadyfeatures` and `howto`. Each
of the main packages has a subpackage named after the section headings.
Example code now uses consistent `// tag::` names and imports are
applied using `[tag=*]` whenever possible.
Test snippets have been moved to `src/main/java` so that only a single
import attribute needs to be defined.
See gh-25077,Merge branch '2.3.x' into 2.4.x
See gh-25076,Add junit-platform-launcher dependency by convention
Update `WarIntegrationTests` do deal with a SNAPSHOT Spring Framwork
dependency.
See gh-23936,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Allow test to use snapshot/milestone repo
Update `spring-boot-maven-plugin` `settings.xml` so that milestone and
snapshot dependencies can be resolved.
See gh-23936,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Fix BOM attached sourceSet
See gh-23936,Merge branch '2.4.x'
Remove hardcoded versions from MavenBuild
Use the dependencies BOM to ensure versions used in the `MavenBuild`
test class are always aligned.
Add junit-platform-launcher dependency
Update `build.gradle` files to ensure that `junit-platform-launcher` is
a `testRuntimeOnly` dependency. This ensures that tests can be run from
Eclipse.
Update documentation for layered wars
\gh-22821
 Add support for creating layered war files with Gradle
See gh-22195,Merge branch '2.4.x'
Include IDialect beans in WebFluxTest and WebMvcTest
Fixes gh-24149,Merge branch '2.4.x'
\gh-25066
Fix classpath.idx format documentation
Since 2.3.8 and 2.4.2 the format includes the directory.
Clarify square bracket map binding notation
Update reference docs to make it clearer when the square bracket map
binding notation should be used.
Document that Spring MVC has own ConversionService
Update documentation to make it clearer that Spring MVC does not use the
`ApplicationConversionService` unless configured explicitly.
Refine CharSequenceToObjectConverter logic
Update `CharSequenceToObjectConverter` so that conversion that would
apply using an `ObjectTo...` converter now favors `toString()` based
conversion.
Prior to this commit, when converting a `CharSequence` to a `Collection`
the `ObjectToCollectionConveter` would be picked instead of the
`StringToCollectionConverter`. This resulted in a `Collection`
containing a single `String` value, rather than the expected list
of values split around ",".
Fixes gh-25057,Merge branch '2.4.x',Remove sysout from test,Merge branch '2.4.x'
Merge pull request #25048 from dreis2211
* gh-25048:
  Fix duplicate anchor id
Fix duplicate anchor id
See gh-25048,Merge branch '2.4.x'
Improve logging.register-shutdown-hook docs
Update the "Logging" reference documentation with a section about
shutting down the logging system.
Merge pull request #25012 from jongmin92
* pr/25012:
  Document missing code to run Gradle bootRun task
Document missing code to run Gradle bootRun task
See gh-25012,Merge branch '2.4.x'
Merge pull request #24982 from robert-smith-911
* pr/24982:
  Polish 'Add note about exploded jars and banner properties'
  Add note about exploded jars and banner properties
Polish 'Add note about exploded jars and banner properties'
See gh-24982,Add note about exploded jars and banner properties
Add a note to the "Customizing the Banner" explaining that you need
to be using the `JarLauncher` to use the `application.*` properties.
See gh-24982,Merge branch '2.4.x'
Merge pull request #24336 from wesuga
* pr/24336:
  Polish 'Add a tip about actuator endpoints'
  Add a tip about actuator endpoints
Polish 'Add a tip about actuator endpoints'
See gh-24336,Add a tip about actuator endpoints
Update the "Externalized Configuration" section with a tip that about
the actuator `env` and `configprops` endpoints.
See gh-24336,Update tests following code changes
See gh-22821,Fix formatting,Add support for creating layered war files with Maven
See gh-22821,Merge branch '2.4.x'
Upgrade Java 15 CI image to jdk-15.0.2+7
Upgrade Java 11 CI image to jdk-11.0.10+9
Upgrade Java 8 CI image to jdk8u282b08
Upgrade CI images to Ubuntu Focal 20210119
Protect against NPE with Option.IGNORE_IMPORTS
Update `ConfigDataEnvironmentContributor` to deal with the fact that
the `properties` instance can be `null`.
Fixes gh-25029,Merge branch '2.4.x'
Allow 'on-profile' in profile specific files
Restore the ability to use `spring.config.activate.on-profile` or
`spring.profiles` in profile specific files.
Replace deprecated constructor with mutate builder
Update `ControllerEndpointHandlerMapping` to use the new `mutate()`
builder rather than deprecated constructors.
See gh-25004,Merge branch '2.4.x',Build against Spring Data 2020.0.4-SNAPSHOT
See gh-25002,Update code for Spring Framework 5.3.4
See gh-24998,Build against Spring Framework 5.3.4-SNAPSHOT
See gh-24998,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Merge branch '2.2.x' into 2.3.x,Update security policy links,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Merge branch '2.2.x' into 2.3.x,Update security policy links,Merge branch '2.4.x'
Support DeferredLogFactory injection
Update `ConfigDataLoader` and `ConfigDataLocationResolver` to support
`DeferredLogFactory` injection.
Set withTestKitDir per Gradle version
Attempt to fix cache locking issues by setting a unique `withTestKitDir`
directory for each tested Gradle version.
Skip direct @ConfugurationProperties binding
Add a `BindRestriction` option to `Bindable` which allows direct
property binding to be bypassed. The option is automatically applied
by the `ConfigurationPropertiesBinder`.
Prior to this commit, `@ConfugurationProperties` binding could silently
fail if a direct property existed that could be converted to the
properties class. This can be the case if a single-argument constructor
is available as the `ObjectToObject` converter would kick in.
\gh-16038
Co-authored-by: Madhura Bhave <mbhave@pivotal.io>,Remove dependency management for spring-boot-starter-data-solr
Upgrade to Gradle 6.8.1
Remove error message attribute instead of blanking it when not included
Use AssertJ's doesNotContainKey
Merge pull request #24964 from aurelien-baudet
* gh-24964:
  Polish "Add reference to Ogham Spring Boot starters"
  Add reference to Ogham Spring Boot starters
Polish "Add reference to Ogham Spring Boot starters"
See gh-24964,Add reference to Ogham Spring Boot starters
See gh-24964,Merge pull request #24967 from bdemers
* gh-24967:
  Fix minor typo in pull request template
Fix minor typo in pull request template
See gh-24967,Merge pull request #24715 from hatefpalizgar
* pr/24715:
  Polish " Change info endpoint to be secure and unexposed by default"
  Change info endpoint to be secure and unexposed by default
Polish " Change info endpoint to be secure and unexposed by default"
See gh-24715,Change info endpoint to be secure and unexposed by default
See gh-24715,Remove metadata for Data Solr property
Data Solr support was removed in 012a1997 so the property is no longer
supported.
See gh-24939,Upgrade to Solr 8.7.0
Upgrade to REST Assured 4.3.3
Upgrade to Flyway 7.5.1
Prohibit major upgrades that are not of interest
Merge pull request #24946 from dreis2211
* gh-24946:
  Upgrade to Groovy 3.0.7
Upgrade to Spring Integration 5.5.0-M1
\gh-24932
Upgrade to Groovy 3.0.7
See gh-24946,Upgrade to Spring Session Bom 2021.0.0-M1
Upgrade to Spring Kafka 2.7.0-M1
Upgrade to Kafka 2.7.0
Upgrade to Oracle Database 21.1.0.0
Upgrade to Kotlin 1.4.21-2
Upgrade to Jetty EL 9.0.29
Upgrade to Jaybird 4.0.2.java8
Upgrade to Git Commit ID Plugin 4.0.3
Upgrade to ActiveMQ 5.16.1
Upgrade to Flyway 7.5
Upgrade to Liquibase 4.2.2
Fix formatting,Upgrade to Spring Security 5.5.0-M1
Delegate `usesPathPatterns()` call to mappings
Update `CompositeHandlerMapping` so that the `usesPathPatterns()` method
returns `true` if any of the delegate mappings return `true`.
Upgrade to Spring Data 2021.0.0-M2
Upgrade to Spring HATEOAS 1.3.0-M1
Remove Spring Data Solr support
In preparation to the upgrade to Spring Data 2021.0, this commit removes
auto-configuration for Spring Data Solr.
See gh-24943,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x
See gh-24943,Polish "Deprecate Spring Data Solr"
See gh-24942,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x
Deprecate Spring Data Solr support
Polish,Upgrade to XmlUnit2 2.8.2
Upgrade to Thymeleaf Layout Dialect 2.5.2
Upgrade to SQLite JDBC 3.34.0
Upgrade to Spring Retry 1.3.1
Upgrade to Spring AMQP 2.3.4
Upgrade to SendGrid 4.7.1
Upgrade to Selenium HtmlUnit 2.46.0
Upgrade to Oracle Database 19.9.0.0
Upgrade to Netty tcNative 2.0.36.Final
Upgrade to Netty 4.1.58.Final
Upgrade to MySQL 8.0.23
Upgrade to Mockito 3.7.7
Upgrade to Micrometer 1.6.3
Upgrade to Log4j2 2.14.0
Upgrade to Lettuce 6.0.2.RELEASE
Upgrade to Json Path 2.5.0
Upgrade to Johnzon 1.2.9
Upgrade to Jetty 9.4.36.v20210114
Upgrade to Jetty Reactive HTTPClient 1.1.5
Upgrade to Jersey 2.33
Upgrade to Jaybird 3.0.10
Upgrade to Jackson Bom 2.12.1
Upgrade to InfluxDB Java 2.21
Upgrade to Infinispan 11.0.9.Final
Upgrade to HtmlUnit 2.46.0
Upgrade to Hibernate Validator 6.2.0.Final
Upgrade to Hibernate 5.4.27.Final
Upgrade to Hazelcast Hibernate5 2.2.0
Upgrade to Hazelcast 4.1.1
Upgrade to Elasticsearch 7.10.2
Upgrade to Dropwizard Metrics 4.1.17
Upgrade to Couchbase Client 3.1.1
Upgrade to Cassandra Driver 4.10.0
Upgrade to Byte Buddy 1.10.19
Upgrade to Artemis 2.16.0
Upgrade to AppEngine SDK 1.9.84
Add ConfigData IGNORE_PROFILES support
Add a new `ConfigData.Option` that allows profile properties to be
ignored. This update will allow Spring Cloud Config Server to provide
`ConfigData` that only has profile properties processed on the
server-side.
Prohibit upgrades to REST Assured 4.3
REST Assured 4.3.x requires Groovy 3 that we can't yet upgrade to as
there is no compatibile GA of Spock.
This commit prohibits upgrades to 4.3 so that Bomr ignores the possible
upgrade.
See gh-22303,Merge pull request #24680 from pedivo
* gh-24680:
  Polish "Add config prop for endpoints' CORS allowed origin patterns"
  Add config prop for endpoints' CORS allowed origin patterns
Polish "Add config prop for endpoints' CORS allowed origin patterns"
See gh-24680,Add config prop for endpoints' CORS allowed origin patterns
See gh-24680,Avoid compiler warning that only occurs with Java 8,Merge branch '2.4.x'
Document WebMvcProperties.MatchingStrategt as being since 2.4.0
Automatically register HttpSessionIdListener's with the servlet context
Fix pattern extraction when MVC is using a PathPatternParser
Fixes gh-24874,Polish,Merge branch '2.4.x'
Merge pull request #24753 from izeye
* pr/24753:
  Update copyright of changed file
  Make MetricsClientHttpRequestInterceptor defensive against metrics recoding failures
Update copyright of changed file
See gh-24753,Make MetricsClientHttpRequestInterceptor defensive against metrics recoding failures
See gh-24753,Disable all mappings endpoint infra when endpoint is unavailable
Previously, when the mappings endpoint was not available, the beans
that provide mapping descriptions were still created. This resulted
in unnecessary CPU and memory usage collecting and storing
information that would never by used.
This commit updates the auto-configuration for the mappings endpoint
so that all the beans that it creates are conditional on the endpoint
being available, rather than only the endpoint bean itself.
Merge pull request #24867 from izeye
* pr/24867:
  Fix property name for spring.dao.exceptiontranslation.enabled
Fix property name for spring.dao.exceptiontranslation.enabled
See gh-24867,Merge pull request #24866 from izeye
* pr/24866:
  Update copyright of changed file
  Restore persistOfNullThrowsIllegalArgumentExceptionWithoutExceptionTranslation()
Update copyright of changed file
See gh-24866,Restore persistOfNullThrowsIllegalArgumentExceptionWithoutExceptionTranslation()
See gh-24866,Merge branch '2.4.x'
Fix reference to spring-javaformat-intellij-idea-plugin
Merge pull request #24862 from izeye
* pr/24862:
  Polish contribution
  Polish
Polish contribution
See gh-24862,Polish
See gh-24862,Restore missing deprecated metadata for Bitronix
See gh-24806,Merge branch '2.4.x'
Merge pull request #24851 from dreis2211
* pr/24851:
  Fix configuration metadata for logging.charset.* properties
Fix configuration metadata for logging.charset.* properties
See gh-24851,Merge branch '2.4.x'
\gh-24855
Move Spring Boot version to main index in reference guide
Merge pull request #24837 from izeye
* pr/24837:
  Polish
Polish
See gh-24837,Merge branch '2.4.x',Polish
See gh-24837,Remove deprecated code in Spring Boot 2.3
Remove deprecated code
See gh-24806,Remove bitronix support
See gh-24806,Switch to the Apache Tomcat EL implementation by default
Previously we used org.glassfish:jakarta.el as our default EL
implementation. Since adopting it we have learned that it can be
significantly slower than Apache Tomcat's EL implementation in some
scenarios. This commit switches to using
org.apache.tomcat.embed:tomcat-embed-el by default instead of the
Glassfish implementation.
See gh-24677,Attempt to fix homebrew tap repo update
See gh-24677,Attempt to fix homebrew tap repo update
See gh-24677,Merge branch '2.4.x',Next development version (v2.4.3-SNAPSHOT),Merge branch '2.4.x',Update copyright year of changed files,Merge branch '2.4.x'
Fixes gh-24846,Apply SystemProperties to LoggerContext
Update `LoggingSystemProperties` so that system environment properties
are also applied to the `LoggerContext`. This is required when multiple
applications are deployed to the same Servlet container. In such setups
there's only a single JVM and the System Environment can be changed
when multiple applications start at the same time.
Fixes gh-24835,Merge branch '2.4.x'
Revert "Remove unnecessary code"
Fixes gh-24835,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Next development version (v2.3.9.BUILD-SNAPSHOT),Merge branch '2.4.x'
Fix docs on probe state during graceful shutdown
This commit improves the "Application lifefycle and Probes states"
section and underlines the difference between `AvailabilityState` and
the availability of Probes over HTTP.
Revert "Upgrade to Kafka 2.6.1"
See gh-24247,Merge branch '2.3.x' into 2.4.x
Unwrap Datasource against an actual interface
This commit updates DataSourceUnwrapper to take a separate interface
type argument if the target datasource has to be unwrapped, given that
the target type is usually not an interface.
Complete configuration metadata for spring.config.*
Next development version (v2.2.14.BUILD-SNAPSHOT),Upgrade to Dependency Management Plugin 1.0.11
Upgrade to Spring AMQP 2.3.4
Upgrade to Spring Integration 5.4.3
Upgrade to Netty tcNative 2.0.36.Final
Upgrade to Netty 4.1.58.Final
Upgrade to Dependency Management Plugin 1.0.11.RELEASE
Upgrade to Spring Integration 5.3.5.RELEASE
Upgrade to Spring AMQP 2.2.14.RELEASE
Upgrade to Netty tcNative 2.0.36.Final
Upgrade to Netty 4.1.58.Final
Upgrade to Dependency Management Plugin 1.0.11.RELEASE
Close gh-24742,Upgrade to Spring Integration 5.2.11.RELEASE
Upgrade to Spring Amqp 2.2.14.RELEASE
Upgrade to Netty 4.1.58.Final
See gh-24815,Merge branch '2.3.x' into 2.4.x
See gh-24814,Merge branch '2.2.x' into 2.3.x
See gh-24813,Simplify lowercase grep logic in docker script
See gh-24811,Merge branch '2.4.x'
Fix parsing of location header in docker update script
Fixes gh-24811,Merge branch '2.4.x'
Fix ordering of properties and yaml files
Fixes gh-24719,Merge branch '2.4.x',Upgrade to Spring Data 2020.0.3
Upgrade to Lettuce 6.0.2.RELEASE
Upgrade to Micrometer 1.6.3
Upgrade to Micrometer 1.5.10
Allow restart to be enabled when CL not named AppClassLoader
Previously, the restart initializer that enables restart when
-Dspring.devtools.restart.enabled=true is set had no effect when the
ClassLoader's name did not contain AppClassLoader. This commit updates
RestartApplicationListener to use the correct RestartInitializer when
the system property has forcibly enabled restart.
When restart is enabled a SilentExitException is thrown and it should be
caught and handled by the SilentExitExceptionHandler. When the
application is invoked via one of the loader's LauncherClasses
reflection is used and this exception becomes wrapped in an
InvocationTargetEception. Previously, this wrapping prevented
SilentExitExceptionHandler from handling the exception. This commit
updates the handler to look for an InvocationTargetException with a
SilentExitException target in addition to continuing to look for a
SilentExitException directly.
Fixes gh-24797,Merge branch '2.4.x'
Support @Name annotation on /actuator/configprops
Update `ConfigurationPropertiesReportEndpoint` so that supports
constructor parameters annotated with `@Name`.
Fixes gh-24713,Merge branch '2.4.x',Fix tests to also work in IDE,Merge branch '2.4.x'
Enforce builder and run images in the same registry
Previously, when an authenticated Docker builder registry was
configured in the Maven or Gradle plugin and the builder and run
images specified different registries, the authentication credentials
would be sent to both registries. This could cause confusion if both
registries don't recognize the same credentials. This commit enforces
that both images are in the same registry when authentication
is configured.
Fixes gh-24552,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Update copyright year of changed files,Merge branch '2.4.x'
Detect bad properties in profile specific files
Throw an `InvalidConfigDataPropertyException` if bad properties are
detected in profile specific files. The following properties will now
trigger an exception if used in a profile specific file:
 `spring.profiles.include`
 `spring.profiles.active`
 `spring.profiles.default`
 `spring.config.activate.on-profile`
 `spring.profiles`
Prior to this commit, profile based properties in a profile specific
file would be silently ignored, making them hard to find.
Fixes gh-24733,Merge branch '2.4.x',Fix typo,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Merge branch '2.2.x' into 2.3.x,Merge pull request #24789 from runningcode
* gh-24789:
  Polish "Upgrade to Gradle Enterprise Maven Extension 1.8.1"
  Upgrade to Gradle Enterprise Maven Extension 1.8.1
Polish "Upgrade to Gradle Enterprise Maven Extension 1.8.1"
See gh-24789,Upgrade to Gradle Enterprise Maven Extension 1.8.1
See gh-24789,Merge branch '2.4.x'
\gh-24790
Use SpringSessionDataSource-annotated DataSource when one is available
Fixes gh-24624,Merge branch '2.4.x'
Merge pull request #24767 from runningcode
* gh-24767:
  Upgrade to Gradle Enterprise Gradle Plugin 3.5.1
Upgrade to Gradle Enterprise Gradle Plugin 3.5.1
See gh-24767,Merge branch '2.4.x'
Fix release train version's comparison with other version types
Fixes gh-24782,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Upgrade to Reactor Dysprosium-SR16
Upgrade to Thymeleaf 3.0.12.RELEASE
Upgrade to Neo4j Ogm 3.2.19
Upgrade to Hibernate Validator 6.0.22.Final
Upgrade to Hibernate 5.4.27.Final
Upgrade to Johnzon Jsonb 1.2.9
Upgrade to Byte Buddy 1.10.19
Upgrade to Joda Time 2.10.9
Upgrade to Netty Tcnative 2.0.36.Final
Upgrade to Netty 4.1.56.Final
Upgrade to Dropwizard Metrics 4.1.17
Upgrade to Hazelcast 3.12.11
Upgrade to Appengine Sdk 1.9.84
Handle files larger than Integer.MAX_VALUE bytes in bootJar and bootWar
Fixes gh-24618,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Upgrade to Netty 4.1.56.Final
Upgrade to Neo4j OGM 3.2.19
Upgrade to Johnzon 1.2.9
Upgrade to Jetty Reactive HTTPClient 1.1.5
Upgrade to Jackson Bom 2.11.4
Upgrade to Hibernate Validator 6.1.7.Final
Upgrade to Hibernate 5.4.27.Final
Upgrade to Hazelcast 3.12.11
Upgrade to Dropwizard Metrics 4.1.17
Upgrade to Byte Buddy 1.10.19
Upgrade to AppEngine SDK 1.9.84
Upgrade to Spring Framework 5.3.3
Simplify resource registration by using the new Spring Framework API
that allows `Resource` instances to be registered directly.
See gh-24745,Start building against Spring Framework 5.3.3 snapshots
See gh-24750,Merge branch '2.4.x'
Register default resource path using a Resource
Update `WebMvcAutoConfiguration` so that the default "/" resource path
is registered directly as a `ServletContextResource`.
Respect spring.dao.exceptiontranslation setting
Update `DataSourceTransactionManagerAutoConfiguration` to respect
the `spring.dao.exceptiontranslation` setting. If `exceptiontranslation`
is `false` then we create a classic `DataSourceTransactionManager`
rather than a `JdbcTransactionManager`.
Fixes gh-24321,Merge branch '2.4.x',Fix tests following upstream framework changes,Merge branch '2.4.x', Test spring.profiles.include in profile file
Add a test to ensure that `spring.profiles.include` is not silently
ignored when used in a profile-specific file.
See gh-24733,Polish,Merge branch '2.4.x'
Upgrade to Reactor 2020.0.3
Polish,Add customizer for jOOQ's configuration
This commit adds a customizer hook point for jOOQ's configuration. When
such a bean is present, it is invoked with the auto-configuration
`Configuration`. This effectively supersedes checking for a number of
jOOQ `*Provider`beans. The existing beans are still honoured, in a
deprecated fashion.
Merge pull request #24734 from PascalSchumacher
* pr/24734:
  Polish "Add support for GET requests for /actuator/startup"
Polish "Add support for GET requests for /actuator/startup"
See gh-24717
See gh-24734,Merge branch '2.4.x'
Configure bootRun to use project's Java toolchain by default
Previously, unlike the application plugin's run task, our bootRun task
ignored the project's Java toolchain. This meant that the application
was run on a JVM with the same Java version as the one being used by
Gradle itself. This could result in a failure if the application
required a more modern JVM.
This commit updates the plugin to configure the bootRun task's
JavaLauncher convention to be one derived from the project's Java
toolchain. Toolchain support was introduced in Gradle 6.7 so this is
only done when using Gradle 6.7 and later.
Fixes gh-24517,Merge branch '2.4.x'
Check configured JavaLauncher when determining version of the JVM
Previously, bootRun assumed that the Java version of the JVM that would
run the application would be the same as the Java version of the JVM
that is running the build. This assumption does not hold true when
Gradle's toolchain support is used to configure tasks that fork a new
JVM to use a version other than that being used by Gradle itself.
This commit updates the BootRun task to query the JavaLauncher property
when determining the version of Java on which the application will be
run. Toolchain support and the JavaLauncher property are new in Gradle
6.7. To support earlier versions of Gradle, NoSuchMethodError is caught
we continue as if no JavaLauncher has been configured and use the local
JVM's Java version.
Fixes gh-24512,Merge branch '2.4.x',Upgrade to Kafka 2.6.1
Upgrade to Thymeleaf Layout Dialect 2.5.2
Upgrade to Spring Retry 1.3.1
Upgrade to Netty 4.1.56.Final
Upgrade to Johnzon 1.2.9
Upgrade to Jetty Reactive HTTPClient 1.1.5
Upgrade to Jackson Bom 2.11.4
Upgrade to Hibernate Validator 6.1.7.Final
Upgrade to Hibernate 5.4.27.Final
Upgrade to Dropwizard Metrics 4.1.17
Upgrade to Byte Buddy 1.10.19
Upgrade to AppEngine SDK 1.9.84
Merge pull request #24717 from bono007
* pr/24717:
  Polish "Add support for GET requests for /actuator/startup"
  Add support for GET requests for /actuator/startup
Polish "Add support for GET requests for /actuator/startup"
See gh-24717,Add support for GET requests for /actuator/startup
See gh-24717,Configure Couchbase to use the application's ObjectMapper
Fix classpath index so entries match those expected by the launcher
This reverts commit ad164269e9aa7d0f39362d78d946a146dac5fdee and adds
some additional tests.
Fixes gh-24192,Merge branch '2.4.x'
Clarify behaviour of WebServerFactory in reference guide
See gh-24703,Start building against Spring AMQP 2.3.3 snapshots
See gh-24702,Start building against Spring Integration 5.4.3 snapshots
See gh-24701,Start building against Spring Data 2020.0.3 snapshots
See gh-24700,Start building against Spring Framework 5.3.3 snapshots
See gh-24699,Start building against Reactor 2020.0.3 snapshots
See gh-24698
Automate homebrew tap repo update
Remove layout parameters from build-image Maven goal
This commit removes the `layout` and `layoutFactory` parameters
from the `build-image` goal in the Maven plugin while retaining
them for the `repackage` goal. The `build-image` goal currently
only supports jar archives, so allowing other layout types to be
configured for the goal could cause confusion.
Fixes gh-24105,Merge branch '2.4.x'
Allow overriding ThemeResolver and FlashMapManager beans
Previously, an error would occur when a user contributed a
`ThemeResolver` or `FlashMapManager` bean because those beans would
would not properly override the default beans provided by Spring
Framework. This commit adds conditional auto-configuration of these
bean types, preferring user-provided beans and falling back to
Framework-provided defaults.
Fixes gh-24207,Merge branch '2.4.x'
Merge pull request #24660 from asheCarry
* pr/24660:
  Fix javadoc typo in ConfigDataLocation
 Fix javadoc typo in ConfigDataLocation
 See gh-24660,Merge pull request #24664 from runningcode
* pr/24664:
  Add filter to Gradle Enterprise Readme badge
Add filter to Gradle Enterprise Readme badge
Add a filter to the Gradle Enterprise Readme badge to filter the scans
list by only the Spring Boot project.
See gh-24664,Merge branch '2.4.x'
Log FailureAnalyzer errors at trace level
Update `FailureAnalyzers` to log errors at `trace` rather than `debug`.
This should reduce noise when an analyzer unexpectedly fails and the
user is running with `--debug`.
Fixes gh-24630,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Merge branch '2.2.x' into 2.3.x,Migrate away from pivotal-legacy/homebrew-tap
Update formula to use spring-boot rather than springboot. This will
allow both taps to be used at the same time.
See gh-24659,Merge branch '2.4.x'
Migrate away from pivotal-legacy/homebrew-tap
Update reference documentation to the new spring-io/homebrew-tap repo.
Consider context-path for WebTestClient baseUrl
Fixes gh-24168,Merge branch '2.4.x'
Replace binder as contributors are processed
Update `ConfigDataEnvironment` so that the bootstrap `Binder` is
replaced as contributors are processed. The final `Binder` is now
also added without the `FAIL_ON_BIND_TO_INACTIVE_SOURCE` option so
that properties can be bound at the last stage even if values exist
in an inactive profile-specific document.
Fix test for JSR-350 @Nonnull
Add test for JSR-350 @Nonnull
See gh-24655,Merge branch '2.3.x' into 2.4.x
See gh-24647,Fix Nullable reference
See gh-24647,Merge branch '2.4.x'
See gh-24655,Merge branch '2.3.x' into 2.4.x
See gh-24647,Reference javax.annotation.Nonnull support in reference guide
See gh-24647,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Merge branch '2.2.x' into 2.3.x,Polish README and CONTRIBUTING files,Update suggested Eclipse version to 2020-12,Merge branch '2.4.x'
Merge pull request #24606 from spartusch
* pr/24606:
  Polish "Return -1 port for non-listening WebServers"
  Return -1 port for non-listening WebServers
Polish "Return -1 port for non-listening WebServers"
See gh-24606,Return -1 port for non-listening WebServers
Update `WebServer` implementations to return -1 from `getPort()` if
the server  isn't listening on a port. This aligns the implementations
with the interface Javadoc.
See gh-24606,Merge branch '2.4.x'
Support JSR-305 annotations on endpoint methods
Update `OperationMethodParameter` to additionally support JSR-305 based
`@Nullable` annotations.
Support symlinks in configtree property paths
Prior to this commit, the configtree property source would not traverse
into a sub-directory in a property path if the sub-directory was a
symbolic link. This commit allows symlinked sub-directories to be
traversed like any other sub-directory in the property path.
Fixes gh-24530,Merge branch '2.4.x'
Ignore documents that do not apply when checking mandatory locations
Merge pull request #24648 from dreis2211
* gh-24648:
  Exclude starters from Javadoc aggregation
Exclude starters from Javadoc aggregation
See gh-24648,Merge branch '2.4.x'
Merge pull request #24628 from andrey4623
* pr/24628:
  Polish "Remove unnecessary semicolon"
  Remove unnecessary semicolon
Polish "Remove unnecessary semicolon"
See gh-24628,Remove unnecessary semicolon
See gh-24628,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Revert fix to enable cors for actuator endpoints
The fix causes a Jersey application to fail in the absence
of a `CorsFilter` or `CorsConfigurationSource` bean.
See gh-11987,Merge branch '2.4.x',Polish
See gh-24597,Merge pull request #24640 from runningcode
* gh-24640:
  Add Revved up by Gradle Enterprise badge to README
Add Revved up by Gradle Enterprise badge to README
See gh-24640,Merge branch '2.4.x'
Merge pull request #24629 from andrey4623
* pr/24629:
  Polish "Make a field final"
  Make a field final
Polish "Make a field final"
See gh-24629,Make a field final
See gh-24629,Merge branch '2.4.x'
Merge pull request #24625 from dreis2211
* pr/24625:
  Update copyrights to 2021
Update copyrights to 2021
See gh-24625,Polish
See gh-21286,Delete ErrorProperties.IncludeStacktrace
Fix sample formatting,Add support for Elasticsearch sniffer
Merge pull request #24604 from izeye
* pr/24604:
  Polish
Polish
See gh-24604,Merge branch '2.3.x' into 2.4.x,Polish
See gh-24604,Upgrade to REST Assured 4.2.1
Upgrade to Thymeleaf 3.0.12
Configure resources filtering encoding
Merge pull request #24597 from edwardsre
* pr/24597:
  Polish "Handle missing manifest files in JarTypeFilter"
  Handle missing manifest files in JarTypeFilter
Polish "Handle missing manifest files in JarTypeFilter"
See gh-24597
Handle missing manifest files in JarTypeFilter
This commit makes sure that a jar file without a manifest is handled
properly (i.e. included in the repackaged archive).
See gh-24597,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Add docs about using InMemoryOAuth2AuthorizedClientService
Add docs about using InMemoryOAuth2AuthorizedClientService
Update documentation containing examples of WebSecurityConfigurerAdapter
Add control connection timeout property for Cassandra
Merge pull request #24239 from meistermeier
* pr/24239:
  Polish "Detect Persistent and RelationshipProperties with Neo4j"
  Detect Persistent and RelationshipProperties with Neo4j
Polish "Detect Persistent and RelationshipProperties with Neo4j"
See gh-24239,Detect Persistent and RelationshipProperties with Neo4j
See gh-24239,Merge pull request #24582 from martindacos
* pr/24582:
  Polish "Allow to configure Kafka Listener's onlyLogRecordMetadata"
  Allow to configure Kafka Listener's onlyLogRecordMetadata
Polish "Allow to configure Kafka Listener's onlyLogRecordMetadata"
See gh-24582,Allow to configure Kafka Listener's onlyLogRecordMetadata
See gh-24582,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x
Harmonize references to ActiveMQ Artemis
Polish,Merge pull request #24302 from jbertram
* pr/24302:
  Polish "Allow to configure ActiveMQ Artemis with a broker url"
  Allow to configure ActiveMQ Artemis with a broker url
Polish "Allow to configure ActiveMQ Artemis with a broker url"
See gh-24302,Allow to configure ActiveMQ Artemis with a broker url
See gh-24302,Merge pull request #24415 from valfirst
* pr/24415:
  Polish "Upgrade to Jackson 2.12.0"
  Upgrade to Jackson 2.12.0
Polish "Upgrade to Jackson 2.12.0"
Guard breaking change to PropertyNamingStrategies so that we tolerate
older Jackson versions.
See gh-24415,Upgrade to Jackson 2.12.0
See gh-24415,Merge pull request #24254 from pdambrauskas
* pr/24254:
  Polish "Upgrade to Embedded Mongo 3.0.0"
  Upgrade to Embedded Mongo 3.0.0
Polish "Upgrade to Embedded Mongo 3.0.0"
See gh-24254,Upgrade to Embedded Mongo 3.0.0
See gh-24254,Merge pull request #24204 from mdeinum
* pr/24204:
  Polish "Reduce the overhead of char[] creation"
  Reduce the overhead of char[] creation
Polish "Reduce the overhead of char[] creation"
See gh-24204,Reduce the overhead of char[] creation
See gh-24204,Merge branch '2.4.x'
Merge pull request #24453 from dreis2211
* pr/24453:
  Add JavaVersion entry for JDK 16
Add JavaVersion entry for JDK 16
See gh-24453,Merge branch '2.3.x' into 2.4.x,Fix multi-release JAR test on JDK 16
See gh-24453,Merge pull request #24478 from izeye
* pr/24478:
  Add note for SPRING_PROFILES_ACTIVE in contributing guide
Add note for SPRING_PROFILES_ACTIVE in contributing guide
See gh-24478,Merge branch '2.4.x'
Merge pull request #24550 from dreis2211
* pr/24550:
  Remove deprecated SpringBootContextLoader#getArgs()
Remove deprecated SpringBootContextLoader#getArgs()
See gh-24550,Merge branch '2.4.x'
Merge pull request #24558 from izeye
* pr/24558:
  Polish
Polish
See gh-24558,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Add a note about disabling git info
See gh-24205,Merge branch '2.4.x'
Update version of git-properties plugin in the docs
Improve documentation regarding git commit info
Change scope of bootstrap registered Binder
Update `ConfigDataEnvironment` so that the `Binder` is registered as
a prototype bootstrap instance. This allows it to be accessed early
but still replaced when a more complete version is available.
Fixes gh-24559,Add BootstrapRegistry Scope support
Update `BootstrapRegistry` so that it can be used to register instances
in either a `singleton` or `prototype` scope. The prototype scope has
been added so that instances can be registered and replaced later
if needed.
See gh-24559,Merge branch '2.4.x',Fixup title anchors,Merge branch '2.4.x'
Clarify when SpEL expressions in application properties are evaluated
Reorder documentation about building images
Update jar `Handler` fallback logic to directly support Tomcat
'jar:war:file' URLs. This commit allows contents to be accessed without
the JDK needing to extracted the nested jar to the temporary folder.
See gh-18631,Fix name clash with integration test apps
Rename "app" projects in `spring-boot-launch-script-tests` and
`spring-boot-loader-tests` to something unique.
See gh-18631,Merge branch '2.4.x'
Prevent Tomcat URL "reflective access" warnings
Update the jar `Handler` class to support a non-reflective fallback
mechanism when possible. The updated code attempts to capture a regular
jar URL before our handler is installed. It can then use that URL as
context when creating the a fallback URL. The JDK jar `Handler` will
be copied from the context URL to the fallback URL.
Without this commit, resolving new Tomcat URLs of the form
`jar:war:file:...` would result in an ugly "Illegal reflective access"
warning.
Fixes gh-18631,Merge branch '2.4.x',Merge branch '2.4.x',Make StandardConfigDataResource.getResource public
Update `StandardConfigDataResource`  to make the `getResource()` method
public so that it can be used by Spring Cloud.
Only throw PortInUseException if port is set
Refine the `PortInUseException` logic in `NettyWebServer` to only throw
an exception if the port is set. The prevents a misleading exception
from being thrown when a domain socket is being used.
Make StandardConfigDataResource.getResource public
Update `StandardConfigDataResource`  to make the `getResource()` method
public so that it can be used by Spring Cloud.
Only throw PortInUseException if port is set
Refine the `PortInUseException` logic in `NettyWebServer` to only throw
an exception if the port is set. The prevents a misleading exception
from being thrown when a domain socket is being used.
Deal with unsupported DisposableServer operations
Update `NettyWebServer` to deal with any `UnsupportedOperationException`
thrown from `DisposableServer`. Specifically, this commit allows the
`NettyWebServer` to work with domain socket backed servers which cannot
provide a port.
Fixes gh-24529,Fix tests
See gh-11987,Merge branch '2.4.x'
Configure CORS in default security configuration for MVC
Fixes gh-11987,Merge branch '2.4.x'
Improve error message with Maven build-image and war packaging
Fixes gh-24522,Merge branch '2.4.x'
Merge pull request #24532 from dreis2211
* pr/24532:
  Avoid duplicates in MergedContextConfiguration
Fixes gh-24521 in 2.4.2,Avoid duplicates in MergedContextConfiguration
Remove duplicate config attribute classes by using a `Set` rather
than a `List` in the `SpringBootTestContextBootstrapper`.
See gh-24532,Fail with Gradle bootBuildImage and war packaging
Prior to this commit, running the bootBuildImage Gradle task on a
project configured for war packaging would result in a jar file being
built and used in the image instead of the war file. With this commit
an error will be thrown from the plugin in this case.
Fixes gh-24521
Protect PluginApplicationActions against absent plugin classes
Add ConfigDataEnvironmentUpdateListener support
Add an overloaded `ConfigDataEnvironmentPostProcessor.applyTo` method
that accepts a listener that can used to track the updates that were
applied to the `Environment`.
The listener can be used to track the which `ConfigDataLocation` and
the `ConfigDataResource` were used to add a `PropertySource`. The lister
can also be used to tell which profiles were applied.
This enhancement is being added in a patch release because it's will
be useful for Spring Cloud 2020.0.0.
Polish,Merge branch '2.4.x',Merge branch '2.3.x' into 2.4.x,Polish,Merge branch '2.4.x',Test that empty property files can be used
Add an additional test to ensure that empty property files do not
throw ConfigDataLocationNotFoundException exceptions.
See gh-24499
See gh-24515,Merge branch '2.4.x'
Include properties from test-autoconfigure in config props appendix
Remove reference to java14 in CI scripts
Pick up new minor releases when upgrading dependencies
See gh-24491,Move EMFDependsOnPostProcessor into autoconfigure.orm.jpa
Update instruction to add the configuration processor with Maven
Merge pull request #24477 from izeye
* pr/24477:
  Use BindResult.orElseGet() where beneficial
Use BindResult.orElseGet() where beneficial
See gh-24477,Merge pull request #24114 from vpelikh
* pr/24114:
  Polish "Add Apache Phoenix to supported database drivers"
  Add Apache Phoenix to supported database drivers
Polish "Add Apache Phoenix to supported database drivers"
See gh-24114,Add Apache Phoenix to supported database drivers
See gh-24114,Merge pull request #24076 from topikachu
* pr/24076:
  Polish "Add configuration for Rabbit's key store and trust store algorithm"
  Add configuration for Rabbit's key store and trust store algorithm
Polish "Add configuration for Rabbit's key store and trust store algorithm"
See gh-24076,Add configuration for Rabbit's key store and trust store algorithm
See gh-24076,Merge branch '2.4.x'
Fix non-optional classpath location checking
Allow directory locations that exist but do not contribute properties
to be specified without an `optional:` prefix. This commit fixes logic
introduced in commit 3dc03ac2752 which didn't account for the fact that
a directory might contain only profile specific property files and that
profiles might not always be active.
Update latest GA param for SDKMAN
See gh-24501,Merge branch '2.3.x' into 2.4.x
Fix detection of latest GA for SDKMAN
Fixes gh-24475,Merge branch '2.4.x'
Remove links to Jetty API and documentation
This commit removes links to Jetty API and documentation as those links
are breaking every time the Jetty team releases a new version
See https://github.com/eclipse/jetty.project/issues/4546
Start work on Spring Boot 2.5
Upgrade Java 8 version in CI image
Upgrade Ubuntu version in CI images
Upgrade CI to Docker 19.03.14
Upgrade Java 8 version in CI image
Upgrade Ubuntu version in CI images
Upgrade CI to Docker 19.03.14
Close gh-24462,Merge branch '2.2.x' into 2.3.x,Upgrade Java 11 version in CI image
Upgrade Java 8 version in CI image
Next development version (v2.4.2-SNAPSHOT),Upgrade Ubuntu version in CI images
Upgrade CI to Docker 19.03.14
Next development version (v2.3.8.BUILD-SNAPSHOT),Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Write docker/config.json for CI Image generation
See gh-24461,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Use GitHub token rather than password
See gh-24458,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Attempt to fix oci-build-task config
See gh-24197,Attempt to fix oci-build-task config
See gh-24197,Attempt to fix oci-build-task config
See gh-24197,Attempt to fix oci-build-task config
See gh-24197,Attempt to fix oci-build-task config
See gh-24197,Fix README,Generate CI images with oci-build-task
Update CI to generate images using an `oci-build-task` since
the `registry-image` resource cannot perform actual image builds.
See gh-24197,Migrate to registry-image in task yaml
See gh-24197,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Fix SDKMAN automation,Update copyright year of changed files,Support @Name meta-annotations with Kotlin binding
Update `ValueObjectBinder` Kotlin support to meta-annotations of
`@Named`.
See gh-24379,Use unique names for wildcard property sources
Update `StandardConfigDataLoader` to use unique names for property
sources imported from a wildcard location.
Prior to this commit, all the property sources created from the same
wildcard location would have the same name. Each time a property source
that is equal to an existing property source is added, it replaces the
existing property source. Property source equality is name-based so this
resulted in the last property sources from the wildcard location
winning.
This commit updates `StandardConfigDataLoader` to use the resolved
Resource rather than the wildcard location in which it was discovered
in the name of the property source that it creates, ensuring that each
is property source from a wildcard location is uniquely named.
Fixes gh-24428,Fix syntax in bash script,Add git-repo as input to sdkman,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Polish
See gh-21903,Next development version (v2.2.13.BUILD-SNAPSHOT),Merge branch '2.3.x'
Upgrade to Gradle 6.7.1
Merge pull request #24418 from izeye
* pr/24418:
  Polish
Polish
See gh-24418,Merge branch '2.3.x'
See gh-24418,Polish
See gh-24418,Upgrade to Tomcat 9.0.41
\gh-24447
Upgrade to SQLite JDBC 3.32.3.3
Upgrade to Netty tcNative 2.0.35.Final
Upgrade to Netty 4.1.55.Final
Upgrade to Caffeine 2.8.8
Upgrade to Spring Kafka 2.6.4
Upgrade to Spring Batch 4.3.1
Upgrade to Spring Integration 5.4.2
Upgrade to Spring AMQP 2.3.2
Upgrade to Micrometer 1.6.2
Upgrade to Tomcat 9.0.41
Upgrade to Netty tcNative 2.0.35.Final
Upgrade to Netty 4.1.55.Final
Upgrade to Caffeine 2.8.8
Upgrade to ActiveMQ 5.15.14
Upgrade to Spring Kafka 2.5.10
Upgrade to Spring Batch 4.2.5
Upgrade to Spring AMQP 2.2.13
Upgrade to Micrometer 1.5.9
Upgrade to Activemq 5.15.14
Upgrade to Undertow 2.0.33.Final
Upgrade to Netty Tcnative 2.0.35.Final
Upgrade to Netty 4.1.55.Final
Upgrade to Caffeine 2.8.8
Upgrade to Spring Kafka 2.3.13
Upgrade to Spring Batch 4.2.5
Upgrade to Spring Integration 5.2.10
Upgrade to Spring AMQP 2.2.13
Use deterministic ordering of JavaBean methods
Update `JavaBeanBinder` so that methods and fields are sorted before
being processed. This ensures that setters are called in a deterministic
order, rather than the unspecified and variable order that reflection
provides.
Fixes gh-24068,Merge branch '2.3.x'
Credit contributors for forward-ported contributions
This commit upgrades github-changelog-generator to 0.0.5 and adds
configuration for forward-port and back-port labels so that
contributors get credit for contributions in the release notes for
each release that includes the contribution.
Fixes gh-24135,Merge branch '2.3.x'
Move SDKMAN to a separate job
Upgrade to Spring Data 2020.0.2
Start building against Spring Data 2020.0.2 snapshots
See gh-24284,Upgrade to Spring HATEOAS 1.2.2
Upgrade to Spring Framework 5.3.2
Upgrade to Spring Framework 5.2.12
Upgrade to Spring Framework 5.2.12
Allow recursive profile group references
Update the original fix for issue #24327 so that recursive elements
are tolerated rather than fail.
See gh-24327,Merge pull request #24327 from dreis2211
* pr/24327:
  Polish 'Fail on recursive references in profile groups'
  Fail on recursive references in profile groups
Polish 'Fail on recursive references in profile groups'
See gh-24327,Fail on recursive references in profile groups
Update `Profiles` group expansion logic to fail if recursive
references are found.
See gh-24327,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Fix checkstyle violations
See gh-21015,Merge pull request #24301 from JimStockwell
* pr/24301:
  Update README with instructions on running tests
Update README with instructions on running tests
See gh-24301,Merge branch '2.3.x'
Narrow auto-configure checkstyle suppressions
See gh-24271,Merge branch '2.3.x'
Merge pull request #24271 from CubeOfCheese
* pr/24271:
  Polish "Triggering a restart" formatting
  Document devtools restart with Maven/Gradle
Polish "Triggering a restart" formatting
See gh-24271,Document devtools restart with Maven/Gradle
Update the documentation to help avoid confusion for people who aren't
using an IDE.
See gh-24271,Merge branch '2.3.x'
Add link to appendix from error handling
Improve documentation by adding a link from the "Error Handling" section
to the appendix.
Merge pull request #24306 from izeye
* pr/24306:
  Polish
Polish
See gh-24306,Merge branch '2.3.x'
Stop deferring JPA bootstrap mode by default
This commit changes the default value of bootstrap-mode to "default"
rather than "deferred" so that the JPA infrastructure starts in the
main thread rather than asynchronously.
Upgrade to Undertow 2.2.3.Final
Upgrade to Tomcat 9.0.40
Upgrade to Nimbus JOSE JWT 9.1.3
Upgrade to Mockito 3.6.28
Upgrade to MariaDB 2.7.1
Upgrade to Kotlin Coroutines 1.4.2
Upgrade to Kotlin 1.4.21
Upgrade to jOOQ 3.14.4
Upgrade to Jetty 9.4.35.v20201120
Upgrade to Infinispan 11.0.8.Final
Upgrade to HttpCore 4.4.14
Upgrade to Hibernate 5.4.25.Final
Upgrade to Groovy 2.5.14
Upgrade to Dropwizard Metrics 4.1.16
Upgrade to DB2 JDBC 11.5.5.0
Upgrade to Caffeine 2.8.7
\gh-24382
Upgrade to Reactor 2020.0.2
Upgrade to Spring Security 5.4.2
Start building against Spring Kafka 2.6.4 snapshots
See gh-24294,Start building against Spring Batch 4.3.1 snapshots
See gh-24291,Start building against Spring AMQP 2.3.2 snapshots
See gh-24288,Start building against Spring HATEOAS 1.2.2 snapshots
See gh-24285,Merge branch '2.3.x',Add @Name support for Kotlin value object binding
Fixes gh-24379,Merge branch '2.2.x' into 2.3.x,Upgrade to Eclipse 2020-09,Merge branch '2.3.x'
Upgrade to Spring Doc Resources 0.2.5
Fixes gh-24146,Merge branch '2.3.x',Upgrade to Spring Security 5.3.6
Start building against Spring Kafka 2.5.10 snapshots
See gh-24293,Start building against Spring Batch 4.2.5 snapshots
See gh-24290,Start building against Spring AMQP 2.2.13 snapshots
See gh-24287,Start building against Spring Data Neumann-SR6 snapshots
See gh-24283,Merge branch '2.2.x' into 2.3.x,Start building against Spring Kafka 2.3.13 snapshots
See gh-24292,Start building against Spring Batch 4.2.5 snapshots
See gh-24289,Start building against Spring AMQP 2.2.13 snapshots
See gh-24286,Start building against Spring Data Moore-SR12 snapshots
See gh-24282,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Merge branch '2.3.x',Upgrade to Tomcat 9.0.40
Upgrade to Jetty 9.4.35.v20201120
Upgrade to HttpCore 4.4.14
Upgrade to Hibernate 5.4.25.Final
Upgrade to Groovy 2.5.14
Upgrade to Dropwizard Metrics 4.1.16
Upgrade to DB2 JDBC 11.5.5.0
Upgrade to Caffeine 2.8.7
Upgrade to Spring Security 5.2.8.RELEASE
Upgrade to Neo4j Ogm 3.2.18
Upgrade to Infinispan 9.4.21.Final
Upgrade to Hibernate 5.4.25.Final
Upgrade to Jetty 9.4.35.v20201120
Upgrade to Groovy 2.5.14
Upgrade to Tomcat 9.0.40
Upgrade to Httpcore 4.4.14
Upgrade to Byte Buddy 1.10.18
Upgrade to Netty 4.1.54.Final
Upgrade to Dropwizard Metrics 4.1.16
Upgrade to Db2 Jdbc 11.5.5.0
Upgrade to Appengine Sdk 1.9.83
Upgrade to Caffeine 2.8.7
Upgrade to Jackson 2.10.5.20201202
Upgrade to Couchbase Client 2.7.18
Use proper CentOS base image
See gh-24344,Switch integration tests to CentOS 7
This commit upgrades the docker image for CentOS to Centos 7.9 as
CentOs 6 is EOL since November 30. Given that CentOS 7 does no longer
support SysVinit, this commit also updates the integration tests to not
test this OS anymore.
See gh-24337,Merge branch '2.3.x',Fix checkstyle header violation
See gh-24337,Revert "Restore HazelcastHealthIndicatorTests"
This reverts commit 5a51b5853e42325cb323eab40350c20027a022d0.,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Restore HazelcastHealthIndicatorTests
Restore `HazelcastHealthIndicatorTests` which was accidentally replaced
with a version from 2.4.x.
See gh-24337,Merge branch '2.3.x'
Fix checkstyle BDD Mockito violations
See gh-24337,Fix checkstyle header violations
See gh-24337,Upgrade to spring-javaformat 0.0.26
Merge pull request #24317 from dreis2211
* pr/24317:
  Remove deprecated code in EndpointDiscoverer
Remove deprecated code in EndpointDiscoverer
See gh-24317,Merge pull request #24326 from dreis2211
* pr/24326:
  Fix Asciidoc build step
Fix Asciidoc build step
See gh-24326,Merge pull request #24325 from dreis2211
* pr/24325:
  Remove System.out.println in DevToolsPropertyDefaultsPostProcessor
Remove System.out.println in DevToolsPropertyDefaultsPostProcessor
See gh-24325,Merge pull request #24323 from dreis2211
* pr/24323:
  Remove deprecated ExposeExcludePropertyEndpointFilter
Remove deprecated ExposeExcludePropertyEndpointFilter
See gh-24323,Document the granularity for property document imports
Correct external application properties load order
Fixes gh-24308,Merge branch '2.3.x'
Add SDKMAN to pipeline
Refine non-optional classpath location checking
Update `StandardConfigDataLocationResolver` to no longer check if
directories exist for classpath resources. Unfortunately checking for
the parent directory of a `ClassPathResource` isn't always possible
without resorting something similar to the
`PathMatchingResourcePatternResolver` which would add a lot of
complexity to the resolver.
In order to ensure that non-optional locations are always resolved,
the `ConfigDataEnvironment` now checks that all imported locations
have been loaded.
Handle wrapper types in Env actuator
This commit modifies the actuator `EnvironmentEndpoint` to allow
primitive wrapper types to be serialized in the response data
structure.
Fixes gh-24307,Start building against Spring Framework 5.3.2 snapshots
See gh-24278,Start building against Reactor 2020.0.2 snapshots
See gh-24275,Merge branch '2.3.x', Start building against Spring Framework 5.2.12 snapshots
 See gh-24277,Start building against Reactor Dysprosium-SR15 snapshots
See gh-24274,Merge branch '2.2.x' into 2.3.x,Start building against Spring Framework 5.2.12 snapshots
See gh-24276,Start building against Reactor Dysprosium-SR15 snasphots
See gh-24273,Merge pull request #24268 from JimStockwell
* pr/24268:
  Mark OriginTrackedPropertiesLoader#isNewDocument private
Mark OriginTrackedPropertiesLoader#isNewDocument private
See gh-24268,Merge branch '2.3.x'
Merge pull request #24257 from JimStockwell
* pr/24257:
  Fix ErrorAttributeOptions#getIncludes Javadoc
Fix ErrorAttributeOptions#getIncludes Javadoc
See gh-24257
Merge pull request #24245 from joca-bt
* pr/24245:
  Fix typo
Fix typo
See gh-24245,Merge pull request #24152 from gesellix
* pr/24152:
  Polish "Check that WebClient is available"
  Check that WebClient is available
Polish "Check that WebClient is available"
See gh-24152,Check that WebClient is available
This commit reinstanties the isWeBClientPresent() check so that
WebTestClientContextCustomizer is only added if a web client is
available.
See gh-24152,Merge branch '2.3.x'
Merge pull request #24208 from xJoeWoo
* pr/24208:
  Polish "Reduce redis health indicator info command result size"
  Reduce redis health indicator info command result size
Polish "Reduce redis health indicator info command result size"
See gh-24208,Reduce redis health indicator info command result size
See gh-24208,Merge branch '2.3.x'
Merge pull request #24230 from wanderleisouza
* pr/24230:
  Polish "Allow to exclude an empty set of ErrorAttributes"
  Allow to exclude an empty set of ErrorAttributes
Polish "Allow to exclude an empty set of ErrorAttributes"
See gh-24230,Allow to exclude an empty set of ErrorAttributes
See gh-24230,Merge branch '2.3.x'
Only run deployment tests when war has material changes
Allow actuator endpoint to have responses with custom HTTP statuses
Fixes gh-24123,Merge branch '2.3.x'
Merge pull request #24095 from artembilan
* gh-24095:
  Polish "Ensure that MeterRegistry bean is defined before SI looks for it"
  Ensure that MeterRegistry bean is defined before SI looks for it
Polish "Ensure that MeterRegistry bean is defined before SI looks for it"
See gh-24095,Ensure that MeterRegistry bean is defined before SI looks for it
Previously, it was possible for Spring Integration, including its
built-in Micrometer support, to be auto-configured before the
Micrometer auto-configuration had defined the MeterRegistry bean. This
resulted in missing Spring Integration metrics.
Spring Integration is unusual in having its own built-in Micrometer
support that it configures itself. Rather than providing
auto-configuration for Integration's Micrometer support (Which isn't
needed), this commit introduces some auto-configuration that just
affects the ordering of the auto-configuration classes. This ordering
ensures that the MeterRegistry bean has been defined by Spring
Integration is auto-configured. This ensures that the MeterRegistry
bean is known to the BeanFactory when Spring Integration goes looking
for it.
See gh-24095,Require bean name match for Locale(Context)Resolver to back off
Web MVC and WebFlux look up by name the Locale(Context)Resolver beans
that they use. Previously, the auto-configured resolvers for MVC and
WebFlux would back off when any bean of the required type was defined,
irrespective of its name. If the name of the user's bean didn't match
the name used by MVC and WebFlux to find the custom resolver, the
custom resolver would be ignored and MVC and WebFlux would use their
defaults. There was no indication of this happening in the condition
evaluation report as all it would show is that the auto-configured
resolver had backed off in favour of the custom resolver. It wouldn't
show anything to explain why the custom resolver had not been used.
This commit updates the auto-configured resolvers to be conditional
on a missing bean of the name required by MVC and WebFlux. If the
user then defines a custom resolver with a different name, the
condition evaluation report will show that the auto-configured
resolver remained as the bean name didn't match.
Fixes gh-24209,Fix processing of line immediately after # in properties file
Fixes gh-24158,Use non deprecated properties to override web resources cache
Only attempt unwrapping of interfaces
Wrapper's isWrapperFor and unwrap methods both take a Class<?> target
but document that the target should be an interface. Prior to this
change, we were calling isWrapperFor with any Class<?> irrespective of
whether or not it was an interface. When using Oracle UCP each call
to isWrapperFor with an interface results in an exception stack trace
being logged.
This commit upates DataSourceUnwrapper to adhere to Wrapper's contract
by only calling isWrapperFor and unwrap with interfaces.
Fixes gh-24154,Merge branch '2.3.x'
Switch to Concourse's registry-image resource
Fix location of Spring LDAP and Spring Session properties
Merge pull request #24147 from stokpop
* pr/24147:
  Polish "Avoid unnecessary pattern compilation in WebFluxTags"
  Avoid unnecessary pattern compilation in WebFluxTags
Polish "Avoid unnecessary pattern compilation in WebFluxTags"
See gh-24147,Avoid unnecessary pattern compilation in WebFluxTags
See gh-24147,Protect against NPE caused by recursive calls
Update `SpringBootConfigurationFactory` so that it no longer attempts
to get a `LoggingSystem`.
The recent `LoggingSystem` update means makes use of the
`SpringFactoriesLoader` class to load candidate logging systems.
Unfortunately, the `SpringFactoriesLoader` class creates a `Logger`
which (when using Log4J2) causes `SpringBootConfigurationFactory` to
run. Calling `LoggingSystem.get` from `SpringBootConfigurationFactory`
results in a recursive call to `SpringFactoriesLoader` which hasn't
yet been fully initialized. We then see an NPE caused by a `null`
`cache`.
This update removes the call to `LoggingSystem.get` with the assumption
that it would never return `null` anyway.
Fixes gh-24163,Merge branch '2.3.x'
Pin github-pr-resource to v0.21.0
Add CharSequenceToObjectConverter support
Update `ApplicationConversionService` with support for converting
`CharSequence` source types by using existing `String` based converters.
The addition is primarily to allow `ConfigTreePropertySource` values
to be converted correctly.
Merge pull request #24173 from izeye
* pr/24173:
  Provide dependency management for elasticsearch-rest-client-sniffer
Provide dependency management for elasticsearch-rest-client-sniffer
See gh-24173,Merge branch '2.3.x'
Use stable builder and run images in integration tests
Fixes gh-24183,Merge branch '2.3.x'
See gh-24179,Correct the ID of the GE conventions plugin
See gh-24178,Merge branch '2.3.x'
Upgrade to Gradle Enterprise Gradle Plugin 3.5
Upgrade to Gradle Enterprise Conventions 0.0.7
Merge pull request #24160 from SCORE1387
* pr/24160:
  Rename "sla" to "slo" in reference documentation
Rename "sla" to "slo" in reference documentation
See gh-24160,Next development version (v2.4.1-SNAPSHOT),Allow Devtools to be enabled irrespective of the launching ClassLoader
Revert "Reduce scope of META-INF customizations to main, source, and javadoc jars"
Upgrade to Netty 4.1.54.Final
Upgrade to jOOQ 3.14.3
Upgrade to Infinispan 11.0.5.Final
Upgrade to AssertJ 3.18.1
Upgrade to Netty 4.1.54.Final
Upgrade to Spring Integration 5.4.1
Merge pull request #24119 from dreis2211
* gh-24119:
  Fix link to Flyway callback docs
Fix link to Flyway callback docs
See gh-24119,Merge pull request #24120 from dreis2211
* gh-24120:
  Fix deprecation warnings in javadoc comments
Fix deprecation warnings in javadoc comments
See gh-24120,Upgrade to Spring Session 2020.0.1
Upgrade to Micrometer 1.6.1
Upgrade to Spring Kafka 2.6.3
Upgrade to Spring AMQP 2.3.1
See gh-24043,Only skip ..-prefixed locations when found via wildcard
Upgrade to Spring Data 2020.0.1
Upgrade to Reactor 2020.0.1
See gh-24096,Merge branch '2.3.x'
Upgrade to Reactor Dysprosium-SR14
Upgrade to Spring HATEOAS 1.2.1
Avoid image pulls in integration tests
This commit sets the pull policy to `IF_NOT_PRESENT` where possible
in integration tests for the Maven and Gradle plugins to reduce
the number of times the default Paketo builder and run images are
pulled from Docker Hub.
Fixes gh-24113,Merge branch '2.3.x'
Test inclusion of system scope dependencies in repackaged war
Start building against Reactor 2020.0.1 snapshots
See gh-24110,Merge branch '2.3.x',Start building against Reactor Dysprosium-SR14 snapshots
See gh-24109,Merge branch '2.3.x'
Upgrade to Testcontainers 1.15.0
Rationalize Testcontainers image versions
This commit rationalizes the Docker image names used in integration
tests.
Polish
See gh-24099,Polish,Add spring.web.resources.cache.use-last-modified
Prior to this commit, packaging a Spring Boot application as a container
image with Cloud Native Buildpacks could result in unwanted browser
caching behavior, with "Last-Modified" HTTP response headers pointing to
dates in the far past.
This is due to CNB resetting the last-modified date metadata for static
files (for build reproducibility and container layer caching) and Spring
static resource handling relying on that information when serving static
resources.
This commit introduces a new configuration property
`spring.web.resources.cache.use-last-modified` that can be used to
disable this behavior in Spring if the application is meant to run as a
container image built by CNB.
The default value for this property remains `true` since this remains
the default value in Spring Framework and using that information in
other deployment models is a perfectly valid use case.
Fixes gh-24099,Upgrade to Spring Framework 5.3.1
See gh-24103,Merge branch '2.3.x'
Upgrade to Testcontainers 1.15.0
This reverts commit b1c446d1b2459c6a8ae756c89a737aa8ba39c3bb.,Upgrade to testcontainers 1.15.0
When a Configuration is copied, any before and after resolve actions
that are registered with its ResolvableDependencies are also copied
over. This means that, when a copied configuration is resolved the
resolution actions may be called on a ResolvableDependencies instances
that isn't the one to which they were added.
Previously, the above-described Gradle behaviour would result in
BootJar accessed the ResolvedConfiguration of a Configuration that may
not have yet been resolved. At best this would trigger Configuration
resolution and at worst it would fail. A failure could occur if the
configuration had been copied so that it could be made resolvable.
The afterResolve action would then try to access the
ResolvedConfiguration of the original Configuration. This would trigger
a resolution attempt that fails due to the original configuration being
marked as unresolvable.
This commit updates the afterResolve action in BootJar to check that
the ResolvableDependencies with which it is called matches the
ResolvableDependencies with which it was original registered. Only
when the two match, and therefore the configuration has actually been
resolved, does processing proceed.
Fixes gh-24072,Upgrade to SendGrid 4.6.8
Upgrade to Pooled JMS 1.2.1
Upgrade to Nimbus JOSE JWT 9.1.2
Upgrade to Kotlin Coroutines 1.4.1
Upgrade to jOOQ 3.14.1
Upgrade to Hibernate 5.4.23.Final
Upgrade to Couchbase Client 3.0.10
Upgrade to Byte Buddy 1.10.18
Upgrade to AppEngine SDK 1.9.83
Upgrade to Hibernate 5.4.23.Final
Upgrade to Couchbase Client 3.0.10
Upgrade to Byte Buddy 1.10.18
Upgrade to AppEngine SDK 1.9.83
Only pick up new maintenance releases when upgrading dependencies
Start building against Spring Framework 5.3.1 snapshots
See gh-24035,Merge branch '2.3.x',Start building against Spring Framework 5.2.11 snapshots
See gh-24034,Merge branch '2.3.x'
Upgrade to spring-doc-resources 0.2.4
Show how to configure a case-sensitive physical naming strategy
Use most specific getter when generating metadata
This commit makes sure to use the most specific getter if more than
one candidate exists.
Reduce scope of META-INF customizations to main, source, and javadoc jars
Upgrade to test-retry-gradle-plugin 1.1.9
See gh-24053,Merge branch '2.2.x' into 2.3.x
See gh-24052,Do not set Tomcat's trust store password when null
See gh-24041,Merge branch '2.3.x'
Do not set Tomcat's key store and key pass when null
Fixes gh-24041,Upgrade to Jetty 9.4.34.v20201102
Narrow criteria for hidden property paths
A previous change intended to prevent temporary directories created as
an implementation detail of mounting volumes on kubernetes pods from
being used as a source for property files had a side-effect of also
preventing other types of hidden directories from being recognized. This
commit narrows the criteria for considering a directory as hidden,
using the kubernetes `..` prefix convention instead of the Unix `.`
prefix.
Fixes gh-23983,Correct cross-reference in reference documentation
See gh-24033,Merge branch '2.3.x'
Configure DockerHub credentials on staging builds
See gh-24038,Log into DockerHub prior to running CI builds
Clarify documentation for relaxed binding of environment variables
Improve description of spring.datasource.initialization-mode
Recommend disabling context root redirects with proxied Tomcat
Ignore schema username when auto-configuring a test DB
Previously, when an embedded test database was being auto-configured
any schema username and password specified by the user would result
in a separate embedded test database being created to load the schema.
This then left the actual test database without the schema causing
test failures.
This commit updates the test database auto-configuration to set the
schema username to an empty string in a property source that's added
first to the environment's property sources. This causes any schema
username configured by the user to be ignored, preventing the creation
of a separate database for schema.sql processing.
Fixes gh-19321,Merge branch '2.3.x'
Merge pull request #24020 from PascalSchumacher
* gh-24020:
  Fix typo in Spring Session documentation
Fix typo in Spring Session documentation
See gh-24020,Merge branch '2.3.x'
Improve Spring Session back-off documentation
Allow entries to be streamed from JarURLConnections' jar file
Fixes gh-23821,Merge branch '2.3.x'
Merge pull request #23999 from mruzicka
* gh-23999:
  Polish "Avoid repeated calls of WebFlux and MVC registrations' getters"
  Avoid repeated calls of WebFlux and MVC registrations' getters
\gh-23999
Polish "Avoid repeated calls of WebFlux and MVC registrations' getters"
See gh-23999,Deprecate classpath logging listener and stop registering by default
Avoid repeated calls of WebFlux and MVC registrations' getters
See gh-23999,Merge branch '2.3.x'
Ensure that Quartz can be auto-configured with a Quartz-specific TM
Previously, Quartz could be configured with a specific DataSource
using `@QuartzDataSource` but it was not possible to configure a
Quartz-specific transaction manager. This could result in the
different DataSources being used by Quartz itself and Quart'z
DataSourceTransactionManager.
This commit introduces a new qualifier, `@QuartzTransactionManager`,
that can be used to avoid the above-described problem. Any
`@QuartzTransactionManager`-annotated bean will be used by the
Quartz auto-configure configuration instead of the application's main
`TransactionManager`. If no such qualified bean is present, the
application's main TransactionManager, if any, will be used as before.
Fixes gh-20184,Merge branch '2.3.x'
Implement equals and hashCode in TestTypeExcludeFilter
Fixes gh-23978,Merge pull request #24011 from dsyer
* gh-24011:
  Polish "Align MustacheViewResolver with other similar resolvers"
  Align MustacheViewResolver with other similar resolvers
Polish "Align MustacheViewResolver with other similar resolvers"
See gh-24011,Align MustacheViewResolver with other similar resolvers
The `FreeMarkerViewResolver` (and other template-based resolvers) in
Spring Framework avoid using reflection if they know how to
instantiate the view class. This change aligns with them.
See gh-24011,Merge branch '2.3.x'
Remove use of `@PostConstruct` from main code
When running on Java 11 (where `@PostConstruct` is no longer part of
the JRE) and without a dependency on jakarta-annotation-api,
`@PostContruct` annotions are silently dropped. This leads to obscure and
hard-to-track down changes in the behaviour of our auto-configuration
as the `@PostConstruct`-annotated methods are not invoked.
To allow users to run on Java 11 without having jakarta-annotation-api
on the classpath, this commit removes use of `@PostConstruct` from main
code. A Checkstyle rule has also been added to prevent its usage in
main code from being reintroduced.
Make it clearer that only the main DataSource bean may be replaced
Add tip about providing as much typo info as possible in @Bean methods
Polish manifests of source and javadoc jars
Previously, the main jar file and the source and javadoc jar files all
had the same changes applied to their manifests.
The commit changes the Implementation-Title of source and javadoc jars
so that the title indicates that's what they are. Rather than using
the project's description as the title (as is done for the main jar),
the titles for source and javadoc jars will now be "Source for
${project.name}" and "Javadoc for ${project.name}" respectively.
Correct replacement for stale-while-revalidate config property
Fixes gh-23980,Fix nested test config discovery for sliced tests
Fixes gh-23984,Work around Micrometer JvmGcMetrics introspection failure
Make deployment integration tests run when war changes
Fix metadata for deprecated logging.file properties
See gh-23609
Remove code that's no longer used
Add missing default values in configuration properties metadata
Use Graal friendly logging factory implementations
Update `LoggingSystemFactory` class present checks to use a static
final field so that they work better with Graal.
Polish formatting,Merge pull request #23986 from izeye
* pr/23986:
  Polish
Polish
See gh-23986,Merge branch '2.3.x',Fix release script distribution check
Update `BintrayService.isDistributionComplete` to use unpublished
artifacts.,Fix test that depended on snapshot version
A test case would fail to accurately capture the contents
of the layers.idx file unless the test project contained
at least one non-project snapshot dependency, which was only
true when the Spring Boot version was a snapshot.
See gh-23463,Upgrade to Micrometer 1.6.0
See gh-23824,Move spring.resources.* properties to spring.web.resources.*
Update copyright year of changed files,Merge branch '2.3.x',Update copyright year of changed files,Merge branch '2.3.x'
Upgrade to spring-doc-resources 0.2.3.RELEASE
Use overriding rather than overridden getter methods in config prop AP
Fixes gh-23966,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Next development version (v2.2.12.BUILD-SNAPSHOT),Upgrade to Flyway 7.1.1
Upgrade to github-changelog-generator 0.0.4
* gh-23958:
  Polish "Add liquibase driver class name property"
  Add liquibase driver class name property
Polish "Add liquibase driver class name property"
See gh-23958,Configure release script to use .RELEASE suffix,Add liquibase driver class name property
See gh-23958,Merge branch '2.3.x',Ensure that additional metadata is available to annotation processor
Fixes gh-23934,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Merge branch '2.1.x' into 2.2.x
See gh-23962,Workaround broken function in concourse scripts
See spring-io/concourse-java-scripts#11,Upgrade to Spring Batch 4.3.0
Upgrade to Spring Session 2020.0.0
Upgrade to Spring Integration 5.4.0
See gh-23962,Workaround broken function in concourse scripts
See spring-io/concourse-java-scripts#11,Refine MetadataCollector logic
Update `MetadataCollector` merge logic so that previous items are no
longer added if the current round contains a property of the same name.
Fixes gh-23916,Merge branch '2.3.x'
Retain inner-class data on incremental compile
Ensure that metadata sourced from inner-types is not deleted when
performing an incremental compile. Prior to this commit, the source
type was searched using the `Outer$Inner` format. This is not supported
`Elements.getTypeElement` so we now convert the names to `Outer.Inner`.
Upgrade CI to Java 15.0.1_9
Upgrade CI to Ubuntu Focal 20201008
Upgrade CI to Java 11.0.9_11
Upgrade CI to jdk8u272-b10
\gh-23946
Show the source jar of a ClasspathResource
Update `TextResourceOrigin` so that it shows the source jar file
of a `ClasspathResource`.
Provide content-length header to Docker API calls
Docker daemon authorization plugins reject POST or PUT requests that have a
content type `application/json` header but no content length header. This
commit ensures that a content length header is provided in these cases.
This is a cherry-pick of the changes in d5b2836ec90c5a94b2201c074db5e3fcc99a9204
which were lost in a forward-merge.
Fixes gh-23957,Merge branch '2.3.x',Upgrade to Spring Kafka 2.5.7
Upgrade to Spring Integration 5.2.9
Fix test failure caused by MavenBuild upgrades
See gh-23937,Merge branch '2.3.x'
Ensure that additional metadata is available to annotation processor
Fixes gh-23934,Provide content-length header to Docker API calls
Docker daemon authorization plugins reject POST or PUT requests that have a
content type `application/json` header but no content length header. This
commit ensures that a content length header is provided in these cases.
Fixes gh-22840,Revert "Upgrade to Flyway 7.1.0"
This reverts commit a6c6aba40d3e8af6dc4bdbcab9ead5eb88b997cc.
See gh-23932,Merge branch '2.3.x'
Upgrade MavenBuild versions
Align versions with those in the main build.
Upgrade to Spring AMQP 2.3.0
Upgrade to Spring Integration 5.3.3
Upgrade to Micrometer 1.5.6
Merge pull request #23935 from nohn
* pr/23935:
  Upgrade to Log4j 2.13.3 in Maven tests
Upgrade to Log4j 2.13.3 in Maven tests
See gh-23935,Upgrade to Spring Data 2020.0.0
Upgrade to Flyway 7.1.0
Wait for DataSource init before allowing context refresh to complete
Upgrade to Spring Data Moore-SR11
Remove version elements from Maven plugin documentation
This commit removes `<version>` from the Maven Plugin documentation
where it makes sense so that versions aren't hardcoded unnecessarily.
Rather, a plugin or dependency management should be in place so those
are not needed.
Fix custom layout example so that tokens are replaced,Make isPresent check more Graal-friendly
Streamline use of TestContextAnnotationUtils
See gh-12470,Provide Mockito with a MockResolver that removes Spring-created proxies,Inherit enclosing class's configuration in nested tests
Fixes gh-12470,Upgrade to Spring HATEOAS 1.2.0
Upgrade to Mockito 3.6.0
Upgrade to Lettuce 6.0.1.RELEASE
See gh-21454,Upgrade to Lettuce 5.3.5.RELEASE
Revert to Spring AMQP 2.1.17
See gh-23782,Add auto-trimming support to configtree sources
Update `ConfigTreePropertySource` with an option to automatically trim
trailing new-line characters.
Use stricter document properties separator logic
Update `OriginTrackedPropertiesLoader` with stricter logic around the
document separator. If the preceding or following lines are comments
then the separator will be ignored.
Don't adapt RandomPropertySource
Stop adapting `RandomPropertySource` to `ConfigurationPropertySource`
since it's not useful as a binding source.
Merge pull request #23146 from otaconix
* pr/23146:
  Polish 'Support nested @PropertyMapping annotations'
  Support nested @PropertyMapping annotations
Polish 'Support nested @PropertyMapping annotations'
See gh-23146,Support nested @PropertyMapping annotations
Update `AnnotationsPropertySource` so that nested annotations are
supported. Prior to this commit, annotations annotated with
`@PropertyMapping` that contained nested annotation attributes would
result in instances of `TypeMappedAnnotation` being used as properties.
This usually led to errors due to not being able to convert those to
Strings. This commit makes it so that nested annotations are recursively
mapped to properties. This should allow for more complex configuration
to be mapped from annotations.
See gh-23146,Exclude property beans from method validation
Exclude `@ConfigurationProperties` beans from method validation so
that `@Validated` can be used on final classes without the method
validation post-processor throwing an exception.
This commit introduces a `FilteredMethodValidationPostProcessor` class
which will use `MethodValidationExcludeFilters` to exclude beans from
method validation processing. Using `@EnableConfigurationProperties`
will automatically register an appropriate filter.
Support wildcard configtree imports
Update `ConfigTreeConfigDataResource` so that a wildcard suffix can
be used to import multiple folders. The pattern logic from
`StandardConfigDataLocationResolver` has been extracted into a new
`LocationResourceLoader` class so that it can be reused.
Upgrade to Spring Framework 5.3.0
Previously, the test would make an HTTP request and, as soon as the
response was received, it would check the presence and value of the
http.server.requests meter. This create a race condition between the
meter being registered once the response had been flushed and the
meter's presence being checked. If the check won the race, the test
would fail.
This commit updates the test to wait for up to 5 seconds for the
meter to be present and have a count of 1, matching the single request
that has been made.
Fixes gh-23919,Polish,Merge branch '2.3.x',Upgrade to Spring Framework 5.2.10
Upgrade to Rsocket 1.1.0
Remove skipping of spring-boot-* projects from DevTools restart triggers
Provide config properties for configuring WebFlux's locale resolution
Previously, the locale context resolver used with WebFlux could only be
configured by provided a custom LocaleContextResolver bean. By
constrast, when using Spring MVC, the spring.mvc.locale and
spring.mvc.locale-resolver properties could be used to configure the
locale and the resolver (fixed or Accept header) respectively.
This commit introduces spring.web.locale and spring.web.locale-resolver
properties and deprecates their spring.mvc equivalents. The new
properties can be used to configure locale resolution with either
Spring MVC or WebFlux.
Add @ConditionalOnDefaultWebSecurity annotation
Add a dedicate condition annotation to detect when Spring Security is
available but has not been configured by the user. The new annotation
helps simplify quite a few of our auto-configuration classes.
See gh-23421,Configure WebSecurity using WebSecurityCustomizer
Replace `WebSecurityConfigurer` and `WebSecurityConfigurerAdapter`
configurations with `WebSecurityCustomizer` or `SecurityFilterChain`
beans.
Add ConfigurationProperty.toString() for debugging
Update `ConfigurationProperty` with a sensible `toString()` to help
debug task failures.,Upgrade to Reactor 2020.0.0
Polish
See gh-23914,Upgrade to Kotlin Coroutines 1.4.0
Close gh-23913,Merge branch '2.3.x',Upgrade to JUnit 4.13.1
Upgrade to JUnit Jupiter 5.6.3
Register @WebListeners in a way that allows them to register components
Previously, @WebListeners were discovered via custom component scanning
and then registered programmatically via the ServletContext. The servlet
spec requires any ServletContextListener registered in this manner to be
prohibited from programatically configuring servlets, filters, and
listeners. This left us not strictly complying with the servlet spec
as a ServletContextListener registered via a @WebListener annotation
should be able to programatically configure other components.
This commit updates WebListenerHandler to register each @WebListener
component directly with Jetty, Tomcat, or Undertow rather than via the
ServletContext API. This ensure that any @WebListener-annoated
ServletContextListener registered via servlet component scanning is
able to programatically register servlets, filters, and listeners.
There is a small chance that this will be a breaking change for some
users:
1. The ServletListenerRegistrationBeans that were previously defined
   for each @WebListener will now be
   WebListenerHandler.WebListenerRegistrars
2. Each @WebListener-annotated class will now be instantiated by
   Jetty, Tomcat, or Undertow. Jetty and Tomcat both require the class
   to be public and have a public default constructor. Previously,
   a package-private class or default constructor could be used as the
   instantiation was performed by Spring Framework. Undertow is not
   affected as it can instantiate a package-private type.
Fixes gh-18303,Prevent serialization exception from Env actuator
When `EnvironmentEndpoint` is building a response to return to the
web infrastructure, it creates a data structure containing all
property values from all property sources. Prior to this commit, it
was possible for the response data structure to contain property
values that were not serializable to JSON by Jackson, which would
cause an exception to be thrown by the web infrastructure. This
commit ensures the data structure is serializable to JSON by
ensuring property values are primitives or Strings, and returning
a placeholder value if a property value is of any other type.
Fixes gh-23805,Merge branch '2.3.x',Upgrade to Reactor Dysprosium-SR13
Provide default charset properties
Fixed gh-23827
Add support for SAML2 relying party registration's decryption credentials
Await registration of http.server.requests meter
Previously, the test would make an HTTP request and, as soon as the
response was received, it would check the presence and value of the
http.server.requests meter. This create a race condition between the
meter being registered once the response had been flushed and the
meter's presence being checked. If the check won the race, the test
would fail.
This commit updates the test to wait for up to 5 seconds for the
meter to be present and have a count of 1, matching the single request
that has been made.
Fixes gh-23863,Introduce management base-path property for servlet and reactive actuator
Previously, the base path of a servlet-based management server could be
configured using management.server.servlet.context-path but there was no
equivalent property for WebFlux.
This commit introduces a new property, management.server.base-path,
that can be used with both servlet and reactive management servers. The
existing servlet-specific property has been deprecated in favour of the
new general property. When using the servlet stack, if both the general
property and the servlet-specific property are set, the new general
property takes precedence. When using the reactive stack, only the new
general property is considered.
Upgrade to SendGrid 4.6.7
Upgrade to Rabbit AMQP Client 5.10.0
Upgrade to R2DBC Bom Arabba-SR8
Upgrade to Postgresql 42.2.18
Upgrade to Oracle Database 19.8.0.0
Upgrade to Nimbus JOSE JWT 9.1.1
Upgrade to OAuth2 OIDC SDK 8.23.1
Upgrade to Netty 4.1.53.Final
Upgrade to MySQL 8.0.22
Upgrade to MongoDB 4.1.1
Upgrade to Mockito 3.5.15
Upgrade to Lombok 1.18.16
Upgrade to jOOQ 3.14.0
Upgrade to Jetty 9.4.33.v20201020
Upgrade to Flyway 7.0.4
Upgrade to Elasticsearch 7.9.3
Upgrade to Dropwizard Metrics 4.1.14
Upgrade to Commons Pool2 2.9.0
Upgrade to AssertJ 3.18.0
Upgrade to Spring Security 5.3.5.RELEASE
Upgrade to RxJava2 2.2.20
Upgrade to R2DBC Bom Arabba-SR8
Upgrade to Postgresql 42.2.18
Upgrade to Netty 4.1.53.Final
Upgrade to Neo4j OGM 3.2.17
Upgrade to MySQL 8.0.22
Upgrade to Lombok 1.18.16
Upgrade to jOOQ 3.13.5
Upgrade to Jetty 9.4.33.v20201020
Upgrade to Jackson Bom 2.11.3
Upgrade to HttpClient 4.5.13
Upgrade to Hibernate Validator 6.1.6.Final
Upgrade to Hibernate 5.4.22.Final
Upgrade to Hazelcast 3.12.10
Upgrade to Dropwizard Metrics 4.1.14
Upgrade to Couchbase Client 3.0.9
Upgrade to Caffeine 2.8.6
Upgrade to Byte Buddy 1.10.17
Align versions of scala-library and scala-reflect
Fix configuration of Webflux Spring Session smoke test
See gh-23752,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Do not use servlet session timeout for reactive web applications
This commit fixes the auto-configuration of Spring Session to use
"server.servlet.session.timeout" as a fallback for Servlet-based web
applications only.
Upgrade to Spring Security 5.2.7.RELEASE
Upgrade to Lombok 1.18.16
Upgrade to Postgresql 42.2.18
Upgrade to Neo4j Ogm 3.2.17
Upgrade to Hibernate Validator 6.0.21.Final
Upgrade to Hibernate 5.4.22.Final
Upgrade to Elasticsearch 6.8.13
Upgrade to Jetty 9.4.33.v20201020
Upgrade to Tomcat 9.0.39
Upgrade to Httpclient 4.5.13
Upgrade to Byte Buddy 1.10.17
Upgrade to Mysql 8.0.22
Upgrade to Joda Time 2.10.8
Upgrade to Undertow 2.0.32.Final
Upgrade to Rxjava2 2.2.20
Upgrade to Netty 4.1.53.Final
Upgrade to Dropwizard Metrics 4.1.14
Upgrade to Hazelcast 3.12.10
Upgrade to Caffeine 2.8.6
* pr/23719:
  Polish "Allow overriding image.cleanCache from the command-line"
  Allow overriding image.cleanCache from the command-line
Polish "Allow overriding image.cleanCache from the command-line"
See gh-32719,Allow overriding image.cleanCache from the command-line
See gh-32719,Upgrade to Spring Security 5.1.13.RELEASE
Upgrade to Lombok 1.18.16
Upgrade to Postgresql 42.2.18
Upgrade to Hibernate Validator 6.0.21.Final
Upgrade to Jetty 9.4.33.v20201020
Upgrade to Tomcat 9.0.39
Upgrade to Httpclient 4.5.13
Upgrade to Mysql 8.0.22
Upgrade to Joda Time 2.10.8
Upgrade to Undertow 2.0.32.Final
Upgrade to Rxjava2 2.2.20
Upgrade to Netty 4.1.53.Final
Attempt to fix flaky logging tests,Refine exception handling in logging listener
Refine the exception handling block to cover initialization exceptions
without a log file.
Fix main class resolution failure when loaded from config cache
See gh-22922,Merge branch '2.3.x',Polish,Polish,Add properties for logging charsets
Add `logging.charset.console` and `logging.charset.file` properties
that can be used to configure charsets for Logback/Log4J2.
Allow TestPropertyValues.of to take a Map source
Extend the API of `TestPropertyValues` so that it can be constructed
from an existing `Map` or a `Stream` and mapping `Function`.
Polish,Adapt to breaking change in Framework's RouterFunctions.Visitor
See gh-23774,Adapt test to cope with increased Instant precision on Java 11
See gh-22922,Avoid calling getProject() during BootBuildImage's execution
See gh-22922,Merge branch 'gradle-plugin-configuration-cache'
Document support for Gradle's configuration cache
See gh-22922
Update BootBuildImage to support Gradle's configuration cache
See gh-22922,Update bootJar and bootWar to use new main class resolution mechanism
See gh-22922,Update BootRun to support Gradle's configuration cache
See gh-22922,Update BuildInfo to support Gradle's configuration cache
See gh-22922, Update BootWar to support Gradle's configuration cache
 See gh-22922,Update BootJar to support Gradle's configuration cache
See gh-22922,Allow tests to provide properties that modify the build.gradle script
See gh-22922,Add support for testing the Gradle plugin with --configuration-cache
See gh-22922,Fix missing broken link in reference docs
See gh-23126,Change favicon StaticResourceLocation
Prior to this commit, the `StaticResourceLocation` for favicons would
point to `"/**/favicon.ico"`. This location does not reflect the current
web development landscape, since the png format and size variants are
not supported here. Also, the `"**"` pattern can be costly at runtime
and is deprecated by the new path pattern support in Spring Framework
(see gh-22833).
This commit changes the default locations to `"/favicon.*","/*/icon-*"`,
supporting common use cases such as `"/favicon.ico"`, `"/favicon.png"`
and `"/icons/icon-48x48.png"`.
Polish HTTP/2 Cleartext documentation
See gh-23816
Merge pull request #23799 from garyrussell
* pr/23799:
  Polish "Remove RabbitMQ AutoConfig Boolean Coercion"
  Remove RabbitMQ AutoConfig Boolean Coercion
Polish "Remove RabbitMQ AutoConfig Boolean Coercion"
See gh-23799,Remove RabbitMQ AutoConfig Boolean Coercion
See gh-23799,Merge branch '2.3.x'
Prevent duplicate jar entries from being written
Update the `AbstractJarWriter` so that it can directly build the layer
index as entries are written. Prior to this commit, a layer tracking
was handled by a decorator class which was broken because it didn't
override enough methods. Since `AbstractJarWriter` has quite a complex
API, it seems sensible to have it handle the layer index directly,
removing the need for a decorator entirely.
Fixes gh-23801,Rationalize Logback logging properties
Deprecate and provide alternatives for logging properties that are
specific to Logback.
The following Spring Boot properties have been changed:
  * logging.pattern.rolling-file-name ->
    logging.logback.rollingpolicy.file-name-pattern
  * logging.file.clean-history-on-start ->
    logging.logback.rollingpolicy.clean-history-on-start
  * logging.file.max-size ->
    logging.logback.rollingpolicy.max-file-size
  * logging.file.total-size-cap ->
    logging.logback.rollingpolicy.total-size-cap
  * logging.file.max-history ->
    logging.logback.rollingpolicy.max-history
As have the system environment properties that they map to:
  * ROLLING_FILE_NAME_PATTERN ->
    LOGBACK_ROLLINGPOLICY_FILE_NAME_PATTERN
  * LOG_FILE_CLEAN_HISTORY_ON_START ->
    LOGBACK_ROLLINGPOLICY_CLEAN_HISTORY_ON_START
  * LOG_FILE_MAX_SIZE ->
    LOGBACK_ROLLINGPOLICY_MAX_FILE_SIZE
  * LOG_FILE_TOTAL_SIZE_CAP ->
    LOGBACK_ROLLINGPOLICY_TOTAL_SIZE_CAP
  * LOG_FILE_MAX_HISTORY ->
    LOGBACK_ROLLINGPOLICY_MAX_HISTORY
This commit also cleans up and simplifies `DefaultLogbackConfiguration`.
Document how to configure h2c protocol
Prior to this commit, the how-to documentation would say that Spring
Boot does not support the h2c protocol. While it's not supported
out-of-the-box with a configuration property, this protocol can still be
configured using server customizers.
This commit documents, with code snippets, the server customizers one
should use to configure the h2c protocol in an application - for each
supported server.
Add HttpEncodingAutoConfiguration to WebMvcTest
Prior to this commit, tests using the `@WebMvcTest` annotation would not
include the `HttpEncodingAutoConfiguration`. This means that, even if
configured, the encoding filter would not be configured in MVC tests,
resulting in an inconsistency with `@SpringBootTest` tests.
This commit ensures that the `HttpEncodingAutoConfiguration` is included
when `@WebMvcTest` is used.
Fixes gh-23749,Adapt to deprecation of StringUtils.isEmpty(Object)
See gh-23774,Put module deps in app layer and make customization easier
Previously, when building a layered jar with Maven, dependencies
on modules in the same build were treated the same as any other
dependency, being included in the dependencies or snapshot dependencies
layer based on their version.
This commit updates the default layering when using Maven to include
dependencies on modules in the same build in the application layer by
default. The XML schema has also been updated to allow the layer to be
customized using new <includeModuleDependencies/> and
<excludeModuleDependencies/> elements rather than relying on including
and excluding them via a group:artifact:version pattern.
Ignore properties files in hidden directories
This commit modifies the logic for finding properties files using
wildcard paths to ignore files if any part of the file path contains
a hidden directory. Hidden directories are common when Kubernetes
mounts config maps onto volumes in a pod, which was causing the same
properties files to be loaded multiple times.
Fixes gh-23160,Merge branch '2.3.x',Start building against Spring Kafka 2.5.7 snapshots
See gh-23787,Start building against Spring AMQP 2.2.12 snapshots
See gh-23784,Start building against Spring Integration 5.3.3 snapshots
See gh-23780,Start building against Spring Data Neumann-SR5 snapshots
See gh-23777,Merge branch '2.2.x' into 2.3.x,Start building against Spring Kafka 2.3.12 snapshots
See gh-23786,Start building against Spring AMQP 2.2.12 snapshots
See gh-23783,Start building against Spring Data Moore-SR11 Snapshots
See gh-23776,Merge branch '2.1.x' into 2.2.x,Start building against Spring AMQP 2.1.18 snapshots
See gh-23782,Start building against Spring Data Lovelace-SR21 snapshots
See gh-23775,Start building against Reactor Californium-SR22 snapshots
See gh-23792,Start building against Spring Framework 5.3.0 snapshots
See gh-23774,Start building against Reactor 2020.0.0 snapshots
See gh-23771,Merge branch '2.3.x',Start building against Reactor Dysprosium-SR13 snapshots
See gh-23770,Merge branch '2.2.x' into 2.3.x,Start building against Spring Framework 5.2.10 snapshots
See gh-23773,Start building against Reactor Dysprosium-SR13 snapshots
See gh-23769,Merge branch '2.1.x' into 2.2.x,Start building against Spring Framework 5.1.19 snapshots
See gh-23772,Merge pull request #23766 from garyrussell
* pr/23766:
  Polish "Add configuration options for RabbitMQ's batch listener config"
  Add configuration options for RabbitMQ's batch listener config
Polish "Add configuration options for RabbitMQ's batch listener config"
See gh-23766,Add configuration options for RabbitMQ's batch listener config
See gh-23766,Remove unnecessary code
Remove code from `LogbackLoggingSystem.loadDefaults` that sets Logback
context properties from the Spring Environment. The code should not be
required since `LoggingSystemVariables` will have already set system
variables for the logging config to use.
Merge pull request #23755 from cdalexndr
* pr/23755:
  Polish contribution
  Note that using LiveReload requires Devtools restart to be enabled
Polish contribution
See gh-23755,Note that using LiveReload requires Devtools restart to be enabled
See gh-23755,Add configuration properties for SAML2 relying party registration's ASM
This commit allows to configure the location and binding of the
Assertion Consumer Service used by a SAML2 relying party.
Merge pull request #23762 from izeye
* pr/23762:
  Polish assertions
  Polish
Polish assertions
See gh-23762,Polish
See gh-23762,Fix content filters when excludeProjectDependencies() is used
Fixes gh-23763,Merge pull request #23753 from omlip
* pr/23753:
  Expose BootBuildImage's cleanCache property as a command-line option
Expose BootBuildImage's cleanCache property as a command-line option
See gh-23753,Merge branch '2.3.x'
Prevent access to the EMF within the singleton lock
This commit makes sure to defer registration of hibernate statistics
outside of the singleton lock as it can lead to deadlocks when the
EntityManagerFactory is initialized in deferred mode.
Hacking
See gh-23740,Add support for CNB platform API 0.4
This commit adds support for platform API 0.4 when invoking a CNB
builder in the Maven and Gradle plugins. If the builder advertises
that it supports platform API 0.4 then that version will be
requested when invoking lifecycle phases. Otherwise the plugins
will fall back to requesting platform API 0.3.
Requesting platform API 0.4 when invoking builder lifecycle phases
has the primary benefit of making it easier to pass command-line
arguments to the default process in the generated image.
Fixes gh-23692,Polish Maven plugin javadoc
This commit polishes the javadoc for Maven plugin classes now that
the plugin reference docs link to the javadoc. Visibility of some
MOJO parameter class getters and setters were also changed for
consistency.
See gh-21555,Merge branch '2.3.x'
Upgrade to Gradle 6.7
Remove erroneous management.server.address config from Actuator smoke test
See gh-22187,Fail if management.server.address is set but actuator is on the same port
Stop using PostConstruct to default session timeout to ServerProperties'
Fixes gh-23716,Align relying party entity ID property with Spring Security
This reverts commit c4a5a347028b827ea53975d1ec80f52a14223c5c.
See gh-23721,Upgrade to MSSQL JDBC 8.4.1.jre8
Register shutdown hook so it can tidy up a partial refresh
Previously, the shutdown hook was only registered once refresh has
completed. If the JVM was shut down during refresh (or after refresh
and before the hook was registered) the hook wouldn't run and the
partially refreshed context would not be cleaned up.
This commit moves the registration of the shutdown hook to before
refresh processing begins. This ensures that the hook is available
to clean up the context if the JVM is shutdown while refresh is in
progress.
Fixes gh-23625,Merge pull request #23737 from dreis2211
* pr/23737:
  Fix links to Spring Framework documentation
Fix links to Spring Framework documentation
See gh-23737,Merge branch '2.3.x'
Deprecate BootJar#getConfigurations
Fixes gh-23527,Merge pull request #23720 from izeye
* pr/23720:
  Polish
Polish
See gh-23720,Merge branch '2.3.x',Fix detection logic for embedded databases
Polish
See gh-23693,Merge branch '2.3.x'
Add javadoc links in Maven plugin parameter docs
This commit modifies the documentation generated for the
Maven plugin to include links to javadoc when Spring
Boot types are mentioned. Some javadoc was also polished
to improve the generated docs.
Fixes gh-21555,Revert "Rename CompositeMeterRegistryAutoConfiguration"
This reverts commit 9460d74e8ad8c247c3ad9a627ab35aa08df21152.
Fixes gh-23724,Remove unwanted titles from config blocks
Add reference to JobRunr Spring Boot starter
Merge pull request #23693 from somayaj
* pr/23693:
  Polish "Fix detection logic for embedded databases"
  Fix detection logic for embedded databases
Polish "Fix detection logic for embedded databases"
See gh-23693,Fix detection logic for embedded databases
See gh-23693,Make block switches work on every page of multi-page docs
There's a bug in some versions of AsciidoctorJ where extensions are
only called on this first conversion performed by a given Asciidoctor
instance. This affects the multi-page documentation where there are
multiple conversions performed – one for each page in the
documentation.
This commit upgrades the version of AsciidoctorJ used by the
Asciidoctor Gradle plugin to 2.4.1, which contains fix for the problem.
\gh-23709
Document how to override plugin configuration on the command line
Polish,Polish,Upgrade to github-changelog-generator 0.0.5
Merge pull request #23633 from Miehau
* pr/23633:
  Polish 'Add a FailureAnalyzer for ConfigDataNotFound'
  Add a FailureAnalyzer for ConfigDataNotFound
Polish 'Add a FailureAnalyzer for ConfigDataNotFound'
See gh-23633,Add a FailureAnalyzer for ConfigDataNotFound
Add a `FailureAnalyzer` to deal with `ConfigDataNotFoundException`.
See gh-23633,Improve ConfigData processing code
Refactor `ConfigData` processing code to make it less awkward to
follow.
Prior to this commit the `ConfigDataLocationResolver` would take a
String location and return a `ConfigDataLocation` instance. This was
a little confusing since sometimes we would refer to `location` as the
String value, and sometimes it would be the typed instance. We also
had nowhere sensible to put the `optional:` prefix logic and we needed
to pass a `boolean` parameter to a number of methods. The recently
introduced `Orgin` support also didn't have a good home.
To solve this, `ConfigDataLocation` has been renamed to
`ConfigDataResource`. This frees up `ConfigDataLocation` to be used
as a richer `location` type that holds the String value, the `Orgin`
and provides a home for the `optional:` logic.
This commit also cleans up a few other areas of the code, including
renaming `ResourceConfigData...` to `StandardConfigData...`. It also
introduces a new exception hierarchy for `ConfigDataNotFoundExceptions`.
Allow FailureAnalizers without ApplicationContext
Update `SpringApplication` so that `FailureAnalyzers` apply even if
the `ApplicationContext` was not created. If no `ApplicationContext`
is available, only `FailureAnalyzer` instances that do not implement
any `Aware` interfaces are considered.
Put project deps in app layer and make customization easier
Previously, when building a layered jar with Gradle, project
dependencies were treated the same as any other dependency, being
included in the dependencies or snapshot dependencies layer based
on their version.
This commit updates the default layering when using Gradle to include
project dependencies in the application layer by default. The DSL has
also been updated to allow their layer to be customized using new
includeProjectDependencies() and excludeProjectDependencies() methods
rather than relying on including and excluding them via a
group:artifact:version pattern.
Fix image folder name in update detection script
Fixes gh-23699,Upgrade to Liquibase 3.10.3
This commit upgrades to Liquibase 3.10.3 and adds an explicit exclude
check as this version started to include a "banner.txt" at the root of
the classpath. Given it may override a banner configured by the user it
is ignored so that the default banner is displayed.
Users impacted by this change can rename their banner and configure the
"spring.banner.location" property to point to it.
Add configuration for changelog generator
This commits adds a dedicated configuration to be used when invoking
the github changelog generator. This custom configuration makes sure
to sort dependency upgrades based on the issue title.
Merge pull request #23694 from izeye
* pr/23694:
  Upgrade to spring-asciidoctor-extensions 0.5.0
Upgrade to spring-asciidoctor-extensions 0.5.0
See gh-23694,Upgrade to Spring AMQP 2.3.0-RC1
Upgrade to Spring Kafka 2.6.2
Upgrade to Spring Integration 5.4.0-RC1
Use config map name for configtree property sources
When Kubernetes mounts config maps onto volumes in a pod, it creates
hidden files on the pod filesystem with symbolic links to the
hidden files. The symlinks are named for the user-provided config
map that was mounted, while the hidden files have system-generated
names.
Prior to this commit, the property sources created by the
configtree property source were added to the environment using the
system-generated hidden file name instead of the user-provided
symlink name. This commit corrects that behavior so the property
sources are named as a user would expect.
Fixes gh-23232,Rename eagerInitFilters to align with Undertow's naming
Set platform API version when invoking image builder
The CNB specifications allow builders to support multiple platform
API versions. The supported versions are published in the builder
image metadata as an array of version numbers, while a single
supported version number was published in earlier builder metadata.
These changes read the supported versions from the builder metadata
and fall back to the single version if the array is not present.
A CNB_PLATFORM_API environment variable is set on each lifecycle
phase invocation to request a specific version as recommended in
the CNB platform spec.
Fixes gh-23682,Upgrade to Spring Data 2020.0.0-RC2
Remove NIO Multipart Parser  in favour of WebFlux's own parser
Merge pull request #23636 from adrien-ben
* pr/23636:
  Polish "Add configuration options for Kafka Stream's CleanupConfig"
  Add configuration options for Kafka Stream's CleanupConfig
Polish "Add configuration options for Kafka Stream's CleanupConfig"
See gh-23636,Add configuration options for Kafka Stream's CleanupConfig
See gh-23636,Document how to use DataNeo4jTest with reactive access
Note that a Neo4j reactive transaction manager is not auto-configured
Merge pull request #23634 from izeye
* pr/23634:
  Polish
Polish
See gh-23634
Configure Undertow not to presever path on forward by default
Start building against Spring AMQP 2.3.0-RC1 snapshots
See gh-23680,Start building against Spring Kafka 2.6.2 snapshots
See gh-23679,Upgrade to Spring Framework 5.3.0-RC2
Upgrade to Kotlin Coroutines 1.4.0-M1
Apply server.undertow.eager-filter-init to factory
Fixes gh-23675,Upgrade to OAuth2 OIDC SDK 8.22
Fix mapping of outputQueryResults property
Simplify temp directory creation and improve diagnostics
Upgrade to Flyway 7.0.2
Upgrade to Undertow 2.2.2.Final
Upgrade to Tomcat 9.0.39
Upgrade to Spring Security 5.4.1
Upgrade to SendGrid 4.6.6
Upgrade to Selenium HtmlUnit 2.44.0
Upgrade to RxJava2 2.2.20
Upgrade to QueryDSL 4.4.0
Upgrade to Postgresql 42.2.17
Upgrade to Mockito 3.5.13
Upgrade to MariaDB 2.7.0
Upgrade to Lombok 1.18.14
Upgrade to Lettuce 6.0.0.RELEASE
Upgrade to Kotlin 1.4.10
Upgrade to JUnit 4.13.1
Upgrade to jOOQ 3.13.5
Upgrade to Jetty 9.4.32.v20200930
Upgrade to Jersey 2.32
Upgrade to Jackson Bom 2.11.3
Upgrade to Infinispan 11.0.4.Final
Upgrade to HttpClient 4.5.13
Upgrade to HtmlUnit 2.44.0
Upgrade to Hibernate Validator 6.1.6.Final
Upgrade to Hibernate 5.4.22.Final
Upgrade to Elasticsearch 7.9.2
Upgrade to Dropwizard Metrics 4.1.13
Upgrade to Couchbase Client 3.0.9
Upgrade to Commons DBCP2 2.8.0
Upgrade to Caffeine 2.8.6
Upgrade to Byte Buddy 1.10.17
Upgrade to RSocket 1.1.0-RC1
Merge pull request #23628 from ekcasey
* gh-23628:
  Polish "Update default builder image"
  Update default builder image
Polish "Update default builder image"
See gh-23628,Update default builder image
This commit updates the default builder image used by the Maven
and Gradle plugins image-building goal and task to use the latest
Paketo builder image. The builder image is pulled from Docker Hub
instead of Google Container Registry by default.
See gh-23628,Upgrade to Reactor 2020.0.0-RC2
Merge pull request #23632 from dreis2211
* pr/23632:
  Fix XML tag in image publishing example
Fix XML tag in image publishing example
See gh-23632,Polish,Replace use of deprecated Reactor MonoProcessor in tests
Fixes gh-23627,Merge branch '2.3.x'
Document buildpack configuration of JVM options
Fixes gh-21582,Fix formatting,Expose cache metrics for Redis
This commit adds support for Redis cache metrics. Users can opt-in for
statistics using the "spring.cache.redis.enable-statistics" property.
Clarify image builder configuration documentation
This commit qualifies examples of configuring the CNB builder to clarify
that the examples apply to use of the default Paketo builder, and adds links
to the official Paketo docs for more details.
Fixes gh-19967,Replace deprecated API in ElasticsearchReactiveHealthIndicator
Fixes gh-23537,Start building against Reactor 2020.0.0-RC2 snapshots
See gh-23621,Merge pull request #23672 from mdeinum
* pr/23572:
  Polish "Prefer JdbcTransactionManager over DataSourceTransactionManager"
  Prefer JdbcTransactionManager over DataSourceTransactionManager
Polish "Prefer JdbcTransactionManager over DataSourceTransactionManager"
See gh-23672,Prefer JdbcTransactionManager over DataSourceTransactionManager
Spring 5.3 introduced the JdbcTransactionManager with exception
translation on commit and rollback. This commit updates the
auto-configuration to use this implementation rather than
DataSourceTransactionManager.
See gh-23672
Use Property<String>s for main class configuration in the Gradle plugin
Disable docker registry integration tests
A docker registry running in testcontainers behaves
differently in CI vs running locally. Disabling the tests for
now while working on getting them running reliably in CI.
See gh-21001,Add support for publishing docker images to a registry
This commit adds options to the Maven and Gradle plugins to publish
to a Docker registry the image generated by the image-building goal
and task.
The Docker registry auth configuration added in an earlier commit
was modified to accept separate auth configs for the builder/run
image and the generated image, since it is likely these images will
be stored in separate registries or repositories with distinct
auth required for each.
Fixes gh-21001,Merge branch '2.3.x' into master
Support Formatter conversion service beans
Update `ConversionServiceDeducer` to also include `Formatter` beans
when they are qualified with `@ConfigurationPropertiesBinding`.
Fixes gh-23576,Merge branch '2.3.x' into master
Add upgrading section to reference docs
Add a section to the reference documentation with links to the release
notes on the wiki.
Polish
See gh-23480,Make sure that the type used for discovery implements DataSource
See gh-23480,Start building against Spring Data 2020.0.0 RC2 snapshots
See gh-23594,Revert "Support constructor binding on 3rd party classes"
This commit reverts the support of constructor binding on 3rd party
classes using @ImportConfigurationPropertiesBean
See gh-23172
Provide both properties and YAML examples in docs
Update all configuration examples in the docs to YAML and make use of
the new `configblocks` spring-asciidoctor-extensions feature to
automatically create both "Properties" and "Yaml" versions.
Refine configuration property table column sizes
Increase the size of the first column to improve readability.
Use title case for config props appendix
Upgrade to spring-asciidoctor-extensions 0.5.0
Polish,Merge pull request #23602 from snicoll
* pr/23602:
  Fix typo
Fix typo
See gh-23602,Trigger configuration properties annotation processsor on `@Endpoint`
We generate metadata for `@Endpoint` annotated types so the annotation
processor need to indicate that it supports the endpoint annotation.
See gh-23580,Merge branch '2.3.x',Update tests to look for snippets in correct location
See gh-23598,Limit supported annotations to `@ConfigurationProperties` and `@Configuration`
Previously, the configuration property annotation processor declared
that it supported all annotation types. This hurt performance and
prevented incremental builds with Gradle when compiling source code
containing source-retention annotations.
This commit updates its supported annotation types to be only
`@ConfigurationProperties` and `@Configuration`. The latter is declared
to allow binding third-party classes returned from a `@Bean` method.
Fixes gh-23580,Merge branch '2.3.x'
See gh-23599,More Gradle snippets to correct location
See gh-23598,Merge branch '2.3.x'
Expand Gradle plugin's docs on setting bootRun's system properties
Remove code deprecated in Spring Boot 2.2
Polish,Add configuration properties for Flyway 7's new config options
Upgrade to Flyway 7.0.0
Avoid unnecessary reflection in builders
Allow to customize RSocketServer's fragment size
Merge pull request #23550 from sann3
* pr/23550:
  Polish "Polish empty string checks"
  Polish empty string checks
Polish "Polish empty string checks"
See gh-23550,Polish empty string checks
See gh-23550,Replace reflection call in HttpMessageConverters
Merge pull request #23575 from dreis2211
* pr/23575:
  Avoid unnecessary explicit initialization of Atomics
Avoid unnecessary explicit initialization of Atomics
Constructor calls like new AtomicInteger(0) cause a volatile write that
can be saved in cases where the constructor parameter is the default
value.
See gh-23575,Merge pull request #23041 from tomekl007
* pr/23041:
  Polish "Improve Cassandra health indicator with more robust mechanism"
  Improve Cassandra health indicator with more robust mechanism
Polish "Improve Cassandra health indicator with more robust mechanism"
See gh-23041,Improve Cassandra health indicator with more robust mechanism
See gh-23041,Merge pull request #23554 from dreis2211
* pr/23554:
  Improve performance of DispatcherServletRegistrationCondition
Improve performance of DispatcherServletRegistrationCondition
See gh-23554,Merge pull request #23564 from jkhoward
* pr/23564:
  Polish "Add configuration option for channelRpcTimeout"
  Add configuration option for channelRpcTimeout
Polish "Add configuration option for channelRpcTimeout"
See gh-23564,Add configuration option for channelRpcTimeout
This commit adds a configuration option to configure
RabbitConnectionFactory's channelRpcTimeout property.
See gh-23564,Merge pull request #23571 from mnhock
* pr/23571:
  Update copyright of changed file
  Use platform-independent line separator
Update copyright of changed file
See gh-23571,Use platform-independent line separator
See gh-23571,Merge branch '2.3.x'
Merge pull request #23561 from thorasine
* pr/23561:
  Fix typos
Fix typos
See gh-23561,Merge branch '2.3.x'
Merge pull request #23566 from Shraddha-Yeole
* pr/23566:
  Polish "Do not fail if h2Console bean cannot connect to db"
  Do not fail if h2Console bean cannot connect to db
Polish "Do not fail if h2Console bean cannot connect to db"
See gh-23566,Do not fail if h2Console bean cannot connect to db
See gh-23566,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Polish,Merge branch '2.3.x'
Merge pull request #23562 from ketaki-t
* pr/23562:
  Remove documentation for unsupported gradle versions
Remove documentation for unsupported gradle versions
See gh-23562,Merge pull request #23565 from desainidhi99
* pr/23565:
  Polish "Deprecate EmbeddedDatabaseConnection#HSQL"
  Deprecate EmbeddedDatabaseConnection#HSQL in favor of HSQLDB
Polish "Deprecate EmbeddedDatabaseConnection#HSQL"
See gh-23565,Deprecate EmbeddedDatabaseConnection#HSQL in favor of HSQLDB
See gh-23565,Merge branch '2.3.x'
Only change the method of requests that Jetty won't handle by default
Previously, JettyEmbeddedErrorHandler would change the method of every
request that is handles to GET. This was being done to work around
Jetty's error handling only dealing with GET, POST, and HEAD requests
by default. It had the unwanted side-effect of causing an error
response to a HEAD request having a body as, from the error handling's
perspective, it was a GET request.
This commit updates JettyEmbeddedErrorHandler to only set the method
on a request for which error handling is being performed if the method
isn't already one that will be handled, leaving the method of GET,
POST, and HEAD requests unchanged.
Unfortunately, short of implementing an HTTP client, this change cannot
be tested as the Apache HttpClient, OkHttp, and the JDK's
HttpURLConnection all silently drop the body of a response to a HEAD
request, preventing a test from asserting that a body hasn't been sent.
Upgrade Ubuntu version in CI images
Implement BeanFactoryAware to inject BeanFactory
Remove unnecessary stubbing,Adapt to API change in Spring Framework 5.3.0 snapshots
See gh-23534,Merge branch '2.3.x'
Introduce a dedicated @GradleCompatibility annotation
Rather than using the extension directly, introduced a dedicated
annotation will enable customization of the compatibility tests that
are run via attributes on the annotation. For example, it will allow
certain test classes to run their tests with Gradle's configuration
cache enabled while others disable it.
Fix matching of SNAPSHOT artifacts when customizing layers
Previously the artifact's version was used. In an artifact's version,
SNAPSHOT is replaced with the timestamped version number of a specific
snapshot. As a result, it no longer matches the *:*:*SNAPSHOT pattern.
This commit replaces switches to using the artifact's base version.
This preserves the SNAPSHOT in the version number. For non-snapshot
artifacts, the version and base version are identical.
Fixes gh-23533,Adapt to API change in Spring Framework 5.3.0 snapshots
See gh-23534,Merge branch '2.3.x'
Start building against Spring Framework 5.3.0 snapshots
See gh-23534,Do not execute datasource initialization in a separate thread
This commit makes sure that `data.sql` is performed in the same thread
as the one initializing the JPA container.
Start building against Spring Framework 5.3.10 snapshots
See gh-23526,Reduce configuration resolution when building a layered jar
Previously, BootJar would resolves all of a project's configurations
when building a layered jar. This was unnecessarily broad as it was
likely to include configurations that had contributed nothing to the
jar's classpath.
This commit replaces the configuration resolution with an afterResolve
action that populates the ResolvedDependencies in response to a
configuration being resolved. This allows the resolved dependencies to
be populated from all of the configurations that were resolved as part
of determining the jars classpath and no more.
Merge pull request #23403 from fabio-grassi-gbs
* pr/23403:
  Polish "Add support for Oracle UCP"
  Add support for Oracle UCP
Polish "Add support for Oracle UCP"
See gh-23403,Add support for Oracle UCP
See gh-23403,Stop registering the default servlet by default
Previously, the default servlet was registered automatically when using
embedded Jetty, Tomcat, or Undertow. However, it is not used by the
majority of applications where Spring MVC's DispatcherServlet will be
the only servlet that's needed. As such configuring the default servlet
was wasting CPU and memory.
This commit changes the default for registering the default servlet to
false. It can be re-enabled by setting
server.servlet.register-default-servlet=true.
Remove useless version override for MongoDBContainer
\gh-23522
Migrate SessionAutoConfigurationMongoTests to Testcontainers
Associate ResourceLoader with RabbitConnectionFactoryBean
Add support for Redis 6 authentication with username
Polish,Merge branch '2.3.x'
See gh-23496,Merge branch '2.2.x' into 2.3.x
See gh-23495,Merge branch '2.1.x' into 2.2.x
See gh-23494,Rename changelog generator's task name
Merge pull request #23435 from celcius112
* gh-23435:
  Configure the bootBuildInfo task lazily
Configure the bootBuildInfo task lazily
Prior to this commit, the bootBuildInfo was configured eagerly.
Configuring it lazily prevent this task from being configured when not
explicitly needed. Also, the 'classes' and 'bootJar' tasks are now
lazily configured, as the bootBuildInfo task was causing them to be
configured eagerly.
See gh-23435,Remove use of deprecated SDR API when describing request mappings
Apply DataSource aliases only when necessary
This commit makes sure that aliases are only applied when they match
the DataSource being bound. This prevent an alias targetted to a
DataSource to accidently match an unexpected property of another
DataSource.
Merge pull request #23502 from chenrujun
* pr/23502:
  Add mising entry for Netty tcnative dependency management
Add mising entry for Netty tcnative dependency management
See gh-23502,Merge pull request #23507 from Allurx
* pr/23507:
  Polish "Add reference to desensitization spring boot starter"
  Add reference to desensitization spring boot starter
Polish "Add reference to desensitization spring boot starter"
See gh-23507,Add reference to desensitization spring boot starter
See gh-23507,Merge branch '2.3.x'
Remove use of spring-core's Assert from PropertiesLauncher
Fixes gh-23474,Merge branch '2.3.x' into master,Merge branch '2.2.x' into 2.3.x,Merge branch '2.1.x' into 2.2.x,Upgrade to latest concourse-java-scripts,Merge branch '2.3.x' into master
Upgrade docker images to Ubuntu Focal
Upgrade to github-changelog-generator 0.0.3
Align default tldScanPatterns with Tomcat's
Previously, we configured embedded Tomcat in such a way that no TLD
scan patterns were configured. This differed from a standalone
Tomcat installation where 4 patterns are configured that take
precedence over some of the skip patterns. The missing scan patterns
resulted in the skip patterns preventing the discovery of Log4j2's
TLDs.
This commit updates TomcatServletWebServerFactory to configure the
same four scan patterns as standalone Tomcat configures by default.
Fixes gh-23302,Remove UnresolvedDependenciesAnalyzer from the Gradle plugin
Upgrade to Hazelcast Hibernate5 2.1.1
Add support for Hazelcast
This commit upgrades to Hazelcast 4.0.3, yet keeping compatibility with
Hazelcast 3.x.
\gh-20856
Consider SpringBootTest's web environment in context cache key
Previously, the web environment configured on `@SpringBootTest` was not
part of the context cache key. As a result, two test classes that has
identical configuration other than one using a MOCK web environment and
the other using a DEFINED_PORT web environment would share a context
when they should not do so. Classes that use MOCK and RANDOM_PORT were
not affected as the use of RANDOM_PORT results in a property for the
port being added to the environment.
This commit adds a new ContextCustomizer, SpringBootTestWebEnvironment,
that is used to capture the `webEnvironment` from `@SpringBootTest`
and use it in its hashCode and equals implementations. This fixes the
problem as all context customizers are evaluated when determing the
equality of two context cache keys.
Fixes gh-23085,Update Bomr to treat CalVer versions as newer than release train versions
Merge pull request #23465 from thorasine
* pr/23465:
  Fix typos
Fix typos
See gh-23465,Merge branch '2.3.x'
Upgrade CI to Docker 19.03.13
Update CI images to use ubuntu:bionic-20200903
Merge pull request #23459 from pavelgordon
* pr/23459:
  Fix link to Log4j's JDK Logging Adapter in reference documentation
Fix link to Log4j's JDK Logging Adapter in reference documentation
See gh-23459,Merge pull request #23456 from thorasine
* pr/23456:
  Fix typo
Fix typo
See gh-23456,Rewrite JobLauncherApplicationRunnerTests
This commit rewrites the test to use an in-memory database rather than
the deprecated Map-based arrangement.
See gh-22983,Merge branch '2.3.x'
Rework tip on templates location in the IDE
This commit rework the tip on locating templates when running the app
in the IDE. Using classpath* should not change anything as this won't
make a difference without a pattern in the path.
Add bomr exclusion for Apache Solr 8.6+
Make the auto-configured LocaleContextResolver conditional on missing bean
Document that Java 15 is supported
Allow RestTemplateBuilder to be further customized
Merge pull request #23445 from dreis2211
* pr/23445:
  Fix multi-release JAR test on JDK 15
Fix multi-release JAR test on JDK 15
Backport of 54f93e9
See gh-23445,Polish,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x
Make HandlerFunctionDescription JDK 15 compatible
Update `HandlerFunctionDescription` so that it will work with JDK 15.
Backport JDK 15 detection support
See gh-23433,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Refine StringSequence checkstyle suppression
See gh-23440,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x
Make `StringSequence.isEmpty()` public
Make `StringSequence.isEmpty()` public for compatibility with JDK 15.
See gh-23433,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Upgrade Java version used in CI from 14 to 15
Merge pull request #21704 from unix1982
* pr/21704:
  Polish 'Add origin support for empty YAML list and map'
  Add origin support for empty YAML list and map
Polish 'Add origin support for empty YAML list and map'
See gh-21704,Add origin support for empty YAML list and map
Update `OriginTrackedYamlLoader` to better deal with empty maps
and collections.
See gh-21704,Allow binding when 'is' method also exists
Improve the `JavaBeanBinder` so that an bean that has both a `get` and
`is` method can still be bound.
Add missing registration convenience methods
Update `BootstrapContext` with convenience methods that help if the
type has not been registered.
Make ConfigData Resolvers/Loaders public
Change the visibility of our own ConfigDataLocationResolver and
ConfigDataLoader classes so that they can be created outside of
`spring.factories`.
See gh-22983,Merge branch '2.3.x'
Consume level and dateformat patterns as system props in Log4j config
Previously LOG_LEVEL_PATTERN and LOG_DATEFORMAT_PATTERN were not
consumed as system properties in log4j2.xml and log4j2-file.xml. As a
result, the logging.pattern.level and logging.pattern.dateformat
configuration properties, which are translated into the
LOG_LEVEL_PATTERN and LOG_DATEFORMAT_PATTERN system properties
respectively had no effect.
This commit updates the log4j2.xml and log4j2-file.xml config files to
consume LOG_LEVEL_PATTERN and LOG_DATEFORMAT_PATTERN as system
properties. When the system property is not set, the configuation falls
back to the default values specified in the config files. Tests for
both log4j2.xml and log4j2-file.xml to verify the behaviour have also
bean added.
Fixes gh-22983,Stop applying MeterFilters to auto-configured composite registry
Previously, all MeterFilter beans were applied to all MeterRegistry
beans. As a result, when a composite registry was auto-configured, both
the composite and all of its delegates would have the same MeterFilters
applied. This made it impossible for one of the delegate registries to
have a locally-configured filter that would allow a meter that would be
denied by one of the MeterFilter beans applied to the composite.
This commit update MeterRegistryConfigurer to skips the auto-configured
composite meter registry when applying MeterFilter beans to
MeterRegistry beans. As a result, the composite's filters will no
longer deny a meter before it reaches a delegate that would have
accepted it due to one of its locally-configured filters.
Test the Gradle plugin against 6.7-rc-1
Merge pull request #23418 from fernandezseb
* gh-23418:
  Polish "Add note about Kotlin main class name"
  Add note about Kotlin main class name
Polish "Add note about Kotlin main class name"
See gh-23418,Add note about Kotlin main class name
See gh-23418,Polish javadoc of LoggingSystemFactory
See gh-23387,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Merge branch '2.1.x' into 2.2.x
Upgrade to Gradle Enterprise Maven Extension 1.6.6
Fix LoggingSystem package tangle
Introduce a new `LoggingSystemFactory` interface so that the
`LoggingSystem` class can find implementations without needing to
be directly tied to them.
Configure Docker host in build plugins
This commit adds the ability to configure the Maven and Gradle
plugins to use a remote Docker daemon using build file
configuration, as an alternative to setting environment variables
to specify remote host connection details.
Fixes gh-23400,Merge branch '2.3.x'
Configure Flyway with initSqls for any DataSource configuration
Previously, spring.flyway.init-sqls was only applied to Flyway's
configuration if Flyway was being configured to create the DataSource.
If Flyway was being configured to use an existing DataSource, init-sqls
was not applied. This is a hangover from when the init SQLs support was
introduced. At that time, Flyway only supported SQL to initialize the
connection when it was creating the DataSource. Flyway 5.2 added init
SQL support no matter how Flyway's DataSource was configured.
This commit updates FlywayAutoConfiguration to always apply the
init-sqls property to Flyway's configuration. The property's
documentation does not describe the current limitation so this change
should align the behaviour with what the documentation leads people to
expect.
Fixes gh-23392,Merge branch '2.3.x'
Add anchors to section headers in Gradle plugin docs
Fixes gh-23402,Add Binder to BootstrapContext
Update `ConfigDataEnvironment` so that it adds the initial `Binder`
to the `BootstrapContext` for `Bootstrappers` to use.
Allow trailing whitespace document split marker
Refine `OriginTrackedPropertiesLoader` document split detection to be
more lenient if there is trailing whitespace.
Merge pull request #23391 from dreis2211
* gh-23391:
  Upgrade Java 15 CI image to use the Java 15 GA build
Upgrade Java 15 CI image to use the Java 15 GA build
See gh-23391,Merge branch '2.3.x',Next development version (v2.3.5.BUILD-SNAPSHOT),Upgrade to SendGrid 4.6.5
Upgrade to Micrometer 1.5.5
Upgrade to Flyway 6.5.6
Upgrade to Micrometer 1.5.5
See gh-23326,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Merge branch '2.1.x' into 2.2.x,Polish logging in BintrayService,Attempt to fix ConcurrentModificationException
Attempt to fix `ConcurrentModificationException` which occurs on
Java 11+.
See gh-23326,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Merge branch '2.1.x' into 2.2.x,Next development version (v2.1.18.BUILD-SNAPSHOT),Update copyright year of changed files,Refactor BootstrapRegistry support
Refactor `BootstrapRegistry` support following initial prototype work
with the Spring Cloud team.
This update splits the `BootstrapRegistry` API into `BootstrapRegistry`,
`BootstrapContext` and  `ConfigurableBootstrapContext` interfaces and
moves it to the same package as `SpringApplication`.
A new `Bootstrapper` interface has been introduced that can be added
to the `SpringApplication` to customize the `BootstrapRegistry` before
it's used.
Polish,Fix FailureAnalyzer package tangle
Move `IncompatibleConfigurationFailureAnalyzer` to fix a package tangle.
Fix DefaultPropertiesPropertySource package tangle
Relocate `DefaultPropertiesPropertySource` to fix a package tangle.
Upgrade Java 15 version in CI image
Upgrade to Spring Session 2020.0.0-RC1
Upgrade to Spring Session Corn-SR4
Upgrade to Spring Session Bean-SR12
Upgrade to Spring Batch 4.3.0-RC1
Upgrade to Spring Integration 5.4.0-M3
Upgrade to Spring Kafka 2.6.1
Merge pull request #22972 from wmz7year
* gh-22972:
  Polish "Support authentication to private Docker registry"
  Support authentication to private docker registry
Polish "Support authentication to private Docker registry"
See gh-22972,Support authentication to private docker registry
This commit adds the ability to configure Docker image registry
authentication credentials in the Maven and Gradle plugins. The
authentication credentials are passed to the Docker daemon with
all daemon API calls, and the daemon forwards the credentials to the
image registry when necessary. This makes it possible to use
builder and run images stored in a private Docker registry.
See gh-22972,Merge branch '2.3.x'
Remove spring-boot.version property from spring-boot-dependencies
The version of Spring Boot should not be modifiable by a property,
only being using a different version of spring-boot-dependencies or
spring-boot-starter-parent.
Fixes gh-23174,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Merge branch '2.1.x' into 2.2.x,Upgrade to Spring REST Docs 2.0.5.RELEASE
\gh-23377
Upgrade to Spring REST Docs 2.0.5.RELEASE
Upgrade to Spring AMQP 2.3.0-M3
Upgrade to Spring Data 2020.0.0-RC1
Merge pull request #22366 from dreis2211
* pr/22366:
  Document that Java 15 is a supported version
Document that Java 15 is a supported version
See gh-22366,Adapt tests to deprecations in Spring Batch,Upgrade to Mockito 3.5.10
Upgrade to Undertow 2.2.0.Final
Upgrade to Thymeleaf Layout Dialect 2.5.1
Upgrade to SnakeYAML 1.27
Upgrade to Postgresql 42.2.16
Upgrade to Pooled JMS 1.2.0
Upgrade to InfluxDB Java 2.20
Upgrade to Artemis 2.15.0
Upgrade to Lettuce 6.0.0.RC2
Upgrade to Tomcat 9.0.38
Upgrade to Spring WS 3.0.10.RELEASE
Upgrade to SendGrid 4.6.4
Upgrade to R2DBC Bom Arabba-SR7
Upgrade to Nimbus JOSE JWT 9.0.1
Upgrade to OAuth2 OIDC SDK 8.19.2
Upgrade to Netty tcNative 2.0.34.Final
Upgrade to Netty 4.1.52.Final
Upgrade to JUnit Jupiter 5.7.0
Upgrade to Hibernate 5.4.21.Final
Upgrade to Hazelcast 3.12.9
Upgrade to Flyway 6.5.5
Upgrade to Elasticsearch 7.9.1
Upgrade to Ehcache3 3.9.0
Upgrade to Couchbase Client 3.0.8
Upgrade to Commons Codec 1.15
Upgrade to Cassandra Driver 4.9.0
Upgrade to AppEngine SDK 1.9.82
Exclude Kotlin Coroutines 1.3.9+ as it is built against Kotlin 1.4
Upgrade to Spring HATEOAS 1.1.2.RELEASE
Upgrade to Lettuce 5.3.4.RELEASE
Upgrade to Neo4j Ogm 3.2.16
Upgrade to Tomcat 9.0.38
Upgrade to Neo4j Ogm 3.1.22
Upgrade to Tomcat 9.0.38
Use ephemeral ports for RSocket tests
Rename @ConfigurationPropertiesImport
Rename `@ConfigurationPropertiesImport` to
`@ImportAsConfigurationPropertiesBean` and also refine the registrar
so that it can be used with type directly annotated with
`@ConfigurationProperties`.
Upgrade to Spring Framework 5.3 RC1
Ensure that the source jar entry is closed before reading
certificates and code signers from the entry.
gh-19041,Merge branch '2.3.x'
Disable proxyBeanMethods on Spring Session config sub-classes
Upgrade to Tomcat 9.0.38
Upgrade to R2DBC Bom Arabba-SR7
Upgrade to Postgresql 42.2.16
Upgrade to Netty tcNative 2.0.34.Final
Upgrade to Netty 4.1.52.Final
Upgrade to Neo4j OGM 3.2.16
Upgrade to Hibernate 5.4.21.Final
Upgrade to Hazelcast 3.12.9
Upgrade to Flatten Maven Plugin 1.2.5
Upgrade to Couchbase Client 3.0.8
Upgrade to AppEngine SDK 1.9.82
Disable proxyBeanMethods on all management context config classes
Fixes gh-23301,Upgrade to RSocket 1.1.0-M2
Upgrade to Reactor 2020.0.0-RC1
\gh-23192
Rename @ImportConfigurationPropertiesBean
Rename `@ImportConfigurationPropertiesBean` to
`@ConfigurationPropertiesImport`.
Update `JarFileEntries` so that the interface is obtained rather than
the concrete implementation. This allows `JarEntry` values to be used
without causing a ClassCastException.
Adapt to WebClient's new exception wrapping
See spring-projects/spring-framework#23842
See gh-23170,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Upgrade to Spring Security 5.2.6.RELEASE
Upgrade to Spring Amqp 2.2.10.RELEASE
Upgrade to Postgresql 42.2.16
Upgrade to Neo4j Ogm 3.2.15
Upgrade to Infinispan 9.4.20.Final
Upgrade to Hibernate 5.4.21.Final
Upgrade to Elasticsearch 6.8.12
Upgrade to Jetty 9.4.31.v20200723
Upgrade to Byte Buddy 1.10.14
Upgrade to Undertow 2.0.31.Final
Upgrade to Rsocket 1.0.2
Upgrade to Netty Tcnative 2.0.34.Final
Upgrade to Netty 4.1.52.Final
Upgrade to Micrometer 1.3.12
Upgrade to Dropwizard Metrics 4.1.12.1
Upgrade to Hazelcast 3.12.9
Upgrade to Appengine Sdk 1.9.82
Upgrade to Spring Security 5.1.12.RELEASE
Upgrade to Postgresql 42.2.16
Upgrade to Neo4j Ogm 3.1.21
Upgrade to Infinispan 9.4.20.Final
Upgrade to Hibernate 5.3.18.Final
Upgrade to Jetty 9.4.31.v20200723
Upgrade to Undertow 2.0.31.Final
Upgrade to Dependency Management Plugin 1.0.10.RELEASE
Upgrade to Netty Tcnative 2.0.34.Final
Upgrade to Micrometer 1.1.17
Upgrade to Appengine Sdk 1.9.82
Upgrade to Jackson 2.9.10.20200824
Merge pull request #19041 from mathieufortin01
* pr/19041:
  Polish 'Fix signed jar performance issues'
  Fix signed jar performance issues
  Ignore Visual Studio Code Files
Polish 'Fix signed jar performance issues'
Update the performance improvements to push certificate loading
and storage into the `JarFileEntries` class. This allows us to
keep certificates without needing to cache all entry data. We
now also keep certificates and code signers in a dedicated class
which is set whenever the full jar stream as been read, even if
the contained values are `null`. The logic that assumes META-INF
entries are not signed has been removed in favor of delegating to
the streamed entry results.
See gh-19041,Fix signed jar performance issues
Update Spring Boot nested JarFile support to improve the performance of
signed jars. Prior to this commit, `certificates` and `codeSigners`
were read by streaming the entire jar whenever the existing values
were `null`. Unfortunately, the contract for `getCertificates` and
get `getCodeSigners` states that `null` is a valid return value. This
meant that full jar streaming would occur whenever either method was
called on an entry that had no result. The problem was further
exacerbated by the fact that entries might not be cached.
See gh-19041,Ignore Visual Studio Code Files
See gh-19041,Merge branch '2.3.x'
Support validation of bound map key entries
Update `ValidationBindHandler` so that pushed fields that reference
map keys can be used. This fixes a regression that was introduced in
commit 4483f417 when we switched to a `AbstractBindingResult` that no
longer required public getters/setters.
See gh-23256,Merge branch '2.3.x'
Merge pull request #23256 from lock14
* pr/23256:
  Polish 'Allow other "timestamp" types in MVC error model'
  Allow other "timestamp" types in MVC error model
Polish 'Allow other "timestamp" types in MVC error model'
See gh-23256,Allow other "timestamp" types in MVC error model
Remove casting "timestamp" to `java.util.Date` in
`ErrorMvcAutoConfiguration` as the cast is not necessary and it
prevents other types (e.g. `java.time`) from being used.
See gh-23256,Make it possible to link to individual configuration properties
Publish single page doc to /htmlsingle consistently
Merge pull request #23137 from anshlykov
* pr/23137:
  Polish "Add separate property for Redis read and connection timeout"
  Add separate property for Redis read and connection timeout
Polish "Add separate property for Redis read and connection timeout"
See gh-23137,Add separate property for Redis read and connection timeout
See gh-23137,Merge branch '2.3.x'
Improve sanitization for list of URI types
Prior to this commit, Actuator would sanitize properties values when
serializing them on the dedicated endpoint. Keys like "password" or
"secret" are entirely sanitized, but other keys like "uri" or "address"
are considered as URI types and only the password part of the user info
is sanitized.
This commit fixes the sanitization process where lists of such URI types
would not match the first entries of the list since they're starting
with `'['`. This commit improves the regexp matching process to sanitize
all URIs within a collection.
The documentation is also updated to better underline the processing
difference between complete sanitization and selective sanitization for
URIs.
Fixes gh-23037,Merge branch '2.3.x'
Fix mapping of Cassandra's idle-timeout and heartbeat-interval
Previous to this commit the connection idle timeout and heartbeat
interval were mapped to seconds whereas Cassandra expects ms for all
duration types.
This commit fixes the mapping and removes the default duration unit
since it should be considered ms like every other duration properties.
Merge pull request #23246 from dreis2211
* gh-23246:
  Reinstate smoketest.rsocket.SampleRSocketApplicationTests.rSocketEndpoint()
Reinstate smoketest.rsocket.SampleRSocketApplicationTests.rSocketEndpoint()
See gh-23246,Merge branch 'gh-22036'
Exclude starter jars when running and packaging with Gradle
This commit updates the Gradle Plugin to filter dependencies based on
the Spring-Boot-Jar-Type entry in their manifest. Jars with a
Spring-Boot-Jar-Type of dependencies-starter are excluded. Unlike the
Maven plugin, jars with a type of annotation-processor are not
excluded. It is not necessary with Gradle as use of the
annotationProcessor configuration for such dependencies already ensures
that they are not included.
See gh-22036,Exclude by jar type when running and packaging with Maven
This commit updates the Maven Plugin to filter dependencies based on
the Spring-Boot-Jar-Type entry in their manifest. Jars with a
Spring-Boot-Jar-Type of dependencies-starter or annotation-processor
are excluded.
See gh-22036,Merge pull request #22203 from dreis2211
* gh-22203:
  Note starters' and annotation processors' jar type in their manifest
Note starters' and annotation processors' jar type in their manifest
See gh-22203,Merge pull request #19399 from bono007
* gh-19205:
  Polish "Add SSL support to RSocketServer"
  Add SSL support to RSocketServer
Polish "Add SSL support to RSocketServer"
See gh-19399,Add SSL support to RSocketServer
See gh-19399,Merge branch '2.3.x'
Document that sliced tests don't scan @ConfigurationProperties beans
Upgrade to Spring Security 5.4.0
The commit also includes an upgrade to Nimbus JOSE JWT 9.0. Spring
Security requires 9.0 and it is not backwards compatible with 8.19.
\gh-23225
Align PropertiesLauncher's close behavior with JarLauncher
Previously, PropertiesLauncher would close each archive that it
iterated over when creating its ClassLoader. This was not aligned
with JarLauncher's behaviour and left the ClassLoader with closed
archives. The close was introduced in [1] and became more apparent
following the change to fail operations on closed archives [2].
This commit updates Launcher to remove the close() that was added in
[1]. This aligns the behavior of PropertiesLauncher with JarLauncher
and ensures that the ClassLoader does not have entries backed by
closed archives on its classpath.
Fixes gh-23165
[1] https://github.com/spring-projects/spring-boot/commit/ad72f86bdb9c2a889a76679767e9627de0f2543c
[2] https://github.com/spring-projects/spring-boot/commit/ed7a5db17441bdb37df8e90dc0fa6c52948c008e,Upgrade Java 15 version in CI image
Add @ImportConfigurationPropertiesBean support
Add repeatable `@ImportConfigurationPropertiesBean` annotation that can
be used to import types and treat them as `@ConfigurationProperties`
beans. This annotation is specifically designed to support third-party
classes that can't contain any Spring annotations.
Align WebClient uri metric tag with RestTemplate
Prior to this commit, the `WebClientExchangeTags`, when given a request
without a string template, would only get the request path to create the
"uri" tag for metrics. This is inconsistent with the
`RestTemplateExchangeTags`, which are taking the full request URI minus
the protocol+host+port.
This commit aligns the `WebClientExchangeTags` behavior in this case.
Upgrade to Spring Kafka 2.6.0
Polish,Merge pull request #23229 from dreis2211
* gh-23229:
  Enable Spring Integration RSocket test again
Enable Spring Integration RSocket test again
See gh-23229,Deprecate resource "app-cache" configuration support
This commit deprecates the
`"spring.resources.chain.html-application-cache"` configuration property
and its support, since the feature has been deprecated in Spring
Framework.
The app-cache manifest feature is being removed from browsers in favor
of web workers.
Deprecate Cassandra health indicators that rely on Spring Data
With the introduction of health indicators that only require the
CqlSession, this commit deprecates the health indicators that require
Spring Data since the latter build on top of the former.
Use classpath normalizer on antlib's integration test classpath input
Polish
This commit makes sure that no high-level client is auto-configured if
a low-level client is registered as a bean.
See gh-22358,Adapt to deprecation of ReactiveDataAccessStrategy
ReactiveDataAccessStrategy has been deprecated in Spring Data R2BC in
favor of R2dbcConverter (and StatementMapper and UpdateMapper). When
not using Boot, an R2dbcConverter bean is now defined by
AbstractR2dbcConfiguration. This commit updates
R2dbcDataAutoConfiguration to replace the definition of a
ReactiveDataAccessStrategy bean with the definition of an
R2dbcConverter bean.
See gh-23197,Polish
See gh-22358
Remove Elasticsearch RestClient auto-configuration
Prior to this commit, Spring Boot would auto-configure both
Elasticsearch variants: `RestClient` ("Low Level" client) and
`RestHighLevelClient` ("High Level" client).
Since one can be derived from the other, this would create complex and
unclear situations depending on what developers provided with their
configuration.
`RestHighLevelClient` is mostly for actual use of the Elasticsearch API,
with support for specific methods and (de)serialization. On the other
hand, `RestClient` is merely wrapping the Apache HTTP client for
load-balancing support and low level HTTP features.
This commit completely removes the support for `RestClient` in Spring
Boot and now requires the presence of the
`org.elasticsearch.client:elasticsearch-rest-high-level-client`
dependency for REST client support with Elasticsearch.
Temporarily disable Spring Integration RSocket test
See gh-23214
See gh-23010,Upgrade to OAuth2 OIDC SDK 8.19.1
Merge pull request #23215 from spencergibb
* pr/23215:
  Fix typo
Fix typo
See gh-23215,Polish,Switch startup actuator endpoint to using HTTP POST
Switch to RSocket SNAPSHOTs for 1.1.0-M2 upgrade
See gh-23214,Add startup Actuator endpoint
This commit builds on top of gh-22603 and exposes data collected by the
`BufferingApplicationStartup` on a dedicated `"/startup"` Actuator
endpoint.
Add mainApplicationClass tag to startup step
This commit adds a new tag to the `"spring.boot.application.starting"`
startup step.
Add buffering ApplicationStartup variant
As of spring-projects/spring-framework#24878, Spring Framework provides
an `ApplicationStartup` infrastructure that applications can use to
collect and track events during the application startup phase.
This commit adds a new `BufferingApplicationStartup` implementation that
buffer `StartupStep`s and tracks their execution time. Once buffered,
these steps can be pushed to an external metrics system or drained
through a web endpoint, to a file...
Update container versions used in deployment integration tests
Improve robustness of DeploymentIntegrationTests
Start building against Spring Session 2020.0.0-RC1 snapshots
See gh-23188,Start building against Spring Batch 4.3.0-RC1 snapshots
See gh-23189,Start building against Spring Data 2020.0.0-RC1 snapshots
See gh-23197,Merge branch '2.3.x',Start building against Spring Kafka 2.5.6 snapshots
See gh-23199,Start building against Spring Session Dragonfruit-SR1 snapshots
See gh-23187,Start building against Spring Data Neumann-SR4 snapshots
See gh-23196,Start building against Reactor Dysprosium-SR12 snapshots
See gh-23192,Merge branch '2.2.x' into 2.3.x,Start building against Spring Kafka 2.3.11 snapshots
See gh-23198,Start building against Spring Session Corn-SR4 snapshots
See gh-23186,Start building against Spring Data Moore-SR10 snapshots
See gh-23195,Start building against Reactor Dysprosium-SR11 snapshots
See gh-23191,Merge branch '2.1.x' into 2.2.x,Merge branch '2.3.x'
See gh-23204,Merge branch '2.2.x' into 2.3.x
See gh-23203,Restore identifying org.hsqldb.jdbcDriver as embedded
See gh-23036,Start building against Spring Data Bean-SR12 snapshots
See gh-23185,Start building against Spring Data Lovelace-SR20 snapshots
See gh-23194,Start building against Reactor Californium-SR21 snapshots
See gh-23190,Start building against Spring Framework 5.0.19 snapshots
See gh-23181,Merge branch '2.3.x'
Restore ordering of ErrorPageFilter lost in 49f8943
See gh-19471,Merge branch '2.3.x'
Document that buildpacks use non-root users
Align EmbeddedDatabaseConnection with DatabaseDriver
Fixes gh-23036,Fix use of deprecated methods,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x
See gh-23183,Start building against Spring Framework 5.2.9 snapshots
See gh-23182,Merge pull request #23179 from eddumelendez
* pr/23179:
  Polish "Upgrade to Assertj 3.17.2"
  Upgrade to Assertj 3.17.2
Polish "Upgrade to Assertj 3.17.2"
See gh-23179,Upgrade to Assertj 3.17.2
See gh-23179,Start building against Spring Framework 5.3.0.RC1 SNAPSHOTs
See gh-23170,Merge branch '2.3.x'
Upgrade build to Gradle 6.6.1
Merge pull request #23045 from jzheaux
* pr/23045:
  Polish "Configure SAML 2.0 Service Provider via Metadata"
  Configure SAML 2.0 Service Provider via Metadata
Polish "Configure SAML 2.0 Service Provider via Metadata"
See gh-23045,Configure SAML 2.0 Service Provider via Metadata
See gh-23045,Merge pull request #23161 from darioseidl
* pr/23161:
  Add reference to AOProfiling Spring Boot starter
Add reference to AOProfiling Spring Boot starter
See gh-23161,Avoid unnecessary reflection in TaskExecutorBuilder
Merge pull request #22528 from pradipta
* pr/22528:
  Polish "Removed some redundant 'else's using early return"
  Removed some redundant 'else's using early return
Polish "Removed some redundant 'else's using early return"
See gh-22528,Removed some redundant 'else's using early return
See gh-22528,Polish
See gh-23157,Merge branch '2.3.x'
Review checkstyle rule to prevent non BDD mockito imports
Review instructions for running launch script tests with Gradle
Merge pull request #23111 from EruDev
* pr/23111:
  Polish "Simplify code"
  Simplify code
Polish "Simplify code"
See gh-23111,Simplify code
See gh-23111,Allow to customize how EntityScanner scans entities
This commit adds a protected method that lets an override customize the
configuration of the ClassPathScanningCandidateComponentProvider used
to scan entities.
Remove node and recursive limits for YAML
Update `OriginTrackedYamlLoader` to remove node limits and recursive
parsing restrictions. SnakeYAML 1.26 introduced these options in order
to protect against the "billion laugh attacks" but since we consider
`application.yml` files to be trusted, we don't need these restrictions.
Fixes gh-23096,Make file detection more resilient across restarts
Retain file snapshot state across devtools restarts to help prevent
detection failures.
Document buildpacks are configured with target Java version
Document how to perform tasks after application startup
Clarify how to take full control of ElasticSearch's rest client
Document how to customize the jmxPort for Maven integration tests
Document how to add auto-configurations to a test slice
Add a note about using graceful shutdown from an IDE
Refine global optional config data opt-out
Rename the opt-out property and use an enum in case we want to provide
additional options in the future.
See gh-22946,Merge branch '2.3.x'
Merge pull request #22946 from rgoers
* pr/22946:
  Polish 'Remove ResourceUtils.getURL logging config check'
  Remove ResourceUtils.getURL logging config check
Polish 'Remove ResourceUtils.getURL logging config check'
Extend `initializeSystem` to search the exception stack for a
FileNotFoundException before reporting the error. This allows
us to provide a similar stack trace to the one that used to be
thrown when we had the `ResourceUtils.getURL` check.
See gh-22946,Remove ResourceUtils.getURL logging config check
Remove `ResourceUtils.getURL` checking from `LoggingApplicationListener`
so that logging systems can implement custom location support.
Prior to this commit, we checked in the listener if the specified config
location could be opened as a URL. This unfortunately prevents Log4J
extensions such as `log4j-spring-cloud-config-client` from implementing
configurable SSL and credentials support.
See gh-22946,Merge branch '2.3.x'
Ensure layer digest hashes contain 64 characters
This commit ensures that encoded digest hashes for Docker image
layers are zero-padded to the required 64 characters length.
Fixes gh-23132,Merge branch '2.3.x'
Fail on Docker image load with empty response
In some cases, a call to the Docker image load API will fail but
return a 200 OK response status code and an empty response. This
commit detects that the response from this call is empty and
treats this condition as an error instead of a silent failure.
Fixes gh-23130
Upgrade to Gradle Enterprise Maven Extension 1.6.3
Merge pull request #23127 from dreis2211
* gh-23127:
  Use DynamicPropertySource in MongoDB tests
Use DynamicPropertySource in MongoDB tests
See gh-23127,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Remove duplicate jackson-datatype-jsr310 dependency
Replace Embedded Mongo with Testcontainers' MongoDB support
Merge pull request #22943 from chali
* gh-22943:
  Polish "Mark bootArchives configuration as unresolvable"
  Mark bootArchives configuration as unresolvable
Polish "Mark bootArchives configuration as unresolvable"
See gh-22943,Mark bootArchives configuration as unresolvable
See gh-22943,Expose originParents on actuator endpoints
Update `ConfigurationPropertiesReportEndpoint` and `EnvironmentEndpoint`
so that they expose `originParents` when they are available.
Add parent origin support to config data
Allow `ConfigDataLocationResolvers` to access `Origin` information for
locations so that they can be used as a parent origin of loaded items.
The `ResourceConfigData...` classes have been reworked so that loaded
`PropertySources` include the parent origin.
See gh-23018,Add parent origin support
Update the `Origin` interface to include a default `getParent()` method
which can be used to get the parent origin. The `TextResourceOrigin`
has been updated to implement the method against the source `Resource`.
A new `OriginTrackedResource` implementation allows any `Resource` to
be decorated and carry an optional `Origin`.
Ultimately this will allow us to include parent `Origin` information
on properties loaded via a `PropertySourceLoader` without needing any
changes to that interface.
See gh-23018,Polish test method names
Polish method names to remove "should".,Support binding with multiple constructors
Update `DefaultBindConstructorProvider` so that binding to objects with
multiple constructors is allowed, as long as there is only one
non-public candidate.
Merge pull request #23091 from 01045972746
* pr/23091:
  Polish "Add support for RabbitMQ's addressShuffleMode property"
  Add support for RabbitMQ's addressShuffleMode property
Polish "Add support for RabbitMQ's addressShuffleMode property"
See gh-23091,Add support for RabbitMQ's addressShuffleMode property
See gh-23091,Upgrade Java 15 version in CI image
Upgrade Ubuntu version in CI images
Fix global optional config data opt-out test
See gh-23097,Add global optional config data opt-out
Support a `spring.config.all-locations-optional` property which can be
set to `true` if all config data locations should be considered
optional.
Add limited support for spring.profiles.include
Restore support for the `spring.profiles.include` property but only
for non-profile specific documents.
Widen timeout and delay to accommodate Windows' imprecision under load
Merge pull request #23081 from izeye
* pr/23081:
  Polish
Polish
See gh-23081,Merge branch '2.3.x'
Merge pull request #23086 from dreis2211
* pr/23086:
  Remove unused methods
Remove unused methods
See gh-23086,Merge pull request #23084 from spencergibb
* gh-23084:
  Polish "Handle null RSocketServer address when setting port property"
  Handle null RSocketServer address when setting port property
Polish "Handle null RSocketServer address when setting port property"
See gh-23084,Handle null RSocketServer address when setting port property
See gh-23084,Support extensionless file imports
Update `ResourceConfigDataLocationResolver` so that it can import files
that have no file extension.
Throw exception if import locations are not found
Update config data processing code so that import locations are
mandatory by default. Any import request will now throw a
`ConfigDataLocationNotFoundException` if the specified import
location cannot be found. For optional imports, the user can
use the `optional:` prefix to indicate that the application should
continue to start, even if the location does not exist.
See gh-22909,Increase timeouts used in Cassandra integration tests
Merge pull request #23048 from s50600822
* gh-23048:
  Polish "Add a configuration property for KLC's idleBetweenPolls"
  Add a configuration property for KLC's idleBetweenPolls
Polish "Add a configuration property for KLC's idleBetweenPolls"
See gh-23048,Add a configuration property for KLC's idleBetweenPolls
See gh-23048,Generate default values from Duration and Period .ZERO
Adapt auto-configurations to back-off in presence of TransactionManager
Previous to this commit, an auto-configuration would create a
PlatformTransactionManager if none is present and others conditions are
met. Spring Framework now has the notion of TransactionManager, a parent
interface that gathers both PlatformTransactionManager and
ReactiveTransactionManager.
Spring Boot should not be in a situation where both managers are defined
out-of-the-box. This commit makes sure to back-off if any
TransactionManager is available.
Polish,Merge branch '2.3.x'
Merge pull request #23071 from dreis2211
* pr/23071:
  Disallow Apache Commons Lang & Lang3 imports
Disallow Apache Commons Lang & Lang3 imports
See gh-23071,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Test the Gradle Plugin against 6.5 and 6.6
Merge pull request #22996 from ThomasKasene
* gh-22996:
  Polish "Added dependency management for nimbus-jose-jwt"
  Added dependency management for nimbus-jose-jwt
Polish "Added dependency management for nimbus-jose-jwt"
See gh-22996,Added dependency management for nimbus-jose-jwt
See gh-22996,Disable file system preference for Freemarker templates
Previously to this commit, a project that has several classpath
locations matching the template path may lead to some of those
locations to be ignored if one of them is a directory. This can easily
happen if you run your tests in your IDE.
This commit changes the default of "preferFileSystemAccess" to
false so that the complete classpath is always considered.
Start building against Reactor 2020.0.0-RC1 snapshots
See gh-23065,Merge branch '2.3.x'
Fix unintended import on commons lang
Merge pull request #23028 from bedla
* pr/23028:
  Polish "Add example of custom Actuator operations"
  Add example of custom Actuator operations
Polish "Add example of custom Actuator operations"
See gh-23028,Add example of custom Actuator operations
See gh-23028,Merge pull request #23052 from dreis2211
* pr/23052:
  Simplify InputStream assertions
Simplify InputStream assertions
See gh-23052,Merge pull request #23058 from mvanmeerbeck
* pr/23058:
  Polish "Add Hyperledger Fabric for Spring Boot Starter"
  Add Hyperledger Fabric for Spring Boot Starter
Polish "Add Hyperledger Fabric for Spring Boot Starter"
See gh-23058,Add Hyperledger Fabric for Spring Boot Starter
See gh-23058,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Merge branch '2.1.x' into 2.2.x
\gh-23056
Upgrade to Gradle Enterprise Maven Extension 1.6.2
Allow placeholders to be used in imports
Allow `${..}` property placeholders to be used in `spring.config.import`
properties. Prior to this commit, placeholders were not resolved when
binding the `ConfigDataProperty` instance. Furthermore, binding happened
too early for all placeholders to be resolved correctly. The
`ConfigDataEnvironmentContributor` class now has two states for imported
contributors, `UNBOUND_IMPORT` has the initial unbound state and is
eventually replaced with a `BOUND_IMPORT`.
Merge pull request #23050 from dreis2211
* pr/23050:
  Fix typos in tests
Fix typos in tests
See gh-23050,Add BootstrapRegisty support for config data
Expose the `BootstrapRegisty` to both `ConfigDataLocationResolver` and
`ConfigDataLoader` implementations. The registry is exposed via the
context interfaces and may be used to reuse instances that are expensive
to create. It may also be used to ultimately register beans with the
`ApplicationContext`.
Add BootstrapRegistry for long lived instances
Add a simple `BootstrapRegistry` that can be used to store and share
object instances across `EnvironmentPostProcessors`. The registry
can be injected into the constructor of any `EnvironmentPostProcessor`.
Registrations can also perform additional actions when the
`ApplicationContext` has been prepared. For example, they could register
the the bootstrap instances as beans so that they become available to
the application.
See gh-22956,Provide a simple Instantiator utility class
Make `Instantiator` a public utility class so that it can be used
by other parts of the codebase.
Upgrade to Kotlin Coroutines 1.3.9
Upgrade to Kotlin 1.4.0
Upgrade Java 15 version in CI image
Add configuration option for GridFsTemplate's bucket
Use canonical path for CNB builder lifecycle binaries
This commit changes the path used to invoke lifecycle binaries in
CNB builders from `/lifecycle` to `/cnb/lifecycle` to conform to
the CNB spec. This will ensure the build plugin image-building
goals and tasks are compatible with future versions of builders
that may not support both paths.
See gh-23009,Merge branch '2.3.x'
Reduce HTTP debug logging when building image
Update `BuildImageMojo` so that commons HTTP wire logging is configured
to ERROR. Without this update, running `mvn -X` will produce a great
deal of logging since by default HTTP Client logs all bytes transfered
at DEBUG and Maven will enable DEBUG for all logs.
Upgrade to Spring Kafka 2.6.0-SNAPSHOT
See gh-23012,Upgrade to Spring AMQP 2.3.0-SNAPSHOT
See gh-23011,Upgrade to Spring Integration 5.4.0-SNAPSHOT
See gh-23010,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Fix Windows path issue in JarFileWrapperTests
See gh-22991,Merge branch '2.3.x',Close writer after use in ExtractCommandTests
Update `ExtractCommandTests` so that the writer is closed after the
contents have been written.
See gh-22993,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Use @AfterEach to close the source jar file
Update `JarFileWrapperTests` so that the jar files are closed after each
test.
See gh-22991,Merge branch '2.3.x'
Merge pull request #23002 from dreis2211
* pr/23002:
  Mention correct JUnit 5 annotations in Kotlin testing section
Mention correct JUnit 5 annotations in Kotlin testing section
See gh-23002,Merge branch '2.3.x'
Ensure LayoutFactory is not passed an empty file
Update `Repackager` to ensure that `getLayout` is called before we
backup the source file. This restores earlier behavior that some
custom `ModuleFactory` implementations were relying on.
Remove Mockto from JarFileWrapperTests since it seems to be failing on
later versions of Java.
See gh-22991,Update copyright year of changed files,Merge branch '2.3.x',Update copyright year of changed files,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Merge branch '2.2.x' into 2.3.x,Update copyright year of changed files,Refine AbstractJarFile method visibility
Refine method visibility in an attempt to fix test issues on Java 11+.
See gh-22991,Merge branch '2.3.x'
Fail on layertools extract with launch script
This commit adds a check to the `layertools extract` command to
ensure that the jar file being processed is readable and has a
valid directory.
Fixes gh-22993,Merge branch '2.3.x'
Attempt to fix memory leak in JarFile class
Create a new `JarFileWrapper` class so that we can wrap and existing
`JarFile` and offer a version that can be safely closed.
Prior to this commit, we provided wrapper functionality in the `JarFile`
class itself. Unfortunately, because we override `close` and also create
a lot of wrappers this caused memory issues when running on Java 11.
With Java 11 `java.util.zip.ZipFile` class uses `FinalizableResource`
for any implementation that overrides `close()`. This means that any
wrapper classes will not be garbage collected until the JVM finalizer
thread runs.
Rename neo4j.version to neo4j-java-driver.version
Rename CompositeMeterRegistryAutoConfiguration
Rename `CompositeMeterRegistryAutoConfiguration` to
`MeterRegistryAutoConfiguration` since it can also create non-composite
registries.
Merge pull request #21134 from bendiscz
* pr/21134:
  Polish 'Order metrics auto-configurations correctly'
  Order metrics auto-configurations correctly
Polish 'Order metrics auto-configurations correctly'
See gh-21134,Order metrics auto-configurations correctly
Update metrics auto-configurations so that they are auto-configured
after `CompositeMeterRegistryAutoConfiguration` in order to ensure
the `MeterRegistry` bean has been defined.
Prior to this commit, metrics auto-configurations that depended on a
`MeterRegistry` has `@AutoConfigureAfter(MetricsAutoConfiguration.class)`
which is not sufficient since `MetricsAutoConfiguration` does not export
a `MeterRegistry`.
See gh-21134,Preserve user-provided values in MongoClientSettings
Prior to this commit, values from MongoProperties would always
overwrite matching fields in MongoClientSettings. This commit
preserves all values in MongoClientSettings if the client app
provides the MongoClientSettings bean, and only overwrites from
MongoProperties if no MongoClientSettings bean is provided.
Fixes gh-22321,Merge branch '2.3.x'
Merge pull request #22750 from Lopfest
* pr/22750:
  Polish "Fix include exception handling in DefaultErrorAttributes"
  Fix include exception handling in DefaultErrorAttributes
Polish "Fix include exception handling in DefaultErrorAttributes"
See gh-22750,Fix include exception handling in DefaultErrorAttributes
This commit fixes a problem with the handling of the includeException
field in DefaultErrorAttributes.
See gh-22750,Merge branch '2.3.x'
Merge pull request #22918 from jnizet
* pr/22918:
  Fix custom image name example and documentation
Fix custom image name example and documentation
There is no `artifactId` property in a gradle Project, and the default
value uses the project name.
See gh-22918,Remove trailing whitespaces,Merge pull request #22973 from anshlykov
* pr/22973:
  Polish "Consider RecordFilterStrategy in Kafka auto-configuration"
  Consider RecordFilterStrategy in Kafka auto-configuration
Polish "Consider RecordFilterStrategy in Kafka auto-configuration"
See gh-22973,Consider RecordFilterStrategy in Kafka auto-configuration
See gh-22973,Merge pull request #22945 from dreis2211
* pr/22945:
  Fix typos in docs
Fix typos in docs
See gh-22945,Merge branch '2.3.x',Polish
See gh-22945,Merge branch '2.3.x'
Add @Interited to @TypeExcludeFilters
Update `@TypeExcludeFilters` so that it is also annotated with
`@Inherited`.
Fix and improve SpringApplicationBuilder javadoc
Update SpringApplicationBuilder.properties method javadoc to fix
inaccuracies and apply more consistency.
Polish method order,Merge branch '2.3.x'
Merge pull request #22948 from maciejwalkowiak
* pr/22948:
  Fix typo `Assert4J` -> `AssertJ`
Fix typo `Assert4J` -> `AssertJ`
See gh-22948,Make security auto-configs back off when SecurityFilterChain present
See gh-22909,Rename volumemount -> configtree
Polish,Fix DataNeo4jTestReactiveIntegrationTests
See gh-22940,Merge branch '2.3.x',Next development version (v2.3.4.BUILD-SNAPSHOT),Document Spring Data Neo4j 6 support
Do not configure a ReactiveNeo4jTransactionManager
The current arrangement with Neo4j does not allow us to know for sure
that the user intends to use `@Transactional` for reactive or imperative
operations.
The main reason for that is that the only trigger for the reactive
auto-configuration is the presence of reactor on the classpath given
that the Neo4j driver ships with both styles in the same jar. And
reactor can be on the classpath for a number of reasons that are
unrelated to imperative access (typically `WebClient`).
This commits removes the auto-configuration of the
ReactiveNeo4jAutoConfiguration and makes sure that if the user defines
one, the regular `PlatformTransactionManager` backs off. This is
a temporarily situation until we can provide a better signal that the
user intends to primarily use imperative repositories.
Revert "Merge pull request #21060 from dsyer"
This reverts commit 6547ea56f9a6e90ce886c4ba73ca852ccb648bec, reversing
changes made to e9e4a34e622ba3652d4f65e3a1433bed725907fc.
Fixes gh-22039,Merge branch '2.3.x',Upgrade to Selenium HtmlUnit 2.43.1
Upgrade to Micrometer 1.5.4
Upgrade to Flyway 6.5.4
Upgrade to Micrometer 1.5.4
Upgrade to Spring Batch 4.3.0-M2
Upgrade to Micrometer 1.5.4
Merge pull request #22919 from smlc
* pr/22919:
  Polish "Fix conditions that lead to auto-configure PushGateway"
  Fix conditions that lead to auto-configure PushGateway
Polish "Fix conditions that lead to auto-configure PushGateway"
See gh-22919,Fix conditions that lead to auto-configure PushGateway
See gh-22919,Upgrade Java 15 version in CI image
Fix default value of server.jetty.accesslog.format
See gh-22916,Merge branch '2.3.x'
Use Java version wildcard in image building docs
Fixes gh-22916,Merge pull request #22736 from anshlykov
* gh-22736:
  Polish "Add pullPolicy option for image building"
  Add pullPolicy option for image building
Polish "Add pullPolicy option for image building"
See gh-22736,Add pullPolicy option for image building
This commit adds a pullPolicy option to the configuration of the Maven
plugin spring-boot:build-image goal and the Gradle plugin bootBuildImage
task. The new option gives users control over pulling the builder image
and run image from a remote image registry to the local Docker daemon.
See gh-22736,Upgrade to Spring Integration 5.4.0-M2
Upgrade to Spring AMQP 2.2.10.RELEASE
Upgrade to Spring Kafka 2.6.0-M1
Merge pull request #22710 from dreis2211
* gh-22710:
  Introduce @ForkedClassPath for testing unmodified class path
Introduce @ForkedClassPath for testing unmodified class path
See gh-22710,Upgrade to Spring AMQP 2.3.0-M2
Fix configuration of environment in Kotlin bootBuildImage examples
Fixes gh-22913,Fix spring.config.activate.on-profile metadata
Fix the `spring.config.activate.on-profile` entry which was accidentally
entered as `spring.config.import.on-profile`.
See gh-22497,Merge branch '2.3.x',Upgrade to Spring Data Neumann SR3
See gh-22909,Improve diagnostics when remote application does not start as expected
See gh-22909,Merge branch '2.3.x'
Merge pull request #22765 from izeye
* gh-22765:
  Mention configuration customizers for WebTestClient and RestAssured
Mention configuration customizers for WebTestClient and RestAssured
See gh-22765,Restore handling of certain spring.data.neo4j.* properties
This commit switches the deprecation level of several properties in the
spring.data.neo4j namespace from error and warning. The server URI and
basic authentication can be used in a deprecated fashion to configure
the new neo4j driver.
Upgrade to Gradle 6.6
Simplify build.gradle for spring-boot-starter-data-solr
Upgrade to Spring Data 2020.0.0-M2
Merge pull request #22548 from AndrewDi
* pr/22548:
  Polish "Add basic auth support for Prometheus pushgateway"
  Add basic auth support for Prometheus pushgateway
Polish "Add basic auth support for Prometheus pushgateway"
See gh-22548,Add basic auth support for Prometheus pushgateway
See gh-22548,Merge branch '2.3.x'
Merge pull request #22898 from johncfranco
* pr/22898:
  Polish "Harmonize Discover the HTTP Port at Runtime How-To"
  Harmonize Discover the HTTP Port at Runtime How-To
Polish "Harmonize Discover the HTTP Port at Runtime How-To"
See gh-22898,Harmonize Discover the HTTP Port at Runtime How-To
See gh-22898,Merge pull request #22858 from dsyer
* pr/22858:
  Polish 'Support ConfigurationClassPostProcessor supplier'
  Support ConfigurationClassPostProcessor supplier
Polish 'Support ConfigurationClassPostProcessor supplier'
See gh-22858,Support ConfigurationClassPostProcessor supplier
Update `SharedMetadataReaderFactoryContextInitializer` to optionally
support a `ConfigurationClassPostProcessor` provided via an instance
`Supplier`.
If the instance supplier is available then we can use that to set the
`MetadataReaderFactory` non-reflectively, instead of using a
`PropertyValue` (and the `BeanWrapper` eventually).
The previous behavior is left as a  fallback and without a change in
Spring Framework will continue to be the default for most applications.
See gh-22858,Merge branch '2.3.x'
Do not ignore null/empty values from SPRING_APPLICATION_JSON
Fixes gh-21542,Merge pull request #22845 from mdeinum
* pr/22845:
  Polish 'Allow step action to be optional'
  Allow step action to be optional
Polish 'Allow step action to be optional'
See gh-22845,Allow step action to be optional
Update `SpringApplicationRunListeners` so that the step action
is optional and does not need to call `end()`.
This commit also introduces a test for the failure case showing
that there is a missed call to end with the initial solution.
See gh-22845,Upgrade to Spring HATEOAS 1.2.0-M1
Merge pull request #22829 from emilytsanova
* gh-22829:
  Polish "Exclude cookie headers by default from HTTP traces"
  Exclude cookie headers by default from HTTP traces
Polish "Exclude cookie headers by default from HTTP traces"
See gh-22829,Exclude cookie headers by default from HTTP traces
See gh-22829,Merge branch '2.3.x'
Document the limitation of default value detection
Polish,Merge branch '2.3.x'
Document that Cassandra's application.conf is not considered
Avoid duplicates with different versions in Devtools' int test deps
Upgrade to Versions Maven Plugin 2.8.1
Upgrade to Selenium HtmlUnit 2.43.0
Upgrade to Pooled JMS 1.1.2
Upgrade to Maven Resources Plugin 3.2.0
Upgrade to Lettuce 5.3.3.RELEASE
Upgrade to Kotlin Coroutines 1.3.8
Upgrade to HtmlUnit 2.43.0
Upgrade to Hibernate 5.4.20.Final
Upgrade to Dropwizard Metrics 4.1.12.1
Upgrade to Dependency Management Plugin 1.0.10.RELEASE
Upgrade to Spring HATEOAS 1.1.1.RELEASE
Upgrade to RSocket 1.0.2
Upgrade to Pooled JMS 1.1.2
Upgrade to Lettuce 5.3.3.RELEASE
Upgrade to Kafka 2.5.1
Upgrade to jOOQ 3.13.4
Upgrade to Jetty 9.4.31.v20200723
Upgrade to Jackson Bom 2.11.2
Upgrade to Hibernate 5.4.20.Final
Upgrade to Dropwizard Metrics 4.1.12.1
Upgrade to Dependency Management Plugin 1.0.10.RELEASE
Upgrade to Couchbase Client 3.0.7
Upgrade to Commons Pool2 2.8.1
Upgrade to Byte Buddy 1.10.14
Restore customization of the Couchbase cache manager
With the upgrade to the new Couchbase SDK and the related changes in
Spring Data Couchbase, CacheManagerCustomizer can no longer be used to
customize the Couchbase cache manager as it is an immutable class.
This commit introduces a dedicated callback for the
CouchbaseCacheManagerBuilder that is used by the auto-configuration and
update the documentation to refer to it with a sample usage.
Upgrade to Spring Framework 5.3.0-M2
Only enable full path optimization when there's one DispatcherServlet
Previously, UrlPathHelper's full path optimization was enabled when
there was a dispatcher servlet mapped to /. The UrlPathHelper is used
across Spring MVC and if there are multiple dispatcher servlets they
all share the sample UrlPathHelper. This meant that any additional
dispatcher servlets mapping to locations other than / would not be able
to map requests correctly as the UrlPathHelper would use the full path,
ignoring the url mapping of the dispatcher servlet.
This commit updates the MVC auto-configuration so that use of the full
path is only enabled if there's a single dispatcher servlet
registration.
Fixes gh-22682,Upgrade to RSocket 1.1.0-M1
Upgrade to Reactor 2020.0.0-M2
Upgrade to Mockito 3.4.6
Merge pull request #21615 from Larisho
* pr/21615:
  Polish "Migrate legacy endpoint that have a dash in their id"
  Migrate legacy endpoint that have a dash in their id
Polish "Migrate legacy endpoint that have a dash in their id"
See gh-21615,Migrate legacy endpoint that have a dash in their id
See gh-21615,Merge pull request #22839 from dreis2211
* pr/22839:
  Fix some doc anchors
Fix some doc anchors
See gh-22839,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Polish,Merge branch '2.3.x'
Merge pull request #22777 from davidbilge
* pr/22777:
  Polish "Propagate the cause that led Reactor"s debug agent to fail"
  Propagate the cause that led Reactor"s debug agent to fail
Polish "Propagate the cause that led Reactor"s debug agent to fail"
See gh-22777,Propagate the cause that led Reactor"s debug agent to fail
Prior to this commit, DebugAgentEnvironmentPostProcessor throws a
RuntimeException with a generic error message if its initialization
fails. The causing exception is discarded, which makes error analysis
unnecessarily difficult.
This commit attaches the cause to the newly thrown RuntimeException.
See gh-22777,Merge branch '2.3.x',Upgrade to Reactor Dysprosium-SR11
Merge pull request #22760 from ksmilek-wr
* pr/22760:
  Fix wrong reference in `ReadinessStateHealthIndicator` javadoc
Fix wrong reference in `ReadinessStateHealthIndicator` javadoc
See gh-22760,Merge branch '2.3.x',Start building against Spring Data Neumann SR3 snapshots
See gh-22844,Start building against Spring Kafka 2.5.5 snapshots
See gh-22843,Start building against Spring AMQP 2.2.10 snapshotsEnabled
See gh-22842,Start building against Reactor Dysprosium-SR11 snapshots
See gh-22841,Align with changes in latest Integration snapshots
See gh-22729,Adapt to MonoProcessor deprecations in Reactor
This commit updates our usage of `MonoProcessor` after the deprecations
introduced in reactor/reactor-core#1053,End StartupSteps only once in SpringApplicationRunListeners
Fixes gh-22776,Merge branch '2.3.x'
Isolate Maven Plugin's integration tests from repo.spring.io
Previously, the Maven plugin integration tests used a settings.xml file
that defined https://repo.spring.io/snapshot as a repository. This
allowed them to resolve snapshots of the plugin's Spring Framework
dependencies but it had the unfortunate side-effect of also allowing
them to resolve snapshots of other Spring Boot modules from Artifactory
rather than using those currently being built.
This commit replaces the repositories in settings.xml with a Gradle
task that resolves the necessary dependencies and populates a local
repository with the dependencies' jars and pom files. This is achieved
using a ComponentMetadataRule that creates a custom variant of each
dependency that includes its pom file, inspired by the example in
gradle/gradle/#11449. A configuration that extends the
runtimeClasspath configuration and select the custom variant via its
attribute is then used to resolve the jars and pom files of the runtime
classpath such that they can then be used to populate the local
repository.
Update HTTP/2 auto-configuration for Jetty
Prior to this commit, the HTTP/2 server auto-configuration for Jetty
would require Conscrypt as a hard dependency.
This commit updates the auto-configuration for more flexibility and now
allows the following deployments:
* JDK9+ with the JDK ALPN implementation
* JDK8u252+ with the backported ALPN implementation
* Conscrypt with no JDK requirement
The auto-configuration now improves detection and guides developers in
case there is a missing `jetty-alpn-*-server` dependency.
The reference docs in the HOWTO section has been updated accordingly.
Configure generated snippets as inputs to the Asciidoctor tasks
Upgrade to Tomcat 9.0.37
Upgrade to SQLite JDBC 3.32.3.2
Upgrade to Spring HATEOAS 1.1.1.RELEASE
Upgrade to Solr 8.5.2
Upgrade to SendGrid 4.6.3
Upgrade to Selenium HtmlUnit 2.42.0
Upgrade to Netty 4.1.51.Final
Upgrade to MySQL 8.0.21
Upgrade to MongoDB 4.1.0
Upgrade to Micrometer 1.5.3
Upgrade to Maven War Plugin 3.3.1
Upgrade to MariaDB 2.6.2
Upgrade to Liquibase 3.10.2
Upgrade to Lettuce 5.3.2.RELEASE
Upgrade to jOOQ 3.13.4
Upgrade to Johnzon 1.2.8
Upgrade to Jetty 9.4.31.v20200723
Upgrade to Jackson Bom 2.11.2
Upgrade to Infinispan 11.0.3.Final
Upgrade to HtmlUnit 2.42.0
Upgrade to HSQLDB 2.5.1
Upgrade to Hibernate 5.4.19.Final
Upgrade to Flyway 6.5.3
Upgrade to Dropwizard Metrics 4.1.11
Upgrade to DB2 JDBC 11.5.4.0
Upgrade to Commons Pool2 2.8.1
Upgrade to Commons Lang3 3.11
Upgrade to Cassandra Driver 4.8.0
Upgrade to Caffeine 2.8.5
Upgrade to Byte Buddy 1.10.14
Upgrade to Build Helper Maven Plugin 3.2.0
Upgrade to AspectJ 1.9.6
Upgrade to Artemis 2.14.0
Upgrade to AppEngine SDK 1.9.81
Upgrade to ActiveMQ 5.16.0
Remove version from name of Ant-built jar
Previously, the project version was included in the name of the
Ant-built jar and the integration test assumed that there would be a
single jar in the output directory. This assumption did not hold true
if the project's version had changed and the project had been built
again without a clean. This resulted in two jars, one for the previous
version and one for the current version, in the output directory. This
caused a test failure.
This commit updates the build.xml to remove the version from the name
of the Ant-built jar and updates the integration test to find it.
Make processResources out-of-date on version change
Fix documentation related to the health endpoint's inner details
Add ConfigDataEnvironmentPostProcessor.applyTo
Add static methods to `ConfigDataEnvironmentPostProcessor` so that
post-processing can be applied to `Environment` instances directly.
Update copyright year of changed files,Polish,Merge branch '2.3.x',Ensure Maven plugin descriptor inputs are out-of-date on version change
Retry when dependency resolution fails in ModifiedClassPathClassLoader
Require RSocket 1.0+
This commit removes usage of methods and classes that were previously
deprecated in RSocket and Spring Framework and have been removed.
Instrument SpringBootApplication for ApplicationStartup
This commit allows the configuration of a custom `ApplicationStartup`
implementation on the `SpringApplication` and
`SpringApplicationBuilder` for collecting `StartupStep` metrics.
This also instruments Spring Boot run listeners and server-specific
application context implementations for collecting Spring Boot
application events during startup.
Starting building against Spring AMQP 2.3.0-M2 snapshots
See gh-22761,Merge branch '2.3.x'
Add tip about using AopTestUtils.getTargetProxy with proxied spy beans
Upgrade Java 15 version in CI image
Upgrade Java 8 version in CI image
Fix additional deprecations,Fix deprecations,Fix test,Fail hard if spring.profiles.include is used with new config processing
Upgrade to Spring Security 5.4.0-RC1
Clarify docs on schema and data SQL scripts with Flyway and Liquibase
Remove WebClient's in-memory buffer size limit for endpoint tests
Previously, the endpoints' responses could occasionally exceed
WebClient's in-memory buffer limt, for example if the threads endpoint
was reporting a large number of threads or the threads had large
stacks.
This commit disables WebClient's in-memory buffer size limit so that
the tests passing is not dependent on the size of the endpoints'
responses.
Merge pull request #22740 from izeye
* pr/22740:
  Polish
Polish
See gh-22740,Merge pull request #17490 from ayudovin
* pr/17490:
  Polish "Add test slice for Spring Data Cassandra"
  Add test slice for Spring Data Cassandra
Polish "Add test slice for Spring Data Cassandra"
See gh-17490,Add test slice for Spring Data Cassandra
See gh-17490,Merge branch '2.3.x'
Try to make FileSystemWatcherTests.waitsForQuietPeriod() more robust
Previously, waitsForQuietPeriod would iterate 10 times, touching a new
file and then sleeping for 100ms at it did so. With a quiet period of
200ms, this was intended to result in a single change set containing
10 files. However, the test would fail occasionally as multiple change
sets were detected. The test is multi-threaded and is, therefore, at
the mercy of the scheduler. If the thread that is iterating and
touching the files takes over 200ms to be scheduled – exceeding the
watcher's quiet period – the watcher may detect a change set while the
changes are still being made. Eliminating this possibilty would require
the test to participate in the watcher's synchronization, which would
require some changes to its implementation. Instead, this commit
aims to avoid the problem by sleeping for 1/10 of the time (10ms) and
expecting a single change set of 100 files. The hope is that the much
shorter sleep time will result in the file touching thread being
scheduled well within the 200ms quiet period.
Merge pull request #22258 from danilopiazza
* pr/22258:
  Polish "Support configuration of entityId for a SAML Relying Party"
  Support configuration of entityId for a SAML Relying Party
Polish "Support configuration of entityId for a SAML Relying Party"
See gh-22258,Support configuration of entityId for a SAML Relying Party
See gh-22258,Merge pull request #22569 from bono007
* pr/22569:
  Polish "Add support for selecting the Redis client to use"
  Add support for selecting the Redis client to use
Polish "Add support for selecting the Redis client to use"
See gh-22569,Add support for selecting the Redis client to use
See gh-22569,Merge branch '2.3.x'
Allow empty env entries when building an image
Prior to this commit, an entry in the environment map provided to the
build plugin image building goal or task that had a null value would
result in a failure with a message that was difficult to diagnose.
This commit treats env map entries with a null value as an empty
entry to prevent the failure and also make it easier to provide an
explicit empty entry in the Maven XML.
Fixes gh-22703,Polish,Merge branch '2.3.x',Disable JarLaunchScriptIntegrationTests without Docker
See gh-21388,Start building against Spring Integration 5.4.0-M2 snapshots
See gh-22729,Start building against Spring Kafka 2.6.0-M1 snapshots
See gh-22730,Upgrade to Kafka 2.6.0
Merge pull request #22571 from bono007
* pr/22571:
  Polish "Add option to disable Redis Cluster dynamic sources refresh"
  Add option to disable Redis Cluster dynamic sources refresh
Polish "Add option to disable Redis Cluster dynamic sources refresh"
See gh-22571,Add option to disable Redis Cluster dynamic sources refresh
This commit adds an option to enable/disable the DynamicRefreshSources
setting on the Lettuce cluster toplogy refresh options.
See gh-22571,Merge branch '2.3.x'
Disable caching of changing modules
Temporarily disable rSocketEndpoint test
See gh-22725,Update to core r2dbc support
This commit adapts the auto-configuration for the new core r2dbc support
in Spring Framework and provides auto-configuration for
R2dbcEntityOperations.
Upgrade to Gradle Enterprise Maven Extension 1.6.1
Upgrade to Spring Security 5.4.0-SNAPSHOT
See gh-22668,Upgrade to Couchbase Java Client 3.0.7
Upgrade to Reactor 2020.0.0 SNAPSHOTs
See gh-22667,Merge pull request #21388 from aivinog1
* gh-21388:
  Polish "Test the launch script when executed directly"
  Test the launch script when executed directly
Polish "Test the launch script when executed directly"
See gh-21388,Test the launch script when executed directly
See gh-21388,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Fix syntax for slack notification
See gh-22709,Switch layering on by default
Make Slack build failure notifications more noticeable
Merge pull request #22699 from dreis2211
* pr/22699:
  Use Supplier variants of Assert methods
Use Supplier variants of Assert methods
See gh-22699,Merge branch '2.3.x'
Merge pull request #22704 from izeye
* pr/22704:
  Fix broken links to Micrometer registry docs
Fix broken links to Micrometer registry docs
See gh-22704,Reduce reflection in LoggingSystem to make it more Graal-friendly
Polish,Merge pull request #22696 from dreis2211
* gh-22696:
  Polish "Fix NPE in BeanDefinitionLoader when XML support is disabled"
  Fix NPE in BeanDefinitionLoader when XML support is disabled
Polish "Fix NPE in BeanDefinitionLoader when XML support is disabled"
See gh-22696,Fix NPE in BeanDefinitionLoader when XML support is disabled
See gh-22696,Merge branch '2.3.x'
Fix missing liveness and readiness indicators
Prior to this commit, the livenessState and readinessState health
indicators would not be configured automatically and would be missing
from the "liveness" and "readiness" health groups, leading to 404s when
hitting the `/actuator/health/liveness` or `/actuator/health/readiness`.
This commit ensures that the health indicators beans have the proper
name and revisits the auto-configuration conditions to reflect that as
well.
Fixes gh-22562,Merge branch '2.3.x'
Merge pull request #22631 from ttddyy
* gh-22631:
  Polish "Document properties to enable probe health indicators"
  Document properties to enable probe health indicators
Polish "Document properties to enable probe health indicators"
See gh-22631
Document properties to enable probe health indicators
Document property names to enable probe(readiness/liveness)
health indicators.
See gh-22631,Try to fix Windows-specific CI failures,Merge branch '2.3.x'
Merge pull request #22681 from biergit
* gh-22681:
  Polish "Look in correct context when finding Liquibase beans"
  Look in correct context when finding Liquibase beans
Polish "Look in correct context when finding Liquibase beans"
See gh-22681,Look in correct context when finding Liquibase beans
See gh-22681,Merge branch '2.3.x',Allow build-pr-project.sh to be executed
See gh-22645,Merge branch '2.3.x'
Document how to use Gradle's native bom support
Document how to re-enable DataSource auto-config when using R2DBC
Avoid having multiple wars when project's version changes
Fixes gh-21606,Merge branch '2.3.x'
Register ErrorPageFilter for async dispatch
Fixes gh-19471,Merge branch '2.3.x'
Clarify documentation on @AutoConfigureRestDocs with WebTestClient
Merge pull request #22646 from dreis2211
* gh-22646:
  Polish "Allow DurationFormat and PeriodFormat to be used on parameters"
  Allow DurationFormat and PeriodFormat to be used on parameters
Polish "Allow DurationFormat and PeriodFormat to be used on parameters"
See gh-22646,Allow DurationFormat and PeriodFormat to be used on parameters
See gh-22646,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x
Document that constructor binding does not support @…Unit annotations
Update CI images to use ubuntu:bionic-20200713
Update JDK 15 CI to use 2020-07-28-23-03
This upgrades to Spring Data 2020.0.0 snapshots which required some
changes in Spring Data REST and Spring Data Elasticsearch before
upgrading to Spring Data Neo4j 6.
Polish "Upgrade to Spring Data Neo4j 6"
See gh-22299,Upgrade to Spring Data Neo4j 6
See gh-22299,Upgrade to Elasticsearch 7.8.1
Start building against Spring Data 2020.0.0 snapshots
See gh-22647,Merge branch '2.3.x'
Build pull requests with --continue
Increase max heap of the Maven JVM
The overhead of build scans seems to have brought us right to the limit
of the Maven JVM's heap. As a result, builds are occasionally failing
as the heap's been exhausted.
This commit increases the JVM's max heap.
Revert back to /snapshot repository for SNAPTHOTs
See gh-22640,Add missing libs-snapshot repository declaration
See gh-22640,Merge branch '2.3.x'
Allow XADataSource auto-config with no spring.datasource properties
Fixes gh-20229,Upgrade to Spring Framework 5.3.0-SNAPSHOT
This commit also switches to RSocket SNAPSHOTs and updates the
repository configuration to rely on "libs-snapshot", since the RSocket
SNAPSHOTs are mirrored there.
See gh-22640,Merge branch '2.3.x'
Try to stabilise descendantOfPropertyAccess performance test
Allow exclude only health groups
Add expanded profile groups to environment
Fixes gh-22605,Merge branch '2.3.x'
Recommend the use of a MeterBinder when a metric depends on a bean
Merge pull request #22302 from meistermeier
* pr/22302:
  Polish "Update Neo4j health check to use the Neo4j Driver"
  Update Neo4j health check to use the Neo4j Driver
Polish "Update Neo4j health check to use the Neo4j Driver"
See gh-22302,Update Neo4j health check to use the Neo4j Driver
This commit replaces the Neo4j-OGM based health checks with one based on
the Neo4j Java driver. A Reactive variant is also added in this commit.
See gh-22302,Merge branch '2.3.x'
Fix actuator dependency on Jackson JSR 310 module
This commit harmonizes dependency declarations for Jackson in the
actuator. Both Jackson and JSR 310 are back to optional in the core
actuator module and mandatory when using the auto-configuration.
List DevTools in section overview of multi-page documentation
Merge pull request #22614 from runningcode
* gh-22614:
  Upgrade to Gradle Enterperise Maven Extension 1.6.0
Upgrade to Gradle Enterperise Maven Extension 1.6.0
See gh-22614,Merge branch '2.3.x'
Merge pull request #22616 from dreis2211
* gh-22616:
  Add ElasticsearchReactiveHealthIndicator to docs
Add ElasticsearchReactiveHealthIndicator to docs
See gh-22616,Merge branch '2.3.x'
Merge pull request #22598 from dreis2211
* gh-22598:
  Fix link to Elasticsearch health indicator
Fix link to Elasticsearch health indicator
See gh-22598,Merge branch '2.3.x'
Merge pull request #22604 from ttddyy
* gh-22604:
  Polish "Use milliseconds when configuring awaitTerminationPeriod"
  Use milliseconds when configuring awaitTerminationPeriod
Polish "Use milliseconds when configuring awaitTerminationPeriod"
See gh-22604,Use milliseconds when configuring awaitTerminationPeriod
Prior to this change, TaskExecutorBuilder used seconds as its precision
to map the awaitTerminationPeriod value. This caused a loss of
millisecond information in the period.
This commit fixes the loss by converting the period to millisecond and
using setAwaitTerminationMillis to configure the executor.
See gh-22604,Merge branch '2.3.x'
Update link to App Engine's Spring Boot sample
Improve deprecated exception message
Update the exception message so that it includes the class name of the
implementation.
See gh-22497,Merge branch '2.3.x',Polish,Merge branch '2.3.x'
Improve documentation about swapping one technical starter for another
Merge pull request #22301 from meistermeier
* pr/22301:
  Polish "Add auto-configuration for Neo4j driver"
  Add auto-configuration for Neo4j driver
Polish "Add auto-configuration for Neo4j driver"
See gh-22301,Add auto-configuration for Neo4j driver
This commit adds the support for creating a managed instance of the
Neo4j Java driver. The low-level support for Neo4j is helpful in
situations where the high-level abstraction of Spring Data Neo4j is not
needed.
See gh-22301,Merge branch '2.3.x'
\gh-22592
Define the reference doc authors in a single place
Describe MongoClientSettingsBuilderCustomizer in the documentation
Document the need for configuration files to have a file extension
Do not ignore unknown fields when invalid fields are being ignored
Previously, ignoring invalid fields would cause the failure for an
unknown field to be ignored, irrespective of the ignoreUnknownFields
attribute on `@ConfigurationProperties`.
This commit updates the NoUnboundElementsBindHandler to ensure that
any UnboundConfigurationPropertiesException is thrown rather than
being ignored when the handler has been wrapped by an
IgnoreErrorsBindHandler.
Fixes gh-22308,Merge branch '2.3.x'
Fix Mock|SpyBean context caching
The fix for gh-20916 updated DefinitionsParser so that the
ResolvableType for each MockBean or SpyBean field included the
implementation class from which the field was found. Where the field
was declared with a variable generic signature that was made constant
by its implementation class, this allowed the correct concrete type to
be determined. It also had the unintended side-effect of preventing two
test classes with identical `@MockBean` and `@SpyBean` configuration
from sharing a context as the resolvable types for their mock and spy
bean fields would now be different.
This commit updates DefinitionsParser to only include the
implementation class in the ResolvableType if the field's generic type
is variable. For cases where it is not variable, this restores the
behaviour prior to the fix for gh-20916.
Fixes gh-22566,Merge branch '2.3.x'
Defer background pre-init till the environment is prepared
Previously, background pre-init was started in response to the
application starting event. This meant that it would be running while
the logging turbo filter was in place and was rejecting all logging.
As a result, any logging performed during pre-init would be lost.
This commit changes background pre-init so that it is now started
in response to the application environment prepared event. By this
point, the logging turbo filter has been removed as the logging levels
have been configured from the environment.
Fix property-based configuration of Undertow socket options
Previously, only UndertowOptions was used as the source of options for
both server and socket options, but it only contains server options.
As a result, attempting to configure any socket options defined by
XNIO's Options class would fail.
This commit updates the property-based configuration of options to use
UndertowOptions as the source for server options and XNIO's Options as
the source for socket options.
Fixes gh-22502,Merge branch '2.3.x'
Include Jackson Modules in WebMvcTest and WebFluxTest
Fixes gh-22530,Merge branch '2.3.x'
Advise against java.util.Optional configuration properties
Fix CacheAutoConfiguration relative order for Couchbase
This commit fixes the auto-configuration of the Couchbase caching
support by configuring the cache once Spring Data Couchbase has gotten
a chance to be processed.
Merge pull request #22555 from runningcode
* gh-22555:
  Polish "Add generated-snippets as output to test goal"
  Add generated-snippets as output to test goal
Polish "Add generated-snippets as output to test goal"
See gh-22555,Add generated-snippets as output to test goal
The generated snippets were not declared as an output to the
`spring-boot-actuator-autoconfigure` test goal so when the test was
pulled from the cache, it did not contain the `generated-snippets`
directory. This directory is required as an input to the Asciidoctor
plugin.
See gh-22555,Merge pull request #22549 from izeye
* pr/22549:
  Polish
Polish
See gh-22549,Merge branch '2.3.x'
Fix typo for management.health.readinessstate.enabled
Merge pull request #21658 from bono007
* pr/21658:
  Polish "Disable metrics export in integration tests"
  Disable metrics export in integration tests
Polish "Disable metrics export in integration tests"
See gh-21658,Disable metrics export in integration tests
This commit introduces a new property to globally disable metrics
export. In integration tests, this property is automatically set to
disable everything but in-memory metrics.
This commit also introduces a `@AutoConfigureMetrics` annotation that
can be used for integration tests that require metrics export to operate
as they would in an application.
See gh-21658,Merge branch '2.2.x' into 2.3.x,Merge branch '2.1.x' into 2.2.x
Merge pull request #22550 from runningcode
* gh-22550:
  Disable extra scans for full profile.
Disable extra scans for full profile.
The extra scans were not disabled for the full profile, only the
regular profile.
See gh-22550,Merge branch '2.2.x' into 2.3.x,Merge branch '2.1.x' into 2.2.x,Polish integration of Gradle Enterprise in CI builds,Merge branch '2.2.x' into 2.3.x,Merge branch '2.1.x' into 2.2.x,Polish integration of Gradle Enterprise in CI builds,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Merge branch '2.1.x' into 2.2.x,Align gradle-enterprise-maven-extension versions,Merge pull request #22535 from dreis2211
* pr/22535:
  Polish
Polish
See gh-22535,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Merge branch '2.1.x' into 2.2.x
Merge pull request #22089 from runningcode
* gh-22089:
  Polish "Add Gradle Enterprise Extension"
  Add Gradle Enterprise Extension
Polish "Add Gradle Enterprise Extension"
See gh-22089,Add Gradle Enterprise Extension
This adds build caching and build scans.
The changes required disabling scans when using the maven invoker
plugin in order to not cause duplicate build scans when invoking other
maven builds. There is also an empty `.mvn` folder in the
spring-boot-starters project to prevent duplicate build scans as well
since there is no way to pass properties to the maven-javadoc-plugin.
The checkstyle plugin was causing a cache miss with the
`propertyExpansion` because it contains an absolute path. The absolute
path is now ignored and instead the files are added as inputs to the
checkstyle plugin. This only enables the local build cache. The remote
cache is not yet enabled.
On my local machine:
./mvnw clean install build times go from about 30 minutes to about 10 minutes.
./mvnw clean install -Pfull build times go from about 60 minutes to about 13 minutes.
See gh-22089,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Merge branch '2.3.x'
Override other variant of registerBeanDefintions
Fixes gh-22480,Next development version (v2.2.10.BUILD-SNAPSHOT),Merge pull request #22544 from dsyer
* gh-22544:
  Restore missing EnvironmentPostProcessors
Restore missing EnvironmentPostProcessors
See gh-22544,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Merge branch '2.1.x' into 2.2.x,Refine regex
See gh-22543,Move properties to correct file
See gh-22543
Allow certain artifacts to be optionally deployed
Update `DistributeCommand` so that regex patterns can be used to mark
artifacts that are optional and need not fail the release.
Deal with 404 response when checking for artifacts,Backport build script updates,Turn on debug logging,Next development version (v2.1.17.BUILD-SNAPSHOT),Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Upgrade to Jackson 2.10.5
Upgrade to AspectJ 1.9.6
Upgrade to Micrometer 1.3.11
Upgrade to Aspectj 1.9.6
Upgrade to Micrometer 1.1.16
Add EnvironmentPostProcessorsFactory
Update `EnvironmentPostProcessorApplicationListener` so that it can
either use values from `spring.factories` or use a factory interface.
Merge pull request #22524 from dreis2211
* pr/22524:
  Polish
Polish
See gh-22524,Add @Name support to the annotation processor
Update the `ConfigurationMetadataAnnotationProcessor` so that `@Name`
annotated parameters generate the correct meta-data.
Merge pull request #22506 from royclarkson
* gh-22506:
  Update conditional inclusion of milestone repository
Update conditional inclusion of milestone repository
The new Spring version schema does not include a "RELEASE" version.
This commit modifies the Gradle conditional to include the milestone
repository for all milestone and snapshot versions.
See gh-22506,Merge branch '2.3.x'
Upgrade to Groovy 2.5.13
Upgrade to Groovy 2.5.13
Upgrade Java 15 version in CI image
Upgrade Java 8 version in CI image
Upgrade Java 8 version in CI image
Upgrade Java 8 version in CI image
Add volume mount property source support
Add support for volume mounted directories where the filename becomes
the property key and the file contents becomes the value.
Support is provided via a dedicated `VolumeMountDirectoryPropertySource`
class which can either be used directly, or via a "volumemount:/..."
`spring.config.import` location.
\gh-19990
Co-authored-by: Phillip Webb <pwebb@vmware.com>,Add support for profile groups
Add support for profile groups so that users can combine a number of
fine-grained profiles into a single logical group.
Overhaul "externalized configuration" docs
Update the "externalized configuration" reference documentation
following the recent updates.
Provide ConfigFileApplicationListener replacement
Deprecate `ConfigFileApplicationListener` and provide a replacement
mechanism that supports arbitrary config data imports.
This commit updates the following areas:
- Extract `EnvironmentPostProcessor` invocation logic from the
  `ConfigFileApplicationListener` to new dedicated listener. Also
  providing support for `Log` injection.
- Extract `RandomPropertySource` adding logic from the
  `ConfigFileApplicationListener` to a dedicated class.
- Migrate to the recently introduced `DefaultPropertiesPropertySource`
  class when moving the defaultProperties `PropertySource`
- Replace processing logic with a phased approach to ensure that
  profile enablement happens in a distinct phase and that profiles
  can no longer be activated on an ad-hoc basis.
- Provide a more predictable and logical import order for processing
  `application.properties` and `application.yml` files.
- Add support for a `spring.config.import` property which can be used
  to import additional config data. Also provide a pluggable API
  allowing third-parties to resolve and load locations themselves.
- Add `spring.config.activate.on-profile` support which replaces the
  existing `spring.profiles` property.
- Add `spring.config.activate.on-cloud-platform` support which allows
  a config data document to be active only on a given cloud platform.
- Support a `spring.config.use-legacy-processing` property allowing the
  previous processing logic to be used.
\gh-22497
Co-authored-by: Madhura Bhave <mbhave@vmware.com>,Add Binder backed CloudPlatform.isEnforced method
Update `CloudPlatform` with a new `isEnforced` method that's backed
by a `Binder` rather than the `Environment`. We'll require this when
we overhaul our external config data processing logic.
Extract DefaultPropertiesPropertySource class
Extract `DefaultPropertiesPropertySource` from `SpringApplication` so
that logic can be easily accessed by other classes. Specifically the
property source name and logic to move the source to the end of the
list needs to be called from several places.
Add DeferredLogFactory support
Add a new `DeferredLogFactory` interface and `DeferredLogs`
implementation that can be used when a `DeferredLog` instance is needed
but the `switchOver` method should be handled elsewhere.
This interface has primarily been added so `EnvironmentPostProcessor`
classes will no longer need to implement `ApplicationEventListener`
just to switch over their logs.
Add multi-document properties file support
Update `OriginTrackedPropertiesLoader` so that it can support
multi-document properties files. These are similar to multi-document
YAML files but use `#---` as the separator.
\gh-22495
Co-authored-by: Phillip Webb <pwebb@vmware.com>,Add ConfigurationPropertySource.from method
Add a factory method to `ConfigurationPropertySource` that allows a
single Spring `PropertySource` instance to be adapted.
Filter empty YAML documents
Update `OriginTrackedYamlLoader` so that empty documents are filtered
from the result. Prior to this commit, our origin wrapper would confuse
the YAML processor and cause empty documents to be included in the Map
with a key of "document" and no value.
Add trailing escape character test
Update `OriginTrackedPropertiesLoaderTests` to also test that an escape
character can be the last character on a line.,Add @Name support for value object binding
Update value object binder support so that parameters can be annotated
with `@Name` if a specific property name should be used. Prior to this
commit is was not possible to use Java reserved words as property names.
Polish,Update copyright year of changed files,Polish,Merge branch '2.3.x',Update copyright year of changed files,Polish,Merge branch '2.2.x' into 2.3.x,Update copyright year of changed files,Polish,Merge branch '2.3.x',Upgrade to Spring Integration 5.3.2
Upgrade to Spring Integration 5.2.8
See gh-22505,Merge branch '2.3.x',Upgrade to Spring Data Neumann-SR2
Merge pull request #22499 from dreis2211
* gh-22499:
  Add plugin management for liquibase-maven-plugin
Add plugin management for liquibase-maven-plugin
See gh-22499,Merge branch '2.3.x'
Merge pull request #22488 from dreis2211
* gh-22488:
  Remove redundant compiler arguments in Gradle build files
Remove redundant compiler arguments in Gradle build files
See gh-22488,Do not attempt to use AprLifecycleListener in a native image
See gh-22107,Merge branch '2.3.x'
Improve liveness/readiness health config
Prior to this commit, the application availability infrastructure
would mix the `AvailabilityState`, the `HealthIndicator` and the
`HealthGroup` concepts and would not align with the rest.
This commit auto-configures the livenessState and readinessState
health indicators with the relevant configuration properties.
Unlike other indicators, they are not enabled by default but might
be in future versions.
This also moves the `management.health.probes.enabled` property
to `management.endpoint.health.probes.enabled` since "probes" here
is not a health indicator but rather a configuration flag for the
health endpoint.
Finally, the probes auto-configuration is refined to automatically
add liveness and readiness indicators for the probes group if
they're not already present.
Upgrade to Reactor Bom Dysprosium-SR10
\gh-22376
Upgrade to Tomcat 9.0.37
Upgrade to Solr 8.5.2
Upgrade to Netty 4.1.51.Final
Upgrade to Neo4j OGM 3.2.14
Upgrade to MySQL 8.0.21
Upgrade to MongoDB 4.0.5
Upgrade to Micrometer 1.5.2
Upgrade to MariaDB 2.6.1
Upgrade to Lettuce 5.3.2.RELEASE
Upgrade to Kotlin Coroutines 1.3.8
Upgrade to jOOQ 3.13.3
Upgrade to Johnzon 1.2.8
Upgrade to Jetty 9.4.30.v20200611
Upgrade to Jetty Reactive HTTPClient 1.1.4
Upgrade to Jakarta Servlet 4.0.4
Upgrade to Jackson Bom 2.11.1
Upgrade to HSQLDB 2.5.1
Upgrade to Hibernate 5.4.18.Final
Upgrade to Hazelcast 3.12.8
Upgrade to Flatten Maven Plugin 1.2.4
Upgrade to Dropwizard Metrics 4.1.11
Upgrade to DB2 JDBC 11.5.4.0
Upgrade to Couchbase Client 3.0.6
Upgrade to Caffeine 2.8.5
Upgrade to Byte Buddy 1.10.13
Upgrade to AppEngine SDK 1.9.81
Upgrade to ActiveMQ 5.15.13
Upgrade to Reactor Dysprosium-SR10
Upgrade to Spring Session Bom Corn-SR3
Upgrade to Neo4j Ogm 3.2.14
Upgrade to Kotlin Coroutines 1.3.8
Upgrade to Hsqldb 2.5.1
Upgrade to Hibernate 5.4.18.Final
Upgrade to Jetty 9.4.30.v20200611
Upgrade to Tomcat 9.0.37
Upgrade to Johnzon Jsonb 1.2.8
Upgrade to Activemq 5.15.13
Upgrade to Byte Buddy 1.10.13
Upgrade to Mysql 8.0.21
Upgrade to Jakarta Servlet 4.0.4
Upgrade to Netty 4.1.51.Final
Upgrade to Micrometer 1.3.10
Upgrade to Dropwizard Metrics 4.1.11
Upgrade to Db2 Jdbc 11.5.4.0
Upgrade to Hazelcast 3.12.8
Upgrade to Appengine Sdk 1.9.81
Upgrade to Caffeine 2.8.5
Upgrade to Couchbase Client 2.7.16
Upgrade to Reactor Californium-SR20
Upgrade to Spring Session Bom Bean-SR11
Upgrade to Neo4j Ogm 3.1.20
Upgrade to Jetty 9.4.30.v20200611
Upgrade to Tomcat 9.0.37
Upgrade to Activemq 5.15.13
Upgrade to Mysql 8.0.21
Upgrade to Netty 4.1.51.Final
Upgrade to Micrometer 1.1.15
Upgrade to Appengine Sdk 1.9.81
Upgrade to Jackson 2.9.10.20200621
Upgrade to Couchbase Client 2.7.16
Make DefaultErrorAttributes easier to subclass for message customization
Reinstate jetty-jndi exclusion in spring-boot-starter-jetty
Fixes gh-22241,Merge branch '2.3.x'
Avoid trivialising what the reader's learning about
Merge pull request #22392 from sdeleuze
* gh-22392:
  Ignore BackgroundPreinitializer in native images
Ignore BackgroundPreinitializer in native images
BackgroundPreinitializer is not relevant in native images so it is
better to ignore it automatically in order to reduce the footprint
in such environment.
See gh-22392,Perform enablement checks once in BackgroundPreinitializer
Merge pull request #22397 from dreis2211
* pr/22397:
  Remove version management for exec-maven plugin
Remove version management for exec-maven plugin
See gh-22397,Merge pull request #22367 from Julien-Eyraud
* gh-22367:
  Polish "Add properties for Netty HttpDecoderSpec"
  Add properties for Netty HttpDecoderSpec
Polish "Add properties for Netty HttpDecoderSpec"
See gh-22367,Add properties for Netty HttpDecoderSpec
See gh-22367,Merge branch '2.3.x'
Merge pull request #22320 from fernandezseb
* gh-22320:
  Polish "Add failure analyzer for missing Liquibase changelog"
  Add failure analyzer for missing Liquibase changelog
Polish "Add failure analyzer for missing Liquibase changelog"
See gh-22320,Add failure analyzer for missing Liquibase changelog
See gh-22320,Upgrade to R2DBC Arabba-SR6
See gh-22390,Start building against Spring Integration 5.3.2 snapshots
See gh-22389,Start building against Spring Data Neumann-SR2 snapshots
See gh-22388,Start building against Spring AMQP 2.2.9 snapshots
See gh-22387,Merge branch '2.2.x' into 2.3.x,Merge branch '2.1.x' into 2.2.x,Start building against Spring Kafka 2.3.10 snapshots
See gh-22386,Start building against Spring Integration 5.2.8 snapshots
See gh-22385,Start building against Spring Data Moore-SR9 snapshots
See gh-22384,Start building against Spring AMQP 2.2.9 snapshots
See gh-22383,Start building against Spring Data Lovelace-SR18 snapshots
See gh-22382,Merge branch '2.3.x'
Start building against Reactor Dysprosium-SR10 snapshots
See gh-22376,Start building against Spring Framework 5.2.8 snapshots
See gh-22375,Merge branch '2.2.x' into 2.3.x,Start building against Reactor Dysprosium-SR10 snapshots
See gh-22374,Start building against Spring Framework 5.2.8 snapshots
See gh-22372,Merge branch '2.1.x' into 2.2.x,Start building against Reactor Californium-SR20 snapshots
See gh-22371,Start building against Spring Framework 5.1.17 snapshots
See gh-22370,Merge branch '2.3.x'
Configure path sensitivity of tasks' file inputs
Merge pull request #22296 from fernandezseb
* pr/22296:
  Polish "Restructure "Building Container Images" section"
  Restructure "Building Container Images" section
Polish "Restructure "Building Container Images" section"
See gh-22296,Restructure "Building Container Images" section
See gh-22296,Avoid using reflection to create SpringApplication's context
Merge pull request #22344 from dreis2211
* pr/22344:
  Handle null items as advertized in the Javadoc
Handle null items as advertized in the Javadoc
See gh-22344,Update JDK 14 CI image to use 14.0.2_12
Update JDK 11 CI image to use 11.0.8_10
Update JDK 15 CI to use 2020-07-15-08-59
Find nearest milestone for forward merge with .x pattern
Fixes gh-22350,Merge branch '2.3.x'
Restore accidentally deleted line,Fail on bootBuildImage with launch script
This commit adds a check to the support code for the Gradle plugin
bootBuildImage task to ensure that the jar file that will be passed
to a builder is readable and has a valid directory. This prevents a
situation where the jar file cannot be read because it is prepended
with a launch script, and the builder does not receive any files to
process.
Notes have also been added to the Gradle plugin documentation to warn
against using a bootJar launchScript configuration and bootBuildImage
together, as well as caveats about launchScript that match the Maven
plugin documentation.
Fixes gh-22223,Merge pull request #22329 from fhanik
* gh-22329:
  Polish "Avoid using reflection when configuring Tomcat listener"
  Avoid using reflection when configuring Tomcat listener
Polish "Avoid using reflection when configuring Tomcat listener"
See gh-22329,Avoid using reflection when configuring Tomcat listener
This benefits native image building and AOT compilation,
as reflection requires manual configuration.
See gh-22329,Merge branch '2.3.x'
Clarify the effects of ordering auto-configuration classes
Polish,Avoid reflection when creating manual RootBeanDefinitions
Merge pull request #22330 from dreis2211
* pr/22330:
  Avoid unnecessary allocations in ConditionMessage for NORMAL style
Avoid unnecessary allocations in ConditionMessage for NORMAL style
See gh-22330,Broaden cast as registry may be a GenericApplicationContext
* pr/21219:
  Polish "Add additional properties to configure R2DBC pool"
  Add additional properties to configure R2DBC pool
Polish "Add additional properties to configure R2DBC pool"
See gh-21219,Add additional properties to configure R2DBC pool
See gh-21219,Merge branch '2.3.x'
Merge pull request #22112 from dreis2211
* gh-22112:
  Cleanup temporary files after Maven plugin execution
Cleanup temporary files after Maven plugin execution
See gh-22112,Merge branch '2.3.x'
Merge pull request #22294 from dreis2211
* gh-22294:
  Reduce started threads in OnClassCondition
Reduce started threads in OnClassCondition
Prior to this commit, OnClassCondition started a thread even if the number of
passed autoconfiguration class candidates never exceeded 1. This commit only
starts a thread if there is actually work to split in half.
See gh-22294,Avoid using reflection with manual bean definitions
Replace ConfigurationPropertiesBeanDefinitionValidator with a FailureAnalyzer
Previously, regular bean definitions for configuration properties classes
that attempt to use constructor binding were detected in a bean factory
post-processor, ConfigurationPropertiesBeanDefinitionValidator. This
validation examined every standard bean definition and failed if it
encountered one for a class that should have used constructor binding.
There were two downsides to this approach:
1. Reflection used to identify if the bean should be using constructor
   binding triggered class loading that could prevent subsequent
   instrumentation by a load-time weaver.
2. The cost of the validation was incurred when there was no
   misconfiguration to report.
This commit replaces ConfigurationPropertiesBeanDefinitionValidator
with a failure analyzer. This failure analyzer only runs once a failure
has occurred and the application context is not going to complete
refresh. This avoids causing problems with subsequent instrumentation
and also avoids the cost of validation and error reporting unless there
is an error.
Fixes gh-20798,Merge branch '2.3.x'
Update WebServerInitEvent docs to reflect ordering w.r.t. refresh
Fix handling of DOCKER_HOST that begins with unix://
Fixes gh-22300,Add option to configure PathPatternParser
As of Spring Framework 5.3, it is now possible to use `PathPatternParser`
to parse and match request mapping path patterns, as an alternative to
the current default `AntPathMatcher`.
This new implementation has been used for a while in Spring WebFlux and
it’s been designed for consistency and performance.
This commit introduces a new configuration property for opting-in this
new variant:
`spring.mvc.pathmatch.matching-strategy=path_pattern_parser`
The default option is still `ant_path_matcher` for now, but we might
change the default in future versions since Spring Framework considers
it the best choice for modern applications.
There are several behavior differences with this new variant:
* double wildcards `"**"` are rejected when used in the middle patterns,
this is only allowed as the last matching segment in a pattern.
* it is incompatible with some path matching options, like
suffix-pattern, registered-suffix-pattern or configuring a Servlet
prefix on the `DispatcherServlet` (`spring.mvc.servlet.path=/test`)
This commit introduces two `FailureAnalyzer` implementations to guide
developers when facing those issues.
Test the Gradle plugin against Gradle 6.5.1
Upgrade to Gradle 6.4.1
Extend DefaultTask rather than AbstractTask in buildSrc
Upgrade to Infinispan 11.0.1.Final
This commit upgrade to Infinispan 11.0.1.Final and update dependency
management to use the bom now that it declares all the modules that
the project ships. See gh-19791
Try to make ConfigurationPropertySourcesTests perf tests more robust
Previously, the tests used absolute values to verify that the work
had completed sufficiently quickly. This led to flaky tests in
environments where the performance can be variable such as CI.
This commit tries to make the tests more robust by comparing the
performance to a baseline and requiring it to be twice as fast.
Rework spring-boot-docs to be a full-blown java project
Previously, spring-boot-docs used the java-base-plugin and then added
configuration on top. This has proven to be error prone, with the most
recent problem being that the tests were not being compiled and run.
This commit changes approach and applies the java plugin to the project
instead of the java-base plugin. Now, rather than adding the necessary
configuration to the base, the unwanted pieces of the java plugin's
configuration – specifically the jar and javadoc tasks – are disabled
instead. The DeployedPlugin has also been updated so that it does not
create a publication from the java component for projects that have a
disabled jar task.
Merge pull request #21746 from encircled
* pr/21746:
  Polish "Allow data unit to be specified on the constructor parameter"
  Allow data unit to be specified on the constructor parameter
Polish "Allow data unit to be specified on the constructor parameter"
See gh-21746,Allow data unit to be specified on the constructor parameter
See gh-21746,Merge branch '2.3.x'
Make reactive Jetty auto-config back off without jetty-servlet
Fixes gh-22275,Merge pull request #22266 from dreis2211
* gh-22266:
  Polish "Measure with nanoseconds in HttpExchangeTracer"
  Measure with nanoseconds in HttpExchangeTracer
Polish "Measure with nanoseconds in HttpExchangeTracer"
See gh-22266,Measure with nanoseconds in HttpExchangeTracer
See gh-22266,Merge pull request #22274 from fernandezseb
* gh-22274:
  Fix dead link url and name of the STS download link
Fix dead link url and name of the STS download link
See gh-22274,Merge branch '2.3.x'
Upgrade CI images to use ubuntu:bionic-20200630
Update JDK 15 CI to use 2020-07-08-05-49
Improve Redis URL validation
This commit improves the validation of URLs provided in the property
'spring.redis.url' used to auto-configure a Spring Data Redis
connection. In particular, only the URL schemes 'redis://' and
'rediss://' are allowed, and any other scheme will result in a
configuration error. A failure analyzer is also provided to improve
diagnostics for common mis-configurations detected by this validation.
Fixes gh-21999,Merge branch '2.3.x'
Link to application properties section from externalized config list
Honor spring.autoconfigure.exclude in test slices
Previously, the import selector for `@ImportAutoConfiguration` did not
consider the spring.autoconfigure.exclude property when determining
which auto-configurations to exclude. This meant that tests using a
slice that included a particular auto-configuration would include it
even if the application's configuration excluded it via
spring.autoconfigure.exclude. Confusingly, this could result in a
sliced test using an auto-configuration that would be excluded in a
broader `@SpringBootTest`.
This commit updates the ImportAutoConfigurationImportSelector to
consider the spring.autoconfigure.exclude property so that sliced tests
will use a subset of the auto-configurations that a `@SpringBootTest`
would use.
Fixes gh-21736,Merge pull request #22261 from izeye
* pr/22261:
  Replace ReflectionUtils with AssertJ's extracting()
Replace ReflectionUtils with AssertJ's extracting()
See gh-22261,Merge branch '2.3.x'
Auto-configure Rabbit CF with credentials provider and refresh service
\gh-22016
Merge pull request #22240 from izeye
* pr/22240:
  Polish ErrorPage.equals()
Polish ErrorPage.equals()
See gh-22240,Streamline OAuth2 resource server auto-config class conditions
Fixes gh-22233,Merge branch '2.3.x'
Disable bean method proxying in SpringBootJdbcConfiguration
Fix handling of NestedServletException with no root cause
Fixes gh-22169,Merge pull request #21913 from dreis2211
* gh-21913:
  Use Class.getDeclaredConstructor().newInstance()
Use Class.getDeclaredConstructor().newInstance()
See gh-21913,Merge branch '2.3.x'
Merge pull request #22207 from Sineaggi
* gh-22207:
  Polish "Rename NoneOfNestedConditions to NoneNestedConditions in example docs"
  Rename NoneOfNestedConditions to NoneNestedConditions in example docs
Polish "Rename NoneOfNestedConditions to NoneNestedConditions in example docs"
See gh-22207,Rename NoneOfNestedConditions to NoneNestedConditions in example docs
See gh-22207,Merge pull request #22212 from XenoAmess
* gh-22212:
  Polish "Remove redundant bitwise operations"
  Remove redundant bitwise operations
Polish "Remove redundant bitwise operations"
See gh-22212,Remove redundant bitwise operations
See gh-22212,Merge pull request #22209 from XenoAmess
* gh-22209:
  Use valueOf rather than parseInt as result is assigned to an int
Use valueOf rather than parseInt as result is assigned to an int
See gh-22209,Merge pull request #22213 from XenoAmess
* gh-22213:
  Polish "Remove redundant close() call from JarResourceManagerTests"
  Remove redundant close() call from JarResourceManagerTests
Polish "Remove redundant close() call from JarResourceManagerTests"
See gh-22213,Remove redundant close() call from JarResourceManagerTests
See gh-22213,Merge pull request #22211 from XenoAmess
* gh-22211:
  Polish "Use new ArrayList(Collection) rather than new and addAll"
  Use new ArrayList(Collection) rather than new and addAll
Polish "Use new ArrayList(Collection) rather than new and addAll"
See gh-22211,Use new ArrayList(Collection) rather than new and addAll
See gh-22211,Merge pull request #22210 from XenoAmess
* gh-22210:
  Use new ArrayList(Collection) rather than new, iterate, and add
Use new ArrayList(Collection) rather than new, iterate, and add
See gh-22210,Merge pull request #22218 from XenoAmess
* gh-22218:
  Fix typos in test code
Fix typos in test code
See gh-22218,Merge branch '2.3.x'
Merge pull request #22214 from XenoAmess
* gh-22214:
  Polish "Fix unwrapping of captured PrintStream in test support's OutputCapture"
  Fix unwrapping of captured PrintStream in test support's OutputCapture
Polish "Fix unwrapping of captured PrintStream in test support's OutputCapture"
See gh-22214,Fix unwrapping of captured PrintStream in test support's OutputCapture
See gh-22214,Merge pull request #22222 from juliojgd
* gh-22222:
  Polish "Optionally ignore routing data sources when creating DB health indicators"
  Optionally ignore routing data sources when creating DB health indicators
Polish "Optionally ignore routing data sources when creating DB health indicators"
See gh-22222,Optionally ignore routing data sources when creating DB health indicators
See gh-22222,Merge branch '2.3.x'
Add support for ChronoUnit.WEEKS when using PeriodUnit
Fixes gh-22225,Merge branch '2.3.x',Correct class name of StringToPeriodConverterTests,Merge branch '2.3.x'
Improve testing of PropertyPlaceholderAutoConfiguration
Since Spring Framework 4.3.0.RC2, a default embedded value resolver
has been registered with the bean factory when one is not otherwise
configured. This meant that placeholders in `@Value` would be resolved
with or without PropertyPlaceholderAutoConfiguration defining a
PropertySourcesPlaceholderConfigurer bean. However, placeholders in
bean definitions would only be resolved if a
PropertySourcesPlaceholderConfigurer was defined.
This commit updates PropertyPlaceholderAutoConfigurationTests to align
with this change in Framework. We now test that placeholders are
resolved in `@Value` annotations with or without the auto-configuration
and that placeholders in bean definitions are only resolved with the
auto-configured.
Merge pull request #22227 from anshlykov
* gh-22227:
  Update to Maven Shade Plugin 3.2.4
Update to Maven Shade Plugin 3.2.4
See gh-22227,Merge branch '2.3.x',Polish
See gh-21921,Merge branch '2.3.x'
Polish support for reactive Elasticsearch healthcheck
Fixes gh-21042,Add support for reactive Elasticsearch healthcheck
Prior to this commit, configuring a reactive Elasticsearch client would
auto-configure an Actuator Health check using a synchronous client, with
the default configuration properties (so tarting localhost:9200).
This would lead to false reports of unhealthy Elasticsearch clusters
when using reactive clients.
This commit reproduces the logic for MongoDB repositories: if a reactive
variant is available, it is selected for the health check
infrastructure.
See gh-21042,Merge branch '2.3.x'
Use source sets to determine configurations deprecated for resolution
Fixes gh-22200,Merge branch '2.3.x'
Ignore scoped targets when finding matching beans
Fixes gh-22038,Use ApplicationContextRunner in ConditionalOnSingleCandidateTests,Merge branch '2.3.x'
Upgrade CI to Docker 19.03.12
Update JDK 15 CI to use 2020-07-01-07-28
Merge pull request #21921 from eddumelendez
* gh-21921:
  Reinstate metrics for Kafka Streams
Reinstate metrics for Kafka Streams
See gh-21921,Merge branch '2.3.x',Upgrade to Spring Kafka 2.5.3.RELEASE
Merge pull request #22110 from dreis2211
* gh-22110:
  Improve error handling in JDK upgrade checks
Improve error handling in JDK upgrade checks
See gh-22110,Merge branch '2.3.x',Upgrade to Reactor Dysprosium-SR9
Improve error handling when builder image isn't a builder
Fixes gh-22179,Merge pull request #21289 from filiphr
* gh-21289:
  Polish "Add properties to control exceptions ignored by LdapTemplate"
  Add properties to control exceptions ignored by LdapTemplate
Polish "Add properties to control exceptions ignored by LdapTemplate"
See gh-21289,Add properties to control exceptions ignored by LdapTemplate
See gh-21289,Merge pull request #22178 from dreis2211
* gh-22178:
  Remove redundant deprecation suppression
Remove redundant deprecation suppression
See gh-22178,Merge branch '2.3.x'
Merge pull request #22138 from dreis2211
* gh-22138:
  Accept empty filter dispatcher types in auto-configurations
Accept empty filter dispatcher types in auto-configurations
Prior to this commit, the usage of EnumSet.copyOf resulted in exceptions when
the underlying collection was empty.
See gh-22138,Suggest iso-offset as value for WebFlux time and date-time properties
Merge pull request #21630 from gaurav-91
* gh-21630:
  Polish "Support iso-offset for date-time and time formatting with MVC"
  Support iso-offset for date-time and time formatting with MVC
Polish "Support iso-offset for date-time and time formatting with MVC"
See gh-21630,Support iso-offset for date-time and time formatting with MVC
See gh-21630,Merge branch '2.3.x'
Add package info to o.s.b.autoconfigure.elasticsearch.rest
\gh-22170
Merge pull request #22163 from XenoAmess
* gh-22163:
  Remove duplicated icon from git-repo-windows resource definition
Remove duplicated icon from git-repo-windows resource definition
See gh-22163,Merge branch '2.3.x'
Merge pull request #22141 from im47cn
* gh-22141:
  Polish "Avoid NPE when binder is closed before started event"
  Avoid NPE when binder is closed before started event
Polish "Avoid NPE when binder is closed before started event"
See gh-22141,Avoid NPE when binder is closed before started event
Previously, if TomcatMetricsBinder destroy() was called before it had
received an ApplicationStartedEvent an NPE would be thrown due to
TomcatMetrics being null. This NPE was then caught and logged at
warning level by the disposable bean adapter.
This prevents the NPE by checking that the TomcatMetrics instance is
null before calling close() on it.
See gh-22141,Support incremental annotation processing with Gradle
Use TCCL at time of access for resource loading
Fixes gh-22119,Merge branch '2.3.x'
Merge pull request #22082 from thenx-wei
* pr/22082:
  Simplify logic in ErrorPage's equals method
Simplify logic in ErrorPage's equals method
See gh-22082,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Merge branch '2.1.x' into 2.2.x,Fix typo,Merge branch '2.3.x'
Merge pull request #22090 from izeye
* pr/22090:
  Polish
Polish
See gh-22090,Merge branch '2.3.x',Fix typo,Merge branch '2.3.x'
Update layers.idx file example in docs
Fixes gh-21510,Make spring-boot -dependencies and -parent available
See gh-22066,Only create effective bom artifact when needed
Upgrade to Spring Session 2020.0.0-M1
Merge pull request #22125 from lndobryden
* gh-22125:
  Polish "Add StatsD transport protocol configuration option"
  Add StatsD transport protocol configuration option
Polish "Add StatsD transport protocol configuration option"
See gh-22125,Add StatsD transport protocol configuration option
See gh-22125,Merge pull request #22120 from kedar-joshi
* gh-22120:
  Upgrade to Flyway 6.5.0 and support createSchemas
Upgrade to Flyway 6.5.0 and support createSchemas
See gh-22120,Switch to a RuntimeException as NPE has a message on Java 15
Upgrade to WebJars Locator Core 0.46
Upgrade to Spring Kafka 2.5.3.RELEASE
Upgrade to Oracle Database 19.7.0.0
Upgrade to Micrometer 1.5.2
Upgrade to MariaDB 2.6.1
Upgrade to Jackson Bom 2.11.1
Upgrade to Hazelcast 3.12.8
Upgrade to Spring AMQP 2.3.0-M1
Upgrade to Spring Batch 4.3.0-M1
Drop back to Spring Security 5.4.0-M1
See gh-21932,Upgrade to Spring Integration 5.4.0-M1
Improve validation of layertools input
This commit improves the validation performed on the user
input provided to the layertools jarmode to provide more
clear error messages when the input is not correct and
reduce the chance of ambiguity.
Fixes gh-22042,Merge pull request #221144 from jfarcand
* gh-221144:
  Update Atmosphere versions used in smoke test
Update Atmosphere versions used in smoke test
See gh-221144,Trim trailing whitespace from value of logging.config
Disable LogbackLoggingSystem's XML support when spring.xml.ignore=true
Update JDK 15 CI to use 2020-06-24-06-14
Merge pull request #22093 from sdeleuze
* gh-22093:
  Polish "Disable XML reader when spring.xml.ignore is true"
  Disable XML reader when spring.xml.ignore is true
Polish "Disable XML reader when spring.xml.ignore is true"
See gh-22093,Disable XML reader when spring.xml.ignore is true
This commit allows to set the XmlBeanDefinitionReader field from
BeanDefinitionLoader to null in a way that allows the GraalVM native
compiler to remove it from the native image when the spring.xml.ignore
flag introduced by spring-projects/spring-framework#25151
is set to true.
The purpose of this change is to allow smaller footprint on native
images without requiring to use GraalVM native substitutions
which are unmaintainable by nature and also to increase the consistency
between JVM and native images.
In order to effective, this optimization requires BeanDefinitionLoader
class to be initialized at build time.
See gh-22093,Polish 16263e3
See gh-22105,Upgrade to Spring Data Bom 2020.0.0-M1
Upgrade to Spring Framework 5.3.0-M1
Upgrade to Reactor Bom 2020.0.0-M1
Move bean definition counting only used in tests into test code
Remove WebClient's in-memory buffer size limit for endpoint tests
Previously, the thread dump endpoint's response could exceed
WebClient's in-memory buffer limt when there were a large number of
threads or the threads had large stacks.
This commit disables WebClient's in-memory buffer size limit so that
the test passing is not dependent on the number of active threads and
their stack sizes.
Provide cluster info in RedisReactiveHealthIndicator
This commit changes the information provided by
RedisReactiveHealthIndicator to include cluster details when Spring
Data Redis detects that Redis is running in a clustered configuration.
This brings the reactive and non-reactive Redis health indicators
into alignment.
Fixes gh-21514,Merge branch '2.3.x'
Fixes gh-22061 in 2.3.2,Fix RedisReactiveHealthIndicator in clustered configuration
Prior to Spring Data Redis version 2.2.8, the contents of the
Properties object returned from the
ReactiveRedisConnection.ServerCommands.info API were the same
for clustered and non-clustered Redis configurations, containing a set
of key/value pairs. This allowed ReactiveRedisHealthIndicator to get
a version property using a well-known key. Starting with Spring Data
Redis 2.2.8, the info property keys contain a host:port prefix in a
clustered Redis configuration. This prevented
ReactiveRedisHealthIndicator from getting the version property as
before and resulted in the health always being reported as DOWN.
This commit adjusts ReactiveRedisHealthIndicator to detect the
clustered configuration from Spring Data Redis and find the version
property for one of the reported cluster nodes.
Fixes gh-22061,Start building against Spring Session 2020.0.0-M1 snapshots
See gh-21928,Start building against Spring Security 5.4.0-M2 snapshots
See gh-21932,Start building against Spring Integration 5.4.0-M1 snapshots
See gh-21931,Restrict JLine version to 2.11 to avoid breaking changes in 2.12+
Use Groovy's bom in spring-boot-dependencies
Upgrade to Testcontainers 1.14.3
Upgrade to MockK 1.10.0
Upgrade to Maven Shade Plugin 3.2.4
Upgrade to Maven Resolver 1.4.2
Upgrade to Commons Compress 1.20
Upgrade to Maven Shade Plugin 3.2.4
Upgrade to Maven Resolver 1.4.2
Use bom plugin to configure spring-boot-parent
Merge pull request #22022 from polarbear567
* pr/22022:
  Polish 'Inherit show-details property in health groups'
  Inherit show-details property in health groups
Polish 'Inherit show-details property in health groups'
Rework the inheritance so that the property metadata JSON more
accurately reflects the default value.
See gh-22022,Inherit show-details property in health groups
Update `Group` properties so that the `showDetails` value does not
inherit `Show.NEVER`. Prior to this commit, the `Group` properties
would not correctly inherit a `showDetails` value from the main
`management.endpoint.health.show-details` property.
See gh-22022,Merge branch '2.3.x',Rename ImageReferenceParser to Regex
Rename `ImageReferenceParser` to `Regex` and remove state. The regular
expressions are now used directly by the `ImageName` and
`ImageReference` classes with the values accessed directly from the
`Matcher`.
See gh-21495,Upgrade to SQLite JDBC 3.32.3
Upgrade to Jetty Reactive HTTPClient 1.1.4
Upgrade to Jakarta Servlet 4.0.4
Upgrade to Hibernate 5.4.18.Final
Upgrade to Byte Buddy 1.10.12
\gh-22059
Merge pull request #22040 from Konrado85
* pr/22040:
  Polish 'Fix infinite loop in FieldValues'
  Fix infinite loop in FieldValues
Polish 'Fix infinite loop in FieldValues'
See gh-22040,Fix infinite loop in FieldValues
Update `FieldValues` test object so that it doesn't cause an infinite
loop if it is actually created.
See gh-22040,Upgrade to Cassandra Driver 4.7.2
Starting building against Spring Data 2020.0.0 snapshots
See gh-21930,Start building against Spring Framework 5.3.0 snapshots
See gh-21929,Start building against Reactor 2020.0.0 snapshots
See gh-21927,Merge branch '2.3.x'
Enforce spring-boot-parent's platform dependencies
Merge pull request #22035 from dreis2211
* gh-22035:
  Catch more generic FileSystemException in NamedPipeSocket
Catch more generic FileSystemException in NamedPipeSocket
See gh-22035,Merge branch '2.3.x'
Merge pull request #22018 from izeye
* pr/22018:
  Remove Javadoc throw for ConfigurationPropertyName.ofIfValid()
Remove Javadoc throw for ConfigurationPropertyName.ofIfValid()
See gh-22018,Merge branch '2.3.x'
Merge pull request #22000 from mla-mpensdavila
* pr/22000:
  Polish "Document how to exclude an annotation processor with Maven"
  Document how to exclude an annotation processor with Maven
Polish "Document how to exclude an annotation processor with Maven"
See gh-22000,Document how to exclude an annotation processor with Maven
See gh-22000,Merge branch '2.3.x'
Only consider current context when finding lifecycle processor
Previously, LifecycleAutoConfiguration would check the current context
and all of its ancestors for a lifecycle processor bean, only
configuring a custom processor if one was not found. Every context
has a lifecycle processor so this check meant that lifecycle processing
timeout could not be customized in any context with a parent.
This commit updates the auto-configuration to only check the current
context.
Merge pull request #21988 from tszmytka
* gh-21988:
  Polish "Use Awaitility instead of Thread.sleep"
  Use Awaitility instead of Thread.sleep
Polish "Use Awaitility instead of Thread.sleep"
See gh-21988,Use Awaitility instead of Thread.sleep
See gh-21988,Merge branch '2.3.x'
Validate image references before passing to CNB builder
Prior to this commit, an image name or run image name derived from
the project name or provided by the user would be passed to the CNB
builder without validation by the Maven plugin build-image goal or
Gradle plugin bootBuildImage task. This could lead to error messages
from the plugins that are difficult to understand and diagnose.
This commit makes parsing of the image names more strict, based on
the grammar implemented by the Docker go library. This provides
validation of the image names before passing them to the builder,
with a more descriptive error message when parsing and validation
fails.
Fixes gh-21495,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Only process main metadata as it already includes additional metadata
Previously, the configuration property table generation was reading
both the main metadata and the additional metadata from each project.
This was unnecessary as the annotation processor will have already
merged the additional metadata into the main metadata before writing
it to disk. Processing both the main and additional metadata led to
a clash as the metadata overlapped. When the entry in the additional
metadata won the clash, the resulting entry in the configuration
property table would lose any details that aren't contained in the
additional metadata.
This commit updates the property table generation code to only use
the main metadata files.
Fixes gh-21131,Merge branch '2.3.x'
Configure context on SizeAndTimeBasedRollingPolicy
Previously, when file-based logging was enabled, Logback would output
the following during logging system initialization:
LOGBACK: No context given for c.q.l.core.rolling.SizeAndTimeBasedRollingPolicy
This commit updates the default logback configuration to set the
context on the SizeAndTimeBasedRollingPolicy that it creates.
Fixes gh-21056,Merge branch '2.3.x'
Prevent oauth2-oidc-sdk from downgrading json-smart in Maven projects
Fixes gh-21939,Merge branch '2.3.x'
Merge pull request #21986 from dreis2211
* pr/21986:
  Use lazy lambda instead of explicit argument
Use lazy lambda instead of explicit argument
See gh-21986,Merge branch '2.3.x'
Update CI images to use ubuntu:bionic-20200526
Update JDK 15 CI to use 2020-06-17-05-44
Make MockBean resolve right type for abstract test class
Fixes gh-20916,Merge branch '2.3.x',Correct additions to spring-boot-starter-parent's pom
Following the fix for gh-21989, spring-boot-starter-parent no longer
contains an <issueManagement> element. As a result the additional
content was no longer being added to the pom. This commit updates
the additions so that they are now added after the <scm> element
that is still present.
See gh-21989,Merge branch '2.3.x'
Minimize contents of poms that are an ancestor of a user's pom
Fixes gh-21989,Remove plugin management for Flatten Maven Plugin
Enable varargs compilation warnings
See gh-21271,Enable rawtypes compilation warnings
See gh-21271,Enable deprecation compilation warnings
See gh-21271,Enable unchecked compilation warnings
See gh-21271,Treat warnings as errors when compiling
See gh-21271,Upgrade to Undertow 2.1.3.Final
Upgrade to Tomcat 9.0.36
Upgrade to Spring Retry 1.3.0
Upgrade to Spring Kafka 2.5.2.RELEASE
Upgrade to Spring Batch 4.2.4.RELEASE
Upgrade to Spring AMQP 2.2.7.RELEASE
Upgrade to SendGrid 4.6.0
Upgrade to Selenium HtmlUnit 2.41.0
Upgrade to RSocket 1.0.1
Upgrade to R2DBC Bom Arabba-SR5
Upgrade to Postgresql 42.2.14
Upgrade to Oracle Database 19.6.0.0
Upgrade to OkHttp3 3.14.9
Upgrade to OAuth2 OIDC SDK 7.5
Upgrade to Netty tcNative 2.0.31.Final
Upgrade to Netty 4.1.50.Final
Upgrade to Neo4j OGM 3.2.12
Upgrade to MongoDB 4.0.4
Upgrade to Maven War Plugin 3.3.0
Upgrade to Log4j2 2.13.3
Upgrade to Liquibase 3.10.0
Upgrade to Lettuce 5.3.1.RELEASE
Upgrade to Kotlin Coroutines 1.3.7
Upgrade to Johnzon 1.2.7
Upgrade to Jetty 9.4.30.v20200611
Upgrade to Jetty Reactive HTTPClient 1.1.3
Upgrade to Jersey 2.31
Upgrade to Jaybird 3.0.9
Upgrade to Javax Money 1.1
Upgrade to InfluxDB Java 2.19
Upgrade to HtmlUnit 2.41.0
Upgrade to Hibernate 5.4.17.Final
Upgrade to Groovy 2.5.12
Upgrade to Flyway 6.4.4
Upgrade to Elasticsearch 7.7.1
Upgrade to Dropwizard Metrics 4.1.9
Upgrade to Couchbase Client 3.0.5
Upgrade to Caffeine 2.8.4
\gh-21945
Upgrade to Byte Buddy 1.10.11
Upgrade to Awaitility 4.0.3
Upgrade to Artemis 2.13.0
Require dependency on s-b-dependencies to use its constraints
Previously, Spring Boot's modules published Gradle Module Metadata
(GMM) the declared a platform dependency on spring-boot-dependencies.
This provided versions for each module's own dependencies but also had
they unwanted side-effect of pulling in spring-boot-dependencies
constraints which would influence the version of other dependencies
declared in the same configuration. This was undesirable as users
should be able to opt in to this level of dependency management, either
by using the dependency management plugin or by using Gradle's built-in
support via a platform dependency on spring-boot-dependencies.
This commit reworks how Spring Boot's build uses
spring-boot-dependencies and spring-boot-parent to provide its own
dependency management. Configurations that aren't seen by consumers are
configured to extend a dependencyManagement configuration that has an
enforced platform dependency on spring-boot-parent. This enforces
spring-boot-parent's version constraints on Spring Boot's build without
making them visible to consumers. To ensure that the versions that
Spring Boot has been built against are visible to consumers, the
Maven publication that produces pom files and GMM for the published
modules is configured to use the resolved versions from the module's
runtime classpath.
Fixes gh-21911,Merge branch '2.3.x',Start building against Reactor Dysprosium-SR9 snapshots
See gh-21938,Merge branch '2.2.x' into 2.3.x,Start building against Reactor Dysprosium-SR9 snapshots
See gh-21937,Merge branch '2.3.x'
Add runImage option for image building
This commit adds a runImage property to the Maven plugin build-image
goal and the Gradle bootBuildImage task. The property allows the user
to override the run image reference provided in the builder metadata
with an alternate run image. The runImage property can be specified
in the build file or on the command line.
Fixes gh-21534,Fix assertion for startup info format
See gh-21926,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Merge branch '2.1.x' into 2.2.x,Check that a distribution has been started
Update the releasescript to ensure that a distribution has been started
before starting it again. This functionality was accidentally removed
during the updates for gh-21474.
See gh-21474,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Merge branch '2.1.x' into 2.2.x,Polish,Merge branch '2.3.x',Polish,Merge branch '2.3.x'
Fix welcome page support in WebFlux
Prior to this commit, the welcome page support implemented in gh-9785
would override existing index views in both annotation and functional
variants.
This comes from the fact that the feature was implemented as a
`RouterFunction` configured in the main `RouterFunctionMapping` bean.
Due to ordering issues between mappings, this would override existing
application mappings in some cases.
This commit ensures that the welcome page `RouterFunction` is
contributed to the context in its own handler mapping, ordered after the
application ones.
Fixes gh-21909,Merge pull request #21713 from dreis2211
* pr/21713:
  Polish "Add Java 15 CI"
  Add Java 15 CI
  Allow StringSequence.isEmpty() to be compatible with JDK 15
  Use Class.getName() as fallback in HandlerFunctionDescription
Polish "Add Java 15 CI"
See gh-21713,Add Java 15 CI
See gh-21713,Allow StringSequence.isEmpty() to be compatible with JDK 15
JDK 15 introduces isEmpty() on CharSequence which clashes with the one
declared in StringSequence because it is not public.
See gh-21713,Use Class.getName() as fallback in HandlerFunctionDescription
In JDK 15 the concept of hidden classes was introduced, which also
affects Lambdas in so far that Class.getCanonicalName() will return null
for those. This commit uses Class.getName() as a fallback when no
canonical name is available.
See gh-21713,Polish,Merge pull request #21533 from RadekKoubsky
* pr/21533:
  Polish "Add support for webAdminPassword property of H2 Console"
  Add support for webAdminPassword property of H2 Console
Polish "Add support for webAdminPassword property of H2 Console"
See gh-21533,Add support for webAdminPassword property of H2 Console
See gh-21533,Merge pull request #20887 from adutra
* pr/20887:
  Polish "Add health indicator for Cassandra that uses the CqlSession"
  Add health indicator for Cassandra that uses the CqlSession
Polish "Add health indicator for Cassandra that uses the CqlSession"
See gh-20887,Add health indicator for Cassandra that uses the CqlSession
This commit provides a CassandraDriverHealthIndicator and
CassandraDriverReactiveHealthIndicator that do not require Spring Data.
As a result, a health indicator for Cassandra is provided even if the
application does not use Spring Data.
See gh-20887,Merge pull request #21912 from eddumelendez
* gh-21912:
  Polish "Fix detection of snapshot version when configuring repositories"
  Fix detection of snapshot version when configuring repositories
Polish "Fix detection of snapshot version when configuring repositories"
See gh-21912,Fix detection of snapshot version when configuring repositories
As part of 8e8548756e, snapshot dependency resolution change from
`BUILD-SNAPSHOT` to `-SNAPSHOT`. Currently, if we add a version
dependency which is store in snapshots it is not resolved. This
commit allow to resolves plugins and dependencies.
See gh-21912,Merge branch '2.3.x'
Add section about Kafka metrics support
Merge pull request #21906 from lltx
* pr/21906:
  Update copyright year of changed files
  Fix wrong property reference to keys-to-sanitize in Javadoc
Update copyright year of changed files
See gh-21906,Fix wrong property reference to keys-to-sanitize in Javadoc
See gh-21906,Merge branch '2.3.x'
Fix encoding of @Bean in reference documentation
Ensure AvailabilityChangeEvent carries generics
Update `AvailabilityChangeEvent` to be a `PayloadEvent` and ensure
that the `getResolvableType` method returns a generic compatible
result.
Prior to this commit, a ClassCastExeption would be thrown if the
following event listener was declared:
  @EventListener
  void onEvent(AvailabilityChangeEvent<ReadinessState> event) {
    ...
  }
Cherry-pick release script updates from 2.3.x
See gh-21474,Merge branch '2.3.x'
See gh-21474,Improve release script logging
Improve logging and fix a few issue with the release script.
See gh-21474,Check if promotion has already occurred
Update the release tooling to check for bintray published artifacts
using SHA256 digests and to also check before attempting a promote.
See gh-21474,Polish,Next development version (v2.3.2.BUILD-SNAPSHOT),Merge branch '2.3.x'
Reinstate disabled Reactor Netty test
Reinstate test now that we are on a reactor-netty releases that fixes
reactor/reactor-netty issue 1093.
Further attempt to fix Windows file issues.
See gh-21575,Merge branch '2.3.x'
Allow digest builder references
Update `BuildRequest` to also allow digest based references.
Refactor the internals of `PropertiesLauncher` so that opened jar files
are tracked and can be closed after a test completes.
See gh-21575,Use java 8 compiler
Update Ant smoke test to explicitly use Java 8.,Merge branch '2.3.x'
Merge pull request #21872 from dreis2211
* pr/21872:
  Fix deprecation in NettyRSocketServerFactoryTests
Fix deprecation in NettyRSocketServerFactoryTests
See gh-21872,Merge branch '2.3.x'
Merge pull request #21793 from dreis2211
* pr/21793:
  Link complete Slack message to build log
Link complete Slack message to build log
See gh-21793,Merge branch '2.3.x'
Use non-blocking I/O for Docker API
This commit changes the NamedPipeSocket used for communication with
a local Docker daemon to use a non-blocking AsynchronousByteChannel
instead of a blocking RandomAccessFile, modeled after a similar
change to the docker-java project. This eliminates the potential for
a blocking call to hang indefinitely.
Fixes gh-21672,Merge branch '2.3.x'
Upgrade to Spring Asciidoctor Extensions 0.4.3.RELEASE
Pick up the workaround for the AsciidoctorJ bug that prevents the
configprops macro's attributes from being parsed. The lack of parsing
meant that the envvar format was being lost and properties were being
written in the canonical form instead.
Fix flaky integration test
Next development version (v2.1.16.BUILD-SNAPSHOT),Merge branch '2.3.x',Upgrade to Spring Batch 4.2.4
Upgrade to Spring Integration 5.3.1
Upgrade to Spring Kafka 2.5.2
Upgrade to Postgresql 42.2.14
Upgrade to Spring Kafka 2.3.9
Upgrade to Netty Tcnative 2.0.31.Final
Upgrade to Spring Kafka 2.2.14
See gh-21885,Polish,Merge branch '2.3.x'
Return all loggers for Log4j2
This commit aligns log4j2's behavior with logback such that loggers
with a null configuredLevel are also returned by the actuator endpoint.
Fixes gh-20037,Align default log levels for Log4j2 and Logback
Fixes gh-21293,Merge branch '2.3.x',Further reduce repetition in CI pipeline.yml
See gh-21716,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Merge branch '2.1.x' into 2.2.x,Further reduce repetition in CI pipeline.yml
See gh-21716,Merge branch '2.3.x',Polish pipeline YAML,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Merge branch '2.1.x' into 2.2.x,Polish pipeline YAML,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Merge branch '2.1.x' into 2.2.x,Use milestone as docker tag
Update the pipeline YAML to use ((milestone)) rather than ((branch))
when tagging docker images.
See gh-21716,Merge branch '2.3.x'
Reduce repetition in CI pipeline.yml
Use YAML anchors and aliases to reduce the amount of repetition
in our CI pipeline YAML.
Polish,Merge branch '2.3.x'
Fixes gh-21036 in 2.3.1,Handle bind exceptions in management context
This commit updates the logic for handling binding exceptions in the
management context when it is separate from the application context.
The changes allow the exception details to be visible to
DefaultErrorAttributes without causing the servlet container to
detect an error condition.
Fixes gh-21036,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Upgrade to Spring Integration 5.2.7.RELEASE
Upgrade to Spring Data Moore SR8
Upgrade to Spring Integration 5.1.11.RELEASE
Upgrade to Netty tcNative 2.0.31.Final
Allow child contexts to configure server properties
Previously, HttpMessageConvertersAutoConfiguration registered
ServerProperties. When this happened in a parent context, any child
contexts would skip registering ServerProperties due to its presence
in the parent context. This prevents the child contexts from
configuring their own server properties.
This commit updates HttpMessageConvertersAutoConfiguration to
bind server.servlet.encoding directly instead of enabling
ServerProperties. With ServerProperties no longer enabled in a parent
context, child contexts are now able to configure their own server
properties.
Fixes gh-21789,Merge branch '2.3.x'
Merge pull request #21769 from tszmytka
* pr/21769:
  Back-off if a custom ReactiveSessionFactory is defined
Back-off if a custom ReactiveSessionFactory is defined
This commit makes sure that CassandraReactiveDataAutoConfiguration does
not create a reactiveCassandraSessionFactory bean if the user has
provided their own.
See gh-21769,Merge branch '2.3.x',Upgrade to Undertow 2.1.3.Final
Upgrade to Tomcat 9.0.36
Upgrade to Spring Security 5.3.3.RELEASE
Upgrade to Spring AMQP 2.2.7.RELEASE
Upgrade to RSocket 1.0.1
Upgrade to R2DBC Bom Arabba-SR4
Upgrade to Postgresql 42.2.13
Upgrade to OkHttp3 3.14.9
Upgrade to Netty 4.1.50.Final
Upgrade to Neo4j OGM 3.2.12
Upgrade to MongoDB 4.0.4
Upgrade to Log4j2 2.13.3
Upgrade to Lettuce 5.3.1.RELEASE
Upgrade to Kotlin Coroutines 1.3.7
Upgrade to Johnzon 1.2.7
Upgrade to Jetty 9.4.29.v20200521
Upgrade to Jetty Reactive HTTPClient 1.1.3
Upgrade to Jaybird 3.0.9
Upgrade to Hibernate 5.4.17.Final
Upgrade to Groovy 2.5.12
Upgrade to Flyway 6.4.4
Upgrade to Dropwizard Metrics 4.1.9
Upgrade to Couchbase Client 3.0.5
Upgrade to Caffeine 2.8.4
Upgrade to Byte Buddy 1.10.11
Upgrade to Awaitility 4.0.3
Switch Bomr's upgrade policy to same minor version,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Upgrade to Maven Shade Plugin 3.2.4
Remove bomr rule for maven shade plugin,Upgrade to Spring Security 5.2.5.RELEASE
Upgrade to Spring Amqp 2.2.7.RELEASE
Upgrade to Postgresql 42.2.13
Upgrade to Kotlin Coroutines 1.3.7
Upgrade to Hibernate Validator 6.0.20.Final
Upgrade to Hibernate 5.4.17.Final
Upgrade to Jaybird 3.0.9
\gh-21830
Upgrade to Elasticsearch 6.8.10
Upgrade to Jetty 9.4.29.v20200521
Upgrade to Groovy 2.5.12
Upgrade to Awaitility 4.0.3
Upgrade to Tomcat 9.0.36
Upgrade to Johnzon Jsonb 1.2.7
Upgrade to Byte Buddy 1.10.11
Upgrade to Rsocket 1.0.1
Upgrade to Netty 4.1.50.Final
Upgrade to Micrometer 1.3.9
Upgrade to Dropwizard Metrics 4.1.9
Upgrade to Hikaricp 3.4.5
Upgrade to Okhttp3 3.14.9
Upgrade to Caffeine 2.8.4
Upgrade to Couchbase Client 2.7.15
Make AutoConfigureMockMvc use SecurityProperties' filter ordering
Previously, AutoConfigureMockMvc used Spring Security's default filter
ordering, ignoring the value configured by SecurityProperties that is
used at runtime. This resulted in different ordering at runtime and in
tests.
This commit updates the configuration for AutoConfigureMockMvc to
import the Spring Security filter auto-configuration, thereby ensuring
that the ordering configured via SecurityProperties is applied.
Fixes gh-21801,Upgrade to Maven Shade Plugin 3.2.4
Upgrade to Spring Security 5.1.11.RELEASE
Upgrade to Spring Amqp 2.1.15.RELEASE
Upgrade to Postgresql 42.2.13
Upgrade to Hibernate Validator 6.0.20.Final
Upgrade to Jaybird 3.0.9
Upgrade to Jetty 9.4.29.v20200521
Upgrade to Groovy 2.5.12
Upgrade to Tomcat 9.0.36
Upgrade to Netty 4.1.50.Final
Upgrade to Micrometer 1.1.14
Upgrade to Couchbase Client 2.7.15
Configure password-based authentication with Cassandra
This commit updates the Cassandra auto-configuration to configure
password-based authentication on the CqlSession directly.
Document using system properties in gradle plugin docs
See gh-21776,Merge branch '2.2.x' into 2.3.x,Start building against Spring Data Moore-SR8 snapshots
See gh-21775,Merge branch '2.1.x' into 2.2.x,Start building against Spring Data Lovelace-SR18 snapshots
See gh-21774,Polish test,Merge branch '2.3.x',Start building against Spring Batch 4.2.3 snapshots
See gh-21784,Start building against Spring Kafka 2.5.2 snapshots
See gh-21782,Start building against Spring Integration 5.3.1 snapshots
See gh-21779,Upgrade to Spring Framework 5.2.7
See gh-21783, Start building against Spring Kafka 2.3.9 snapshots
 See gh-21781,Start building against Spring Integration 5.2.7 snapshots
See gh-21778,Upgrade to Spring Framework 5.2.7
See gh-21780,Start building against Spring Integration 5.1.11 snapshots
See gh-21777,Upgrade to Spring Framework 5.1.16
Always initialize stompWebSocketHandlerMapping eagerly
Previously, when lazy initialization was enabled, STOMP-based WebSocket
messaging would not work as the stompWebSocketHandlerMapping bean was
not initialized and CONNECT requests would go unanswered.
This commit adds a LazyInitializationExcludeFilter that causes the
stompWebSocketHandlerMapping bean to always be initialized eagerly.
This triggers initialization of the WebSocket transport allowing
requests to be received and processed.
Fixes gh-19611,Merge branch '2.3.x',Upgrade to Reactor Dysprosium-SR8
Merge pull request #21702 from Aurdo
* gh-21702:
  Improve tests for BasicErrorController
  Fix BasicErrorController include parameter parsing
Improve tests for BasicErrorController
This commit improves the tests for BasicErrorController by decoupling
coverage for the include-message and include-binding-errors
parameters to ensure the options operate properly independent of
each other.
See gh-21702,Fix BasicErrorController include parameter parsing
This commit fixes an error in BasicErrorController where the wrong
property was referenced for binding error inclusion.
See gh-21702,Merge branch '2.3.x'
Document deprecations of Archive.iterator()
Merge pull request #21060 from dsyer
* pr/21060:
  Polish 'Fix Mustache to not ignore native fetcher'
  Fix Mustache to not ignore native fetcher
Polish 'Fix Mustache to not ignore native fetcher'
See gh-21060,Fix Mustache to not ignore native fetcher
Alter the logic of `MustacheEnvironmentCollector` so that the
native fetcher is always consulted if it exists.
When the context is a map (as it is in a web View for instance) you
can't assume a non-null fetcher actually contains the property you are
searching for.
See gh-21060,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Merge branch '2.1.x' into 2.2.x,Ignore 'attach_pid' files,Merge branch '2.3.x'
Merge pull request #21650 from fastso
* pr/21650:
  Polish 'Clarify documentation for probe ports'
  Clarify documentation for probe ports
Polish 'Clarify documentation for probe ports'
See gh-21650,Clarify documentation for probe ports
Update the reference documentation to provide a better description of
the port that should be used for Kubernetes probes.
See gh-21650,Merge branch '2.3.x'
Merge pull request #21758 from dreis2211
* pr/21758:
  Use supplier assertions in availability indicator
Use supplier assertions in availability indicator
See gh-21758,Merge branch '2.3.x'
Merge pull request #20716 from norio-io
* gh-20716:
  Polish "Clarify loss of defaults when adding custom mapping"
  Clarify loss of defaults when adding custom mapping
Polish "Clarify loss of defaults when adding custom mapping"
See gh-20716,Clarify loss of defaults when adding custom mapping
See gh-20716,Merge branch '2.3.x'
Document dispatcher-types configuration for secured error pages
Remove . from CLI's classpath on Unix-like platforms
Previously, the spring bash script added . to the classpath but the
Windows spring.bat script did not. This commit aligns the classpath
of the two scripts by removing . from the classpath in the bash
script.
Fixes gh-19910
Document support for Gradle 5
Merge pull request #21381 from evgeniycheban
* pr/21381:
  Polish 'Support userInfo in elasticsearch URI'
  Support userInfo in elasticsearch URI
Polish 'Support userInfo in elasticsearch URI'
See gh-21381,Support userInfo in elasticsearch URI
See gh-21381,Merge branch '2.3.x'
Drop the use of the term "white list"
See gh-21739,Merge branch '2.2.x' into 2.3.x,Start building against Spring Framework 5.2.7 snapshots
See gh-21738,Merge branch '2.1.x' into 2.2.x,Start building against Spring Framework 5.1.16 snapshots
See gh-21729,Merge branch '2.3.x'
Merge pull request #20929 from encircled
* pr/20929:
  Polish 'Allow beans without public constructors to load'
  Allow beans without public constructors to load
Polish 'Allow beans without public constructors to load'
See gh-20929,Allow beans without public constructors to load
Allow `BeanDefinitionLoader` to load classes that don't have public
constructors. The constraint was first introduced in d82c50804f04 to
solve an issue with anonymous Groovy classes but causes particular
problems with `@SpringBootTest`.
See gh-20929,Merge branch '2.3.x'
Merge pull request #21732 from dreis2211
* pr/21732:
  Polish
Polish
See gh-21732,Merge branch '2.3.x',Start building against Reactor Dysprosium-SR8 snapshots
See gh-21731,Merge branch '2.2.x' into 2.3.x,Start building against Reactor Dysprosium-SR8 snapshots
See gh-21730,Merge branch '2.1.x' into 2.2.x,Start building against Reactor Californium-SR19 snapshots
See gh-21728,Merge branch '2.3.x'
Fix default Launcher.isExploded() result
Fix the default implementation of `Launcher.isExploded` which should
have returned `true`.
Fixes gh-21575,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Refine prepare-forward-merge to detect master,Merge branch '2.3.x'
Merge pull request #21523 from dreis2211
* pr/21523:
  Polish 'Optimize SystemEnvironmentPropertyMapper'
  Optimize SystemEnvironmentPropertyMapper
  Call append only when necessary
  Use chars rather than strings
Polish 'Optimize SystemEnvironmentPropertyMapper'
Introduce a new `ConfigurationPropertyName.ofIfValid` method to
save us needing to throw and catch an exception unnecessarily.
See gh-21523,Optimize SystemEnvironmentPropertyMapper
See gh-21523,Call append only when necessary
See gh-21523,Use chars rather than strings
Update `SystemEnvironmentPropertyMapper` to use single chars
rather than strings whenever possible.
See gh-21523,Update copyright year of changed files,Merge branch '2.3.x',Update copyright year of changed files,Merge branch '2.2.x' into 2.3.x,Update copyright year of changed files,Fixup prepare-forward-merge for master
Fix the regex so that merges to master are supported.,Merge branch '2.3.x'
Fixes gh-21705 in master,Propagate manifest to exploded jars
Update `LaunchedURLClassLoader` so that packages defined from exploded
archive folders have manifest attributes applied to them. Prior to this
calling `package.getImplementationTitle()` would only return the a
manifiest attribute when running non-exploded.
The root cause of this issue is the way that `URLClassLoader` handles
the different URL types. For URLs that reference a jar the manifest is
available. For URLs that reference a folder it isn't. When running
exploded we use a URL that references to the `BOOT-INF/classes` folder
directly. To fix the issue we now attempt to detect when `definePackage`
is being called directly, and replace `null` entries with actual
manifest values.
Fixes gh-21705,Merge branch '2.3.x'
Merge pull request #21671 from dreis2211
* pr/21671:
  Remove usages of deprecated Connector.setAttribute()
Remove usages of deprecated Connector.setAttribute()
See gh-21671,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Polish,Merge pull request #21559 from dreis2211
* gh-21559:
  Polish "Print the java version being used on startup"
  Print the java version being used on startup
Polish "Print the java version being used on startup"
See gh-21559,Print the java version being used on startup
See gh-21559,Merge pull request #21691 from dreis2211
* gh-21691:
  Add Java 15 to JavaVersion enum
Add Java 15 to JavaVersion enum
See gh-21691,Remove JUnit 5's vintage engine from spring-boot-starter-test
* pr/21692:
  Fix event name in documentation
Fix event name in documentation
See gh-21692,Merge branch '2.3.x',Merge pull request #21653 from ThierrySquirrel
* pr/21653:
  Polish "Add reference to rocketmq-spring-boot-starter"
  Add reference to rocketmq-spring-boot-starter
Polish "Add reference to rocketmq-spring-boot-starter"
See gh-21653,Add reference to rocketmq-spring-boot-starter
See gh-21653,Merge branch '2.3.x'
Migrate CustomServletPathSampleActuatorTests to JUnit Jupiter
Merge pull request #21545 from izeye
* pr/21545:
  Polish "Support filtered scrape for Prometheus"
  Support filtered scrape for Prometheus
  Upgrade CI to Docker 19.03.9
Polish "Support filtered scrape for Prometheus"
See gh-21545,Support filtered scrape for Prometheus
See gh-21545,Merge branch '2.3.x'
Upgrade CI to Docker 19.03.9
Merge pull request #21605 from dreis2211
* pr/21605:
  Fix multi-release JAR test on JDK 15
Fix multi-release JAR test on JDK 15
See gh-21605,Merge branch '2.3.x'
Add prepare-forward-merge script
Add a git hook script that can be used to prepare a sensible merge
commit message.
Allow forward merge to work with .x patterns
Add logging to forward-merge script
Add some logging to aid with development.,Merge branch '2.3.x',Merge branch '2.2.x' into 2.3.x,Remove accidentally committed hook file,Merge branch '2.3.x'
Use highlightjs for syntax highlighting in Asciidoctor's HTML output
Always apply retry plugin but only retry on CI
Previously, the retry plugin was only applied on CI as we do not want
tests to be retried in local builds. Unfortunately, this arrangement
led to test tasks from CI builds having additional doFirst and doLast
actions and an additional property. These differences meant that the
output from a test task that has run on CI could not be used by a
local build.
This commit changes our configuration of the test retry plugin so
that it is now always applied. To retain the behaviour of only
retrying tests on CI, max retries is configured to 3 on CI and 0 for
local builds.
\gh-21698
Use servlet context that can access classloader
Update `SpringBootServletInitializer` to use the `ServletContext` that
was provided to the initial `onStartup` call rather than the
one from the `ServletContextEvent`. This allows the `getClassLoader()`
call to complete without throwing an `UnsupportedOperationException`.
Fixes gh-21684,Merge branch '2.3.x'
Improve Docker API 5xx error messages
This commit improves the error messages returned by the Spring Boot
build plugins when a 5xx status code is returned from the Docker
API while attempting to build an image. If the error response has
contents containing a JSON structure with a "message" key, the value
associated with that key will be included in the exception message
and in the build plugin output error.
Fixes gh-21515,Merge branch '2.3.x'
Merge pull request #21673 from dreis2211
* gh-21673:
  Polish Slack notification when no build scan was published
Polish Slack notification when no build scan was published
See gh-21673,Merge branch '2.3.x'
Upgrade to Gradle Enterprise Plugin 3.3.3
Upgrade to Gradle Enterprise Conventions Plugin 0.0.3
Restore Boot 2.2's compile-scoped dependencies
Fixes gh-21507,Merge branch '2.3.x'
Use dirMode and fileMode to configure CLI archive entry permissions
Ensure that the build uses UTF-8 encoding everywhere by default
Add Oracle DB dependency management under com.oracle.database
Support wrapped random property sources
Update `SpringConfigurationPropertySource` so that wrapped random
property sources can be used. It's assumed that wrapped random
sources will use the name of the source as the prefix.
Add missing since tags
Fix containsDescendantOf for random sources
Fix the `containsDescendantOf` logic for random property sources to
ensure that ancestors are correctly matched.
Fix version placeholder replacement in Gradle plugin docs
Polish,Fix Maven plugin help support
Update `MavenPluginPlugin` to fix HelpMojo support.
Polish,Restore TomcatReactiveWebServerFactoryTests
Restore tests that were previously ignored due to a framework bug.
Make management security configuration back off when SAML present
Fixes gh-21620,Merge branch '2.3.x'
Fix inclusion of version-specific content in Gradle plugin's docs
Fixes gh-21610,Merge branch '2.3.x'
Use stable file repository for testing snapshot layers
Support new version scheme in forward-merge hook
Fix pattern for spring-boot-tools' name predicate
Merge pull request #21612 from dreis2211
* gh-21612:
  Update some references to 2.4.x where appropriate
Update some references to 2.4.x where appropriate
See gh-21612,Request only genuine pull-requests are submitted
Update `PULL_REQUEST_TEMPLATE` with an attempt to persuade people not
to use our repo as a GitHub playground.,Merge branch '2.3.x'
Fixes gh-21554 in 2.4.0-M1,Provide better error message if Docker is not running
Previously, if the Spring Boot build plugins got a connection error
when attempting to communicate with a Docker daemon (for example,
when the daemon isn't running), the error message made it appear that
the daemon returned an HTTP error code. This commit makes a connection
error distinct from an HTTP error response code to make it easier for
the user to diagnose the root cause of the problem.
Fixes gh-21554,Merge branch '2.3.x',Start work on Spring Boot 2.4,Prepare 2.3.x branch,Merge branch '2.2.x',Fix checkstyle issues,Merge branch '2.2.x'
Restrict use of custom YAML types
Update `YamlJsonParser` and `OriginTrackedYamlLoader` to ensure that
custom types cannot be loaded.
Ignore irrelevant changes to StarterMetadata's dependencies
Use sorted properties to ensure output is repeatable
Use a separate task to extract legal files to be included in jars
Previously, the files were extracted on the fly and written into the
jars. This didn't work well with Gradle's up-to-date checks as the
inputs of the jar task were not well-defined.
This commit moves the extraction of the notice and license files into
a separate task, the outputs of which are then copied into the jar's
META-INF.
Do not change availability on close unless context is active
Previously, an AvailabilityChangeEvent was published when the servlet
and reactive web server application contexts were closed, irrespective
of whether or not the context was active. This caused problems when
the context was not active due to a refresh failure as the event
publication could then trigger bean creation and post-processing that
relied upon beans that had been destroyed when cleaning up after the
refresh failure. The most commonly seen symptom was a missing
importRegistry bean that is required by ImportAwareBeanPostProcessor.
This commit updates the two web server application contexts to only
publish the availability change event if the context is active.
Fixes gh-21588,Fix dependency management for Kafka
Kafka 2.5 no longer provides artifacts for Scala 2.11
Tolerate change in method format
This commit polishes the assertions of the NoSuchMethodError failure
analyzer as the method format changes according to the JDK.
See gh-21587,Merge pull request #21581 from dreis2211
* pr/21581:
  Upgrade to Testcontainers 1.14.2
Upgrade to Testcontainers 1.14.2
See gh-21581,Harmonize Period conversion support
Include type hierarchy in NoSuchMethodError failure analysis
Merge pull request #21579 from OrangeDog
* pr/21579:
  Polish "Polish duration support javadoc"
  Polish duration support javadoc
Polish "Polish duration support javadoc"
See gh-21579,Polish duration support javadoc
See gh-21579,Restore RestClientBuilderCustomizer in its original location
This commit restores RestClientBuilderCustomizer in the rest package in
a deprecated fashion so that the upgrade from 2.2 is smoother.
Configure attributes on productionRuntimeClasspath
Previously, the productionRuntimeClasspath configuration was created
without any attributes. This caused problems with multi-project
dependency resolution as there was insufficient information for Gradle
to determine which variant of a dependency should be used by the
productionRuntimeClasspath configuration.
This commit updates the configuration to have three attributes, each
configured with the same values as those of Gradle's own
runtimeClasspathConfiguration.
Fixes gh-21549,Map connection and read timeouts for New Relic again
Merge pull request #21540 from BramDeCneudt
* pr/21540:
  Fix links for Apache Camel starter
Fix links for Apache Camel starter
See gh-21540,Merge pull request #21492 from making
* pr/21492:
  Fix default value for spring.data.jpa.repositories.bootstrap-mode
Fix default value for spring.data.jpa.repositories.bootstrap-mode
See gh-21492,Merge branch '2.2.x'
Merge pull request #21480 from olamy
* pr/21480:
  Polish "Use the container IP address for tests using TestContainer"
  Use the container IP address for tests using TestContainer
Polish "Use the container IP address for tests using TestContainer"
See gh-21480,Use the container IP address for tests using TestContainer
See gh-21480,Merge branch '2.2.x'
Polish "Fix uri tag for empty path"
See gh-21392,Merge pull request #21392 from jkschneider
* pr/21392:
  Fix uri tag for empty path
Fix uri tag for empty path
See gh-21392,Document health probes config property in Actuator section
This commit mentions the `management.health.probes.enabled`
configuration property in the Kubernetes Probes section of the Actuator
chapter.
Enabling this property is required if we need to expose Kubernetes
Probes in a non-Kubernetes environment.
Fixes gh-21505,Optimize UrlPathHelper configuration for Spring MVC
Prior to this commit, Spring Boot would auto-configure Spring MVC and
would keep the default `UrlPathHelper` configuration.
Since Spring Boot is in charge of configuring the `DispatcherServlet`
and its mapping, it is in a position to optimally configure the
`UrlPathHelper` depending on the chosen mapping.
This commit sets the `alwaysUseFullPath` property of `UrlPathHelper` if
the Servlet mapping is `"/"`. This is more efficient since this
configuration requires less processing of the request path.
Add welcome page support for Spring WebFlux
This commit adds the support for static and templated welcome pages with
Spring WebFlux. The implementation is backed by a `RouterFunction`
that's serving a static `index.html` file or rendering an `index` view.
Use default tag when pulling run image
Prior to this commit, a default tag of 'latest' was used when no tag
was included in the builder image name used when building an image in
the Maven and Gradle plugins, but the tag for the run image was left
empty if it was not provided. This resulted in errors when pulling
the run image from an image repository. This commit applies the
same tag defaulting logic to the run image name.
Fixes gh-21532
Merge pull request #21485 from FrontierPsychiatrist
* pr/21485:
  Fix typo in section 4.30.6
Fix typo in section 4.30.6
See gh-21485,Merge pull request #21509 from dreis2211
* pr/21509:
  Avoid allocations in ConfigFileApplicationListener
Avoid allocations in ConfigFileApplicationListener
See gh-21509,Merge branch '2.2.x'
Upgrade CI to Docker 19.03.9
Don't add waiting-for-triage label for issues created by CI automation
Polish maven build image command line example,Merge pull request #21490 from dsyer
* gh-21490:
  Polish `Add gradle build image command line example`
  Add gradle build image command line example
Polish `Add gradle build image command line example`
See gh-21490,Add gradle build image command line example
See gh-21490,Merge branch '2.2.x'
Fix log name in ServletWebServerApplicationContext
Fixes gh-21354,Ensure that spring-boot-parent is imported into generated pom
Fixes gh-21518,Preserve property ordering in SpringIterableConfigurationPropertySource
Fixes gh-21470,Merge pull request #21481 from wonwoo
* gh-21481:
  Polish
Polish
See gh-21481,Remove checkstyle config made redundant by ee758fa6
Use HTTPS for license links
This commit updates the MavenPublishingConventions to use HTTPS to
link to the Apache license. The configuration of NoHTTP has also
been reworked so that it will correctly find usch uses of http://
URLs.
Use HTTPS when linking to groovy-lang.org
Restore release scripts POM
Increase bintray timeout,Next development version (v2.3.1.BUILD-SNAPSHOT),Use http liquibase XSDs
Update the lquibase test to use `http://` rather than `https://` so that
it can be resolved from the local jar.,Fix published Maven POMs
Prior to this commit, the published Maven POMs would not pass the Maven
Central mandatory checks.
This commit adds the missing project name and description metadata for
most artifacts. The Spring Boot Gradle plugin artifact was also missing
this information and this is now added in the plugin metadata itself.
This is also updating the project page URL which is now hosted directly
on spring.io.
Fixes gh-21457,Switch back to 2.3.0.BUILD-SNAPSHOT,Next development version (v2.3.1.BUILD-SNAPSHOT),Fix file permissions in the CLI's zip and tar distributions
Fixes gh-21451,Merge branch '2.2.x'
Only enforce spring-boot-parent's constraints internally
See gh-21350,Work around file handle leak when Undertow is stopped
There's a bug in Undertow that means it may leak a file handle is
the server is stopped immediately after a response to an SSL request
has been received. The stop processing races with Undertow's SSL
support tidying things up after sending the response. When the stop
processing wins, the tidying up fails with a NullPointerException that
prevents an input stream from being closed. On Windows, the input
stream remaining open prevents JUnit from being able to clean up its
temporary directory.
This commit uses Awaitility to wait for the file that's being served
over SSL to be deleted before stopping the server. On Windows, this
will delay the stop processing from beginning until after the tidy up
that's performed after sending the response has been completed,
hopefully eliminating the race condition that resulted in the input
stream being left open.
Fixes gh-21172,Fix web services tests on JDK 11+
Compile doc's Java examples and allow them to be imported into Eclipse
Merge pull request #17274 from nosan
* gh-17274:
  Polish 'Add @WebServiceClientTest slice test support'
  Add @WebServiceClientTest slice test support
Polish 'Add @WebServiceClientTest slice test support'
See gh-17274,Add @WebServiceClientTest slice test support
Add `@WebServiceClientTest` and related test auto-configuration to allow
slice testing of Spring Web Service client applications.
See gh-17274,Merge branch '2.2.x'
Upgrade to spring-javaformat 0.0.22
Upgrade to Spring Integration 5.3.0.RELEASE
Upgrade to Spring Session Dragonfruit-RELEASE
Create endpoint beans as late as possible
Update `EndpointDiscoverer` so that `@Endpoint` and `@EndpointExtension`
beans are created as late as possible.
Prior to this commit, endpoint beans and extension beans would be
created during the discovery phase which could cause early bean
initialization. The problem was especially nasty when using an embedded
servlet container since `ServletEndpointRegistrar` is loaded as the
container is initialized. This would trigger discovery and load all
endpoint beans, including the health endpoint, and all health indicator
beans.
Fixes gh-20714,Add redis sentinel password property
Update copyright year of changed files,Polish,Merge branch '2.2.x',Revert "Expose property to configure OAuth2 provider configurationMetadata"
This reverts commit 7b79029949dbc09a98de66522bb6a45f620d33a6.
See gh-21375,Upgrade to Spring Kafka 2.5.0.RELEASE
Restore the `getUseRelativeRedirects` method with a `Boolean` object
result and introduce `isUseRelativeRedirects` for the primitive boolean
variant.
See gh-20796,Polish,Upgrade to XMLUnit 2.7.0
Deregister JDBC drivers when deployed war's ServletContext is destroyed
Remove non-user-facing packages from the javadoc
Merge pull request #21378 from dreis2211
* pr/21378:
  Upgrade to Testcontainers 1.14.1
Upgrade to Testcontainers 1.14.1
See gh-21378,Disable generation of Gradle metadata for spring-boot-dependencies
Gradle's metadata for a platform does not provide a way to define
exclusions in the same way that can be done in <dependencyManagement>
in a Mavne bom. This means that Gradle 6 users lose the exclusions
that are defined in the pom as Gradle 6 will use the metadata rather
than the pom.
Until such a time as Gradle's metadata supports the configuration of
such exclusions we can avoid the problem by disabling the metadata's
publication.
Fixes gh-21350,Disable test that is flaky due to Reactor Netty problem
See gh-21437,Fix typo,Include all deprecated properties in migration report
This commit expands the migration check to all deprecated properties,
not only the ones that have been effectively removed. This provides more
information upfront, including keys that still work in the current
release but will need to be renamed sooner than later anyway.
Use "release notes" in message as it is more generic,Polish,Configure the Asciidoctor revnumber in a central location
See gh-20934,Improve ConfigurationPropertySource performance
Further improve the performance of `containsDescendantOf` by using
a Map to limit the number of candidates that need checking.
Improve ConfigurationPropertySource performance
Attempt to improve the performance of the `ConfigurationPropertySource`
adapters `containsDescendantOf` method. The method now operates on
arrays rather than iterators and reduces the inner for-loop when
possible.
See gh-21416,Set asciidoctor revnumber to null
Address flakiness in TomcatServletWebServerFactoryTests,Allow more time for shutdown result callback to be received
5 seconds isn't always sufficient, particularly on CI where the timing
can be quite variable.,Support local socket path in DOCKER_HOST
Prior to this commit, if a DOCKER_HOST environment variable was present
when attempting to communicate with a Docker daemon, it was assumed
that the value of that variable was an address that could be used to
create an HTTP connection to a remote daemon. In some cases, the value
of the variable is the path to a local socket file, which would cause
the HTTP connection to fail.
This commit adds additional validation of the value of the DOCKER_HOST
environment variable to determine whether it is a remote address or
a local socket file and create the appropriate connection type.
Fixes gh-21173,Fix hang caused by race condition in test for reset of kept-alive connection
Previously, a race between the server starting to reject requests
on a kept-alive connection and the request reaching the blocking
servlet could result in a response never being sent.
This commit updates the test to disable blocking once graceful
shutdown with an in-flight request has being. Awaitility is then used
to make a request on an idle kept-alive connection until it fails
due to the connection reset. This may not happen immediately due to
the aforementioned race.,Merge branch '2.2.x'
Expose property to configure OAuth2 provider configurationMetadata
Auto-configure a lifecycle processor with configurable timeout
Use SmartLifecycle for graceful web server shutdown
Consolidate Undertow WebServers and simplify their constructors
\gh-21391
Co-authored-by: Phillip Webb <pwebb@pivotal.io>,Handle exceptions in management context
Prior to this commit, details about an exception would get dropped when
the management context was separate from the application context and
an actuator endpoint threw a binding exception.
This commit adds some logic to capture the exception so the management
context error handlers can add the appropriate attributes to the error
response.
Fixes gh-21036,Merge pull request #21390 from izeye
* pr/21390:
  Fix ClientHttpConnectorConfigurationTests.shouldApplyHttpClientMapper()
Fix ClientHttpConnectorConfigurationTests.shouldApplyHttpClientMapper()
See gh-21390,Remove wrong replacement key in deprecated metadata,Merge remote-tracking branch 'origin/2.2.x'
Upgrade to RSocket 1.0.0
Upgrade to Spring Data Neumann-RELEASE
Upgrade to Spring HATEOAS 1.1.0.RELEASE
Polish "Calculate hashCode only once in ConfigurationPropertyName"
See gh-21394,Merge pull request #21394 from dreis2211
* pr/21394:
  Polish "Calculate hashCode only once in ConfigurationPropertyName"
  Calculate hashCode only once in ConfigurationPropertyName
Polish "Calculate hashCode only once in ConfigurationPropertyName"
See gh-21394,Calculate hashCode only once in ConfigurationPropertyName
See gh-21394,Merge pull request #21417 from rnorth
* pr/21417:
  Fix capitalization of Testcontainers in Howto docs
Fix capitalization of Testcontainers in Howto docs
See gh-21417,Remove outdated metadata for spring.data.cassandra.port
Upgrade to Tomcat 9.0.35
Upgrade to SQLite JDBC 3.31.1
\gh-21414
Upgrade to Selenium HtmlUnit 2.40.0
Upgrade to Prometheus PushGateway 0.9.0
Upgrade to MongoDB 4.0.3
Upgrade to Micrometer 1.5.1
Upgrade to Maven Assembly Plugin 3.3.0
Upgrade to Kotlin Coroutines 1.3.6
Upgrade to jOOQ 3.13.2
Upgrade to Johnzon 1.2.5
Upgrade to Jedis 3.3.0
Upgrade to Infinispan 10.1.8.Final
Upgrade to HtmlUnit 2.40.0
Upgrade to HikariCP 3.4.5
Upgrade to Hibernate Validator 6.1.5.Final
Upgrade to Hibernate 5.4.15.Final
Upgrade to Dropwizard Metrics 4.1.7
Upgrade to Couchbase Client 3.0.4
Upgrade to Cassandra Driver 4.6.1
Upgrade to AssertJ 3.16.1
Add a testcontainers section in the reference docs
Add more context to the Kubernetes container lifecycle documentation
Document that graceful shutdown requires Tomcat 9.0.33
Improve API of ErrorAttributes and DefaultErrorAttributes
This commit improves the backward-compatibility of the ErrorAttributes
interfaces by providing a default implementation of a new method. It
also encapsulates several parameters that control the inclusion or
exclusion of error attributes into a new ErrorAttributeOptions type to
make it easier and less intrusive to add additional options in the
future. This encapsulation also makes the handling of the
includeException option more similar to other options.
Fixes gh-21324,Polish smoke test with removal of View support in Couchbase
See gh-21383,Start building against Spring Kafka 2.5.0 snapshots
See gh-21387,Start building against Spring Session Dragonfruit snapshots
See gh-21386,Start building against Spring Integration 5.3.0 snapshots
See gh-21385,Start build against Spring HATEOAS 1.1.0 snapshots
See gh-21284,Start building against Spring Data Neumann snapshots
See gh-21383,Ensure @ActiveProfiles replaces existing profiles
Update `SpringBootContextLoader` to both add `spring.profiles.active`
properties and to directly call `Environment.setActiveProfiles`.
The additional `setActiveProfiles` call prevents `AbstractEnvironment`
from accidentally loading `spring.profiles.active` properties directly
when `doGetActiveProfiles` is called.
Directly setting active profiles has only become necessary since we
started adding properties using the square bracket notation. Previously
we added a comma-separated list which would be picked up by both the
`AbstractEnvironment` and the `ConfigurationFileApplicationListener`.
Update CNB buildpack Java version env variable
Prior to this commit, the build tool plugins set the environment
variable BP_JAVA_VERSION when invoking the CNB builder to set the
version of the JDK/JRE that the builder should use in the created
image.
With CNB API 0.3, the convention changed the name of this environment
variable to BP_JVM_VERSION. This commit updates the build tool
plugins to match the newer convention.
See gh-21273,Use CNB creator all-in-one lifecycle
This commit modifies the buildpack platform invocation logic used by
the build plugins to invoke the single creator lifecycle introduced in
the CNB API 0.3, instead of invoking discrete lifecycle phases
separately. It also removes support for CNB API 0.2.
Fixes gh-21273,Merge branch '2.2.x'
Document use case of splitting auto-configuration and starter
Merge pull request #21365 from izeye
* pr/21365:
  Fix JarFileTests.getInputStreamWhenClosed()
Fix JarFileTests.getInputStreamWhenClosed()
See gh-21365,Merge branch '2.2.x'
Merge pull request #21318 from ahrytsiuk
* pr/21318:
  Polish "Align TestRestTemplate Javadoc with documentation"
  Align TestRestTemplate Javadoc with documentation
Polish "Align TestRestTemplate Javadoc with documentation"
See gh-21318,Align TestRestTemplate Javadoc with documentation
See gh-21318,Merge pull request #21040 from dreis2211
* pr/21040:
  Update link to new Spring Security docs location
Update link to new Spring Security docs location
See gh-21040,Add ConfigurationPropertyCaching support
Add a `ConfigurationPropertyCaching` utility interface that can be
used to control the property source caching.
Prior to this commit, a `ConfigurationPropertySource` that was backed
by a mutable `EnumerablePropertySource` would need to call the
`getPropertyNames()` method each time a property was accessed. Since
this this operation can be expensive, we now provide a way to cache
the results for a specific length of time.
This commit also improves the performance of immutable property sources
by limiting the number of candidates that need to be searched.
Previously, all mapped names would be enumerated. Now, mappings are
grouped by `ConfigurationPropertyName`. This is especially helpful when
the `ConfigurationPropertyName` isn't mapped at all since the hash based
map lookup will be very fast and the resulting mappings will be empty.
Add hashcode support to ConfigurationPropertyName
Provide a hashcode implementation for `ConfigurationPropertyName` so
that instances can be stored in Map without them all ending up in the
same bucket.
See gh-20625,Test large property source performance
Add a test to ensure that a large number of property sources that each
contain many items can perform well.
See gh-20625,Merge branch '2.2.x',Merge branch '2.1.x' into 2.2.x,Next development version (v2.2.8.BUILD-SNAPSHOT),Allow clash in spring.config.name
Remove the recently added slash restriction since Spring Cloud
Config Server needs to support names with slashes.
See gh-21217,Simplify regex expressions,Next development version (v2.1.15.BUILD-SNAPSHOT),Merge branch '2.2.x'
Upgrade to Spring Ldap 2.3.3.RELEASE
Upgrade to Spring Security 5.3.2.RELEASE
Add tests to verify Jetty's thread pool defaults match server defaults
Harmonize default for server.tomcat.use-relative-redirects
Prior to this commit, the property was a Boolean with a null default.
If it was explicitly set by the user, a context customizer would use
that value to set it on the context. However, if it was not set, the default
wouldn't be tomcat's default but `false` because it was explicitly set to
`false` in `TomcatServletWebServerFactory`. This commit defaults the property
itself to `false` so that the default is more obvious to the user.
Fixes gh-20796,Polish,Fix legacy environment names in isAncestorOf
Fix the `SystemEnvironmentPropertyMapper.isAncestorOf` implementation
to convert names based on their dashed form and to silently ignore
any invalid results.
Use Gradle's CreateStartScripts task with 6.4 and later
Fixes gh-20759,Merge branch '2.2.x',Tolerate deprecation warnings generated by Gradle 6.4
The warnings will be addressed by gh-20759. CreateBootStartScripts
must be excluded from the classes that are validated by the
ValidatePlugins task. It is invalid, but only for Gradle 6.4. gh-20759
will cause it to only be used with Gradle 6.3 and earlier.
See gh-21329,Upgrade to Jetty El 8.5.54
Upgrade to Hibernate 5.4.15.Final
Upgrade to Johnzon Jsonb 1.2.5
Upgrade to Byte Buddy 1.10.10
Upgrade to Dropwizard Metrics 4.1.7
Upgrade to Saaj Impl 1.5.2
Upgrade to Okhttp3 3.14.8
Upgrade to Hazelcast 3.12.7
Upgrade to Jackson 2.10.4
Upgrade to Hibernate 5.3.17.Final
Upgrade to Gradle 6.4
Allow Undertow to stop when a request is being handled
Previously, unlike embedded Jetty, Netty, and Tomcat, Undertow would
not stop when one of its worker threads was in use. This meant that a
a long-running or stalled request could prevent the application from
shutting down in response to SIGTERM or SIGINT, and SIGTERM would be
required to get the process to exit.
This commit updates the factories for the reactive and servlet
Undertow web server factories to configure Undertow to use a 0ms
shutdown timeout. This aligns it with the behaviour of Jetty, Netty,
and Tomcat. Tests have been introduced to verify the behaviour across
the reactive and servlet variants of all four supported embedded web
servers.
Fixes gh-21319,Stop developmentOnly from removing too much from executable jars and wars
Fixes gh-21288,Merge pull request #21136 from Grubhart
* pr/21136:
  Polish 'Add Period converter support'
  Add Period converter support
Polish 'Add Period converter support'
Polish period converter support, primarily by changing
`PeriodStyle` to parse and print periods that include
more than one unit.
See gh-21136,Add Period converter support
Add converter support for `javax.time.Period` including:
 String -> Period
 Number -> Period
 Period -> String
Period to Number conversion is not supported since `Period` has no
ability to deduce the number of calendar days in the period.
See gh-21136,Consider legacy environment names in isAncestorOf
Update the `isAncestorOf` method of SpringConfigurationPropertySources
so that legacy names are considered for the system environment.
Prior to this commit, binding a property such as `my.camelCase.prop`
would detect `MY_CAMELCASE_PROP` but not `MY_CAMEL_CASE_PROP` in
the system environment.
Fixes gh-14479
Co-authored-by: Phillip Webb <pwebb@pivotal.io>,Merge pull request #21259 from dreis2211
* pr/21259:
  Further optimize StringSequence.startsWith
  Optimize StringSequence.startsWith
Further optimize StringSequence.startsWith
See gh-21259,Optimize StringSequence.startsWith
See gh-21259,Return null when getting a logback logger that does not exist
Detect log4j2-test.* files when using log4J2
Fixes gh-17001,Upgrade to JNA 5.5.0
Upgrade JNA to 5.5.0 and only use the jna-platform dependency.
Allow classpath wildcards with Java 11 or above
Update `StaticResourceJars` to catch both `IOException` and
`InvalidPathException` when checking URLs. Prior to this commit only
`IOException` was caught which worked on Java 8 but not Java 11 or
above.
Fixes gh-21312,Further restrict configuration wildcard patterns
Extend wildcard restrictions to the `spring.config.name` property. Also
refine exception messages to include the property value.
\gh-21217
Merge pull request #21108 from jkatada
* pr/21108:
  Fix duplicate slashes in URL links
Fix duplicate slashes in URL links
See gh-21108,Simplify ReactiveWebServerApplicationContext.ServerManager
Improve testing of ReactiveWebServerApplicationContext
Merge pull request #21310 from kylehoehns
* pr/21310:
  Fix typo for includeLayerTools
Fix typo for includeLayerTools
See gh-21310,Add missing implementation attributes to Shade config
Fixes gh-21304,Include empty layers when listing and extracting
Fixes gh-21301,Merge branch '2.2.x'
Polish bomr exclusion for the maven shade plugin
See gh-21265,Upgrade Ubuntu version in CI images
Remove dependency management for the Wavefront SDK
Fix @DefaultValue PropertyEditor based conversion
Update `ValueObjectBinder` reattempt conversion if the `@DefaultValue`
contains a single element. Prior to this commit, single element
conversion relied on the `ArrayToObjectConverter` which isn't always
available.
Fixes gh-21264,Add json starter to integration test repo,Attempt to fix Windows CI test failure,Add InputStreamSourceToByteArrayConverter
Add an `InputStreamSourceToByteArrayConverter` that can be used to
convert from an `InputStreamSource` (such as a `Resource`) to a
byte array.
Polish,Apply test conventions unconditionally
See gh-21272,Restrict wildcard pattern support for configuration files
This commit restricts how wildcards can be used in search
locations for property files. If a search location contains
a pattern, there must be only one '*' and the location should
end with a '*/'. For search locations that specify the file
name, the pattern should end with '*/<filename>'.
The list of files read from wildcard locations are now sorted
alphabetically according to the absolute path of the file.
Only enable flaky test support on CI
Upgrade to Undertow 2.1.0.Final
Upgrade to SAAJ Impl 1.5.2
Upgrade to Jetty EL 8.5.54
Upgrade to Hazelcast 3.12.7
Upgrade to Byte Buddy 1.10.10
Rename customize to reflect type that it customizes
See gh-20961,Fix Maven plugin command-line examples
Fixes gh-21078,Add transaction auto-configuration to @DataMongoTest
Upgrade to Flyway 6.4.1
Merge pull request #21266 from dreis2211
* pr/21266:
  Fix checkstyle violation
Fix checkstyle violation
See gh-21266,Apply gridFsDatabase to auto-configured ReactiveGridFsTemplate
Merge pull request #21081 from aartiguptaa
* pr/21081:
  Polish "Add support for customizing RSocketMessageHandler"
  Add support for customizing RSocketMessageHandler
Polish "Add support for customizing RSocketMessageHandler"
See gh-21081,Add support for customizing RSocketMessageHandler
See gh-21081,Fix typos in mock tests data,Separate server properties for message and errors
Prior to this commit, there was a property server.error.include-details
that allowed configuration of the message and errors attributes in a
server error response.
This commit separates the control of the message and errors attributes
into two separate properties named server.error.include-message and
server.error.include-binding-errors. When the message attribute is
excluded from a servlet response, the value is changed from a
hard-coded text value to an empty value.
Fixes gh-20505,Merge pull request #20961 from vpavic
* gh-20961:
  Polish "Add support for customizing Spring Session's cookie serializer"
  Add support for customizing Spring Session's cookie serializer
Polish "Add support for customizing Spring Session's cookie serializer"
See gh-20961,Add support for customizing Spring Session's cookie serializer
This commit introduces a CookieSerializerCustomizer callback that
allows the customization of the auto-configured
DefaultCookieSerializer bean. This is particularly useful for
configuring cookie serializer's capabilities, such as SameSite, that
are not supported by the Servlet API and therefore not exposed via
server.servlet.session.cookie.* properties.
See gh-20961,Use paketo-buildpacks/builder as default builder
This commit changes the default builder image from
`cloudfoundry/cnb:bionic-platform-api-0.2` to
`gcr.io/paketo-buildpacks/builder:base-platform-api-0.3`. It also
uses a `paketo-buildpacks/builder` image instead of a
`cloudfoundry/cnb` image to test compatibility with lifecycle v2
and uses paketo naming instead of cloudfoundry when mocking builder
interactions.
Some adjustments to lifecycle phases were also made to align more
closely with the pack CLI.
Fixes gh-21066,Upgrade to Spring Integration 5.3.0.RC1
Improve compatibility by replacing use of seq with a native for-loop
Upgrade to Spring Kafka 2.5.0.RC1
Bind and unbind Kafka metrics as consumers and producers come and go
Fixes gh-21008
Co-authored-by: Andy Wilkinson <awilkinson@pivotal.io>,Upgrade to Artifactory Resource 0.0.12
Rename property for registering default Servlet
As a follow-up for gh-21214, this commit renames the property to:
`"server.servlet.register-default-servlet=false"`
Add property for registering default Servlet
This commit adds a new configuration property for configuring the
registration of the default Servlet in Servlet containers.
`"server.servlet.default-servlet.registered=false"`
The default of this property is still `true`, as it's been the case in
previous releases.
Merge pull request #21207 from PaddyDrury
* gh-21207:
  Polish "Stop limiting layer customization to external modules"
  Stop limiting layer customization to external modules
Polish "Stop limiting layer customization to external modules"
See gh-21207,Stop limiting layer customization to external modules
See gh-21207,Merge pull request #21212 from dreis2211
* pr/21212:
  Fix some deprecations
Fix some deprecations
See gh-21212,Upgrade to Spring AMQP 2.2.6
Upgrade to WebJars Locator Core 0.45
Upgrade to Tomcat 9.0.34
Upgrade to Spring WS 3.0.9.RELEASE
Upgrade to SendGrid 4.4.8
Upgrade to Selenium HtmlUnit 2.39.0
Upgrade to Rabbit AMQP Client 5.9.0
Upgrade to OkHttp3 3.14.8
Upgrade to Netty 4.1.49.Final
Upgrade to Neo4j OGM 3.2.11
Upgrade to MySQL 8.0.20
Upgrade to MongoDB 4.0.2
Upgrade to Log4j2 2.13.2
Upgrade to Liquibase 3.8.9
Upgrade to Kotlin 1.3.72
Upgrade to JUnit Jupiter 5.6.2
Upgrade to Jetty 9.4.28.v20200408
Upgrade to Jackson Bom 2.11.0
Upgrade to InfluxDB Java 2.18
Upgrade to Infinispan 10.1.6.Final
Upgrade to HtmlUnit 2.39.1
Upgrade to HikariCP 3.4.3
Upgrade to Hibernate Validator 6.1.4.Final
Upgrade to Hibernate 5.4.14.Final
Upgrade to Groovy 2.5.11
Upgrade to Glassfish JAXB 2.3.3
Upgrade to Flyway 6.3.3
Upgrade to Flatten Maven Plugin 1.2.2
Upgrade to Dropwizard Metrics 4.1.6
Upgrade to Couchbase Client 3.0.3
Upgrade to Cassandra Driver 4.6.0
Upgrade to Caffeine 2.8.2
Upgrade to Artemis 2.12.0
Upgrade to AppEngine SDK 1.9.80
\gh-20952
Upgrade to Spring AMQP 2.2.6
Upgrade to Spring Kafka 2.2.13
Upgrade to Spring AMQP 2.1.14
Allow base packages to be specified on @AutoConfigurationPackage
Tolerate Hazelcast 4
This commit updates HazelcastHealthIndicator and
HazelcastCacheMeterBinderProvider so that they work with
Hazelcast 4 while retaining compatibility with Hazelcast 3. Reflection
is used when necessary.
This commit also adds a smoke test that validates those features are
working when Hazelcast 4 is on the classpath.
Add support for enabling ISO date, time, and date-time formatting
Merge pull request #18772 from knittl
* gh-18772:
  Polish "Enable users to provide custom time and datetime formats"
  Enable users to provide custom time and datetime formats
Polish "Enable users to provide custom time and datetime formats"
See gh-18772,Enable users to provide custom time and datetime formats
Extend WebFlux and WebMvc properties with timeFormat and
dateTimeFormat properties to allow users to customize format of
LocalTime and LocalDateTime instances.
See gh-18772,Expand configuration class eager filtering to imports
Previously, only root auto-configuration classes could be excluded
eagerly via an AutoConfigurationImportFilter. Any configuration class
loaded as a result of processing a particular auto-configuration were
parsed and checked as usual.
This commit makes use of the `getExclusionFilter` callback to expand
this filter to all candidates that are considered. The annotation
processor has also be expanded to generate metadata for non-root
configuration classes.
Upgrade to Micrometer 1.5.0
Stop relying on transitive com.nimbusds:oauth2-oidc-sdk dependency,Add dependency management for OAuth2 OIDC SDK
Replace "folder" with "directory"
Consistently use the term "directory" instead of "folder"
Fix StatusAggregator static initialization
Prior to this commit, there was a cycle between `StatusAggregator` and
`SimpleStatusAggregator`, which caused a static initialization bug -
depending on which class (the implementation or its interface) was
loaded first.
This commit turns the static field of the `StatusAggregator` interface
into a static method to avoid this problem.
Fixes gh-21211,Upgrade to Spring Data Neumann-RC2
Upgrade to Spring HATEOAS 1.1.0.RC1
Upgrade to Spring Framework 5.2.6
Upgrade to Spring HATEOAS 1.0.5.RELEASE
Upgrade to Spring Data Lovelace-SR17
Upgrade to Spring Framework 5.1.15
Upgrade to Solr 8.5.1
Upgrade to Lettuce 5.3.0.RELEASE
Merge pull request #21129 from dreis2211
* gh-21129:
  Delete Toml class
Delete Toml class
See gh-21129,Upgrade to Spring Doc Resources 0.2.2.RELEASE
Upgrade to RSocket 1.0.0-RC7
This commit upgrades to RSocket 1.0.0-RC7.
This new RC brings API changes we have to adapt to. As of this commit,
we're introducing a new `RSocketServerCustomizer` which replaces the now
deprecated `ServerRSocketFactoryProcessor`.
Upgrade to Spring Security 5.2.3.RELEASE
Upgrade to Spring Batch 4.2.2.RELEASE
Upgrade to Postgresql 42.2.12
Upgrade to Neo4j Ogm 3.2.11
Upgrade to Liquibase 3.8.9
Upgrade to Kotlin 1.3.72
Upgrade to Infinispan 9.4.19.Final
Upgrade to Hibernate Validator 6.0.19.Final
Upgrade to Hibernate 5.4.14.Final
Upgrade to Elasticsearch 6.8.8
Upgrade to Jetty 9.4.28.v20200408
Upgrade to Groovy 2.5.11
Upgrade to Tomcat 9.0.34
Upgrade to Johnzon Jsonb 1.2.4
Upgrade to Byte Buddy 1.10.9
Upgrade to Mysql 8.0.20
Upgrade to Joda Time 2.10.6
Upgrade to Netty 4.1.49.Final
Upgrade to Micrometer 1.3.8
Upgrade to Dropwizard Metrics 4.1.6
Upgrade to Hikaricp 3.4.3
Upgrade to Sendgrid 4.4.8
Upgrade to Appengine Sdk 1.9.80
Upgrade to Caffeine 2.8.2
Upgrade to Couchbase Client 2.7.14
Update `JarFile` so that `super.close()` is called early so that the
file is not left open. Since we re-implement `JarFile` methods to work
directly on the underlying `RandomAccessDataFile`, it should be safe
to close immediately.
Throw exception if classpath*: is used
Update `ConfigFileApplicationListener` to throw a better exception if
`classpath*:` is used as a location.
Start using Artifactory Resource 0.0.12 snapshots
See gh-21170,Revert "Single-thread interaction with Artifactory"
This reverts commit 8404ae7f383ba585551b1492b9549b5ca3923c80. The
long-shot didn't pay off.,Automatically create developmentOnly configuration
Previously, the developmentOnly configuration, typically used for
Devtools, had to be declared manually. The BootJar and BootWar tasks
then had a property, excludeDevtools, that could be used to control
whether or not Devtools would be excluded from the executable archive.
This commit updates the reaction to the Java plugin being applied to
automatically create the developmentOnly configuration. The classpaths
of bootJar and bootWar are then configured not to include the contents
of the developmentOnly configuration. As a result of this, the
excludeDevtools property is no longer needed and has been deprecated.
Its default has also been changed from true to false to make it easy
to opt in to Devtools, when configured as a development-only
dependency, being included in executable jars and wars by adding
developmentOnly to the classpath of the archive task.
Upgrade to Reactor Bom Dysprosium-SR7
Clsoes gh-20937,Revert "Add support for Reactor Netty Micrometer metrics"
This commit removes the support for Reactor Netty metrics since it
seems that Spring Boot should not use this feature:
* HTTP metrics are already covered by WebFlux
* TCP metrics are only meant to TCP server/clients
* allocator metrics are already provided by Netty and there is
no specific API to enable them here.
Merge pull request #21130 from richard1230
* pr/21130:
  Polish contribution
  Polish
Polish contribution
See gh-21130,Polish
See gh-21130,Merge pull request #21137 from dreis2211
* pr/21137:
  Remove empty test rule package
Remove empty test rule package
See gh-21137,Merge branch '2.2.x',Merge branch '2.1.x' into 2.2.x,Upgrade to Maven Dependency Plugin 3.1.2
Upgrade to Xmlunit2 2.6.4
Upgrade to Spring Ws 3.0.9.RELEASE
Upgrade to Spring Session Bom Bean-SR10
Upgrade to Spring Security 5.1.9.RELEASE
Upgrade to Spring Batch 4.1.4.RELEASE
Upgrade to Postgresql 42.2.12
Upgrade to Neo4j Ogm 3.1.19
Upgrade to Mimepull 1.9.13
Upgrade to Infinispan 9.4.19.Final
Upgrade to Hibernate Validator 6.0.19.Final
Upgrade to Hibernate 5.3.16.Final
Upgrade to Freemarker 2.3.30
Upgrade to Jetty 9.4.28.v20200408
Upgrade to Janino 3.0.16
Upgrade to Groovy 2.5.11
Upgrade to Tomcat 9.0.34
\gh-21151
Upgrade to Solr 7.7.3
Upgrade to Httpclient 4.5.12
Upgrade to Activemq 5.15.12
Upgrade to Mysql 8.0.20
Upgrade to Joda Time 2.10.6
Upgrade to Undertow 2.0.30.Final
Upgrade to Rxjava2 2.2.19
Upgrade to Netty Tcnative 2.0.30.Final
Upgrade to Netty 4.1.49.Final
Upgrade to Micrometer 1.1.13
Upgrade to Appengine Sdk 1.9.80
Upgrade to Jackson 2.9.10.20200411
Upgrade to Couchbase Client 2.7.14
Add support for Reactor Netty Micrometer metrics
This commit enables the production of TCP and buffer allocator metrics
for Reactor Netty, client and server.
When applications use auto-configured server
(`NettyReactiveWebServerFactory`) and client (through
`WebClient.Builder`) instances, metrics will be enabled.
Note that HTTP metrics are not enabled here, since similar metrics are
already produced at the WebFlux level. Also, to avoid cardinality
explosion of metrics (through the URI tag), Reactor Netty offers
configurable infrastructure to deduplicate URI tags by turning expanded
URI instances into templated URIs. This is not targeted for Spring
usage.
Add ReactorNettyHttpClientMapper
This new customizer-like interface make it possible to configure the
Reactor Netty `HttpClient` that is going to be used by the
`WebClient.Builder` provided by Spring Boot.
Fix deprecations after Reactor Netty upgrade,Merge branch '2.2.x'
See gh-21127,Attempt to prevent JarFiles from being left open
Update `JarFile` to also call `super.close()` early for nested jars.
See gh-21126,Merge branch '2.2.x'
See gh-21127,Attempt to prevent JarFiles from being left open
Update `JarFile` so that `super.close()` is called early so that the
file is not left open. Since we re-implement `JarFile` methods to work
directly on the underlying `RandomAccessDataFile`, it should be safe
to close immediately.
See gh-21126,Merge pull request #20806 from mikesmithson
* pr/20806:
  Polish "Add instruction to format code in buildSrc"
  Add instruction to format code in buildSrc
Polish "Add instruction to format code in buildSrc"
See gh-20806,Add instruction to format code in buildSrc
See gh-20806,Merge branch '2.2.x'
Merge pull request #21077 from nikmanzotti
* pr/21077:
  Polish "Enhance Database initialization how to guide"
  Enhance Database initialization how to guide
Polish "Enhance Database initialization how to guide"
See gh-21077,Enhance Database initialization how to guide
See gh-21077,Merge branch '2.2.x'
Merge pull request #21002 from dreis2211
* pr/21002:
  Fix typo
Fix typo
See gh-21002,Merge pull request #21117 from dreis2211
* pr/21117:
  Remove unused method
Remove unused method
See gh-21117,Merge pull request #21110 from izeye
* pr/21110:
  Polish
Polish
See gh-21110,Merge pull request #21103 from dreis2211
* pr/21103:
  Avoid recompiling pattern in Handler#canonicalize
Avoid recompiling pattern in Handler#canonicalize
See gh-21103,Merge pull request #21079 from dreis2211
* pr/21079:
  Fix link to R2DBC Query in docs
Fix link to R2DBC Query in docs
See gh-21079,Merge pull request #21054 from dreis2211
* pr/21054:
  Fix Actuator API PDF name
Fix Actuator API PDF name
See gh-21054,Merge pull request #21009 from dreis2211
* pr/21009:
  Update copyright year of changed file
  Polish
Update copyright year of changed file
See gh-21009,Polish
See gh-21009,Merge pull request #21007 from izeye
* pr/21007:
  Update copyright year of changed files
  Remove this keyword on member method invocations
Update copyright year of changed files
See gh-21007,Remove this keyword on member method invocations
See gh-21007,Merge pull request #20992 from mikaelparsekyan
* pr/20992:
  Polish ApplicationHome
Polish ApplicationHome
See gh-20992,Merge branch '2.2.x'
Broaden deprecation warning check in Gradle Plugin's tests
Attempt to stabilise CouchbaseAutoConfigurationIntegrationTests
Starting the CouchbaseContainer fails intermittently when creation
of the primary index for the bucket fails with a read timeout. The
test doesn't require a primary index for the bucket so this commit
disables it creation in the hope that it will help to stabilise the
test.,Avoid capturing TCCL when creating DefaultResourceLoaders
Previously, DefaultResourceLoader instances were created using the
default constructor. This causes the resource loader to capture the
TCCL that was in place at that time. This can lead to a class loader
leak if the resource loader is referenced directly or indirectly from
a static field of a class loaded by a different class loader.
This commit updates the creation of DefaultResourceLoader instances
in main code so that the resource load will use the class loader of
the creating class. In almost all cases this will be the same class
loader as was the thread context class loader that was being captured
so the change in behavior is minimal. Crucially, it will still address
the situation where the TCCL was different.
Note the DevTools' ApplicationContextResourceLoader has been updated
to explicitly use the TCCL. This ensures that it uses the restart
class loader which is required for DevTools to function correctly.
Fixes gh-20900,Deprecate support for Bitronix
Close gh-20507 in 2.3.0.RC1,Merge branch '2.1.x' into 2.2.x
Improve @Value documentation
Improve "@ConfigurationProperties vs. @Value" documentation with the
recommendation that kebab-case is used with the `@Value` annotation.
* pr/21104:
  Fix PropertiesMigrationListenerTests
Fix PropertiesMigrationListenerTests
See gh-21104,Merge branch '2.2.x'
Limit when PortInUseException is thrown
Refactor `PortInUseException` logic to a single place and refine when
the exception is thrown.
Prior to this commit, we assumed that a `BindException` was only thrown
when the port was in use. In fact, it's possible that the exception
could be thrown because the requested address "could not be assigned".
We now only throw a `PortInUserException` if the `BindException` message
includes the phrase "in use".
Fixes gh-21101,Merge branch '2.2.x',Polish,Use current timestamp for index files with Gradle
This commit removes changes the timestamp used when writing the
classpath and layers index files in the Gradle plugin to be the
current timestamp unless `preserveFileTimestamps=true`. It also
polishes some duplication in the handling of entry attributes
when creating the fat archive and adds a test to verify that
the Gradle plugin uses the same fixed timestamp constant as
Gradle uses internally.
See gh-21005,Merge branch '2.2.x'
@SpringBootTest classes with different args shouldn't share a context
Fixes gh-20866,Remove metadata for configuration keys that were removed in 2.0
Polish,Merge branch '2.2.x'
Add missing metadata for removed configuration keys
Order additional metadata according to lexicographic order
Polish,Rename Service Level Agreement to Service Level Objective
This commit harmonizes our integration of Micrometer's Service Level
objectives.
Upgrade Java 14 version in CI image
Upgrade Java 8 version in CI image`
Upgrade Java 8 version in CI image
Add "Health as Gauge" how-to documentation
Add how-to documentation describing how health information can be
exported to a Micrometer Gauge.
Prevent early initialization in MockitoPostProcessor
Fixes gh-20665,Polish,Merge branch '2.2.x'
Remove outdated FIXMEs from tests
Merge pull request #21069 from jkschneider
* gh-21069:
  Polish "Improve property name in thrown Micrometer ValidationException"
  Improve property name in thrown Micrometer ValidationException
Polish "Improve property name in thrown Micrometer ValidationException"
See gh-21069,Improve property name in thrown Micrometer ValidationException
See gh-21069,Polish,Update copyright year of changed files,Fail operations when JarFile is closed
Update `JarFile` to track when the instance has been closed and throw
an exception in the same way that `ZipFile` does.
\gh-21074
Fixes gh-21073,Merge branch '2.2.x'
Relocate section on configuring DevTools' file system watcher
Preserve timestamps on loader directories
Prior to this commit, when the Maven plugin copied
spring-boot-loader.jar to a repackaged archive the timestamps of class
files were preserved but the timestamps of directories were not
preserved. This resulted in the directories having a current timestamp.
This commit copies the directory timestamps from spring-boot-loader.jar
to the repackaged archive and adds tests to verify the proper
behavior.
See gh-20927,Create new JarFile instance for URL connections
Update `JarURLConnection` to ensure that when connections are opened
a new copy of the JarFile is provided.
Prior to this commit, a single `JarFile` instance was shared which meant
that it could be accidental closed if accessed via
`JarURLConnection.getJarFile()`. If the underlying jar file is closed
then it's possible for a `NoClassDefFoundError` to be thrown if running
on JDK 11 with an active `SecurityManager`.
Auto-configure cors on WelcomePageHandlerMapping
Update `WebMvcAutoConfiguration` to automatically apply cors
configuration to the `WelcomePageHandlerMapping`.
Fixes gh-21048,Merge pull request #21067 from jkschneider
* gh-21067:
  Polish "Update validation of Micrometer configuration"
  Update validation of Micrometer configuration
Polish "Update validation of Micrometer configuration"
See gh-21067,Update validation of Micrometer configuration
See gh-21067,Review Cassandra's timeout options
This commit reviews the current timeout options. It creates a connection
and request sub-namespace to separate concerns a bit more.
Add dependency management for the Wavefront SDK
Merge pull request #20994 from vpavic
* improve-es-config:
  Polish
  Improve Elasticsearch RestClient customization capabilities
Polish "Add support for initializing nested object when nothing bound"
This commit harmonizes the change made to @DefaultValue to the
annotation processor. If such annotation is added to a scalar value with
no value at all, no default value is produced.
Polish
See gh-20994,Improve Elasticsearch RestClient customization capabilities
At present, RestClientBuilderCustomizer allows general customization of RestClientBuilder.
This is troublesome for users that want to customize `HttpAsyncClientBuilder` and
`RequestConfig.Builder` since those are set on the `RestClientBuilder`. By customizing
those two builders user lose out on Spring Boot's support for binding username, password,
connection-timeout and read-timeout properties from `"spring.elasticsearch.rest"` namespace.
This commit enhances the `RestClientBuilderCustomizer` with support for customizing
`HttpAsyncClientBuilder` and `RequestConfig.Builder` by providing additional `customize`
methods that accept the aforementioned builders. Both new methods are optional as they have
no-op default implementations.
See gh-20994,Merge branch '2.2.x'
Fix typo in IncludeExcludeEndpointFilter's name
Don't throw NettyWebServer on permission errors
Update `NettyWebServer` so that the `PortInUseException` is not thrown
for permission denied errors.
Fixes gh-19807,Include cause when throwing PortInUseException
Update classes that throw `PortInUseException` so that they also
include the cause. Prior to this commit the cause was not included
which could make diagnosing the real cause difficult.
See gh-19807,Polish,Merge branch '2.2.x'
Process additional locations when non-default location configured
Fixes gh-20745,Fix Dockerfile example in docs
Fixes gh-21020,Merge branch '2.2.x'
Add support for initializing nested object when nothing bound
When using constructor binding, if no properties are bound to
a nested property, the top-level instance will be created with a
null value for the nested property.
This commit introduces support for an empty `@DefaultValue` which
indicates that an instance of the nested property must be created
even if nothing is bound to it. It honors any `@DefaultValue`
annotations that the nested property might have in its constructor.
Fix ConditionalOnAvailableEndpoint dashed matching
Update `ConditionalOnAvailableEndpoint` so that it now uses the same
matching code as the endpoint filter. This allows the condition to
match endpoint IDs that contain a dash.
In order to share logic, the `ExposeExcludePropertyEndpointFilter` class
has been deprecated and its logic moved to a new `expose` package
under `IncludExcludeEndpointFilter`. This filter is used by both the
`OnAvailableEndpointCondition` and the auto-configuration classes.
Fixes gh-21044,Merge branch '2.2.x'
Test that gridFsDatabase is honored by auto-configured GridFsTemplate
Use consistent logic to determine Artifactory repo from version
Fixes gh-21034,Configure Cassandra's request throttling
Add IsolationLevel regression test with Kafka 2.4
This commit makes sure that our copy of the IsolationLevel enum is
consistent with what Kafka 2.4 provides
Merge pull request #21030 from dreis2211
* gh-21030:
  Fix links to CLI binaries in non-snapshot builds
Fix links to CLI binaries in non-snapshot builds
See gh-21030,Merge pull request #21033 from dreis2211
* gh-21033:
  Fix anchors in links to Maven and Gradle plugin docs
Fix anchors in links to Maven and Gradle plugin docs
See gh-21033,Revert unintended Jackson upgrade
This partially reverts commit 1f8ea54c.,Upgrade to Kafka 2.5.0
Restore Graphite tags behaviour unless configured explicitly
This commit harmonizes how Graphite is configured. If tagsAsPrefix is
set, it is used transparently. Otherwise, the new native tagging system
is used.
See https://github.com/micrometer-metrics/micrometer/pull/2007
Document relaxed binding from the environment
Update the reference documentation with more details about how relaxed
binding works against environment variables.
Document devtool property file profile restrictions
Fix checkstyle issues from forward merge.
See gh-21022,Merge branch '2.2.x'
Allow exposure patterns to match dashed IDs
Update `ExposeExcludePropertyEndpointFilter` so that patterns will
also match endpoint IDs that contain a dash.
Apply configuration properties deprecation consistently
This commit makes sure that both the getter and the setter of a
deprecated configuration properties is flagged with `@Deprecated`.
Remove deprecated configuration properties
This commit removes the following deprecated properties:
* `server.connection-timeout`
* `server.use-forward-headers`
* `server.jetty.max-http-post-size`
* `server.tomcat.max-http-post-size`
Support commas in @ActiveProfiles
Update `SpringBootContextLoader` so that it correctly deals with an
`@ActiveProfiles` annotation that contains a comma.
Fixes gh-19537
Co-authored-by: Scott Frederick <sfrederick@pivotal.io>
Co-authored-by: Andy Wilkinson <awilkinson@pivotal.io>,Allow square bracket notation profiles properties
Update `ConfigFileApplicationListener` so that `spring.profiles.active`
and `spring.profiles.include` can use the square bracket list notation.
Prior to this commit, only comma-separated lists could be used for
those values.
Polish,Fix archive attributes in Gradle plugin
This commit ensures that file permissions are set on entries that the
Gradle plugin adds to an archive. It also reverts the constant date
and time used for added entries to a previous value to ensure a time
zone offset is not applied.
See gh-20927,Merge branch '2.2.x'
Allow empty URIs to create embedded datasource
Refine `DataSourceAutoConfiguration` conditions so that an empty
`spring.datasource.url` property can be used to enable the embedded
source.
Fixed gh-20996,Merge pull request #20923 from zolikm
* pr/20923:
  Use RequestDispatcher.ERROR_STATUS_CODE constant
Use RequestDispatcher.ERROR_STATUS_CODE constant
See gh-20923,Merge pull request #20830 from straumat
* pr/20830:
  Add reference to XChange starter
Add reference to XChange starter
See gh-20830,Deprecate unused ErrorController interface method
This commit marks as deprecated an interface method that is no longer
used, and changes all internal implementations to return `null` to
make the fact that the return value is not used more obvious.
Fixes gh-19844,Support server.error config in management context
Prior to this commit, the ManagementErrorEndpoint used to handle error
responses for the management servlet excluded stacktrace and exception
message details from the response unconditionally.
With this commit, the endpoint honors the
`server.error.include-stacktrace` and `server.error.include-details`
properties to conditionally include error details for consistency
with non-management error handling.
Fixes gh-20989,Fix typo,Disable exception details on default error views
Prior to this commit, default error responses included the message
from a handled exception. When the exception was a BindException, the
error responses could also include an errors attribute containing the
details of the binding failure. These details could leak information
about the application.
This commit removes the exception message and binding errors detail
from error responses by default, and introduces a
`server.error.include-details` property that can be used to cause
these details to be included in the response.
Fixes gh-20505,Merge pull request #20928 from dreis2211
* pr/20928:
  Polish "Optimize AutoConfigurationImportSelector.filter()"
  Optimize AutoConfigurationImportSelector.filter()
Polish "Optimize AutoConfigurationImportSelector.filter()"
See gh-20928,Optimize AutoConfigurationImportSelector.filter()
See gh-20928,Polish
See gh-20975,Merge pull request #20973 from izeye
* pr/20973:
  Polish
Polish
See gh-20973,Start building against Spring Kafka 2.5.0 snapshots
See gh-20953,Merge branch '2.2.x'
Upgrade Java 11 version in CI image
Switch docker upgrade script to submit issue rather than PR
Polish,Merge pull request #20966 from yidongnan
* pr/20966:
  Polish "Add reference to gRPC starter"
  Add reference to gRPC starter
Polish "Add reference to gRPC starter"
See gh-20966,Add reference to gRPC starter
See gh-20966,Merge branch '2.2.x'
Merge pull request #20882 from Konrado85
* pr/20882:
  Polish "Polish JarFile to extra anonymous inner class"
  Polish JarFile to extra anonymous inner class
Polish "Polish JarFile to extra anonymous inner class"
See gh-20882,Polish JarFile to extra anonymous inner class
See gh-20882,Merge pull request #20967 from dreis2211
* pr/20967:
  Prevent shaded imports from Datastax
Prevent shaded imports from Datastax
See gh-20967,Merge pull request #20936 from dreis2211
* pr/20936:
  Upgrade to Testcontainers 1.14.0
Upgrade to Testcontainers 1.14.0
See gh-20936,Polish,Start building against Spring Kafka 2.4.6 snapshots
See gh-20953
Start building against Spring Integration 5.3.0 snapshots
See gh-20951,Start building against Spring Data Neumann-RC2 snapshots
See gh-20949,Start building against Spring AMQP 2.2.6 snapshots
See gh-20947,Start building against Spring Framework 5.2.6 snapshots
See gh-20945,Start building against Reactor Dysprosium-SR7 snapshots
See gh-20943,Remove @ConditionalOnMissingBean check on deprecated class
Make it more obvious that Jolokia does not work with a WebFlux app
Rework some aspects of the probes support
Update availability/probe documentation
Update the application availability and probes documentation following
the recent set of updates.
See gh-20962,Change HealthEndpointGroups customization support
Update the `HealthEndpointGroups` customization support to use a
post-processor rather than a mutable registry. Although this approach
is slightly less flexible, it removes a lot of complexity from the
`HealthEndpointGroups` code. Specifically, it allows us to drop the
`HealthEndpointGroupsRegistry` interface entirely.
The probe health groups are now added via the post-processor if they
aren't already defined. Unlike the previous implementation, users are
no longer able to customize status aggregation and http status code
mapping rules _unless_ they also re-define the health indicators that
are members of the group.
See gh-20962,Support `management.health.probes.enabled=false`
Update `AvailabilityProbesAutoConfiguration` to allow the
`management.health.probes.enabled` property to override the platform
detection logic. Prior to this commit, it was possible to use the
property to enable the probes, but it was not possible to disable
them when deploying to Kubernates.
See gh-20962,Restructure probes auto-configuration
Relocate probe auto-configuration from the `kubernetes` package to
`availability` since probes could also be used on other platforms.
The classes have also been renamed to named to `AvailabilityProbes...`
See gh-20962,Rename probe health indicators
Rename `LivenessProbeHealthIndicator` to `LivenessStateHealthIndicator`
and `ReadinessProbeHealthIndicator` to `ReadinessStateHealthIndicator`.
Also introduce a general purpose `AvailabilityStateHealthIndicator`
class.
See gh-20962,Allow custom availability states
Create a general purpose `AvailabilityState` interface and refactor
the existing `LivenessState` and `ReadinessState` to use it. A single
`AvailabilityChangeEvent` is now used to carry all availability state
updates.
This commit also renames `ApplicationAvailabilityProvider` to
`ApplicationAvailabilityBean` and extracts an `ApplicationAvailability`
interface that other beans can inject. The helps to hide the event
listener method, which is really internal.
Finally the state enums have been renamed as follows:
 - `LivenessState.LIVE` -> `LivenessState.CORRECT`
 - `ReadinessState.READY` -> `ReadinessState.ACCEPTING_TRAFFIC`
 - `ReadinessState.UNREADY` -> `ReadinessState.REFUSING_TRAFFIC`
See gh-20962,Add gradle default task,Merge branch '2.2.x',Upgrade to Spring Doc Resources 0.2.1.RELEASE
Start building against Spring Kafka 2.3.8 snapshots
See gh-20952,Start building against Spring Integration 5.2.6 snapshots
See gh-20950,Start building against Spring Data Moore-SR7 snapshots
See gh-20948,Start building against Spring AMQP 2.2.6 snapshots
See gh-20946,Start building against Spring Framework 5.2.6 snapshots
See gh-20944,Start building against Reactor Dysprosium-SR7 snapshots
See gh-20942,Merge branch '2.1.x' into 2.2.x,Merge branch '2.2.x'
Fix Undertow compression config with invalid Mime Types
Prior to this commit, the Undertow compression configuration provided by
Spring Boot would fail and throw an exception for invalid MIME Types
when trying to check them against the list of configured types for
compression.
This commit ensures that invalid MIME Types are ignored and that
compression is disabled for those.
Fixes gh-20955,Start building against Spring Integration 5.1.10 snapshots
See gh-20941,Start building against Spring Data Lovelace-SR17 snapshots
See gh-20940,Start building against Spring AMQP 2.1.14 snapshots
See gh-20939,Start building against Spring Framework 5.1.15 snapshots
See gh-20938,Start building against Reactor Californium-SR18 snapshots
See gh-20937,Polish,Merge pull request #20931 from izeye
* pr/20931:
  Polish
Polish
See gh-20931,Merge pull request #20872 from Konrado85
* pr/20872:
  Change PropertiesLauncher equals method to use URI
Change PropertiesLauncher equals method to use URI
See gh-20872,Merge pull request #20915 from mnusan
* pr/20915:
  Polish "Add reference to Mule 4 starter"
  Add reference to Mule 4 starter
Polish "Add reference to Mule 4 starter"
See gh-20915,Add reference to Mule 4 starter
See gh-20915,Merge pull request #20926 from dreis2211
* pr/20926:
  Remove unused fields in tests
Remove unused fields in tests
See gh-20926,Improve recording of cancellation signal in WebClient
With its initial fix in gh-18444, the `WebClient` instrumentation would
record all CANCEL signals, including:
* when a `timeout` expires and the response has not been received
* when the client partially consumes the response body
Since the second use case is arguable intentional, this commit restricts
the instrumentation and thus avoids recording two events for a single
request in that case.
Polish,Merge pull request #20917 from dhirenmathur
* pr/20917:
  Polish "Align Kafka's missingTopicsFatal default value"
  Align Kafka's missingTopicsFatal default value
Polish "Align Kafka's missingTopicsFatal default value"
See gh-20917,Align Kafka's missingTopicsFatal default value
See gh-20917,Merge pull request #20857 from vpavic
* improve-es-config:
  Harmonize naming of Elasticsearch auto-configuration classes
Harmonize naming of Elasticsearch auto-configuration classes,Add git-repo as an output for windows slack notification
See gh-19703,Record cancelled client requests in WebClient
Prior to this commit, cancelled client requests (for example as a result
of a `timeout()` reactor operator would not be recorded by Micrometer.
This commit instruments the cancelled signal for outgoing client
requests and assigns a status `CLIENT_ERROR`.
The cancellation can be intentional (triggering a timeout and falling
back on a faster alternative) or considered as an error. The intent
cannot be derived from the signal itself so we're considering it as a
client error.
Merge pull request #20913 from cicioflaviu
* pr/20913:
  Add package-info to buildpack.platform.docker.ssl
Add package-info to buildpack.platform.docker.ssl
See gh-20913,Merge pull request #20755 from dreis2211
* pr/20755:
  Improve Binder performance slightly
Improve Binder performance slightly
See gh-20755,Fix startup failure when WebFlux auto-config is skipped
Prior to this commit, the `HttpHandlerAutoConfiguration` would rely on
the `WebFluxProperties` bean being present - this is most of the time
true when the appplication is using the WebFlux auto-configuration.
If the application is overriding the WebFlux auto-configuration and
providing its own setup, the properties bean is not present and we
should skip its usage.
Fixes gh-20891,Merge pull request #20911 from dreis2211
* pr/20911:
  Fix unused parameters
Fix unused parameters
See gh-20911,Adapt to Wavefront SDK 2.1
Merge pull request #20907 from avaz
* pr/20907:
  Fix typo
Fix typo
See gh-20907,Add support for NewRelicClientProvider
Provide a condition for detecting war deployments
Add build scan URI to Slack notifications from CI
Fixes gh-19703,Configure OncePerRequestFilters with all dispatcher types by default
Merge pull request #20805 from mikesmithson
* gh-20805:
  Polish "Split ConventionsPlugin into separate, more focussed classes"
  Split ConventionsPlugin into separate, more focussed classes
Polish "Split ConventionsPlugin into separate, more focussed classes"
See gh-20805,Split ConventionsPlugin into separate, more focussed classes
See gh-20805,Merge branch '2.2.x'
Merge pull request #20799 from ericus20
* gh-20799:
  Polish "Update endpoint enablement description to describe availability"
  Update endpoint enablement description to describe availability
Polish "Update endpoint enablement description to describe availability"
See gh-20799,Update endpoint enablement description to describe availability
See gh-20799,Merge branch '2.2.x'
Upgrade Ubuntu version in CI images
Use Micrometer's getDefaultSenderBuilder
This commit removes the duplication added temporarily in Spring Boot to
initialize a default WavefrontSender builder.
This commit also disables a test is failing at the moment, see
https://github.com/micrometer-metrics/micrometer/issues/1964
See gh-20854,Remove plugin management for exec-maven-plugin
Merge pull request #20874 from dreis2211
* pr/20874:
  Polish LayersIndex
Polish LayersIndex
See gh-20874,Continue processing properties files on error
Prior to this commit, processing of multiple properties files
discovered using a wildcard pattern would stop on any error
encountered while processing a file or when an empty properties file
was found, causing subsequent files from the pattern to be ignored.
This commit changes the behavior such that subsequent files are
processed on error or on an empty file.
Fixes gh-20873,Revert "Add jetty-server to classpath for integration test"
This reverts commit 4e55f2aab431329d743b1ba3337bdff7a14b0e13.
This workaround is no longer required with the latest Micrometer
snapshot.,Add jetty-server to classpath for integration test
This commit works around a problem with deploying Boot apps to Wildfly
for integration testing while we investigate the root cause.
See gh-20876,Polish integration test,Polish,Rename `singleSignOn` property to `singlesignon`
Rename the SAML `singleSignOn` nested property to `singleSignOn` so
that we don't get problems when using uppercase environment variable
names.
See gh-20584,Polish,Don't use Assert class from loader
Remove the use of `Assert` since it's unavailable that early.,Don't use monospacing in documentation headings
Polish plugin documentation headings,Polish plugin documentation headings,Merge branch '2.2.x'
Merge pull request #20832 from dreis2211
* pr/20832:
  Update copyright year
  Fix WebappLoader constructor deprecations
Update copyright year
See gh-20832,Fix WebappLoader constructor deprecations
See gh-20832,Merge branch '2.2.x'
Merge pull request #20847 from dreis2211
* pr/20847:
  Polish ConditionMessage#because()
Polish ConditionMessage#because()
See gh-20847
Ensure streams are always closed
Update `AbstractJarWriter` to ensure that streams are always closed,
even if entries are not written.,Attempt to fix failing Windows test,Attempt to fix failing Windows test,Remove windows line endings when parsing index,Polish,Merge branch '2.2.x',Cleanup paths to fix tests running on Windows,Cleanup paths to fix tests running on Windows,Change PDF rename logic
Rework the rename logic used to include the reference PDF to try
and workaround the following local build error:
 Encountered duplicate path "reference/pdf/spring-boot-reference.pdf"
 during copy operation configured with DuplicatesStrategy.FAIL
See gh-20829,Fix package tangle in Gradle plugin
Relocate `VersionExtractor` to fix a package tangle.,Polish asciidoc formatting and use sentence case,Test layer index can contain filenames with spaces
Add tests to ensure that the layer index can support filenames that
contain spaces.
Ensure empty layers are written to the index file
Update the `LayersIndex` class to ensure that layers that do not contain
content are still written.
Document executable-jar index files
Update the executable jar appendix to include details of the index
files.
Use YAML compatible classpath.idx format
Update the `classpath.idx` format to align with `layers.idx` and allow
third-parties can parse it as YAML
Use a more compact layers.idx format
Update the `layers.idx` format so that it is more compact and can be
parsed by third-parties as YAML.
Since the branch name doesn't always correspond to the milestone name,
eg, master.
See gh-20680,Merge branch '2.2.x'
Prevent duplication of issues created by CI automation
This is done by checking for existing issues only in the milestone
corresponding to the current branch. For issues, the milestone is assigned
at the time of issue creation. For PRs, since the branch is different the
milestone can be derived from that while triaging the issue.
Document builder configuration for HTTP proxy
This commit adds examples for configuring the default builder to use
an HTTP/HTTPS proxy when building OCI images using the Maven or Gradle
plugin.
Fixes gh-19984,Remove duplication in documentation index files
This commit combines index adoc files for single-page HTML and PDF
into one file to remove duplication. It also renames index files to
reflect the separation between source format and generated output
format.
Finishes gh-20829,Merge pull request #20851 from olegz
* pr/20851:
  Change call to createClassLoader(URL) from 'super' to 'this'
Change call to createClassLoader(URL) from 'super' to 'this'
ExecutableArchiveLauncher.createClassLoader(Iterator) calls
createClassLoader(URL) method with 'super'. This means overriding
createClassLoader(URL) is not possible without also overriding
createClassLoader(Iterator). The switch to 'this' enables that.
See gh-20851,Upgrade to Micrometer 1.5 snapshots,Export metrics to Wavefront using WavefrontSender
This commit upgrades the Wavefront metrics export auto-configuration to
provide a `WavefrontSender` if necessary and use that to export metrics
rather than the http client Micrometer used previously.
As a result, the "read-timeout" and "connect-timeout" properties are no
longer honoured.
Update default value for Wavefront's step size
See gh-20833,Expose Prometheus#histogramFlavor property
Expose Elastic's pipeline and indexDateSeparator properties
Expose AppOptics's floorTimes property
Migrate Kafka metrics to KafkaClientMetrics
Stop auto-configuring a StatsdMetrics bean
StatsD no longer publishes metrics about itself and StatsDMetrics is
deprecated as a result. This commit removes the auto-configuration of
it.
Update SLA boundaries to use double
See https://github.com/micrometer-metrics/micrometer/pull/1909
Expose Graphite's graphiteTagsEnabled property
This commit exposes an additional property for Graphite that allows to
restore the previous default behaviour with regards to tags, i.e.
prefixing the ones defined by the "tagsAsPrefix" property.
Close gh-20834,Update default value for Datadog's default uri
See gh-20833,Start building against Micrometer 1.5.0 snapshots
See gh-20833,Merge pull request #20819 from gevoulga
* pr/20819:
  Add reference to quickfixj spring boot starter
Add reference to quickfixj spring boot starter
See gh-20819,Remove PushRegistry's numThreads deprecated property
See gh-20835,Merge branch '2.2.x'
Deprecated PushRegistry's numThreads property
This property is a left-over and was never used in Micrometer so this
commit deprecates its use so that it can be removed in the next feature
release.
Fix AtlasProperties hierarchy
This commit fixes the AtlasProperties hierarchy so that it no longer is
a StepRegistryProperties. The AtlasConfig on the Micrometer side of
things does not share the common config hierarchy either and some
properties have different default and lifecycle.
Consolidate Maven plugin documentation in plugin reference
This commit moves Maven plugin content from several sections in the
main Spring Boot reference documentation to the plugin-specific
documentation.
Fixes gh-19165,Rename plugin PDF reference doc files
This commit renames the PDF documentation files generated for the
build plugins when the distribution archive is created.
See gh-20829,Fix typo,Merge branch '2.2.x',Merge branch '2.1.x' into 2.2.x,Fix CI dockerfile,Merge branch '2.2.x',Merge branch '2.1.x' into 2.2.x,Add get-docker-url script to image before executing it,Fix typo,Add reference to r2dbc database initialization section
Remove direct dependency on Kafka's IsolationLevel
Fix links to Maven Plugin's documentation in reference guide
Polish new layered jar support,Polish,Polish,Polish,Update Maven and Gradle layer customization docs
Update the Maven and Gradle documentation following the refined
layer customization changes.
See gh-20526,Update reference documentation for layer changes
Update the reference documentation following the jar format changes.
See gh-20813,Support flat jar layering with layertools
Update layertools to support the flat jar format. Layers are now
determined by reading the `layers.idx` file.
Support flat jar layering with Gradle
Update the Gralde plugin so that layered jars now use the regular "flat"
format. The layers.idx file now describes which layer each file should
be placed.
See gh-20813
Co-authored-by: Phillip Webb <pwebb@pivotal.io>,Support flat jar layering with Maven
Update the Maven plugin so that layered jars now use the regular "flat"
format. The layers.idx file now describes which layer each file should
be placed.
See gh-20813
Co-authored-by: Phillip Webb <pwebb@pivotal.io>,Create a new layer for loader classes
Create a dedicated layer that is used to hold the launcher support
classes. The layer sits between `dependencies` and
`snapshot-dependencies` so that the layer is sensible for both
SNAPSHOT and RELEASE versions of Spring Boot
Refine layer customization for Maven and Gradle
Simplify layer customization logic for both Maven and Gradle and
refactor some internals of the Gradle plugin.
Both Maven and Gradle now use a simpler customization format that
consists of `application`, `dependencies` and `layer order` sections.
The `application`, `dependencies` configurations support one or more
`into` blocks that are used to select content for a specific layer.
Allow layertools to work without spring-boot jar
Update `spring-boot-jarmode-layertools` so that it no longer required
a `spring-boot` jar to run.
Polish,Fix formatting,Support both JWT and Opaque token configuration for resource server
Add configuration options for SAML authentication requests
Polish javadoc,Override CloudPlatform auto-detection with configuration property
This commit adds the new "`spring.main.cloud-platform`" configuration
property. This allows applications to override the auto-detection and
force a specific Cloud Platform. This is useful for testing behavior on
a local machine or force the detection of a particular platform.
This commit also adds a new `CloudPlatform.NONE` value that allows
applications to disable the auto-detection of the Cloud Platform, thus
avoiding issues with false positives.
Do not set server.port=-1 for non embedded tests
Merge pull request #20205 from wonwoo
* wonwoo/master:
  Polish
  Configure codec buffer size in ES Reactive Rest client
Polish
See gh-20205,Configure codec buffer size in ES Reactive Rest client
This commit adds a new configuration property
`"spring.data.elasticsearch.client.reactive.max-in-memory-size"`
which configures the maximum amount of memory buffered by the
`WebClient` used by the Reactive ElasticSearch client.
See gh-20205,Remove deprecated Humio's repository property
Upgrade to Spring Integration 5.3.0.M4
Merge pull request #20756 from spring-buildmaster
* pr/20756:
  Upgrade to Docker 19.03.8 in CI
Upgrade to Docker 19.03.8 in CI
See gh-20756,Merge branch '2.2.x'
Merge pull request #20793 from dreis2211
* pr/20793:
  Harmonize issue title for auto-created Docker upgrade issues
Harmonize issue title for auto-created Docker upgrade issues
See gh-20793,Polish,Support CNB builder platform API 0.3
This commit adds support for Cloud Native Buildpacks builder platform
API 0.3, which is the latest platform API available currently. Support
for platform API 0.1 has been removed, adopting the policy of the pack
CLI to support the current platform API version and one version prior.
Fixes gh-20757,Use platform API builder image tags
CNB builder images are now being tagged in a manner that indicates
the version of the platform API implemented. This allows Spring Boot
to default to a builder tag that guarantees API compatibility while
allowing for updates to bundled buildpacks.
Fixes gh-20171,Restructure and polish docker code
Restructure and polish docker code to fix a package tangle and
provide better separation of concerns.,Update copyright year of changed files,Polish,Upgrade to Spring Kafka 2.4.5.RELEASE
Merge pull request #20729 from gurbuzali
* pr/20729:
  Polish "Disable Hazelcast auto-configuration when Jet is present"
  Disable Hazelcast auto-configuration when Jet is present
Polish "Disable Hazelcast auto-configuration when Jet is present"
See gh-20729,Upgrade to Spring Batch 4.2.2.RELEASE
Disable Hazelcast auto-configuration when Jet is present
See gh-20729
Add configuration to enable Redis Cluster topology refresh
This commit adds two options to enable a refresh of the cluster
topology using Lettuce.
Use accessor for in-progress async count added in Tomcat 9.0.33
Clear system property set by log file registration
Upgrade to Tomcat 9.0.33
Upgrade to Spring Security 5.3.1.RELEASE
Upgrade to SendGrid 4.4.6
Upgrade to RxJava2 2.2.19
Upgrade to QueryDSL 4.3.1
Upgrade to Postgresql 42.2.12
Upgrade to Netty tcNative 2.0.30.Final
Upgrade to Netty 4.1.48.Final
Upgrade to Neo4j OGM 3.2.10
Upgrade to MongoDB 4.0.1
Upgrade to Mockito 3.3.3
Upgrade to MIMEPull 1.9.13
Upgrade to Micrometer 1.3.7
Upgrade to Maven Javadoc Plugin 3.2.0
Upgrade to MariaDB 2.6.0
Upgrade to Liquibase 3.8.8
Upgrade to Kotlin Coroutines 1.3.5
Upgrade to JUnit Jupiter 5.6.1
Upgrade to Johnzon 1.2.4
Upgrade to Janino 3.1.2
Upgrade to Infinispan 10.1.5.Final
Upgrade to Hibernate 5.4.13.Final
Upgrade to Flyway 6.3.2
Upgrade to Elasticsearch 7.6.2
Upgrade to Commons Lang3 3.10
Upgrade to Cassandra Driver 4.5.1
Upgrade to Byte Buddy 1.10.9
Upgrade to AppEngine SDK 1.9.79
Upgrade to ActiveMQ 5.15.12
If a PR with the given title exists, we clone the existing PR branch so
that it doesn't get overridden by master.
See gh-20530,Merge branch '2.2.x',Merge branch '2.1.x' into 2.2.x,Configure image for create pull request task
See gh-20530,Merge branch '2.2.x',Merge branch '2.1.x' into 2.2.x,Fix no such directory error on CI
See gh-20530,Raise the minimum supported version of Gradle 6 to 6.3
Document remote Docker configuration
This commit adds documentation for the configuration required to
use a remote Docker daemon with the `build-image` Maven goal or the
`bootBuildImage` Gradle task.
See gh-20538,Merge branch '2.2.x'
Merge pull request #20530 from dreis2211
* pr/20530:
  Polish "Automate Docker update in CI"
  Automate Docker updates in CI
Polish "Automate Docker update in CI"
See gh-20530,Automate Docker updates in CI
See gh-20530,Upgrade to Spring HATEOAS 1.1.0.M3
Configure Gradle's Test Retry plugin
Upgrade to Spring Session Dragonfruit-RC2
Upgrade to Spring Data Neumann-RC1
Merge pull request #20727 from parameswaranvv
* gh-20727:
  Polish "Make it clear to which type the DataSource properties are bound"
  Make it clear to which type the DataSource properties are bound
Polish "Make it clear to which type the DataSource properties are bound"
See gh-20727,Make it clear to which type the DataSource properties are bound
See gh-20727,Merge pull request #20580 from Phoosha
* gh-20580:
  Polish "Improve handling of non-existent path in disk space health check"
  Improve handling of non-existent path in disk space health check
Polish "Improve handling of non-existent path in disk space health check"
See gh-20580,Improve handling of non-existent path in disk space health check
See gh-20580,Document how to initialize a database with R2DBC
This commit adds a section to the reference guide on how to initialize
a database using R2DBC. 2 smoke tests are also added to validate this
behaviour with Flyway and Liquibase.
Make sure @DataR2dbcTest invokes database migration if necessary
Make sure Liquibase works with only spring-jdbc on the classpath
This commit improves the Liquibase auto-configuration to only rely on
spring-jdbc when a `DataSource` should be created on-the-fly for the
purpose of its initialization.
Previously, a connection pool implementation must be added as well, now
we're fallbacking on `SimpleDriverDataSource` if necessary. This
improves the database initialization use case with R2DBC.
Merge pull request #20708 from dreis2211
* gh-20708:
  Polish GroovyTemplateAutoConfiguration
Polish GroovyTemplateAutoConfiguration
See gh-20708,Merge branch '2.2.x'
Merge pull request #20676 from dreis2211
* gh-20676:
  Polish "Use @DynamicPropertySource for Neo4J and Redis data tests"
  Use @DynamicPropertySource for Neo4J and Redis data tests
Polish "Use @DynamicPropertySource for Neo4J and Redis data tests"
See gh-20676,Use @DynamicPropertySource for Neo4J and Redis data tests
See gh-20676,Support remote Docker daemon for building images
Prior to this commit, the build plugin goal/task for building images
required a locally running Docker daemon that was accessed via a
non-networked socket or pipe.
This commit adds support for remote Docker daemons at a location
specified by the environment variable `DOCKER_HOST`. Additional
environment variables `DOCKER_TLS_VERIFY` and `DOCKER_CERT_PATH`
are recognized for configuring a secure TLS connection to the daemon.
Fixes gh-20538,Expose MongoDB's replica set name
Rationalize RabbitProperties
Make sure that cassandra health check reports version
Polish,Merge branch '2.2.x'
Use LOCAL_ONE when querying system.local
This commit is a follow-up of gh-20709 to apply the same consistency
level to the Cassandra reactive health indicator.
Merge pull request #20709 from adutra
* pr/20709:
  Polish "Use LOCAL_ONE when querying system.local"
  Use LOCAL_ONE when querying system.local
Polish "Use LOCAL_ONE when querying system.local"
See gh-20709,Use LOCAL_ONE when querying system.local
The system keyspace has a replication factor of 1 and is local to each
node; it is therefore recommended to query system.local with a
consistency level of ONE or LOCAL_ONE.
Stronger consistency levels may result in an Unavailable error, but this
does not mean that the node is down.
See gh-20709,Polish
See gh-20704,Polish
See gh-20704,Merge pull request #20704 from dreis2211
* pr/20704:
  Fix typos
Fix typos
See gh-20704,Restore Cassandra port option
This commit restores the port option that was removed in an earlier
milestone. Contact points that do not define a port already are
automatically transformed to include the one configured, with a default
matching Cassandra's default port.
This makes upgrades easier in the case a cluster uses consistent ports
everywhere.
Upgrade to r2dbc Arabba-SR3
Upgrade to Kotlin 1.3.71
Enhance bomr to handle libraries that use a version property
Document that Java 14 is a supported version
Merge pull request #20681 from az1a
* pr/20681:
  Use jws-algorithm property in ReactiveOAuth2ResourceServerJwkConfiguration
Use jws-algorithm property in ReactiveOAuth2ResourceServerJwkConfiguration
See gh-20681,Merge branch '2.2.x'
Next development version (v2.2.7.BUILD-SNAPSHOT),Merge branch '2.2.x',Remove check for deprecated configuration properties
See gh-20528,Merge branch '2.2.x'
Deprecate use of path extensions for request mapping and content negotiation
Upgrade to Gradle Enterprise Plugin 3.2
Update classpath index to use jar name instead of full path
See gh-20564,Merge branch '2.2.x',Upgrade to Spring Kafka 2.3.7
Upgrade to Mimepull 1.9.13
Do not fail if "spring.datasource.url" cannot be resolved
Previously, a condition checked the value of "spring.datasource.url" to
determine if an embedded database has to be created as a fallback. When
the value is set with an unresolved placeholder, this fails even if
the DataSource is going to created by another mean ultimately.
This commit makes a more conservative check by only checking the
presence of the property rather than its value.
Single-thread interaction with Artifactory
There is a regression in repo.spring.io that causes artifacts from
the same module to have SNAPSHOT replaced with different timestamps.
This then breaks dependency resolution in consuming builds. It's a
long-shot, but JFrog have been unable to identify that cause of the
problem so we're going to try using a single thread for uploading
to Artifactory to see if that helps.,Merge pull request #20667 from dreis2211
* gradle-6.3:
  Upgrade to Gradle 6.3
Upgrade to Gradle 6.3,Do not register shutdownHook for WAR deployments
The application context shutdownHook is not needed for WAR deployments,
and we should let the Servlet container handle the application lifecycle
here.
Fix checkstyle issue,Make base path configurable for WebFlux applications
This commit adds the `"spring.webflux.base-path"` configuration
property. Configuring this property will gather all `HttpHandlers` into
a single composite and prefix all requests with a shared base path.
Merge pull request #20662 from mp911de
* pr/20662:
  Polish "Migrate off deprecated Spring Data Cassandra API"
  Migrate off deprecated Spring Data Cassandra API
Polish "Migrate off deprecated Spring Data Cassandra API"
See gh-20662,Migrate off deprecated Spring Data Cassandra API
Configure UserTypeResolver and CodecRegistry on
MappingCassandraConverter. Configure on CassandraMappingContext only the
simple type holder instead of custom conversions.
See gh-20662,Turn LivenessState and ReadinessState into enums
Prior to this commit, `LivenessState` and `ReadinessState` were
immutable classes. This was done in order to have additional behavior
and information in those classes.
Because the current implementation doesn't need this, this commit turns
those classes into simple enums.
Additional state and information can be added to the
`*StateChangedEvent` classes.
See gh-19593,Version layers configuration xsd
This commit provides a versioned xsd for the layers configuration of the
Maven plugin. The version starts at `2.3` to match with the Spring Boot
feature release in which this was introduced.
Upgrade to Spring Framework 5.2.5
Add dependency management for Jakarta Xml Soap 1.4.2
Extra detail for Kubernetes probes
Provides a few more concrete details about how probes and Kubernetes
behave, so users can make more informed decisions.
See gh-19593
Upgrade to Xmlunit2 2.6.4
Upgrade to Spring Session Bom Corn-SR2
Upgrade to Postgresql 42.2.11
Upgrade to Neo4j Ogm 3.2.10
Upgrade to Liquibase 3.8.8
Upgrade to Kotlin Coroutines 1.3.5
Upgrade to Kotlin 1.3.71
Upgrade to Freemarker 2.3.30
Upgrade to Elasticsearch 6.8.7
Upgrade to Jetty 9.4.27.v20200227
Upgrade to Janino 3.1.2
Upgrade to Tomcat 9.0.33
Upgrade to Httpclient 4.5.12
Upgrade to Activemq 5.15.12
Add dependency management for Jakarta Xml Soap 1.4.2
Merge pull request #20628 from dreis2211
* pr/20628:
  Fix typos in HealthEndpointGroupConfigurer
Fix typos in HealthEndpointGroupConfigurer
See gh-20628,Upgrade to Jakarta Xml Ws 2.3.3
Upgrade to Jakarta Xml Bind 2.3.3
Upgrade to Undertow 2.0.30.Final
Upgrade to Rxjava2 2.2.19
Upgrade to Netty Tcnative 2.0.30.Final
Upgrade to Netty 4.1.48.Final
Upgrade to Micrometer 1.3.6
Upgrade to Dropwizard Metrics 4.1.5
Upgrade to Jakarta Mail 1.6.5
Upgrade to Sendgrid 4.4.6
Upgrade to Appengine Sdk 1.9.79
Upgrade to Jackson 2.10.3
Upgrade to Couchbase Client 2.7.13
Merge pull request #20630 from dreis2211
* pr/20630:
  Fix typos in packaging docs
Fix typos in packaging docs
See gh-20630,Polish,Update copyright year of changed files,Merge branch '2.2.x',Update copyright year of changed files,Add "management.health.probes.enabled" config property
Prior to this commit, we were relying on the
`"spring.main.cloud-platform"` property for overriding cloud platform
detection and enabling liveness and readiness probes. Changes made in
gh-20553 have now been reverted.
This commit adds the `"management.health.probes.enabled"` configuration
property. The auto-configuration now enables the HTTP Probes and
`HealthIndicator` if this property is enabled, or if the Kubernetes
cloud platform is detected.
This property is `false` by default for now, since enabling this for all
Spring Boot applications would be a breaking change. In this case, the
global `"/actuator/health"` endpoint could report `OUT_OF_SERVICE`
during startup time because the application now reports the readiness as
well.
See gh-19593,Revert "Override CloudPlatform auto-detection with property"
This reverts commit 4b7ed5efefd1f5e5c9cfbc3a9b0c69ba65a9de6a.
See gh-20553,Polish reference docs on Kubernetes Probes
See gh-19593,Polish docs,Combine application and resources layers into a single layer
Rename "classes" to "application" in custom layer configuration
Upgrade to Reactor Dysprosium-SR6
Fix import in constructor binding example
Merge pull request #20617 from ta7uw
* pr/20617:
  Polish "Fix @FlywayDataSource with multiple data sources"
  Fix @FlywayDataSource with multiple data sources
Polish "Fix @FlywayDataSource with multiple data sources"
See gh-20617,Fix @FlywayDataSource with multiple data sources
See gh-20617,Merge branch '2.2.x'
Document that Jackson is a required dependency of the Actuator
Auto-configure listener container factory without consumer factory
Previously, the presence of a `ConsumerFactory` bean would make the
auto-configured one to back off, leading to a failure down the line if
no available instance matches the generics criterion. This commit
improves the auto-configuration to create a `ConsumerFactory<?,?>`
behind the scenes if none is available.
Utilise Reactor Netty's new graceful shutdown support
Start building against Reactor Dysprosium-SR6 snapshots
See gh-20570
Merge pull request #20523 from m-kay
* pr/20523:
  Polish "Configure signature algorithm when using public key jwt decoder"
  Configure signature algorithm when using public key jwt decoder
Polish "Configure signature algorithm when using public key jwt decoder"
See gh-20523,Configure signature algorithm when using public key jwt decoder
See gh-20523,Merge pull request #20608 from izeye
* gh-20608:
  Fix "Building Docker Images" section level
Fix "Building Docker Images" section level
See gh-20608,Merge branch '2.2.x'
Merge pull request #20604 from dreis2211
* pr/20604:
  Polish BindableTests
Polish BindableTests
See gh-20604,Merge pull request #20601 from dreis2211
* pr/20601:
  Remove redundant MockitoAnnotations.initMocks()
Remove redundant MockitoAnnotations.initMocks()
See gh-20601,Merge branch '2.2.x'
Only remove trailing slash from URI value
This commit upgrades the algorithm when trailing slash are to be
ignored. Previously a root URI (i.e. "/") would result to to empty
string which is an issue for monitoring system that requires tag values
to be non empty. If the URI is a single character, the trailing is not
applied and "/" is left as is.
Remove Java 13 CI job
Upgrade to spring-doc-resources 0.2.0.RELEASE,Fix section title levels in reference docs,Polish Liveness and Readiness support
This commit moves the core Liveness and Readiness support to its own
`availability` package. We've made this a core concept independent of
Kubernetes.
Spring Boot now produces `LivenessStateChanged` and
`ReadinessStateChanged` events as part of the typical application
lifecycle.
Liveness and Readiness Probes (`HealthIndicator` components and health
groups) are still configured only when deployed on Kubernetes.
This commit also improves the documentation around Probes best practices
and container lifecycle considerations.
See gh-19593,Merge pull request #20585 from dreis2211
* gh-20585:
  Upgrade to Gradle 6.3 RC4
Upgrade to Gradle 6.3 RC4
See gh-20585,Merge branch '2.2.x'
Merge pull request #20583 from j0rdanit0
* gh-20583:
  Link to correct factory in TomcatReactiveWebServerFactory's javadoc
Link to correct factory in TomcatReactiveWebServerFactory's javadoc
See gh-20583,Merge branch '2.2.x'
Merge pull request #20577 from dreis2211
* gh-20577:
  Only suggest Ubuntu versions available in the Docker registry
Only suggest Ubuntu versions available in the Docker registry
See gh-20577,Add command-line options for Gradle bootBuildImage parameters
This commit adds support for setting the image name and builder
parameters of the Gradle bootBuildImage task using command-line
options as an alternative to DSL configuration.
See gh-20520,Polish
See gh-19593,Merge branch '2.2.x'
See gh-20568,Merge branch '2.1.x' into 2.2.x
See gh-20567,Revert "Upgrade CI images to Ubuntu Bionic 20200311"
This reverts commit d25286c5
See gh-20576,Merge branch '2.2.x',Add Java 14 CI
Adapt tests for support for Java 14
See gh-20576,Polish,Add Kubernetes Liveness and Readiness Probes support
Prior to this commit and as of Spring Boot 2.2.0, we would advise
developers to use the Actuator health groups to define custom "liveness"
and "readiness" groups and configure them with subsets of existing
health indicators.
This commit addresses several limitations with that approach.
First, `LivenessState` and `ReadinessState` are promoted to first class
concepts in Spring Boot applications. These states should not only based
on periodic health checks. Applications should be able to track changes
(and adapt their behavior) or update states (when an error happens).
The `ApplicationStateProvider` can be injected and used by applications
components to get the current application state. Components can also
track specific `ApplicationEvent` to be notified of changes, like
`ReadinessStateChangedEvent` and `LivenessStateChangedEvent`.
Components can also publish such events with an
`ApplicationEventPublisher`. Spring Boot will track startup event and
application context state to update the liveness and readiness state of
the application. This infrastructure is available in the
main spring-boot module.
If Spring Boot Actuator is on the classpath, additional
`HealthIndicator` will be contributed to the application:
`"LivenessProveHealthIndicator"` and `"ReadinessProbeHealthIndicator"`.
Also, "liveness" and "readiness" Health groups will be defined if
they're not configured already.
Add HealthEndpointGroupsRegistry and its Customizer
Prior to this commit, `HealthContributor` would be exposed under the
main `HealthEndpoint` and subgroups, `HealthEndpointGroups`. Groups are
driven by configuration properties and there was no way to contribute
programmatically new groups.
This commit introduces the `HealthEndpointGroupsRegistry` (a mutable
version of `HealthEndpointGroups`) and a
`HealthEndpointGroupsRegistryCustomizer`. This allows configurations to
add/remove groups during Actuator auto-configuration.
Override CloudPlatform auto-detection with property
This commit adds a new `"spring.main.cloud-platform"` configuration
property that overrides the `CloudPlatform` detection.
This makes it easier to enable paltform-specific features when running
applications locally or when writing integration tests.
Publish Maven plugin API
This commit enables javadoc generator for the Spring Boot Maven plugin.
This also harmonizes the structure of the documentation, with an `/api`
and a `/reference` root directories for the javadoc and the reference
guide respectively.
Upgrade to Groovy 2.5.10
Merge pull request #19475 from bono007
* pr/19475:
  Polish "Add 'threads' configuration group for embedded containers"
  Add 'threads' configuration group for embedded containers
Polish "Add 'threads' configuration group for embedded containers"
See gh-19475,Add 'threads' configuration group for embedded containers
See gh-19475,Merge branch '2.2.x',Start building against Spring Kafka 2.3.7 snapshots
See gh-20574,Start building against Spring Data Moore SR6 snapshots
See gh-20573,Start building against Spring Framework 5.2.5 snapshots
See gh-20571,Start building against Reactor Dysprosium-SR6 snapshots
See gh-20569,Merge pull request #20360 from dreis2211
* pr/20360:
  Add security.protocol to KafkaProperties
Add security.protocol to KafkaProperties
See gh-20360,Merge branch '2.2.x'
Merge pull request #20566 from dreis2211
* pr/20566:
  Upgrade CI images to Ubuntu Bionic 20200311
Upgrade CI images to Ubuntu Bionic 20200311
See gh-20566,Polish Gradle layer configuration DSL
This commit modifies the DSL for custom layer configuration in the
Gradle plugin to avoid duplication of terms that could be confusing.
Fixes gh-20563,Merge pull request #20561 from dreis2211
* pr/20561:
  Upgrade to Gradle 6.3 RC3
Upgrade to Gradle 6.3 RC3
See gh-20561,Polish "Add Java 14 CI"
See gh-20413,Merge pull request #20413 from dreis2211
* pr/20413:
  Polish "Add Java 14 CI"
  Add Java 14 CI
Polish "Add Java 14 CI"
See gh-20413,Add Java 14 CI
See gh-20413,Upgrade to Gradle 6.3 RC2
Revert "Update extract to write files to their original, unlayered location"
This reverts commit 9f3bc78f364bcb3b81344c201ff26945bc6be011.,Merge branch '2.2.x'
Merge pull request #20323 from larsgrefer
* gh-20323:
  Fix recommended task dependency configuration
Fix recommended task dependency configuration
`compileJava.dependsOn(processResources)` is not enough to ensure the
correct behavior. Using `dependsOn` only affects the execution order
(`processResources` before `compileJava`) but not the up-to-date check
of `compileJava`. After modifying
`META-INF/additional-spring-configuration-metadata.json`, the
`processResouces` task will considered out-of-date and will be
re-executed, but after that `compileJava` will still be considered
up-to-date which causes the changes not to be merged into
`META-INF/spring-configuration-metadata.json`
With this change the up-do-date check of `compileJava` is affected,
too. Therefore, it will correctly re-execute the
configuration-processor when
`META-INF/additional-spring-configuration-metadata.json` was changed.
See gh-20323,Update extract to write files to their original, unlayered location,Fix BuildImageMojo javadoc.,Add command-line properties for Maven build-image options
This commit adds support for setting the image name and builder
parameters of the Maven spring-boot:build-image goal using command-line
properties as an alternative to plugin configuration in pom.xml. Per
Maven conventions, a value in pom.xml configuration will override a
command-line property when both are provided.
Fixes gh-20520,Merge branch '2.2.x'
Merge pull request #20541 from dreis2211
* pr/20541:
  Use @Configuration(proxyBeanMethods=false) wherever possible
Adapt server not running check
The upgrade to the Couchbase SDK v3 changed how errors are reported
when the cluster is not available. This commit updates the check to
look for the new exception in the hope a more solid check can be found
shortly.,Use @Configuration(proxyBeanMethods=false) wherever possible
See gh-20541,Add additional timeout settings
This commit expands the `spring.couchbase.env.timeouts` configuration
namespace with timeouts for disconnect, key-value operations with a
durability level, search, analytics and management.
\gh-19893
Co-authored-by: Michael Nitschinger <michael@nitschinger.at>,Upgrade to Couchbase SDK v3
This commit upgrades to the Couchbase SDK v3 which brings the following
breaking changes:
* Bootstrap hosts have been replaced by a connection string and the
authentication is now mandatory.
* A `Bucket` is no longer auto-configured. The
`spring.couchbase.bucket.*` properties have been removed
* `ClusterInfo` no longer exists and has been replaced by a dedicated
API on `Cluster`.
* `CouchbaseEnvironment` no longer exist in favour of
`ClusterEnvironment`, the customizer has been renamed accordingly.
* The bootstrap-related properties have been removed. Users requiring
custom ports should supply the seed nodes and initialize a Cluster
themselves.
* The endpoints-related configuration has been consolidated in a
single IO configuration.
The Spring Data Couchbase provides an integration with the new SDK. This
leads to the following changes:
* A convenient `CouchbaseClientFactory` is auto-configured.
* Repositories are configured against a bucket and a scope. Those can
be set via configuration in `spring.data.couchbase.*`.
* The default consistency property has been removed in favour of a more
flexible annotation on the repository query methods instead. You can now
specify different query consistency on a per method basis.
* The `CacheManager` implementation is provided, as do other stores for
consistency so a dependency on `couchbase-spring-cache` is no longer
required.
See gh-19893
Co-authored-by: Michael Nitschinger <michael@nitschinger.at>,Configure Spring Data Couchbase explicitly
This commit configures Spring Data Couchbase explicitly rather than
relying on the abstract configuration class. This has the advantage of
simplifying the auto-configuration and let it us proxy-free
configuration classes.
Spring Boot no longer uses or interacts with CouchbaseConfigurer. Users
relying on that to teach Spring Boot which components to use should
rely on `@Primary` flag instead in case of multiple beans of the same
type.
`CouchbaseConfiguration` is no longer public as extending from it is
no longer necessary. If the `CouchbaseEnvironment` has to be
customized, a `CouchbaseEnvironmentBuilderCustomizer` bean can be
registered to tune the auto-configured environment.
Fix detection of application home for paths containing spaces
Fixes gh-20531,Polish,Add missing package-info.json
Rename classes package to application
Use Gradle's configuration avoidance API
Register Boot Gradle tasks instead of creating them so they can be
loaded lazily.
Add support for customizing layers in Gradle
This commit adds configuration to the Spring Boot Gradle plugin that
allows the names and contents of layers to be customized in the build
configuration.
Fixes gh-20296,Fail fast when attempting to repackage a reproducible war
Maven's war plugin does not support reproducible builds, resulting in
the entries in the war file not being written in a consistent order
from build to build.
Support Maven's outputTimestamp when repackaging jars and wars
Merge pull request #20527 from dreis2211
* pr/20527:
  Fix some deprecation warnings
Fix some deprecation warnings
See gh-20527,Merge pull request #20525 from dreis2211
* gh-20525:
  Fix method order checkstyle issue
Fix method order checkstyle issue
See gh-20525,Cache endpoint responses on a per-principal basis
Previously, any HTTP request to an endpoint that included a principal
would bypass the cache. This prevented authenticated requests from
making use of the cache and its configurable time-to-live.
This commit updates the caching operation invoker to include the
principal, if any, in its cache key. As a result, requests that
include a principal will make use of the cache, potentially returning
the result of a previous invocation of the same endpoint by the same
principal.
Allow additional tags to be contributed to WebMvc and WebFlux defaults
Upgrade to Undertow 2.0.30.Final
Upgrade to Sun Mail 1.6.5
Upgrade to Maven Dependency Plugin 3.1.2
Upgrade to Kafka 2.4.1
\gh-20511
Upgrade to Jakarta Mail 1.6.5
Add support for customizing layers in Maven
This commit adds an additional 'layers/configuration' property that can
be used to refer to a separate layers configuration file. This separate
file defines:
* The layers and their order of precedence,
* How libraries are handled using filters that match against the
coordinates of each library, and
* How classes are handled using filters that match against the location
of the entry
An XSD to validate the XML configuration file is available.
\gh-20295
Co-authored-by: Stephane Nicoll <snicoll@pivotal.io>,Upgrade to Spring Integration 5.3.0.M3
Upgrade to Spring Kafka 2.4.4.RELEASE
Merge pull request #20417 from ferengra
* gh-20417:
  Polish "Add clearChecksums to Liquibase auto-configuration"
  Add clearCheckSums to Liquibase auto configuration
Polish "Add clearChecksums to Liquibase auto-configuration"
See gh-20417,Add clearCheckSums to Liquibase auto configuration
Liquibase auto configuration is extended with clearCheckSums to allow
to clear all checksums in the current changelog, so they will be
recalculated upon the next update.
See gh-20417,Merge branch '2.2.x'
Avoid eager init when evaluating DevToolsDataSourceCondition
Previously, DevToolsDataSourceCondition called
getBeanNamesForType(Class) which could trigger unwanted initialization
of lazy init singletons and objects created by FactoryBeans.
This commit updates DevToolsDataSourceCondition to prohibit eager
init when getting the names of the beans of a particular type.
Fixes gh-20430,Merge branch '2.2.x'
Fix behaviour of DependencyCustomizer ifAllResourcesPresent
Previously, DependencyCustomizer's ifAllResourcesPresent method
would return a customizer that added modules if any of the resources
were present. This commit corrects this behaviours so that modules are
only added if all resources are present.
Fixes gh-20418,Merge pull request #20498 from izeye
* pr/20498:
  Polish
Polish
See gh-20498,Upgrade to Spring Data Neumann-M4
The fix was applied as part of 308e1d36. This commit merges forwards
the test that was added in 2.1.x and 2.2.x.
Fixes gh-20386 in 2.2.0.M3.,Merge branch '2.1.x' into 2.2.x
Use getTomcatWebServer to create TomcatWebServer instance
TomcatReactiveWebServerFactory's getTomcatWebServer is described as
being a hook point the can be overrideden to return a different
TomcatWebServer or to apply additional processing to the Tomcat
server. Previously, this did not work as the method was not called
to create the TomcatWebServer instance. Instead, TomcatWebServer was
instantiated and returned directly.
This commit updates TomcatReactiveWebServerFactory to call
getTomcatWebServer to create the TomcatWebServer instance. A test
has also been added to verify that the method is now used.
Fixes gh-20386,Merge branch '2.2.x'
Merge pull request #20436 from DreierF
* gh-20436:
  Update versiion of git-properties plugin shown in the docs
Update versiion of git-properties plugin shown in the docs
See gh-20436,Reinstate leading / in default value for spring.liquibase.change-log
Unfortunately, while redundant for new applications, removing the
leading slash adversely affected existing application upon upgrades as
it caused Liquibase to re-apply every change log.
Merge pull request #20472 from dreis2211
* gh-20472:
  Improve unused exclusion detection and remove those that are unused
Improve unused exclusion detection and remove those that are unused
See gh-20472,Tolerate different connection failure exception thrown on Java 11+
See gh-4657,Upgrade to Postgresql 42.2.11
Upgrade to Maven Source Plugin 3.2.1
Upgrade to Maven Shade Plugin 3.2.2
Upgrade to Flatten Maven Plugin 1.2.1
Upgrade to Build Helper Maven Plugin 3.1.0
Reinstate spring-boot-dependencies' exclusion of jcl-over-slf4j
Upgrade to Spring Security 5.3.0.RELEASE
Upgrade to Reactor Bom Dysprosium-SR5
Upgrade to Netty 4.1.47.Final
Upgrade to Kotlin Coroutines 1.3.4
Upgrade to Kotlin 1.3.70
Upgrade to Jetty 9.4.27.v20200227
Upgrade to Jersey 2.30.1
Upgrade to Jackson Bom 2.10.3
Upgrade to Dropwizard Metrics 4.1.5
Consider plugins and imported boms when finding possible dependency upgrades
Start using Cassandra Driver's bom
Fixes gh-20441,Upgrade to XmlUnit2 2.6.4
Upgrade to WebJars Locator Core 0.44
Upgrade to Spring Kafka 2.4.3.RELEASE
Upgrade to Spring AMQP 2.2.5.RELEASE
Upgrade to SnakeYAML 1.26
Upgrade to SendGrid 4.4.5
Upgrade to Selenium HtmlUnit 2.38.0
Upgrade to RxJava2 2.2.18
Upgrade to OkHttp3 3.14.7
Upgrade to Netty tcNative 2.0.29.Final
Upgrade to Neo4j OGM 3.2.9
Upgrade to MongoDB 4.0.0
Upgrade to Mockito 3.3.0
Upgrade to Log4j2 2.13.1
Upgrade to Liquibase 3.8.7
Upgrade to jOOQ 3.13.1
Upgrade to Jetty Reactive HTTPClient 1.1.2
Upgrade to Janino 3.1.1
Upgrade to Jakarta XML WS 2.3.3
Upgrade to Jakarta XML Bind 2.3.3
Upgrade to Jakarta Activation 1.2.2
Upgrade to Infinispan 10.1.3.Final
Upgrade to HttpClient 4.5.12
Upgrade to HtmlUnit 2.38.0
Upgrade to Hibernate 5.4.12.Final
Upgrade to FreeMarker 2.3.30
Upgrade to Flyway 6.3.0
Upgrade to Couchbase Client 2.7.13
Upgrade to Cassandra Driver 4.5.0
Upgrade to Byte Buddy 1.10.8
Enable generation of Gradle's module metadata
Changes in Gradle 6.2 should address the problems described in
4f75ab5f.
Test Tomcat's handling of a request on an idle connection
See gh-4657,Align embedded Jetty's graceful shutdown behaviour with standalone
Standalone Jetty will, by default, include a Connection: close header
in all responses once graceful shutdown has begun. Previously, the
way in which we were shutting Jetty down did not cause this to happen.
This commit updates JettyGracefulShutdown to shut down each connector.
This causes Jetty to send the Connection: close header, aligning its
behaviour more closely with what it does when used standalone. The
tests have also been updated to verify this behaviour and to ensure
that the correct port is used for requests even once the connector is
no longer bound and the web server no longer knows its ephemeral port.
See gh-4657,Try to make reactive Jetty connect after shutdown test more robust
See gh-4657,Merge branch '2.2.x'
Do not wrap CF JSON Keys containing special characters
This reverts commit 6828a15d31ac7d1ca1bfd560cfa05c393b3b7128.
The commit has been reverted as it breaks backwards compatiblity.
Fixes gh-20343,Polish spelling of elapsed
See gh-4657,Polish
See gh-4657,Add support for gracefully shutting down the web server
This commit adds support for gracefully shutting down the embedded
web server. When a grace period is configured
(server.shutdown.grace-period), upon shutdown, the web server will no
longer permit new requests and will wait for up to the grace period
for active requests to complete.
Merge pull request #20428 from dreis2211
* pr/20428:
  Remove hardcoded version from VersionOverridingElasticsearchContainer
Remove hardcoded version from VersionOverridingElasticsearchContainer
See gh-20428,Revert Spring Data Couchbase version override,Merge pull request #20419 from wycm
* pr/20419:
  Polish
Polish
See gh-20419,Merge branch '2.2.x',Polish,Merge pull request #20423 from dreis2211
* pr/20423:
  Upgrade to Elasticsearch 7.6.1
Upgrade to Elasticsearch 7.6.1
See gh-20423,Merge branch '2.2.x'
Merge pull request #20420 from dreis2211
* pr/20420:
  Upgrade CI to Docker 19.03.7
Upgrade CI to Docker 19.03.7
See gh-20420,Merge pull request #20416 from dreis2211
* pr/20416:
  Upgrade to Testcontainers 1.13.0
Upgrade to Testcontainers 1.13.0
See gh-20416,Merge pull request #20180 from dreis2211
* pr/20180:
  Fix JarFileTests for multi-release JARs on JDK14
  Polish "Handle new Annotation.toString() behaviour in JDK 14"
  Handle new Annotation.toString() behaviour in JDK 14
Fix JarFileTests for multi-release JARs on JDK14
See gh-20180,Polish "Handle new Annotation.toString() behaviour in JDK 14"
See gh-20180
Handle new Annotation.toString() behaviour in JDK 14
See gh-20180,Merge pull request #20411 from dreis2211
* pr/20411:
  Upgrade to Groovy 2.5.10
Upgrade to Groovy 2.5.10
See gh-20411,Merge pull request #20407 from wycm
* pr/20407:
  Update copyright of changed file
  Polish
Update copyright of changed file
See gh-20407,Polish
See gh-20407,Remove the body from actuator 404 responses
When a request to the /actuator/env/{toMatch} endpoint does not match a
property, a response status 404 was being returned along with a body
containing the existing property sources. This commit removes the body
from the response to be more consistent with a typical 404 response.
Fixes gh-20314,Pin SD Couchbase to 4.0.0.M3 to avoid latest breaking changes,Merge branch '2.2.x'
Merge pull request #20388 from dreis2211
* pr/20388:
  Fix some deprecations
Fix some deprecations
See gh-20388,Merge pull request #20390 from gir1yaphets
* pr/20390:
  Polish "Refine if statement logic"
  Refine if statement logic
Polish "Refine if statement logic"
See gh-20390,Refine if statement logic
See gh-20390,Merge pull request #20367 from izeye
* pr/20367:
  Polish DataSourceHealthIndicator
Polish DataSourceHealthIndicator
See gh-20367,Merge pull request #20382 from dreis2211
* pr/20382:
  Add branch information to build scans on Windows
Add branch information to build scans on Windows
See gh-20382,Merge pull request #20356 from bmscomp
* pr/20356:
  Polish "Improve details of neo4h health indicator"
  Improve details of neo4h health indicator
Polish "Improve details of neo4h health indicator"
See gh-20356,Improve details of neo4h health indicator
This commit changes the neo4j health indicator to provide the version
and edition of the neo4j database.
See gh-20356,Merge branch '2.2.x'
Merge pull request #19987 from izeye
* pr/19987:
  Use ServerHttpResponse.getRawStatusCode() in WebFluxTags
Use ServerHttpResponse.getRawStatusCode() in WebFluxTags
See gh-19987,Fix checkstyle violations,Merge pull request #20384 from dreis2211
* pr/20384:
  Upgrade to Gradle 6.2.2
Upgrade to Gradle 6.2.2
See gh-20384,Merge branch '2.2.x',Merge pull request #20385 from dreis2211
* pr/20385:
  Test the Gradle Plugin against Gradle 6.2.2
Test the Gradle Plugin against Gradle 6.2.2
See gh-20385,Merge pull request #20223 from fschmager
* pr/20223:
  Polish "Allow Embedded directory to be used without spring-data-ldap"
  Allow Embedded directory to be used without spring-data-ldap
Polish "Allow Embedded directory to be used without spring-data-ldap"
See gh-20223,Allow Embedded directory to be used without spring-data-ldap
See gh-20223,Bind ConnectionPool beans that are exposed as ConnectionFactory
This commit relaxes the class condition to ConnectionFactory, checking
if the connection factory is a connection pool and bind its metrics to
the registry accordingly.
Merge pull request #20370 from dreis2211
* pr/20370:
  Use isEmpty() where possible
Use isEmpty() where possible
See gh-20370,Merge pull request #20380 from dreis2211
* pr/20380:
  Remove unused parameter in AsciidoctorConventions
Remove unused parameter in AsciidoctorConventions
See gh-20380,Fix "spring.integration.rsocket" canonical name
See gh-18834,Auto-Configure RSocket support for Spring Integration
This commit adds a new auto-configuration for RSocket support in Spring
Integration.
Given an application with `spring-messaging`, `spring-integration-rsocket`
and RSocket dependencies, developers are now able to leverage Spring
Integration features with RSocket.
It is now possible to configure an RSocket server with
`"spring.rsocket.server.*"` properties and let it use
`IntegrationRSocketEndpoint` or `RSocketOutboundGateway` components to
handle incoming RSocket messages. This infrastructure can handle Spring
Integration RSocket channel adapters and `@MessageMapping` handlers
(given `"spring.integration.rsocket.server.message-mapping-enabled"`is
configured.
If the `"spring.integration.rsocket.client.host"` and
`"spring.integration.rsocket.client.port"` (for TCP protocol), or
`"spring.integration.rsocket.client.uri"`  (for WebSocket) is configured
then a `ClientRSocketConnector` will be configured accordingly.
\gh-18834
Co-authored-by: Brian Clozel <bclozel@pivotal.io>,Merge branch '2.2.x'
Merge pull request #20361 from dreis2211
* pr/20361:
  Upgrade CI images to Ubuntu Bionic 20200219
Upgrade CI images to Ubuntu Bionic 20200219
See gh-20361,Merge branch '2.2.x'
Merge pull request #20355 from dreis2211
* pr/20355:
  Automate Ubuntu base image upgrade
Automate Ubuntu base image upgrade
See gh-20355,Merge pull request #20354 from izeye
* pr/20354:
  Polish "Add descriptions for data source pool metrics"
  Add descriptions for data source pool metrics
Polish "Add descriptions for data source pool metrics"
See gh-20354,Add descriptions for data source pool metrics
See gh-20354,Merge pull request #20318 from izeye
* pr/20318:
  Polish tests
Polish tests
See gh-20318,Fix unit test case formatting,Remove unused imports,Merge pull request #20297 from mikesmithson,Polish Docker client exception handling,Improve error message from image building
Translate IOException to DockerException for a more meaningful error
message when the Docker daemon is not available.
Fixes gh-20151,Merge branch '2.2.x'
Merge pull request #20339 from dreis2211
* pr/20339:
  Remove redundant code
Remove redundant code
See gh-20339,Merge branch '2.2.x',Next development version (v2.2.6.BUILD-SNAPSHOT),Merge branch '2.2.x',Merge branch '2.1.x' into 2.2.x,Next development version (v2.1.14.BUILD-SNAPSHOT),Merge branch '2.2.x',Fix tests following changes to EndpointRequest
See gh-20329,Merge branch '2.2.x'
Cache management port type in EndpointRequestMatcher
Fix Maven plugins tests on Windows
This commit fixes problems with file path separators and command
line argument quoting in Maven plug integration tests when run on
Windows.
Fixes gh-20244,Merge branch '2.2.x',Upgrade to Neo4j Ogm 3.2.9
Upgrade to Rxjava2 2.2.18
Upgrade to Dropwizard Metrics 4.1.3
Upgrade to Okhttp3 3.14.7
Upgrade to Spring Integration 5.2.4.RELEASE
Upgrade to Spring AMQP 2.2.5.RELEASE
This reverts commit 34f33e8b0d196a8da966a437c3193fcacd260da2.
See gh-20232,Merge branch '2.2.x',Merge branch '2.1.x' into 2.2.x,Upgrade to Neo4j Ogm 3.1.17
Upgrade to Rxjava2 2.2.18
Upgrade to Jackson 2.9.10.20200223
Upgrade to Spring Data Lovelace-SR16
Configure buildpack to use target Java version
With this commit, the Maven `spring-boot:build-image` goal and the
Gradle `bootBuildImage` task will configure the OpenJDK buildpack
to use the same JRE version as the project's target version,
provided the buildpack Java version is not explicitly set in the
build configuration.
Fixes gh-20172,Upgrade to Spring Framework 5.2.4.RELEASE
Cloes gh-20199,Merge branch '2.1.x' into 2.2.x,Upgrade to Spring Framework 5.1.14
\gh-20197
Merge pull request #20179 from dreis2211
* gh-20179:
  Polish "Allow Gradle tasks to be executed with a custom Java home"
  Allow Gradle tasks to be executed with a custom Java home
Polish "Allow Gradle tasks to be executed with a custom Java home"
See gh-20179,Allow Gradle tasks to be executed with a custom Java home
See gh-20179,Document R2DBC support
\gh-19988
Co-authored-by: Mark Paluch <mpaluch@pivotal.io>,Add smoke test for r2dbc support
See gh-19988
Co-authored-by: Mark Paluch <mpaluch@pivotal.io>,Add R2BC connection pool metrics
This commit adds metrics support for `ConnectionPool` beans.
See gh-19988
Co-authored-by: Mark Paluch <mpaluch@pivotal.io>
Co-authored-by: Tadaya Tsuyukubo <tadaya@ttddyy.net>,Add R2BC connection factory health check
This commit adds an health indicator for R2DBC. If a validation query is
provided, it is used to validate the state of the database. If not, a
check of the connection is issued.
See gh-19988
Co-authored-by: Mark Paluch <mpaluch@pivotal.io>,Add test slice for Spring Data R2DBC
This commit adds a test slice for Spring Data R2DBC. When
`DataR2dbcTest` is added on a test, only Spring Data R2DBC repositories
and the infrastructure that they need is auto-configured.
Contrary to the JDBC counterpart, the `ConnectionFactory` is not swapped
by an embedded database.
See gh-19988
Co-authored-by: Mark Paluch <mpaluch@pivotal.io>,Add auto-configuration for Spring Data R2DBC
This commit adds auto-configuration support for Spring Data R2DBC. If a
`ConnectionFactory` and Spring Data are available, scanning of reactive
repositories is enabled.
This commit also adds a starter to bring R2DBC and the necessary Spring
Data libraries.
See gh-19988
Co-authored-by: Mark Paluch <mpaluch@pivotal.io>
Co-authored-by: Oliver Drotbohm <odrotbohm@pivotal.io>,Add auto-configuration for R2DBC's ConnectionFactory
This commit adds auto-configuration for R2DBC. If R2DBC is on the
classpath, a `ConnectionFactory` is created similarly to the algorithm
used to create a `DataSource`.
If an url is specified, it is used to determine the R2DBC driver and
database location. If not, an embedded database is started (with only
support of H2 via r2dbc-h2). If none of those succeed, an exception is
thrown that is handled by a dedicated FailureAnalyzer.
To clearly separate reactive from imperative access, a `DataSource` is
not auto-configured if a `ConnectionFactory` is present. This makes sure
that any auto-configuration that relies on the presence of a
`DataSource` backs off.
There is no dedicated database initialization at the moment but it is
possible to configure flyway or liquibase to create a local `DataSource`
for the duration of the migration. Alternatively, if Spring Data R2DBC
is on the classpath, a `ResourceDatabasePopulator` bean can be defined
with the scripts to execute on startup.
See gh-19988
Co-authored-by: Mark Paluch <mpaluch@pivotal.io>,Merge branch '2.2.x'
Merge pull request #20313 from YooInKeun
* pr/20313:
  Fix typos in documentation
Fix typos in documentation
See gh-20313,Merge pull request #20309 from dreis2211
* pr/20309:
  Upgrade to Gradle 6.2.1
Upgrade to Gradle 6.2.1
See gh-20309,Merge branch '2.2.x',Merge pull request #20310 from dreis2211
* pr/20310:
  Test the Gradle plugin against Gradle 6.2.1
Test the Gradle plugin against Gradle 6.2.1
See gh-20310,Configure user name used for Gradle CI builds
Binding to collection of custom objects should not fail with unbound error
Fixes gh-20134,Merge pull request #20242 from dreis2211
* pr/20242:
  Explicitly set java home in CommandLineInvoker
Explicitly set java home in CommandLineInvoker
See gh-20242,Merge branch '2.2.x'
Revert "Clear ProducesRequestCondition cache attribute"
Revert "Add actuator specific ObjectMapper"
See gh-12951
See gh-20291,Merge branch '2.2.x',Upgrade to Maven Shade Plugin 3.2.2
Upgrade to Spring Session Bom Corn-SR1
Upgrade to Spring Security 5.2.2.RELEASE
Upgrade to Lombok 1.18.12
Upgrade to Postgresql 42.2.10
Upgrade to Neo4j Ogm 3.2.8
Upgrade to Liquibase 3.8.6
Upgrade to Jooq 3.12.4
Upgrade to Infinispan 9.4.18.Final
Upgrade to Hibernate 5.4.12.Final
Upgrade to Jetty 9.4.26.v20200117
Upgrade to Tomcat 9.0.31
Upgrade to Johnzon Jsonb 1.2.3
Upgrade to Httpclient 4.5.11
Upgrade to Byte Buddy 1.10.8
Upgrade to Rsocket 1.0.0-RC6
Upgrade to Netty Tcnative 2.0.29.Final
Upgrade to Micrometer 1.3.5
Upgrade to Lettuce 5.2.2.RELEASE
Upgrade to Jakarta Activation 1.2.2
Upgrade to Sendgrid 4.4.5
Upgrade to Hazelcast 3.12.6
Upgrade to Appengine Sdk 1.9.78
Upgrade to Caffeine 2.8.1
Upgrade to Jackson 2.10.2.20200130
Upgrade to Couchbase Client 2.7.12
Upgrade to Spring Session Bom Bean-SR9
Upgrade to Spring Security 5.1.8.RELEASE
Upgrade to Lombok 1.18.12
Upgrade to Postgresql 42.2.10
Upgrade to Infinispan 9.4.18.Final
Upgrade to Jetty 9.4.26.v20200117
Upgrade to Tomcat 9.0.31
Upgrade to Httpclient 4.5.11
Upgrade to Dependency Management Plugin 1.0.9.RELEASE
Upgrade to Netty Tcnative 2.0.29.Final
Upgrade to Hazelcast 3.11.7
Upgrade to Appengine Sdk 1.9.78
Upgrade to Couchbase Client 2.7.12
Polish
See gh-20244,Merge branch '2.2.x',Support nested requests in MetricsClientHttpRequestInterceptor
Prior to this commit, requests made by `HttpRequestInterceptor`
instances configured on `RestTemplate` would not be recorded
properly.
This commit ensures that nested requests are recorded separately.
Remove spring security dependencies from Rsocket starter
Fixes gh-20243,Merge branch '2.2.x'
Prefer arguments in POM over spring-boot.run.arguments
This commit changes the order of precedence for the `arguments` property
of the AbstractRunMojo so that values specified in the POM override
values provided on the command line using `spring-boot.run.arguments`.
This brings the `arguments` property in line with all other Mojo
parameters.
Fixes gh-20024,Start building against Spring Data Neumann M4 snapshots
See gh-20241,Start building against Spring Framework 5.2.4 snapshots
See gh-20240,Merge branch '2.2.x',Start building against Spring Kafka 2.3.6 snapshots
See gh-20203,Start building against Spring AMQP 2.2.5 snapshots
See gh-20106,Start building against Spring Integration 5.2.4 snapshots
See gh-20202,Start building against Spring Data Moore SR5 snapshots
See gh-20201,Start building against Spring HATEOAS 1.0.4 snapshots
See gh-20232,Start building against Spring Framework 5.2.4 snapshots
See gh-20199,Merge branch '2.2.x',Start building against Reactor Dysprosium-SR5 snapshots
See gh-20200,Merge branch '2.1.x' into 2.2.x,Start building against Reactor Californium-SR16 snapshots
See gh-20196,Merge branch '2.2.x',Merge branch '2.1.x' into 2.2.x,Polish,Fix gradle plugin validation error,Allow users to opt out of including the layer tools in a layered jar
For Maven, the layer configuration is now an additional configuration
option instead of a layout type.
\gh-19866
See gh-20198,Start building against Spring Framework 5.1.14 snapshots
See gh-20197,Update MongoDB auto-configuration documentation.,Harmonize MongoDB client factories
This commit brings MongoClientFactory and ReactiveMongoClientFactory
into functional alignment and reduces duplication in the classes
and their tests.
There are no behavior changes to ReactiveMongoClientFactory.
MongoClientFactory now throws an exception when a URI is configured
along with a host, port, or credentials, where it previousy ignored
host, port, and credentials silently. MongClientFactory now also
supports MongoClientSettingsBuilderCustomizers.
Fixes gh-20019,Merge pull request #20058 from dreis2211
* gh-20058:
  Polish "Include LICENCE and NOTICE files in shipped jars"
  Include LICENCE and NOTICE files in shipped jars
Polish "Include LICENCE and NOTICE files in shipped jars"
See gh-20058,Include LICENCE and NOTICE files in shipped jars
See gh-20058,Merge pull request #20226 from izeye
* pr/20226:
  Update copyright year of changed files
  Polish
Update copyright year of changed files
See gh-20226,Polish
See gh-20226,Merge branch '2.2.x',Merge pull request #20222 from dreis2211
* pr/20222:
  Test the Gradle Plugin against Gradle 6.2
Test the Gradle Plugin against Gradle 6.2
See gh-20222,Merge pull request #20225 from mustafau
* pr/20225:
  Polish log4j2 configuration
Polish log4j2 configuration
See gh-20225,Remove implicit layers support from the layer tools
Update gradlew.bat with Gradle 6.2's changes
See gh-20213,Merge branch '2.2.x'
Merge pull request #20216 from hbellahc
* pr/20216:
  Document missing reference to DataSourceHealthIndicator
Document missing reference to DataSourceHealthIndicator
See gh-20216,Add support for SimpleDriverDataSource
This commit makes sure that DataSourceBuilder can configure
SimpleDriverDataSource by adding an alias for the driver's class name.
\gh-20220
Co-authored-by: Dmytro Nosan <dimanosan@gmail.com>,Merge branch '2.2.x'
Do not fallback to embedded configuration if a datasource url is set
This commit makes sure that a fallback embedded datasource is not
created if no suitable connection pool is found and an url has been
explicitly registered.
This is consistent with EmbeddedDataSourceConfiguration as it is using
EmbeddedDatabaseBuilder behind the scenes and the latter does not
honour the configured URL anyway.
Merge pull request #20213 from dreis2211
* gh-20213:
  Upgrade to Gradle 6.2
Upgrade to Gradle 6.2
See gh-20213,Use query-less datasource validation by default
This commit changes DataSourceHealthIndicator to validate the connection
rather than issuing a query to the database. If a custom validation
query is specified, it uses that as before.
Merge pull request #20210 from dreis2211
* pr/20210:
  Fix duplicate words
Fix duplicate words
See gh-20210,Merge pull request #20193 from dreis2211
* gh-20193:
  Explicitly set java home in Maven Plugin integration tests
Explicitly set java home in Maven Plugin integration tests
See gh-20193,Clear ProducesRequestCondition cache attribute
As of spring-projects/spring-framework#22644, Spring Framework caches
the "produces" condition when matching for endpoints in the
`HandlerMapping` infrastructure. This has been improved in
spring-projects/spring-framework#23091 to prevent side-effects in other
implementations.
Prior to this commit, the Spring Boot actuator infrastructure for
`EndpointHandlerMapping` would not clear the cached attribute,
presenting the same issue as Spring Framework's infrastructure. This
means that a custom arrangement with custom `HandlerMapping` or
`ContentTypeResolver` would not work properly and reuse the cached
produced conditions for other, unintented, parts of the handler mapping
process.
This commit clears the cached data and ensures that other handler
mapping implementations are free of that side-effect.
Fixes gh-20150,Merge pull request #19316 from eddumelendez
* pr/19316:
  Polish "Add support for configuring Liquibase tag property"
  Add support for configuring Liquibase tag property
Polish "Add support for configuring Liquibase tag property"
See gh-19316,Add support for configuring Liquibase tag property
See gh-19316,Merge pull request #20190 from mikesmithson
* pr/20190:
  Polish "Revisit PluginXmlParserTests"
  Revisit PluginXmlParserTests
Polish "Revisit PluginXmlParserTests"
See gh-20190,Revisit PluginXmlParserTests
See gh-20190,Merge pull request #20206 from dreis2211
* pr/20206:
  Remove redundant useJUnitPlatform declarations
Remove redundant useJUnitPlatform declarations
See gh-20206,Merge pull request #20192 from zhangt2333
* pr/20192:
  Update copyright date
  Polish
Update copyright date
See gh-20192,Polish
See gh-20192,Merge branch '2.2.x',Upgrade to Spring AMQP 2.2.4.RELEASE
Explicitly enable config properties scan in java release scripts
This commit also upgrades the Spring Boot version used by the scripts
to 2.2.4 which is why the explicit annotation is required.
Merge pull request #20169 from juzerali
* pr/20169:
  Polish "Document sanitized keys and uri sanitization behavior"
  Document sanitized keys and uri sanitization behavior
Polish "Document sanitized keys and uri sanitization behavior"
See gh-20169,Document sanitized keys and uri sanitization behavior
See gh-20169,Merge pull request #19494 from bono007
* pr/19494:
  Polish "Add support for configuring Jetty's backing queue"
  Add support for configuring Jetty's backing queue
Polish "Add support for configuring Jetty's backing queue"
See gh-19494,Merge branch '2.1.x' into 2.2.x
Add support for configuring Jetty's backing queue
See gh-19494,Fix up-to-date checking of build info properties
Merge pull request #20168 from dsyer
* pr/20168:
  Remove duplicate auto-configuration class
Remove duplicate auto-configuration class
See gh-20168,Merge branch '2.2.x',Merge branch '2.1.x' into 2.2.x
Revert "Merge pull request #19926 from xak2000"
Upgrade to Spring Session Dragonfruit-M2
Upgrade to Tomcat 9.0.31
Upgrade to Micrometer 1.3.5
Upgrade to Liquibase 3.8.6
Upgrade to Lettuce 5.2.2.RELEASE
Upgrade to Infinispan 10.1.2.Final
Upgrade to Hibernate 5.4.11.Final
Upgrade to Flyway 6.2.3
Upgrade to SendGrid 4.4.4
Upgrade to Spring Boot 2.2.4,Upgrade to spring javaformat 0.0.20,Fix formatting,Move dependency management for JNA into spring-boot-parent
Previously, dependency management for JNA was provided by
spring-boot-dependencies so it affected users' applications. It was
original added for Elasticsearch but is no longer needed for that
purpose. We use JNA in spring-boot-buildpack-platform which is used
by our Gradle and Maven plugins and should not affect an application's
use of JNA.
This commit moves management of JNA from spring-boot-dependencies into
spring-boot-parent. This means that users' applications will now be
free to use whatever version of JNA meets their needs while still
controlling the version used for image building via Gradle or Maven.
Fix configuration property references in the reference docs
Previously, the configprop macro was being used in the source but the
extension that implements the macro was not available to Asciidoctor.
This led to the references not being checked at build time and the
macro being left as-is in the rendered documentation.
This commit updates the dependencies that are available to Asciidoctor
to include the extension and the projects which define the
configuration properties referenced in the documentation.
Upgrade to Spring Asciidoctor Extensions 0.4.1.RELEASE
Merge pull request #19953 from dreis2211
* gh-19953:
  Upgrade to Asciidoctor Gradle JVM 3.0.0
Upgrade to Asciidoctor Gradle JVM 3.0.0
See gh-19953,Merge pull request #20157 from dreis2211
* pr/20157:
  Upgrade CI to Docker 19.03.5
Upgrade CI to Docker 19.03.5
See gh-20157,Remove plugin management for infinispan-protocol-parser-generator
Remove usage of Infinispan BOM
Merge pull request #20143 from scheerer
* pr/20143:
  Fix Spring Boot version reference in spring-boot-starter-parent
Fix Spring Boot version reference in spring-boot-starter-parent
See gh-20143,Upgrade to Spring Integration 5.3.0.M2
Upgrade to Spring AMQP 2.2.4.RELEASE
Upgrade to Spring Kafka 2.4.2.RELEASE
Set ephemeral builder container creation to a fixed date
This commit fixes the `Created` date and time of the ephemeral builder
container image at the Windows epoch plus one second
(1980-01-01T00:00:01Z). This date matches the created date of the builder
image and influences the created date of the resulting image. Using
a fixed date for images ensures that the digest is consistent for all
images with the same version.
Fixes gh-20126,Set Spring Boot version in ephemeral builder
This commit adds a `createdBy` structure to the metadata of the ephemeral
builder container image that identifies Spring Boot as the creator of the
image, along with the Spring Boot version.
See gh-20126,Add actuator specific ObjectMapper
Prior to this commit, Actuator endpoints would use the application
ObjectMapper instance for serializing payloads as JSON. This was
problematic in several cases:
* application-specific configuration would change the actuator endpoint
output.
* choosing a different JSON mapper implementation in the application
would break completely some endpoints.
Spring Boot Actuator already has a hard dependency on Jackson, and this
commit uses that fact to configure a shared `ObjectMapper` instance that
will be used by the Actuator infrastructure consistently, without
polluting the application context.
This `ObjectMapper` is used in Actuator for:
* JMX endpoints
* Spring MVC endpoints with an HTTP message converter
* Spring WebFlux endpoints with an `Encoder`
* Jersey endpoints with a `ContextResolver<ObjectMapper>`
For all web endpoints, this configuration is limited to the
actuator-specific media types such as
`"application/vnd.spring-boot.actuator.v3+json"`.
Fixes gh-12951,Merge branch '2.2.x'
Fix structuring your code link in multi-page HTML documentation
\gh-19953
Upgrade to Spring Data Neumann-M3
Upgrade to Spring HATEOAS 1.1.0.M2
Merge pull request #20141 from dreis2211
* pr/20141:
  Exclude jcl-over-slf4j also on Reactive Cassandra starter
Exclude jcl-over-slf4j also on Reactive Cassandra starter
See gh-20141,Upgrade to Cassandra Driver 4.4.0
Merge pull request #19202 from bono007
* pr/19202:
  Polish "Verify ssl key alias on server startup"
  Verify ssl key alias on server startup
Polish "Verify ssl key alias on server startup"
See gh-19202,Verify ssl key alias on server startup
See gh-19202,Merge branch '2.2.x',Merge branch '2.1.x' into 2.2.x,Update copyright of changed files,Merge branch '2.2.x'
Merge pull request #18915 from schulzh
* pr/18915:
  Polish contribution
  Handle JSON keys containing a dot from CF environment as a single path segment
Polish contribution
Along with surrounding map keys with dot from VCAP_SERVICES with `[ ]`,
this commit also does that for non-alphanumeric and `-` characters so that
they are not stripped off later.
See gh-18915,Handle JSON keys containing a dot from CF environment as a single path segment
See gh-18915,Merge branch '2.2.x'
Harmonize JMS connection factory bean names
This commit restores consistent naming for the auto-configured
connection factory.
Document how to register a blocking health contributor with reactive
Upgrade CI to Artifactory Resource 0.0.11
Merge pull request #20113 from dreis2211
* pr/20113:
  Remove redundant jar task configuration
Remove redundant jar task configuration
See gh-20113,Merge branch '2.2.x'
Document spring-boot.run.arguments behaviour with multiple arguments
See gh-19926,Merge branch '2.2.x',Fix broken smoke test
See gh-19926,Fix broken smoke test
See gh-19926,Merge branch '2.2.x'
Merge pull request #19926 from xak2000
* pr/19926:
  Polish "Remove unnecessary leading slash in changelog locations"
  Remove unnecessary leading slash in changelog locations
Polish "Remove unnecessary leading slash in changelog locations"
See gh-19926,Remove unnecessary leading slash in changelog locations
See gh-19926,Merge branch '2.2.x'
Merge pull request #19948 from jcordoba95
* pr/19948:
  Polish "Fix condition source in OnBeanCondition"
  Fix condition source in OnBeanCondition
Polish "Fix condition source in OnBeanCondition"
See gh-19948,Fix condition source in OnBeanCondition
See gh-19948,Reintroduce "Add Gradle Wrapper Validation GitHub Action"
Fix 404 when composite contributor is added to a group
Fixes gh-19974,Fix typo,Merge pull request #20108 from dreis2211
* pr/20108:
  Fix some deprecation warnings
Fix some deprecation warnings
See gh-20108,Disable Spring Data Neo4j's open session in view by default
Merge pull request #20109 from nosan
* pr/20109:
  Polish "Create HazelCastClient if necessary"
  Create HazelCastClient if necessary
Polish "Create HazelCastClient if necessary"
See gh-20109,Create HazelCastClient if necessary
This commit makes sure to create a HazelcastClient if an instance name
is provided in configuration and if no such client already exists. This
harmonizes the behaviour with of the server counter-part.
See gh-20109,Start building against Spring Kafka 2.4.2 snapshots
See gh-20107,Start building against Spring AMQP 2.2.4 snapshots
See gh-20105,Start building against Spring Integration 5.3 M2 snapshots
See gh-20104,Cleanup cassandra smoke test removal
See gh-19588,Merge branch '2.2.x'
Remove unnecessary dependency on sendgrid
Upgrade to Undertow 2.0.29.Final
Upgrade to UnboundID LDAPSDK 4.0.14
Upgrade to Spring Retry 1.2.5.RELEASE
Upgrade to SLF4J 1.7.30
Upgrade to Selenium HtmlUnit 2.37.0
Upgrade to RxJava2 2.2.17
Upgrade to Prometheus PushGateway 0.8.1
Upgrade to Postgresql 42.2.10
Upgrade to Pooled JMS 1.1.1
Upgrade to OkHttp3 3.14.6
Upgrade to Neo4j OGM 3.2.8
Upgrade to MySQL 8.0.19
Upgrade to Mockito 3.2.4
Upgrade to MariaDB 2.5.4
Upgrade to Lombok 1.18.12
Upgrade to Liquibase 3.8.5
Upgrade to jOOQ 3.12.4
Upgrade to Johnzon 1.2.3
Upgrade to Jetty Reactive HTTPClient 1.1.1
Upgrade to Jetty EL 8.5.49
Upgrade to HttpCore 4.4.13
Upgrade to HttpClient 4.5.11
Upgrade to HtmlUnit 2.37.0
Upgrade to HikariCP 3.4.2
Upgrade to Hibernate Validator 6.1.2.Final
Upgrade to Hibernate 5.4.10.Final
Upgrade to Hazelcast 3.12.6
Upgrade to Groovy 2.5.9
Upgrade to Flyway 6.2.2
Upgrade to Elasticsearch 7.5.2
Upgrade to Couchbase Client 2.7.12
Upgrade to Caffeine 2.8.1
Upgrade to Byte Buddy 1.10.7
Upgrade to Awaitility 4.0.2
Upgrade to AppEngine SDK 1.9.78
Add missing mockito dependency
\gh-20059
Merge pull request #19002 from medamines1
* pr/19002:
  Polish "Make Kubernetes detection slightly more efficient"
  Make Kubernetes detection slightly more efficient
Polish "Make Kubernetes detection slightly more efficient"
See gh-19002,Make Kubernetes detection slightly more efficient
See gh-19002,Merge branch '2.2.x'
Merge pull request #19999 from bono007
* pr/19999:
  Polish contribution
  Add 'uris', 'address' and 'addresses' to keys to sanitize.
Polish contribution
See gh-19999,Add 'uris', 'address' and 'addresses' to keys to sanitize.
See gh-19999,Upgrade default image builder version
This commit upgrades the default CNB builder image from
cloudfoundry/cnb:0.0.43-bionic to cloudfoundry/cnb:0.0.53-bionic.
It also adds integration tests for the Maven and Gradle plugins
to verify both versions are supported.,Add support for CNB platform API v0.2
Cloud Native Buildpacks platform API version 0.2 introduced
two breaking changes: the order of invoking the restore and analyze
phases was reversed, and the cache phase was removed in favor of
distributing caching across other phases.
This commit adds support for Cloud Native Buildpacks builders that
implement platform API version 0.2, while maintaining compatibility
with builders that implement Lifecycle version platform API
version 0.1.
Merge pull request #20032 from dreis2211
* pr/20032:
  Polish "Use Dropwizard metrics BOM to manage dependencies"
  Use Dropwizard metrics BOM to manage dependencies
Polish "Use Dropwizard metrics BOM to manage dependencies"
See gh-20032,Use Dropwizard metrics BOM to manage dependencies
See gh-20032,Merge pull request #20035 from dreis2211
* pr/20035:
  Remove superfluous useJUnit()
Remove superfluous useJUnit()
See gh-20035,Merge pull request #20047 from dreis2211
* pr/20047:
  Set includeantruntime in Ant smoke tests
Set includeantruntime in Ant smoke tests
See gh-20047,Merge pull request #20049 from izeye
* pr/20049:
  Fix typo
Fix typo
See gh-20049,Merge pull request #20052 from scheerer
* pr/20052:
  Fix variable reference in maven-shade-plugin configuration
Fix variable reference in maven-shade-plugin configuration
See gh-20052,Merge pull request #20051 from dreis2211
* pr/20051:
  Add missing deployed plugin to modules
Add missing deployed plugin to modules
This commit registers 'org.springframework.boot.deployed' to
spring-boot-configuration-metadata and spring-boot-properties-migrator
to make sure they are deployed as expected.
See gh-20051,Upgrade to Spring Security 5.3.0.RC1
Upgrade to RSocket 1.0.0-RC6
Upgrade to Spring Session Dragonfruit-M1
Upgrade to Artifactory Resource 0.0.11
Upgrade to Gradle Enterprise Conventions Plugin 0.0.2
Upgrade to Spring Asciidoctor Extensions 0.4.0.RELEASE
Polish wildcard location documentation,Document new Docker-related features
Disambiguate a class in RabbitMQ CLI sample
Fixes gh-20003,Switch to latest snapshots of the GE conventions plugin
See gh-20034,Adopt Gradle Enterprise Conventions Plugin
Merge pull request #19981 from babjo
* pr/19981:
  Polish "Stop time web metrics when autotime is disabled"
  Stop time web metrics when autotime is disabled
Polish "Stop time web metrics when autotime is disabled"
See gh-19981,Stop time web metrics when autotime is disabled
See gh-19981,Merge branch '2.2.x'
Merge pull request #19901 from nosan
* pr/19901:
  Polish contribution
  Handle message of @ResponseStatus-annotated exception with WebFlux
Polish contribution
See gh-19901,Handle message of @ResponseStatus-annotated exception with WebFlux
See gh-19901,Import OAuth2 auto-configurations in web slice tests
Fixes gh-19823,Remove health actuator code deprecated in 2.2
This partially re-applies the deprecation removal from commit
https://github.com/spring-projects/spring-boot/commit/df1837a16bc39a9314e34e5e89c76e1ddf56372c,
without removing CompositeHealthIndicator, HealthAggregator, and related
configuration that is required by Spring Cloud.,Add support for wildcard locations for properties and YAML files
Revert "Remove deprecated HealthIndicator and HealthAggregator 2.2 code"
This reverts commit df1837a16bc39a9314e34e5e89c76e1ddf56372c.,Merge pull request #19978 from dreis2211
* pr/19978:
  Update copyright year of changed files
  Polish buildSrc
Update copyright year of changed files
See gh-19978,Polish buildSrc
See gh-19978,Merge pull request #20020 from izeye
* pr/20020:
  Update copyright year of changed files
  Polish
Update copyright year of changed files
See gh-20020,Polish
See gh-20020,Merge pull request #20022 from dreis2211
* pr/20022:
  Upgrade to Ivy 2.5.0
Upgrade to Ivy 2.5.0
See gh-20022,Merge pull request #19992 from dreis2211
* pr/19992:
  Fix link to Spring Integration Graph documentation
Fix link to Spring Integration Graph documentation
See gh-19992,Merge branch '2.2.x',Fix link to Spring Integration Graph documentation
Fix Embedded Mongo classpath check
This commit changes the classpath check condition to verify that the
core module of the MongoDB driver is present. Previously, we were only
checking for the presence of the sync driver, making embedded support
unavailable with the reactive variant.
Merge pull request #19960 from christophstrobl
* pr/19960:
  Polish "Upgrade to MongoDB Java Driver 4.0 beta1"
  Upgrade to MongoDB Java Driver 4.0 beta1
Polish "Upgrade to MongoDB Java Driver 4.0 beta1"
See gh-19960,Upgrade to MongoDB Java Driver 4.0 beta1
See gh-19960,Merge branch '2.2.x'
Upgrade to spring-javaformat 0.0.20
This commit upgrades to spring javaformat 0.0.20 and Checkstyle 8.29.
This commit also upgrades to the Checkstyle maven plugin 3.1.0.
See gh-20011,Merge pull request #20002 from dreis2211
* pr/20002:
  Upgrade to Ant 1.10.7
Upgrade to Ant 1.10.7
See gh-20002,Merge branch '2.2.x'
Merge pull request #20004 from izeye
* pr/20004:
  Polish samples in doc
Polish samples in doc
See gh-20004,Merge pull request #20009 from dreis2211
* pr/20009:
  Use Spring 5 module of Jersey
Use Spring 5 module of Jersey
See gh-20009,Use a RegularFileProperty to configure BootBuildImage's input jar
Merge pull request #20001 from izeye
* pr/20001:
  Polish
Polish
See gh-20001,Merge pull request #19995 from izeye
* pr/19995:
  Upgrade copyright date
  Polish
Upgrade copyright date
See gh-19995,Polish
See gh-19995,Restore deprecated class required by Spring Cloud
See gh-19860,Polish,Update copyright year of changed files,Polish whitespace,Add documentation for gradle bootBuildImage task,Jar files added after build time should be added to classpath
Fixes gh-19973,Remove adding of existing layers to EphemeralBuilder
Layers were being added to the EphemeralBuilder each time one was
created, but those layers already existed in the base builder image.
Try to make CouchbaseAutoConfigurationIntegrationTests less flakey
Polishing formatting of DockerApi,Sort names alphabetically in metrics list response
Lower the minimum required Docker API version to 1.24
Use posix long names when creating tar archive for image building
Fixes gh-19964,Merge pull request #19985 from dreis2211
* pr/19985:
  Polish "Use new AssertJ duration assertions"
  Use new AssertJ duration assertions
  Upgrade to AssertJ 3.15.0
Polish "Use new AssertJ duration assertions"
See gh-19985,Use new AssertJ duration assertions
See gh-19985
Upgrade to AssertJ 3.15.0
See gh-19985,Stop image building on error from builder
Previously, the image builder used by the build tool plugins ignored
errors from lifecycle phases and continued with subsequent phases.
This commit inspects the status of the builder container after each
lifecycle phase and aborts the image building process if the exit
status of the container after any phase is non-zero.
Fixes #19949,Merge branch '2.2.x'
Merge pull request #19976 from izeye
* pr/19976:
  Update test name in WebFluxTagsTests
Update test name in WebFluxTagsTests
See gh-19976,Polish
See gh-19802,Merge branch '2.2.x'
Unwraper handler to find ContextHandler when logging context path
Previously, only the top-level handlers were examined to find the
ContextHandlers and log the context path. If those handlers had
been wrapped, this prevented the ContextHandlers from being found
and an empty string was always logged.
When finding the context path, this commit unwraps the handler held
by a HandlerWrapper until the ContextHandler is found.
Fixes gh-19969,Disable bean overriding by default in ApplicationContextRunner
For consistency with SpringApplication, this commit disables bean
overriding by default in ApplicationContextRunner. Bean overriding can
be enabled again using withAllowBeanDefinitionOverriding.
Merge pull request #19864 from dreis2211
* pr/19864:
  Use Supplier variants of Assert
Use Supplier variants of Assert
See gh-19864,Merge branch '2.2.x'
Merge pull request #19961 from dreis2211
* pr/19961:
  Fix Gradle plugin documentation links
Fix Gradle plugin documentation links
See gh-19961,Merge branch '2.2.x'
Merge pull request #19944 from dreis2211
* pr/19944:
  Replace deprecated Concourse resource for pull requests
Replace deprecated Concourse resource for pull requests
See gh-19944,Merge pull request #19899 from nosan
* pr/19899:
  Polish "Fix scope of CqlSessionBuilder bean"
  Fix scope of CqlSessionBuilder bean
Polish "Fix scope of CqlSessionBuilder bean"
See gh-19899,Fix scope of CqlSessionBuilder bean
See gh-19899,Merge branch '2.2.x'
Merge pull request #19956 from natrem
* pr/19956:
  Fix typo
Fix typo
See gh-19956,Merge pull request #19952 from dreis2211
* pr/19952:
  Fix links in Maven Plugin documentation
Fix links in Maven Plugin documentation
See gh-19952,Merge pull request #19955 from wonwoo
* pr/19955:
  Register Stackdriver auto-config in `META-INF/spring.factories`
Register Stackdriver auto-config in `META-INF/spring.factories`
See gh-19955,Apply consistent timeout for Cassandra integration tests
Increase timeout for Cassandra tests
Improve documentation of 'image' parameter of Maven Plugin
Remove unnecessary execution-specific configuration in documentation
This documentation moves the specific `build-image` execution
configuration example of the Maven plugin documentation to the general
plugin configuration. This makes sure that it works in most cases and
an execution-specific configuration is not required here anyway.
Configure formatting tasks to use UTF-8 encoding
Merge pull request #19894 from kedar-joshi
* pr/19894:
  Polish "Upgrade to Flyway 6.2.0"
  Upgrade to Flyway 6.2.0
Polish "Upgrade to Flyway 6.2.0"
See gh-19894,Upgrade to Flyway 6.2.0
See gh-19894,Merge pull request #19898 from dreis2211
* pr/19898:
  Polish "Introduce appendix section with version properties"
  Introduce appendix section with version properties
Polish "Introduce appendix section with version properties"
See gh-19898,Introduce appendix section with version properties
With the introduction of Gradle we lost the list of version properties
that were previously in the spring-boot-dependencies POM and were also
linked inside the documentation. This commit introduces an appendix
section in the docs and links the appropriate places to the new section
to restore discoverability.
See gh-19898,Merge pull request #19936 from dreis2211
* pr/19936:
  Fix broken documentation links
Fix broken documentation links
See gh-19936,Merge branch '2.2.x',Fix broken documentation links
See gh-19936,Migrate Couchbase tests to ApplicationContextRunner,Simplify default value for Spring Data Couchbase's typeKey
This commit hard codes the default value so that the annotation
processor picks it up. The default value is tested for consistency so
this is acceptable as providing the default value in the metadata
requires to hard code it anyway.,Fix NPE when waiting for named socket path to become available
Fixes gh-19941,Merge pull request #19789 from grudir
* pr/19789:
  Polish "Add support for Spring Data Couchbase custom type key"
  Add support for Spring Data Couchbase custom type key
Polish "Add support for Spring Data Couchbase custom type key"
See gh-19789,Add support for Spring Data Couchbase custom type key
See gh-19789,Fix Docker socket creation on Windows
Stop caching ~/.m2 across Gradle-based CI tasks
See gh-19931,Deprecate refresh(ApplicationContext) and add refresh(ConfigurableAC)
refresh can only ever be called with a ConfigurableApplicationContext
and we want to evolve the refresh API to reflect that. This commit
takes the first step by overloading refresh(ApplicationContext) with
a new refresh(ConfigurationApplicationContext) method and deprecating
refresh(ApplicationContext). Where the call to refresh is made, the
argument is cast to ApplicationContext to ensure that
refresh(ApplicationContext) is called. This ensures that any existing
override of the method is still effective.
Merge pull request #19902 from dreis2211
* pr/19902:
  Upgrade to Testcontainers 1.12.5
Upgrade to Testcontainers 1.12.5
See gh-19902,Merge pull request #19907 from dreis2211
* pr/19907:
  Upgrade to JUnit Jupiter 5.6.0
Upgrade to JUnit Jupiter 5.6.0
See gh-19907,Merge branch '2.2.x'
Merge pull request #19913 from dreis2211
* pr/19913:
  Upgrade CI images to Ubuntu Bionic 20200112
Upgrade CI images to Ubuntu Bionic 20200112
See gh-19913,Upgrade to SQLite JDBC 3.30.1
Upgrade to Solr 8.4.1
Upgrade to Rabbit AMQP Client 5.8.0
Upgrade to MongoDB 3.12.1
Upgrade to Mongo Driver ReactiveStreams 1.13.0
Upgrade to Log4j2 2.13.0
Upgrade to JUnit 4.13
Upgrade to Jedis 3.2.0
Upgrade to InfluxDB Java 2.17
Upgrade to Commons Pool2 2.8.0
Upgrade to Commons Codec 1.14
Align Bomr with quoting changes in s-b-dependencies build.gradle,Upgrade to Artemis 2.11.0
Upgrade to Gradle 6.1.1,Revert "Add Gradle Wrapper Validation GitHub Action"
This reverts commit 136cdacb401f867e3ab2e299c209994f985ac98e.
Our GitHub billing plan does not support Actions at the moment.
Reverting until that has been resolved.
See gh-19762,Fix typo,Fix xml syntax in example
Merge pull request #19762 from JLLeitschuh
* pr/19762:
  Add Gradle Wrapper Validation GitHub Action
Add Gradle Wrapper Validation GitHub Action
See: https://github.com/gradle/wrapper-validation-action
See gh-19762,Merge pull request #19896 from dreis2211
* pr/19896:
  Remove obsolete files
Remove obsolete files
See gh-19896,Merge branch '2.2.x'
Upgrade to Micrometer 1.3.3
Merge pull request #19880 from izeye
* pr/19880:
  Polish "Close TomcatMetrics on shutdown for cleanup"
  Close TomcatMetrics on shutdown for cleanup
Polish "Close TomcatMetrics on shutdown for cleanup"
See gh-19880,Close TomcatMetrics on shutdown for cleanup
See micrometer-metrics/micrometer#1424
See gh-19880,Upgrade to Micrometer 1.1.10
* pr/19776:
  Test the Gradle Plugin against Gradle 6.1
Test the Gradle Plugin against Gradle 6.1
See gh-19776,Fix warnings in spring-boot-autoconfigure's Kotlin test code
Adapt Cassandra documentation of v4 driver upgrade
See gh-18621,Fix default value for spring.data.couchbase.contact-points
See gh-18621,Add local-datacenter property for Cassandra
The Cassandra v4 driver does not longer have automatic local DC inference
from contact points. As a result, the "local-datacenter" property must be
set with the default load balancing policy and the contact points must
be of that data center.
This commit adds a new property for the local datacenter so that it can
be specified without the use of a customizer.
Correct name of the file added to git after version change in staging
Fix version references in Maven Plugin's reference documentation
Restore @since on build-image parameters,Add documentation for Maven plugin's build-image support
Add integration tests for Maven plugin's build-image support
See gh-19830,Use line endings on all OSs when writing image config JSON
Previously \r\n was used on Windows and \n was used on other
platforms. This resulted in different JSON content being written to
the archive. As the config's entry name is the SHA-256 hash of its
content, it also resulted in the entry name being different.
This commit updates the JSON that's written into the archive to use
\n line endings, irrespective of the OS on which the image is being
built.
See gh-19828,Make line ending expectations in TotalProgressBarTests OS-independent
See gh-19828,Merge pull request #19863 from izeye
* gh-19863:
  Fix TestFailuresPlugin.TestFailure.compareTo()
Fix TestFailuresPlugin.TestFailure.compareTo()
This commit also polishes around it a bit.
See gh-19863,Fix bootBuildImage integration tests on Java 13
We build with Java 8, 11, and 13 without specifying target
compatibility for the bytecode of the app that's placed in the image.
The built image uses Java 11 and when the app is built with Java 13
it fails to start as the Java 11 VM can't read that Java 13 bytecode.
This commit configures the app that's placed in the image to be built
with target compatibility of 1.8. This allows it to be compiled with
all version of Java with which we build and to also be compatible
with the JVM that's in the image.
See gh-19831,Remove unnecessary dependency from HATEOAS starter
Polish,Migrate remaining use of ClassLoader.loadClass to Class.forName
Configure repositories based on the version that is being built
https://repo.spring.io/snapshot should only be available when
building a BUILD-SNAPSHOT. https://repo.spring.io/milestone should
only be available when not building a RELEASE (a BUILD-SNAPSHOT, Mn,
or RCn).
Include layertools in layered jars build with Gradle
Fix zip compression of libs in layered jars
Add support for building OCI images using the Gradle plugin
Polish BootJarTests
See gh-19847
See gh-19792,Use Class.forName rather than ClassLoader.loadClass
This commit changes uses of ClassLoader.loadClass to Class.forName for
consistency with what was initiated in #19342 and better compatibility
with GraalVM.
Merge pull request #19764 from scottfrederick
* pr/19764:
  Upgrade to Kafka 2.4.0 and Spring Kafka 2.4.1
Upgrade to Kafka 2.4.0 and Spring Kafka 2.4.1
See gh-19764,Upgrade to Spring Integration 5.3.0.M1
Merge pull request #19855 from protyay
* pr/19855:
  Polish "Encourage use of SpringBootApplication"
  Encourage use of SpringBootApplication
Polish "Encourage use of SpringBootApplication"
See gh-19855,Encourage use of SpringBootApplication
See gh-19855,Merge branch '2.2.x'
Upgrade Java 13 version in CI image
Upgrade Java 8 version in CI image
Automatically add jarmode jars when packaging
Update the `Packager` to automatically add the layertools jarmode jar
when producing a layered jar.
Fix jarmode support in unexploded jars
Update `LaunchedURLClassLoader` to ensure that the `JarModeLauncher`
is created in the correct classloader.
Prior to this commit the launcher was created by the application
classloader and did not have access to any of the required
`org.springframework` classes.
See gh-19848,Polish,Update copyright year of changed files,Rename spring-boot-layertools
Rename `spring-boot-layertools` to `spring-boot-jarmode-layertools`.
Write classpath index file from Gradle plugin
Fix incorrect spring replace due to `"` change,Reinstate JobLauncherCommandLineRunner
This class was mistakenly marked as deprecated in 2.2.0 instead of deprecated
in 2.3.0. This resulted in the class being deleted as part of the 2.3.0
cleanup.
Putting it back in place now with the correct deprecation noted.
Use parentheses when declaring dependencies
Update all dependencies declarations to use the form `scope(reference)`
rather than `scope reference`.
Prior to this commit we declared dependencies without parentheses unless
we were forced to add them due to an `exclude`.,Polish quote form used in Gradle scripts
Replace Gradle single quote strings with the double quote form
whenever possible. The change helps to being consistency to the
dependencies section where mostly single quotes were used, but
occasionally double quotes were required due to `${}` references.,Remove Spring Cloud Connectors auto-config/starter
The Spring Cloud Connectors project has been deprecated in favor of the
Java CFEnv project. The Boot auto-configuration and starter that support
Connectors were deprecated in Boot 2.2.
This commit removes the Connectors auto-configuration, starter,
and dependency management.
Add support for layered jars in gradle plugin
\gh-19792
Co-authored-by: Andy Wilkinson <awilkinson@pivotal.io>,Default spring.datasource.generate-unique-name to true
This change ensures that each test in a test suite that shares an
application context gets a unique embedded database, to prevent
inconsistent embedded database state between tests.
Fix exploded jar classloader issues
Fix a bug in `ExplodedURLClassLoader` and merge the code into the
existing `LaunchedURLClassLoader` class. Also polish a few method
names relating to layer support.
See gh-19848
See gh-19767,Protect against NPE in server tests
Update `AbstractApplicationLauncher` to not attempt to shutdown
the process if startup fails.,Rename spring-boot-cloudnativebuildpack
Rename the `spring-boot-cloudnativebuildpack` module to
`spring-boot-buildpack-platform` and update the the package
name to `org.springframework.boot.buildpack.platform`.
Change default BootstrapMode for JPA repositories
Change the default `BootstrapMode` for auto-configured `JpaRepositories`
to `BootstrapMode.DEFERRED` to allow the initialization of
`EntityManagerFactory` to be parallelized for increased startup efficiency.
Prior to this change, the default BootstrapMode for all auto-configured
Spring Data repositories was `BootstrapMode.DEFAULT`.
Merge pull request #19850 from dreis2211
* gh-19850:
  Treat Java 11+'s NoSuchFileException the same as FileNotFoundException
Treat Java 11+'s NoSuchFileException the same as FileNotFoundException
See gh-19850,Upgrade to Micrometer 1.3.3
Add layertools jarmode
Add a new `spring-boot-layertools` module which provides jarmode support
for working with layers. The module works with both classic fat jars,
as well as layered jars.
Add jarmode support to the loader code
Update the `Launcher` class to allow a packaged jar to be  launched in
a different mode. The launcher now checks for a `jarmode` property and
attempts to find a `JarMode` implementation using the standard
`spring.factories` mechanism.
Reserve layer names for future use
Update layered jar support so that the name `ext` and any name
starting `springboot` are reserved.
See gh-19767,Add cloudnativebuildpack to dependencies
Update the managed dependencies to include the recently added
`spring-boot-cloudnativebuildpack` module.
See gh-19828,Fix packager code to generate layer index file
Update `Packager` to create the layer index file when repackaging.
Polish Gradle expression references
Expand all expression `$` references to the full `${...}` form.,Fix classpath used for Gradle Plugin integration tests in Eclipse
See gh-19841,Merge pull request #19790 from scottfrederick
* pr/19790:
  Polish "Upgrade to Infinispan 10.1.1.Final"
  Upgrade to Infinispan 10.1.1.Final
Polish "Upgrade to Infinispan 10.1.1.Final"
See gh-19790,Upgrade to Infinispan 10.1.1.Final
See gh-19790,Merge branch '2.2.x'
Polish actuator dependencies and test resources
This commit removes references of cache infra following the move to
Micrometer. We no longer ships an infinispan specific binder so the
dependency has been removed as well.
Rework loader-tools resource generation to work with Buildship
Previously, the generated resources were added as an output to the
main source set. This worked on the command line, but resulted in
the META-INF folder that contains the loader jar not being on the
classpath of downstream projects in Eclipse.
This commit changes loader-tools to add the generated resources
as a srcDir to the main source set. This results in it appearing on
the classpath of other projects in Eclipse that depend on loader-tools
such as the Gradle plugin, thereby allowing its tests to be run in
the IDE as well as on the command line.
Fixes gh-19841,Use JavaExec to invoke Ant with required dependencies on its classpath
Previously, we were adding dependencies to Ant's ClassLoader within
Gradle. It is suspected that this was causing sporadic loader
contraint violations as types that Gradle itself uses (from Commons
Compress) were then available from two different ClassLoaders.
This commit reworks the Ant smoke test to use JavaExec and Ant's
launcher to run the build. This allows us to make the necessary
dependencies available to Ant in an isolated manner. The javac
invocation within Ant is now forked to allow it to find the tools jar
even when the build itself is running on a JRE.
Register JNA's native library integration in LinuxSocketDomain
See gh-19836,Merge pull request #19797 from dreis2211
* pr/19797:
  Revisit documentation that mentions Gradle "compile" configuration
Revisit documentation that mentions Gradle "compile" configuration
See gh-19797,Disable integration test on Linux
See gh-19836,Attempt to make DockerApiIntegrationTests work on Linux,Merge pull request #19826 from dreis2211
* pr/19826:
  Reinstate running of OutputCaptureRuleTests
Reinstate running of OutputCaptureRuleTests
See gh-19826,Merge pull request #19835 from dreis2211
* pr/19835:
  Add UTF-8 encoding to spring-boot-starter-parent POM
Add UTF-8 encoding to spring-boot-starter-parent POM
See gh-19835,Add build-image support to the maven plugin
Add a new `build-image` goal to the Maven plugin to allow Docker images
to be create via using the cloud native buildpack.
See gh-19830, Create a new ImagePackager tools class
Pull functionality from `Repackager` into a new `Packager` base class
and develop a variant for Docker image creation. The new `ImagePackager`
class provides a general purpose way to construct jar entries without
being tied to an actual file. This will allow us to link it to a
buildpack and provide application content directly.
Add cloud native buildpack module
Add a Java implementation of the buildpacks.io specification allowing
projects to be packaged into OCI containers. The `builder` class
provides a Java equivalent of `pack build` command and is based on
the `pack` CLI Go code published at https://github.com/buildpacks/pack.
Fixes gh-19821,Merge branch '2.2.x'
Merge pull request #19819 from nosan
* pr/19819:
  Polish "Document RedisCacheManagerBuilderCustomizer"
  Document RedisCacheManagerBuilderCustomizer
Polish "Document RedisCacheManagerBuilderCustomizer"
See gh-19819,Document RedisCacheManagerBuilderCustomizer
See gh-19819,Revert "Add profiles directly to the application environment for tests"
This reverts commit 487b9cbf963829ea33ba3c1fde48a9265c633e9d.
Fixes gh-19788,Merge pull request #19817 from Abdullah8006
* pr/19817:
  Polish README.adoc
Polish README.adoc
See gh-19817,Merge branch '2.2.x'
Upgrade to Dependency Management Plugin 1.0.9.RELEASE
\gh-19763 in 2.2.4,Upgrade Java 11 version in CI image
Upgrade to Reactor Dysprosium-SR4
Apply Java conventions to projects that only apply Java base plugin
Fixes gh-19806,Retry when findAvailableTcpPort returns an unavailable port
Revise credhub references for Gradle Enterprise cache user
Restore previous credhub references for cache username and password
The references with . in them did not work, resulting in pushing to
the remote cache being disabled.,Merge branch '2.2.x'
Upgrade to Spring HATEOAS 1.1.0.M1
Upgrade to spring-javaformat 0.0.19
Upgrade to Spring AMQP 2.2.3.RELEASE
Close FileInputStreams in RepackagerTests,Sort test failures before logging them
See gh-19696,Update ConventionsPlugin's javadoc
See gh-19784,Use a centrally managed version for commons-compress,Log some information about all test failures when the build completes
Upgrade to Spring Data Neumann-M2
Compile with Java with the '-parameters' option
Update the `ConventionsPlugin` to apply the `-parameters` compiler
argument.
Revert "Upgrade to Spring Data Neumann-M1"
This reverts commit e44206e88eb9e82bfe4bdde5ab4dbc0bc154587b.,Polish DisabledIfDockerUnavailable
Convert `DisabledIfDockerUnavailable` to be an annotation and make
it slightly less noisy.,Add tests for configuring layered jar layout
Merge pull request #19632 from dreis2211
* pr/19632:
  Make Tomcat javadoc link version dependent
Make Tomcat javadoc link version dependent
See gh-19632,Merge pull request #19658 from dreis2211
* pr/19658:
  Polish "Pass CI branch parameter to build scan"
  Pass CI branch parameter to build scan
Polish "Pass CI branch parameter to build scan"
See gh-19658,Pass CI branch parameter to build scan
See gh-19658,Merge pull request #19699 from scottfrederick
* pr/19699:
  Polish "Remove deprecated Joda-Time support"
  Remove deprecated Joda-Time support
  Remove deprecated 2.2 code
  Remove deprecated HealthIndicator and HealthAggregator 2.2 code
  Remove deprecated Actuator metrics 2.2 code
  Polish "Remove deprecated logging properties"
  Remove deprecated logging properties
Polish "Remove deprecated Joda-Time support"
See gh-19699,Remove deprecated Joda-Time support
See gh-19699,Remove deprecated 2.2 code
See gh-19699,Remove deprecated HealthIndicator and HealthAggregator 2.2 code
See gh-19699,Remove deprecated Actuator metrics 2.2 code
See gh-19699,Polish "Remove deprecated logging properties"
See gh-19699,Remove deprecated logging properties
See gh-19699,Deprecate CachingOperationInvoker#apply
This commit deprecates the only public accessor to
`CacheOperationInvoker` so that we can make the entire class package
private in the next feature release.
Only attempt to publish a build scan when we can authenticate,Upgrade to Gradle 6.1
Allow Boot's Jetty error handler to be overridden
Fixes gh-19520,Merge branch '2.2.x',Revert "Build against Micrometer 1.3.3 snapshots"
The release didn't happen in time for 2.2.3.
See gh-19645,Merge branch '2.1.x' into 2.2.x,Revert "Start building against Micrometer 1.1.10 snapshots"
The release did not happen in time for 2.1.12.
See gh-19649.,Add layered jar layout support to the maven plugin
Update the Maven plugin with a new `LAYERED_JAR` layout option.
See gh-19768,Support generation and loading of layered jars
Support an alternative fat jar format that is more amenable to Docker
image layers.
The new format arranges files in the following structure:
 BOOT-INF/
   layers/
     <layer-name #1>
       /classes
       /lib
     <layer-name #2>
       /classes
       /lib
The `BOOT-INF/layers.idx` file provides the names of the layers and the
order in which they should be added (starting with the least changed).
The `JarLauncher` class can load layered jars in both fat and exploded
forms.
\gh-19767
Co-authored-by: Phillip Webb <pwebb@pivotal.io>,Add classpath index support for exploded archives
Update the `Repackager` class so that an additional `classpath.idx` file
is written into the jar that provides the original order of the
classpath. The `JarLauncher` class now uses this file when running as
an exploded archive to ensure that the classpath order is the same as
when running from the far jar.
\gh-9128
Co-authored-by: Phillip Webb <pwebb@pivotal.io>,Polish loader and loader-tools
Polish and refactor `spring-boot-loader` and `spring-boot-loader-tools`
to make it easier to add indexing and layering support.
The JarFile was not being closed which linked a file handle and caused
a test failure on Windows.
The local variable has been renamed as, when declared in a
try-with-resources, Checkstyle was confused by the shadowing of the
jarFile field and required references to jarFile within the try-block
the be prefixed with this.
See gh-19595,Merge branch '2.2.x',Upgrade to Spring Kafka 2.3.5
Upgrade to Spring Integration 5.2.3
Upgrade to Spring AMQP 2.2.3
Revert "Publish a build scan only when authenticated"
publishIfAuthenticated() does not appear to work as intended as it
disables publishing even when authenticated.,Publish a build scan only when authenticated,Merge branch '2.2.x',Merge branch '2.1.x' into 2.2.x,Upgrade to Spring Kafka 2.2.12.RELEASE
Upgrade to Spring AMQP 2.1.13
Configure the access key needed to publish build scans,Merge branch '2.2.x',Upgrade to Spring Data Moore-SR4
Upgrade to Spring HATEOAS 1.0.3.RELEASE
Upgrade to Spring Retry 1.2.5.RELEASE
Upgrade to Slf4j 1.7.30
Upgrade to Postgresql 42.2.9
Upgrade to Neo4j Ogm 3.2.6
Upgrade to Liquibase 3.8.5
Upgrade to Kotlin Coroutines 1.3.3
Upgrade to Infinispan 9.4.17.Final
Upgrade to Hibernate 5.4.10.Final
Upgrade to Elasticsearch 6.8.6
Upgrade to Jetty 9.4.25.v20191220
Upgrade to Groovy 2.5.9
Upgrade to Awaitility 4.0.2
Upgrade to Httpcore 4.4.13
Upgrade to Byte Buddy 1.10.6
Upgrade to Mysql 8.0.19
Upgrade to Undertow 2.0.29.Final
Upgrade to Rxjava2 2.2.17
Upgrade to Netty 4.1.45.Final
Upgrade to Dropwizard Metrics 4.1.2
Upgrade to Hikaricp 3.4.2
Upgrade to Unboundid Ldapsdk 4.0.14
Upgrade to Okhttp3 3.14.6
Upgrade to Hazelcast 3.12.5
Upgrade to Jackson 2.10.2
Upgrade to Slf4j 1.7.30
Upgrade to Postgresql 42.2.9
Upgrade to Neo4j Ogm 3.1.16
Upgrade to Infinispan 9.4.17.Final
Upgrade to Hibernate 5.3.15.Final
Upgrade to Jetty 9.4.25.v20191220
\gh-19728
Upgrade to Groovy 2.5.9
Upgrade to Httpcore 4.4.13
Upgrade to Mysql 8.0.19
Upgrade to Undertow 2.0.29.Final
Upgrade to Rxjava2 2.2.17
Upgrade to Netty 4.1.45.Final
Upgrade to Unboundid Ldapsdk 4.0.14
Upgrade to Hazelcast 3.11.6
Upgrade to Jackson 2.9.10.20200103
Rework dep mgmt again to avoid consumers picking up strict constraints
This paves the way for publishing Gradle module metadata once the
problem caused by snapshot versions and our two-step publication
process has been addressed.
See gh-19609,Polish Intellij IDEA contribution guidelines,Merge branch '2.2.x',Merge branch '2.1.x' into 2.2.x,Upgrade to Spring Data Lovelace-SR15
Merge pull request #19711 from dreis2211
* pr/19711:
  Fix deprecations in spring-boot-smoke-test-hateoas
Fix deprecations in spring-boot-smoke-test-hateoas
See gh-19711,Merge branch '2.2.x'
Merge pull request #19595 from nosan
* pr/19595:
  Polish "Limit ChronoField values to their range"
  Limit ChronoField values to their range
Polish "Limit ChronoField values to their range"
See gh-19595,Limit ChronoField values to their range
See gh-19595,Use a consistent version of spring-javaformat
See gh-19710,Fix file handle leak in JarFileArchiveTests
Start using spring-javaformat 0.0.19 snapshots
See gh-19710,Harmonize Cassandra bean names,Revert "Rework dep management to avoid consumers picking up strict constraints"
This reverts commit b34a311d02fe60ac267493ccc7f2c6b816f3a15c as,
having disabled the publishing of Gradle's module metadata (4f75ab5),
the changes are no longer needed.
See gh-19609,Disable generation of Gradle's module metadata
The way in which we deploy the artifacts (publishing to a Maven
repository on the filesystem and then using the Concourse artifactory
resource to upload them) is incompatible with Gradle's module metadata
generation.
The metadata contains an entry, url, that contains the name of the
artifact. This will be something like
spring-boot-gradle-plugin-2.3.0.BUILD-20200114.095038-1.jar. The -1 in
the name is derived from the Maven snapshot build number. It's -1 as
the local repository to which the artifact is published is empty and
has no maven-metadata.xml file. When the artifact is uploaded to
Artifactory there is a maven-metadata.xml file so the build number is
different. As a result, the module metadata points to a file that
doesn't exist. This leads to problems like this when trying to consume
the snapshots:
Could not find spring-boot-gradle-plugin-2.3.0.BUILD-20200114.095038-1-2.3.0.BUILD-SNAPSHOT.jar (org.springframework.boot:spring-boot-gradle-plugin:2.3.0.BUILD-SNAPSHOT:20200114.101952-123)
Gradle has used the maven-metadata.xml file on the server to determine
that 2.3.0.BUILD-SNAPSHOT:20200114.101952-123 is the latest version.
It has downloaded the .module file with this version but it points to
spring-boot-gradle-plugin-2.3.0.BUILD-20200114.095038-1.jar. That file
doesn't exist so the build fails.
See gh-19609,Polish Cassandra v4 support,Upgrade to Spring Framework 5.2.3
Move spring.http.* config properties namespace
Make sure Redis cache prefix includes cache name
This commit maps 'spring.cache.redis.key-prefix' to the new
'prefixCacheNameWith' method introduced in Spring Data Neumann. This
makes sure that the configured prefix includes the cache name.
Disable failing TomcatReactiveWebServerFactoryTests
Temporarily disable some tests in `TomcatReactiveWebServerFactoryTests`
that fail since the Netty upgrade.
See gh-19702,Update copyright year of changed files,Merge branch '2.2.x',Update copyright year of changed files,Merge branch '2.2.x',Merge branch '2.1.x' into 2.2.x,Merge branch '2.2.x'
Ignore trailing slash when recording Web metrics
Fixes gh-18207,Update copyright year of changed files,Merge branch '2.2.x'
Upgrade to Eclipse 2019.12
Polish smoke tests' Gradle configuration,Merge pull request #19681 from scottfrederick
* pr/19681:
  Remove support for deprecated Elasticsearch Jest client
Remove support for deprecated Elasticsearch Jest client
\#19676,Rework dep management to avoid consumers picking up strict constraints
Previously, enforcedPlatform dependencies were using to pull in the
constraints defined in spring-boot-dependencies and
spring-boot-parent and applied them strictly so that the constrained
version had to be used. This worked as intended in Spring Boot's own
build but incorrectly enforced those same strict version requirements
on external consumers of Spring Boot's modules.
This commit reworks how Spring Boot defines its internal dependency
management so that platform dependencies are exposed to external
consumers while enforced platform dependencies are using internally.
See gh-19609,Upgrade to Reactor Dysprosium-SR3
Merge pull request #19690 from dreis2211
* pr/19690:
  Fix typo in NoSuchBeanDefinitionFailureAnalyzer exception
Fix typo in NoSuchBeanDefinitionFailureAnalyzer exception
See gh-19690,Merge branch '2.2.x'
Upgrade to Jakarta Validation 2.0.2
Fixes gh-19671,Merge branch '2.2.x'
Cope with different exception messages in ValidationException failure analyzer
Fixes gh-19671,Merge pull request #19680 from dreis2211
* gh-19680:
  Disable tests on Java 13 that require an incompatible Gradle version
Disable tests on Java 13 that require an incompatible Gradle version
See gh-19680,Merge branch '2.2.x'
Merge pull request #19540 from jason-liu475
* pr/19540:
  Polish "Make equality checks defensive to null reference"
  Make equality checks defensive to null reference
Polish "Make equality checks defensive to null reference"
See gh-19540,Make equality checks defensive to null reference
See gh-19540,Merge branch '2.2.x'
Merge pull request #19637 from nosan
* pr/19637:
  Fix retrieval of parent logger in PoolingDataSourceBean
Fix retrieval of parent logger in PoolingDataSourceBean
See gh-19637,Merge branch '2.2.x'
Remove duplicate note in Hazelcast section of reference guide
Remove support for Elasticsearch transport client
The Elasticsearch transport client has been deprecated since Spring Boot
2.2.0 and is about to be removed from Spring Data Elasticsearch and
Elasticsearch itself in their next major releases.
The available REST client support variants are now the preferred way of
using Elasticsearch features.
Build against Spring HATEOAS 1.1.0.M1 snapshots
See gh-19649,Upgrade to Spring Data Neumann-M1
Upgrade to Apache Cassandra 4.3.1
See gh-19588,Upgrade to Elasticsearch 7.5.1
See gh-19588,Start building against Spring Data Neumann-M1 snapshots
See gh-19588,Raise the minimum supported version of Gradle to 5.6
Merge pull request #19464 from nosan
* pr/19464:
  Support nested requests in MetricsClientHttpRequestInterceptor
Support nested requests in MetricsClientHttpRequestInterceptor
Prior to this commit, requests made by `HttpRequestInterceptor`
instances configured on `RestTemplate` would not be recorded
properly.
This commit ensures that nested requests are recorded separately.
See gh-19381,Merge branch '2.2.x',Merge branch '2.1.x' into 2.2.x,Upgrade to Reactor Californium-SR15
Relax the Gradle plugin's Kotlin version constraint
Enforcing the spring-boot-dependencies platform makes for too strong
an opinion about the version of Kotlin that should be on the build
script's classpath. It clashes with the version of Kotlin that's
embedded in Gradle and used with Gradle's Kotlin DSL.
This commit switches to a normal platform (rather than an enforced
platform) which allows it to express an opinion about the version of
Kotlin without making it a strict requirement.
Upgrade to Spring Security 5.3.0.M1
Build against Reactor Dysprosium-SR3 snapshots
See gh-19653,Build against Micrometer 1.3.3 snapshots,Build against Spring AMQP 2.2.3 snapshots
See gh-19651,Build against Spring Integration 5.3.0.M1 snapshots
See gh-19650,Remove validation starter from web starters
This commit removes the validation starter from the web and
webflux starters - we've reconsidered that choice since many were
not using this feature as part of their default web experience.
Thit commit also changes the default EL implementation for the
Jakarta implementation, aligning all servers on it and simplifying
dependency management (especially exclusions that were required
previously).
Build against Spring Data Moore-SR4 snapshots
See gh-19648,Build against Spring Integration 5.2.3 snapshots
See gh-19647,Build against Spring AMQP 2.2.3 snapshots
See gh-19646
Build against Micrometer 1.3.3 snapshots
See gh-19645,Build against Spring HATEOAS 1.0.3 snapshots
See gh-19644,Build against Reactor Dysprosium-SR3 snapshots
See gh-19643,Suppress Gradle's welcome message in CI builds
Pass Gradle Enterprise-related parameters into Windows build,Merge branch '2.2.x',Merge branch '2.1.x' into 2.2.x,Start building against Micrometer 1.1.10 snapshots
See gh-19639,Start building against Spring Data Lovelace-SR15 snapshots
See gh-19642,Start building against Spring AMQP 2.1.13 snapshots
See gh-19641,Start building against Reactor Californium-SR15 snapshots
See gh-19640,Merge branch '2.2.x',Merge branch '2.1.x' into 2.2.x
Isolate Gradle Plugin build from other Gradle configuration
Merge pull request #19621 from dreis2211
* pr/19621:
  Update copyright in legal doc section
Update copyright in legal doc section
See gh-19621,Revert "Try to fix problem with corrupted build numbers on Artifactory"
This reverts commit ab981b9cbae6d8c3b64a1553bad93cf99391cd77 since
it's hopefully now fixed upstream.,Polish,Merge branch '2.2.x',Fix tests
See gh-19599,Auto-configure HTTP client builders as Lazy
Prior to this commit, HTTP client builders auto-configured by Spring
Boot would be eagerly instantiating resources, even if those were not
used by the application.
This commit makes the `RestTemplateBuilder` bean as Lazy.
`WebClient.Builder` was already a prototype bean, but some of its
dependencies could consume resources, like the `HttpClientConnector` and
the related infrastructure. This commit makes those pieces lazy.
Note that since those components are meant to help instantiate actual
HTTP clients for application components, making them lazy won't make any
difference at runtime since they'll be used during context refresh, or
they won't be used at all.
Short circuit validation in bind handler if previous exception present
Merge pull request #19620 from vpavic
* gh-19620:
  Reuse optional configuration name constant
Reuse optional configuration name constant
See gh-19620,Merge pull request #19619 from vpavic
* gh-19619:
  Simplify Gradle's build settings
Simplify Gradle's build settings
See gh-19619,Remove leftover Maven settings template,Merge pull request #19618 from dreis2211
* gh-19618:
  Remove Maven wrapper leftovers
Remove Maven wrapper leftovers
See gh-19618,Disable tests that use Docker when Docker is unavailable
Update README to reflect the build now using Gradle
Tag the build scan with the JDK that was used
Remove outdated buildSrc README,Try to fix problem with corrupted build numbers on Artifactory,Use version property to set Boot's version in dependencies bom
See gh-19608
See gh-19609,Publish BUILD-SNAPSHOT artifacts with Gradle
See gh-19608
See gh-19609,Port the build to Gradle
\gh-19609
Fallback on underlying server default when determining outcome tag
This commit also changed the default outcome to SUCCESS
Fixes gh-19367,Merge branch '2.2.x'
Adapt field name in ValidationBindHandler to a valid ConfigurationPropertyName
Fixes gh-19580,Merge branch '2.2.x'
Merge pull request #19581 from dreis2211
* gh-19581:
  Fix links to external types in javadoc
Fix links to external types in javadoc
See gh-19581,Merge branch '2.2.x'
Merge pull request #19584 from matthiasstock
* pr/19584:
  Simplify validation pattern of EndpointId
Simplify validation pattern of EndpointId
See gh-19584,Merge branch '2.2.x'
Improve diagnostics when using `@ConstructorBinding` on a Kotlin class
Merge pull request #19578 from dreis2211
* gh-19578:
  Add micrometer-registry-stackdriver dependency for javadoc generation
Add micrometer-registry-stackdriver dependency for javadoc generation
See gh-19578,Remove support for Jetty 9.4.21 and earlier
Fix javadoc warnings
Fixes gh-19572,Harmonize cassandra tests,Polish,Polish cassandra tests
See gh-18019,Merge pull request #19528 from grafjo
* pr/19528:
  Polish "Add Stackdriver metrics export support"
  Add Stackdriver metrics export support
Polish "Add Stackdriver metrics export support"
See gh-19528,Add Stackdriver metrics export support
See gh-19528,Merge branch '2.2.x'
Increase startup timeout for Docker containers
Configure WebTestClient to be able to consume large responses
HypermediaAutoConfiguration should back off when Spring MVC absent
Fixes gh-19392,Refactor HypermediaAutoConfigurationTests,Merge branch '2.2.x',Fix checkstyle,Merge branch '2.2.x'
Merge pull request #19556 from scottfrederick
* pr/19556:
  Add profiles directly to the application environment for tests
Add profiles directly to the application environment for tests
Prior to this commit, active profiles were being added to the Spring Boot
application environment by setting the `spring.profiles.active` property.
This could result in profiles getting parsed differently than other uses of `@ActiveProfiles`.
Setting the profiles directly in the `Environment` prevents this parsing.
See gh-19556,Merge branch '2.2.x'
Remove loading of non-existent properties file from antlib
Fixes gh-19552,Merge branch '2.2.x',Avoid 406 Not Acceptable for error pages
Prior to this commit, the `ErrorController` would override the original
error response status if the error map cannot be written due to content
negotiation with the HTTP client. In that case, the error handling
infrastructure returns a `406 Not Acceptable` response.
This commit improves the `ErrorController` so that
`HttpMediaTypeNotAcceptableException` instances thrown by that
controller are not returned as is but instead we write the error
response with an empty body and the original HTTP error status.
Fixes gh-19545
See gh-19522,Add ComponentScan#nameGenerator alias on @SpringBootApplication
This commit allows to customize the default BeanNameGenerator for
scanned components using @SpringBootApplication.
Merge pull request #19536 from dreis2211
* pr/19536:
  Remove deprecated usage of WebTestClientBuilderCustomizer
Remove deprecated usage of WebTestClientBuilderCustomizer
See gh-19536,Merge pull request #19511 from nosan
* pr/19511:
  Polish "Add Java 14 to JavaVersion enumeration"
  Add Java 14 to JavaVersion enumeration
Polish "Add Java 14 to JavaVersion enumeration"
See gh-19511,Add Java 14 to JavaVersion enumeration
See gh-19511,Merge branch '2.2.x'
Merge pull request #19521 from rstoyanchev
* pr/19521:
  Improve Spring MVC auto-configuration section
Improve Spring MVC auto-configuration section
See gh-19521,Merge branch '2.2.x'
Merge pull request #19523 from dreis2211
* pr/19523:
  Upgrade CI to Artifactory Resource 0.0.10
Upgrade CI to Artifactory Resource 0.0.10
See gh-19523,Merge branch '2.2.x'
Support explicitly setting forward headers strategy to NONE
Prior to this commit, there was no distinction between explicitly setting
forward headers strategy to a value of NONE and not setting it at all.
This meant that in a cloud environment, a cloud provider was always checked
to see if it was active and using forward headers and there was no way to
prevent that.
This commit changes the default value of the property to null so that there
is a way to determine if the property was explicitly set to NONE.
Fixes gh-19333
Add a test case for binding to map with wildcard types
This commit also changes the spring framework version
to use snapshots.
Avoid 406 Not Acceptable for error pages
Prior to this commit, the `ErrorController` would override the original
error response status if the error map cannot be written due to content
negotiation with the HTTP client. In that case, the error handling
infrastructure returns a `406 Not Acceptable` response.
This commit improves the `ErrorController` so that
`HttpMediaTypeNotAcceptableException` instances thrown by that
controller are not returned as is but instead we write the error
response with an empty body and the original HTTP error status.
Fixes gh-19522,Merge branch '2.2.x'
Use RBAC credentials for Couchbase cluster info
Prior to this commit, the Couchbase auto-configuration would use the
bucket credentials when RBAC is configured. This commit ensures that
RBAC is used in that case.
This commit also adds new configuration properties to customize the
bootstrap ports for Couchbase:
* `spring.couchbase.env.bootstrap.http-direct-port`
* `spring.couchbase.env.bootstrap.http-ssl-port`
Fixes gh-19393,Merge branch '2.2.x'
Merge pull request #19510 from dreis2211
* pr/19510:
  Update some copyrights to 2020
Update some copyrights to 2020
See gh-19510,Merge branch '2.2.x'
Merge pull request #19508 from ge0ffrey
* pr/19508:
  Add reference to OptaPlanner starter
Add reference to OptaPlanner starter
See gh-19508,Merge branch '2.2.x'
Merge pull request #19503 from ochiengolanga
* pr/19503:
  Polish "Fix outdated reference in ArtemisConfigurationCustomizer javadoc"
  Fix outdated reference in ArtemisConfigurationCustomizer javadoc
Polish "Fix outdated reference in ArtemisConfigurationCustomizer javadoc"
See gh-19503,Fix outdated reference in ArtemisConfigurationCustomizer javadoc
See gh-19503,Polish,Upgrade to Flyway 6.1.3
Merge pull request #19491 from izeye
* pr/19491:
  Polish doc
Polish doc
See gh-19491,Merge pull request #19490 from victor-ferrer
* pr/19490:
  FilteringSpringBootCondition uses Class.forName instead of classLoader
FilteringSpringBootCondition uses Class.forName instead of classLoader
See gh-19490,Merge branch '2.2.x',Polish,Merge branch '2.2.x'
Merge pull request #19492 from gZack
* pr/19492:
  Fix typo in BindHandler#onFinish javadoc
Fix typo in BindHandler#onFinish javadoc
See gh-19492,Merge branch '2.2.x'
Harmonize property visibility in Saml2RelyingPartyProperties
Simplify cache smoke tests
Fix formatting,Merge pull request #19484 from izeye
* pr/19484:
  Polish
Polish
See gh-19484,Polish test setup
This commit polishes a test configuration to avoid registering a mock
for the same bean twice.,Fix component scan test setup
This commit fixes the setup of tests using component scan. Previously,
a configuration used an include filter to only include a particular
configuration class in a given package. Unfortunately, include filters
do not prevent regular filters by default and the definition did not
have the intended behaviour.
This commit disables default filters so that only the specified include
filter is applied.,Merge branch '2.2.x'
Upgrade to nohttp 0.0.4.RELEASE
Extract RabbitTemplate auto-configuration in a configurer
This commit movers the auto-configuration of RabbitTemplate to a
dedicated class that can be reused to create additional template with
similar settings.
See gh-19474,Merge branch '2.1.x' into 2.2.x
See gh-19473,Fix Tomcat's maxConnections default value
Upgrade to Tomcat 9.0.30
Merge pull request #18732 from nosan
* pr/18732:
  Polish "Add toolchains support for Spring Boot Maven Plugin"
  Add toolchains support for Spring Boot Maven Plugin
Polish "Add toolchains support for Spring Boot Maven Plugin"
See gh-18732,Add toolchains support for Spring Boot Maven Plugin
See gh-18732,Fix build failure,Merge branch '2.2.x'
Merge pull request #18711 from nosan
* pr/18711:
  Polish contribution
  Support commas embedded in command line arguments from Maven plugin
Polish contribution
See gh-18711,Support commas embedded in command line arguments from Maven plugin
See gh-18711,Polish,Merge branch '2.2.x'
Merge pull request #19458 from gintellect79
* pr/19458:
  Polish contribution
  Fix file rotation documentation according to maxHistory new default
Polish contribution
See gh-19458,Fix file rotation documentation according to maxHistory new default
See gh-19458,Merge branch '2.2.x'
Clarify documentation of repackage mojo's attach property
Clarify which part of @ConfigurationProperties is internal API
Clarify which caches are automatically bound to the metrics registry
See gh-19412,Merge branch '2.2.x'
Merge pull request #19446 from izeye
* pr/19446:
  Add JMX note for Kafka consumer metrics
Add JMX note for Kafka consumer metrics
See gh-19446,Harmonize class visibility
Fix visibility of inner classes of ServletWebServerFactoryConfiguration
Execute batch jobs with ApplicationRunner
This commit migrates JobLauncherCommandLineRunner to an
ApplicationRunner implementation. The latter allows to parse option
arguments (i.e. `--spring.something=value`) and makes it easy to ignore
arguments that are not meant to be passed to batch jobs.
See gh-19211,Merge branch '2.2.x'
Merge pull request #19099 from ChunMengLu
* pr/19099:
  Polish "Detect config props using builder pattern and generics"
  Detect config props using builder pattern and generics
Polish "Detect config props using builder pattern and generics"
See gh-19099,Detect config props using builder pattern and generics
See gh-19099,Merge branch '2.2.x'
Merge pull request #19211 from Buzzardo
* pr/19211:
  Polish "Improve Spring Batch coverage in reference documentation"
  Improve Spring Batch coverage in reference documentation
Polish "Improve Spring Batch coverage in reference documentation"
See gh-19211,Improve Spring Batch coverage in reference documentation
See gh-19211,Merge pull request #19437 from izeye
* pr/19437:
  Polish LdapAutoConfigurationTests
Polish LdapAutoConfigurationTests
See gh-19437,Merge branch '2.2.x'
Merge pull request #19352 from filiphr
* pr/19352:
  Disable SerializationFeature.WRITE_DURATIONS_AS_TIMESTAMPS by default
Disable SerializationFeature.WRITE_DURATIONS_AS_TIMESTAMPS by default
See gh-19352,Merge branch '2.2.x'
Merge pull request #19354 from ttddyy
* pr/19354:
  Fix typo on ConditionMessage
Fix typo on ConditionMessage
See gh-19354
Merge pull request #19357 from dreis2211
* pr/19357:
  Add missing icon to daily CI build
Add missing icon to daily CI build
See gh-19357,Merge branch '2.2.x'
Merge pull request #19409 from izeye
* pr/19409:
  Polish
Polish
See gh-19409,Merge branch '2.2.x'
Merge pull request #19410 from Dark0096
* pr/19410:
  Remove unused import statement
Remove unused import statement
See gh-19410,Merge branch '2.2.x'
Merge pull request #19424 from fjacobs
* pr/19424:
  Polish
  Fix typo in RSocket docs
Polish
See gh-19424,Fix typo in RSocket docs
See gh-19424,Merge pull request #19423 from dreis2211
* gh-19423:
  Fix compilation error
Fix compilation error
See gh-19423,Merge branch '2.2.x'
Protect against NoSuchMethodError when deploying to old Tomcats
Fixes gh-19308,Merge branch '2.2.x'
Fix test ordering problems by always clearing URL stream handler factory
Protect against available port actually being unavailable
Remove plugin management for Maven's site plugin
Use Testcontainers in the launch script integration tests
Add deprecation documentation to Archive.iterator
See gh-16655,Merge branch '2.2.x'
Improve docs on running apps behind proxies
Fixes gh-15046,Merge branch '2.2.x',Merge pull request #19397 from aklish
* pr/19397:
  Add Elide as 3rd party Spring Boot Starter
Add Elide as 3rd party Spring Boot Starter
See gh-19397,Merge branch '2.2.x',Merge branch '2.1.x' into 2.2.x,Merge pull request #19377 from izeye
* pr/19377:
  Remove duplicate entry for Neo4jHealthIndicator
Remove duplicate entry for Neo4jHealthIndicator
See gh-19377,Merge branch '2.2.x'
Merge pull request #19369 from dreis2211
* pr/19369:
  Add group property to DynatraceProperties
Add group property to DynatraceProperties
See gh-19369,Remove accidental usage of Plexus's CollectionUtils
See gh-16655 and 8f5777cf,Make processor output fully reproducible
Update `AutoConfigureAnnotationProcessor` to ensure that the generated
properties file is fully repeatable. Properties are now sorted and
written out directly to ensure that the timestamp comment is not
present.
Polish end-to-end configuration properties tracing
See gh-14880,Polish,Merge branch '2.2.x',Merge branch '2.1.x' into 2.2.x,Fix checkstyle violation,Merge branch '2.2.x',Merge branch '2.1.x' into 2.2.x,Update copyright header of changed files,Polish Netty SSL key alias support
See gh-19197,Merge pull request #19364 from dreis2211
* pr/19364:
  Fix unknown tag in javadoc
Fix unknown tag in javadoc
See gh-19364,Provide end-to-end traceability for config properties
\gh-14880
Co-authored-by: Andy Wilkinson <awilkinson@pivotal.io>,Optimize JarLauncher when used with exploded jar
- Previously, we would create a JarFileArchive for all nested jars.
This was an additional overhead. We only need to create a JarFileArchive
for jars that can have nested jars in them. For all other jars we only need
the URL to build the classpath.
- While iterating over nested entries in the exploded jar, we only need to
look at BOOT-INF and we can skip any entry that does not match that.
\gh-16655
Co-authored-by: Phillip Webb <pwebb@pivotal.io>,Merge branch '2.2.x'
Merge pull request #19340 from dreis2211
* pr/19340:
  Link consistently to Tomcat 9.0 docs
Link consistently to Tomcat 9.0 docs
See gh-19340,Merge branch '2.2.x'
Merge pull request #19338 from dreis2211
* pr/19338:
  Fix link to Vaadin Spring Boot starter
Fix link to Vaadin Spring Boot starter
See gh-19338,Merge branch '2.2.x'
Merge pull request #19326 from jcordoba95
* pr/19326:
  Polish contribution
  Add missing assertion to SampleTestApplicationWebIntegrationTests.test()
Polish contribution
See gh-19326,Add missing assertion to SampleTestApplicationWebIntegrationTests.test()
See gh-19326,Merge pull request #19328 from filiphr
* pr/19328:
  Polish "Detect DirContextAuthenticationStrategy bean"
  Detect DirContextAuthenticationStrategy bean
Polish "Detect DirContextAuthenticationStrategy bean"
See gh-19328,Detect DirContextAuthenticationStrategy bean
This commit improves the LDAP auto-configuration to detect if a
DirContextAuthenticationStrategy bean is defined and, if so, associates
it with the auto-configured `LdapContextSource`.
See gh-19328,Merge branch '2.2.x'
Merge pull request #19291 from dreis2211
* pr/19291:
  Simplify some Stream API usages
Simplify some Stream API usages
See gh-19291,Next development version (v2.2.3.BUILD-SNAPSHOT),Don't ignore `build` folders
Upgrade to Spring Batch 4.2.1
Next development version (v2.1.12.BUILD-SNAPSHOT),Merge branch '2.2.x'
Merge pull request #19196 from FunThomas424242
* pr/19196:
  Document Nitrite starter in README
Document Nitrite starter in README
See gh-19196,Merge branch '2.2.x'
Merge pull request #19193 from dreis2211
* pr/19193:
  Increase cache ttl in CachingOperationInvokerTests
Increase cache ttl in CachingOperationInvokerTests
See gh-19193,Merge branch '2.2.x'
Recommend mockito-inline for mocking and spying of CGLib proxies
This reverts commit 52050c173c35e8b96722051031ab55774f524967.
See gh-17817
Merge pull request #19197 from bono007
* gh-19197:
  Polish "Honour SSL key alias when using Netty"
  Honour SSL key alias when using Netty
Polish "Honour SSL key alias when using Netty"
See gh-19197,Honour SSL key alias when using Netty
See gh-19197,Merge branch '2.2.x'
Merge pull request #19290 from lyyprean
* gh-19290:
  Remove redundant hasText check as query always has text
Remove redundant hasText check as query always has text
See gh-19290
Merge pull request #19218 from tongluyang
* gh-19218:
  Add missing closing parenthesis to the document
Add missing closing parenthesis to the document
See gh-19218,Merge branch '2.2.x'
Merge pull request #19292 from dreis2211
* gh-19292:
  Upgrade to Testcontainers 1.12.4
Upgrade to Testcontainers 1.12.4
See gh-19292,Merge branch '2.2.x',Merge branch '2.1.x' into 2.2.x,Fix Asciidoc syntax,Merge branch '2.2.x'
Merge pull request #19294
* gh-19294:
  Reduce visibility of test methods
\gh-19294
See gh-19287,Reduce visibility of test methods
See gh-19294
See gh-19287,Merge branch '2.2.x'
See gh-19288,Reduce visibility of the Gradle plugin's test methods
See gh-19287,Merge branch '2.2.x'
Clarify limitations of @PropertySource
Upgrade to spring-javaformat 0.0.17
Change version from 2.2.x to 2.3.x.,Merge branch '2.1.x' into 2.2.x,Use Eclipse m2e 1.14.0
Update our Oomph setup to use m2e 1.14.0 from their milestone
update site. Unfortunately we need to use the milestone since
the fix for https://bugs.eclipse.org/bugs/show_bug.cgi?id=548652
has not yet made it into a stable m2e release.
No longer hide nested projects
Change the Oomph setup to no longer hide nested Maven projects
so that https://bugs.eclipse.org/bugs/show_bug.cgi?id=553789
doesn't get triggered.
See gh-19280,Upgrade to Eclipse 2019.9
Upgrade our Oomph setup to use Eclipse 2019.9
See gh-19280,Merge branch '2.2.x'
Display @Validated constructor bound properties in configprops endpoint
Fixes gh-19219,Upgrade to Maven Enforcer Plugin 3.0.0-M3
Upgrade to Webjars Locator Core 0.43
Upgrade to Spring Cloud Connectors 2.0.7.RELEASE
Upgrade to Neo4j Ogm 3.2.3
Upgrade to Jetty El 8.5.49
Upgrade to Mockito 3.2.0
Upgrade to Mariadb 2.5.2
Upgrade to Liquibase 3.8.2
Upgrade to Kotlin 1.3.61
Upgrade to Hibernate 5.4.9.Final
Upgrade to Jaybird 3.0.8
Upgrade to Elasticsearch 6.8.5
Upgrade to Jetty Reactive Httpclient 1.1.0
Upgrade to Jetty 9.4.24.v20191120
Upgrade to Aspectj 1.9.5
Upgrade to Tomcat 9.0.29
Upgrade to Johnzon Jsonb 1.2.2
Upgrade to Activemq 5.15.11
Upgrade to Byte Buddy 1.10.4
Upgrade to Undertow 2.0.28.Final
Upgrade to Rxjava2 2.2.15
Upgrade to Prometheus Pushgateway 0.8.0
Upgrade to Netty Tcnative 2.0.28.Final
Upgrade to Unboundid Ldapsdk 4.0.13
Upgrade to Querydsl 4.2.2
Upgrade to Appengine Sdk 1.9.77
Upgrade to Jackson 2.10.1
Upgrade to Couchbase Client 2.7.11
Upgrade to Spring Integration 5.2.2.RELEASE
Upgrade to Neo4j Ogm 3.2.3
Upgrade to Jetty El 8.5.49
Upgrade to Liquibase 3.8.2
Upgrade to Kotlin 1.3.61
Upgrade to Aspectj 1.9.5
Upgrade to Activemq 5.15.11
Upgrade to Byte Buddy 1.10.4
Upgrade to Netty Tcnative 2.0.28.Final
Upgrade to Unboundid Ldapsdk 4.0.13
Upgrade to Couchbase Client 2.7.11
Upgrade to Spring Data Lovelace-SR14
Upgrade to Spring Cloud Connectors 2.0.7.RELEASE
Upgrade to Jetty El 8.5.49
Upgrade to Aspectj 1.9.5
Upgrade to Activemq 5.15.11
Upgrade to Netty Tcnative 2.0.28.Final
Upgrade to Micrometer 1.1.9
Upgrade to Unboundid Ldapsdk 4.0.13
Upgrade to Couchbase Client 2.7.11
Upgrade to Spring Kafka 2.3.4.RELEASE
Upgrade to Spring Hateoas 1.0.2.RELEASE
Upgrade to Spring Amqp 2.2.2.RELEASE
Upgrade to Spring Data Moore-SR3
Upgrade to Spring Amqp 2.2.2.RELEASE
Upgrade to Spring Data Moore-SR3
Upgrade to Spring Kafka 2.3.4.RELEASE
\gh-19217
Ignore CannotLoadBeanClassException in config props validator
If the bean definition type contains a placeholder value, beanFactory.getType
can throw a CannotLoadBeanClassException. We can ignore this exception while
validating the bean definitions for constructor binding beans.
Fixes gh-19207,Merge branch '2.2.x'
Use generic type when binding constructor parameters
Fixes gh-19156,Merge branch '2.2.x',Merge branch '2.1.x' into 2.2.x,Upgrade to Spring Framework 5.1.12.RELEASE
Upgrade to Spring Framework 5.2.2.RELEASE
Document how properties are applied in JPA auto-config
Merge pull request #19189 from dreis2211
* gh-19189:
  Remove code that is deprecated since 2.1.x
Remove code that is deprecated since 2.1.x
See gh-19189,Merge branch '2.2.x'
Merge pull request #19171 from polarbear567
* gh-19171:
  Polish "Fix Liquibase endpoint's output with multiple datasources"
  Fix Liquibase endpoint's output with multiple datasources
Fixes gh-19171,Polish "Fix Liquibase endpoint's output with multiple datasources"
See gh-19171,Fix Liquibase endpoint's output with multiple datasources
Previously, the endpoint used the same change log history service for
for each SpringLiquibase bean that it processed. This resulted in
pollution of the reported changes as the history of each bean was not
isolated.
This commit updates the endpoint to use a new history service for each
SpringLiquibase bean that is processed.
See gh-19171,Merge branch '2.2.x'
Polish test method name to reflect its expectation
Merge pull request #19180 from dreis2211
* pr/19180:
  Fix deprecation info in CompositeHealthIndicatorConfiguration
Fix deprecation info in CompositeHealthIndicatorConfiguration
See gh-19180,Merge branch '2.2.x'
Merge pull request #19170 from izeye
* pr/19170:
  Add missing indentations for pom.xml in doc
Add missing indentations for pom.xml in doc
See gh-19170,Merge branch '2.2.x'
Merge pull request #19168 from dreis2211
* pr/19168:
  Use AdoptOpenJDK API V3 when detecting JDK updates
Use AdoptOpenJDK API V3 when detecting JDK updates
See gh-19168,Upgrade to Reactor Dysprosium-SR2
Merge pull request #18489 from manduinca
* pr/18489:
  Polish "Add dedicated namespace for RemoteIpValve properties"
  Add dedicated namespace for RemoteIpValve properties
Polish "Add dedicated namespace for RemoteIpValve properties"
See gh-18489,Add dedicated namespace for RemoteIpValve properties
See gh-18489,Merge branch '2.2.x',Fix reflective access to archiveBaseName property
Previously, reflective access to the archiveBaseName property
incorrectly treated the property as a String. It should have been
treated as a Property<String>. This caused an exception to be thrown
and the deprecated baseName property to be used as a fallback.
This commit corrects the reflective access to the archiveBaseName
property. It also updates the tests to fail if a build outputs a
deprecation warning. Tests that use Gradle's Maven plugin have been
updated to expect deprecation warnings when run with Gradle 6.0 where
the plugin is deprecated. Tests that configure an archive's base name
have been updated to use archiveBaseName when running with Gradle 6.0
and later.
Merge pull request #19159 from izeye
* pr/19159:
  Remove ConditionEvaluationReportLoggingListener usage if possible
Remove ConditionEvaluationReportLoggingListener usage if possible
See gh-19159,Merge branch '2.2.x'
Merge pull request #19101 from larsgrefer
* pr/19101:
  Polish "Remove '.' and '-' reference in the EndpointId javadoc"
  Remove '.' and '-' reference in the EndpointId javadoc
Polish "Remove '.' and '-' reference in the EndpointId javadoc"
See gh-19101,Remove '.' and '-' reference in the EndpointId javadoc
Endpoint ID's which contain '-' or '.' cause a deprecation warning.
Therefore they shouldn't be doumented as valid characters.
See gh-19101,Merge pull request #19142 from dreis2211
* pr/19142:
  Use DateTimeFormatter in favor of SimpleDateFormat
Use DateTimeFormatter in favor of SimpleDateFormat
See gh-19142,Merge pull request #19044 from polarbear567
* pr/19044:
  Polish "Add support for test containers jdbc url"
  Add support for test containers jdbc url
Polish "Add support for test containers jdbc url"
See gh-19044,Add support for test containers jdbc url
See gh-19044,Merge branch '2.2.x'
See gh-19151,Merge branch '2.1.x' into 2.2.x
See gh-19150,Add metadata for spring.main.log-startup.info
See gh-19026,Merge pull request #19106 from fzilic
* pr/19106:
  Polish "Add configuration for RabbitMQ requested channel max property"
  Add configuration for RabbitMQ requested channel max property
Polish "Add configuration for RabbitMQ requested channel max property"
See gh-19106,Add configuration for RabbitMQ requested channel max property
See gh-19106,Merge branch '2.2.x'
Merge pull request #19149 from dreis2211
* pr/19149:
  Add missing health indicators to docs
Add missing health indicators to docs
See gh-19149,Merge branch '2.2.x'
Clarify contradictory advice on the use of `@PropertySource`
In general we do not recommend using @PropertySource due to them being
added to the environment too late for auto-configuration to use them. This
commit updates the documentation to mention them in the list of external
sources along with a note.
Document logging of startup info
Upgrade to Liquibase 3.8.1
Upgrade to Hibernate 5.4.9.Final
Upgrade to Jaybird 3.0.8
Upgrade to Elasticsearch 6.8.5
Upgrade to Jetty 9.4.24.v20191120
Upgrade to Tomcat 9.0.29
Upgrade to Johnzon Jsonb 1.2.2
Upgrade to Byte Buddy 1.10.3
Upgrade to Undertow 2.0.28.Final
Upgrade to Rxjava2 2.2.15
Upgrade to Netty Tcnative 2.0.27.Final
Upgrade to Querydsl 4.2.2
Upgrade to Appengine Sdk 1.9.77
Upgrade to Jackson 2.10.1
Upgrade to Couchbase Client 2.7.10
Upgrade to Hibernate 5.3.14.Final
Upgrade to Jaybird 3.0.8
Upgrade to Jetty 9.4.24.v20191120
Upgrade to Tomcat 9.0.29
Upgrade to Undertow 2.0.28.Final
Upgrade to Rxjava2 2.2.15
Upgrade to Netty Tcnative 2.0.27.Final
\gh-19117
Upgrade to Querydsl 4.2.2
Upgrade to Appengine Sdk 1.9.77
Upgrade to Couchbase Client 2.7.10
Merge pull request #19109 from bono007
* pr/19109:
  Polish "Use ssl.enabled flag when RabbitMQ address has no protocol"
  Use ssl.enabled flag when RabbitMQ address has no protocol
Polish "Use ssl.enabled flag when RabbitMQ address has no protocol"
There is a direct link between the sslEnabled flag and the default port
that should be used by an address. The checks are currently set in two
places:
* Determine which port should be used
* Determine if SSL should be enabled
This commit polishes the initial proposal so that secureConnection is
only set if a protocol is available.
See gh-19109,Use ssl.enabled flag when RabbitMQ address has no protocol
See gh-19109,Merge pull request #19108 from dreis2211
* pr/19108:
  Fix link in new Maven Plugin docs
Fix link in new Maven Plugin docs
See gh-19108,Merge branch '2.2.x'
Merge pull request #19000 from thelproad
* pr/19000:
  Remove redundant code
Remove redundant code
See gh-19000,Merge pull request #19094 from dreis2211
* gh-19094:
  Fix StepVerifier usage in HealthIndicatorReactiveAdapterTests
Fix StepVerifier usage in HealthIndicatorReactiveAdapterTests,Merge branch '2.2.x'
Fix responseCommitted test in webflux error handling
This commit updates the `responseCommitted` after changes were made in
`WebTestClient` with spring-projects/spring-framework#24051.
Fixes gh-19083,Merge branch '2.2.x'
Merge pull request #18873 from dreis2211
* pr/18873:
  Let Liquibase smoke test pass on non-english systems
Let Liquibase smoke test pass on non-english systems
See gh-18873,Polish "Replace the Maven Plugin's site with Asciidoctor documentation"
See gh-19080,Update links from main reference docs to Maven Plugin docs
See gh-19080,Merge branch '2.2.x'
Merge pull request #19057 from adammichalik
* pr/19057:
  Remove invalid example of spring.mvc.async.request-timout property
Remove invalid example of spring.mvc.async.request-timout property
See gh-19057,Merge branch '2.2.x'
Merge pull request #18961 from dreis2211
* pr/18961:
  Handle ApiVersion in CachingOperationInvoker
Handle ApiVersion in CachingOperationInvoker
Prior to this commit, ApiVersion was treated as a mandatory parameter in
CachingOperationInvokerAdvisor and thus prevented the
CachingOperationInvoker to kick in. By skipping ApiVersion in the same
way we're skipping SecurityContext we can avoid this.
In order to not return the same cached response, this commit also
changes the cache handling in CachingOperationInvoker to account for
different ApiVersions being passed.
See gh-18961,Merge branch '2.2.x'
Merge pull request #19065 from dreis2211
* pr/19065:
  Test the Gradle Plugin against Gradle 6.0.1
Test the Gradle Plugin against Gradle 6.0.1
See gh-19065,Merge branch '2.2.x'
Merge pull request #19027 from markbigler
* pr/19027:
  Polish "Fix logging in CloudFoundryVcapEnvironmentPostProcessor"
  Fix logging in CloudFoundryVcapEnvironmentPostProcessor
Polish "Fix logging in CloudFoundryVcapEnvironmentPostProcessor"
See gh-19027,Fix logging in CloudFoundryVcapEnvironmentPostProcessor
See gh-19027,Replace the Maven Plugin's site with Asciidoctor documentation
\gh-19080
Co-authored-by: Stephane Nicoll <snicoll@pivotal.io>,Merge branch '2.2.x',Temporarily ignore failing error web handler test
See gh-19083,Merge branch '2.2.x'
Fix loading of devtools yaml files
Fixes gh-19081,Start building against Spring Data Moore-SR3 snapshots
See gh-19075,Start building against Spring Framework 5.2.2 snapshots
See gh-19076,Start building against Reactor Dysprosium-SR2 snapshots
See gh-19077,Merge branch '2.2.x',Start building against Spring Data Moore-SR3 snapshots
See gh-19069,Start building against Spring Framework 5.2.2 snapshots
See gh-19053,Start building against Reactor Dysprosium-SR2 snapshots
See gh-19054,Merge branch '2.2.x',Merge branch '2.1.x' into 2.2.x,Start building against Spring Batch 4.1.3 snapshots
See gh-19072,Start building against Spring Data Lovelace-SR14 snapshots
See gh-19068,Start building against Spring Framework 5.1.12 snapshots
See gh-19051,Start building against Reactor Californium-SR14 snapshots
See gh-19068,Merge branch '2.2.x'
Parse version from build.json for release notes generation
Fixes gh-18908,Merge branch '2.2.x',Merge branch '2.1.x' into 2.2.x,Polish,Merge branch '2.2.x'
Check authorities when exposing health details
Fixes gh-18998,Merge branch '2.2.x'
Upgrade to Kotlin 1.3.60
Merge pull request #19028 from dreis2211
* pr/19028:
  Fix syntax error in configuration metadata sample in docs
Fix syntax error in configuration metadata sample in docs
See gh-19028,Merge branch '2.2.x'
Merge pull request #19029 from dsyer
* pr/19029:
  Polish "Use caps in docker file example for consistency"
  Use caps in docker file example for consistency
Polish "Use caps in docker file example for consistency"
See gh-19029,Use caps in docker file example for consistency
See gh-19029,Merge branch '2.2.x'
Merge pull request #19008 from Christoph Dreis
* pr/19008:
  Fix build badge in README
Fix build badge in README
See gh-19008,Merge branch '2.2.x'
Merge pull request #19003 from Christoph Dreis
* pr/19003:
  Consistently use task timeout in CI pipeline
Consistently use task timeout in CI pipeline
See gh-19003,Merge branch '2.2.x'
Support constructor binding on 3rd party classes
Merge pull request #18932 from glours
* pr/18932:
  Polish "Improve Deploying to Containers section"
  Improve Deploying to Containers section
Polish "Improve Deploying to Containers section"
See gh-18932,Improve Deploying to Containers section
See gh-18932,Merge branch '2.2.x'
Merge pull request #18999 from izeye
* pr/18999:
  Polish a test name
Polish a test name
See gh-18999,Merge branch '2.2.x'
Merge pull request #18962 from izeye
* pr/18962:
  Polish test methods
Polish test methods
See gh-18962,Merge branch '2.2.x'
Merge pull request #18918 from dreis2211
* pr/18918:
  Polish
Polish
See gh-18918,Merge branch '2.2.x',Merge branch '2.1.x' into 2.2.x
Polish,Merge branch '2.2.x'
Support Gradle 6.0
Previously, our Gradle plugin was not tested against Gradle 6.0,
a number of deprecation warnings were output when using the plugin
with Gradle 6, and some functionality related to the application
plugin did not work as expected.
This commit tests the plugin against Gradle 6. It also avoids calling
deprecated APIs. The plugin is compatibile against Gradle 4.10 where
the deprecated APIs' replacements are not available so reflection is
used to call the replcaements. Lastly, the way in which the base name
of the boot distribution that is created when the application plugin
is applied has been modified to ensure that it is effective when using
Gradle 6.
Remove samples references from docs
Fixes gh-18904,Merge branch '2.2.x'
Apply changes recommended by Jetty team to JettyEmbeddedErrorHandler
Upgrade to Maven Source Plugin 3.2.0
Upgrade to Maven Jar Plugin 3.2.0
Upgrade to Maven Assembly Plugin 3.2.0
Upgrade to Webjars Locator Core 0.42
Upgrade to Pooled Jms 1.1.0
Upgrade to Mariadb 2.5.1
Upgrade to Influxdb Java 2.16
Upgrade to Hibernate Validator 6.1.0.Final
Upgrade to Hamcrest 2.2
Upgrade to Assertj 3.14.0
Update Bomr config to look for minor version upgrades,Merge branch '2.2.x'
Allow 5 seconds for child to handle SIGINT before destroying it
Previously, when RunProcess handled a SIGINT it would immediately
attempt to destroy the process that it had run. This created a race
condition between the SIGINT being handled by the child process
and RunProcess destroying the child. The exact behavior of destroy
is implementation dependent and it may result in forcible termination
of the process where shutdown hooks are not called. This is what
happens on Windows. The exit code in such a case is 1 which prevents
anything from waiting for the process to complete from detecting
that it ended as a result of a SIGINT, leaving it with no choice but
to report an error. This is what happens with mvn spring-boot:run
with a forked process on Windows and results in the build failing.
This commit updates RunProcess to allow the child process to handle
the SIGINT itself, waiting for up to five seconds for that to happen
before the process is then destroyed. Given this time, the child
process exits with 130 which RunMojo already handles correctly as
indicating that the process died due to SIGINT and the build completes
with success as a result.
Fixes gh-18936,Merge branch '2.2.x'
Merge pull request #18920 from wonwoo
* pr/18920:
  Polish "Remove reference to ConfigurationPropertiesScan in javadoc"
  Remove reference to ConfigurationPropertiesScan in javadoc
Polish "Remove reference to ConfigurationPropertiesScan in javadoc"
See gh-18920,Remove reference to ConfigurationPropertiesScan in javadoc
See gh-18920,Merge branch '2.2.x',Update CI to use the new 2.2.x maintenance branch,Start work on Spring Boot 2.3,Tag CI images with version number rather than branch name
See gh-18844,Rename CI pipeline to include the version in its name
Trim whitespace in BasicJsonParser
Previously, whitespace in between the keys and values in the JSON was
not trimmed correctly in BasicJsonParser which lead to it incorrectly
parsing JSON with whitespace between the opening of a list ([) and the
opening of a map ({).
This commit updates the parser to trim unwanted whitespace and adds a
test to AbstractJsonParserTests to verify the whitespace handling
behaviour across all JsonParser implementations.
Fix @ServletComponentScan with a component index
Previously @ServletComponentScan did not work when there was a
component index on the classpath as it made an assumption about
the concrete type of the BeanDefinitions produced by scanning that
does not hold true when an index is present.
This commit updates the scanning and the handlers to correct the
assumpution by working with a bean definition type that is produced
by scanning both when there is and when there is not an index present.
To prevent the problem from reoccuring, a test that uses and index
has been added and the import of ScannedGenericBeanDefinition is now
prohibited by Checkstyle.
Next development version (v2.2.2.BUILD-SNAPSHOT),Merge branch '2.1.x'
Make CI credentials requirement lenient when building RestTemplate
Fixes gh-18901,Merge branch '2.1.x'
Wait for distribution to reach Bintray before checking its completeness
Previously, as soon as the distribution of a release from Artifactory
to Bintray had been initiated we would start checking if it was
complete. This created a race condition between the distribution being
created and us checking if it was complete. If the check won the race
and happened before the creation, Bintray would respond with a 404.
This commit updates BintrayService to wait for up to 5 minutes for the
distribution to be created on Bintray. Once it has been created we
then wait for up to 40 minutes for it to be complete as we did before.
The use of Awaitility has been introduced in this commit to simplify
the logic required to wait for the distribution's creation and
completion.
Make sure health endpoint is available with no contributor
This commit makes sure that the health endpoint returns a default health
status when no contributors are available. Previously, it was returning
`null` which leads to a 404 when exposed via HTTP.
Merge pull request #18855 from TASure
* pr/18855:
  Polish "Polish comment in pom.xml"
  Polish comment in pom.xml
Polish "Polish comment in pom.xml"
See gh-18855,Polish comment in pom.xml
See gh-18855,Merge pull request #18883 from izeye
* pr/18883:
  Use try-with-resources blocks in JarFileArchiveTests
Use try-with-resources blocks in JarFileArchiveTests
See gh-18883,Do not validate value object bean definion when singleton present
Prior to this commit constructor bound configuration properties could
not be mocked because it would fail validation from
ConfigurationPropertiesBeanDefinitionValidator. The MockitoPostProcessor
registers the mocked bean as a singleton and validation can be skipped if a
singleton for the type is found in the bean factory.
Fixes gh-18652,Fix constructor binding issues
This commit fixes a few bugs related to constructor binding.
The ContructorFilter on the Bindable has been replaced with a
Binder level BinderConstructorProvider so that it can be used to
determine the constructor to use for nested properties as well.
Fixes gh-18810
Fixes gh-18670
\gh-18685
\gh-18894
Co-authored-by: Phillip Webb <pwebb@pivotal.io>,Upgrade to Spring Kafka 2.3.3.RELEASE
Prevent recursive config props from causing a stack overflow
Previously, when the configuration properties annotation processor
encountered a property that was the same as an outer type that had
already been processed, it would fail with a stack overflow error.
This commit introduces the use of a stack to track the types that
have been processed. Types that have been seen before are skipped,
thereby preventing a failure from occurring. We do not fail upon
encountering a recursive type to allow metadata generation to
complete. At runtime, the recursive property will not cause a problem
if it is not bound.
Fixes gh-18365,Merge branch '2.1.x'
Improve documentation on using Jersey alongside Spring MVC
Previously, the documentation did not provide any guidance on using
Jersey alongside Spring MVC or any other web framework.
This improves the documentation in two ways:
1. It notes that, in the presence of both Jersey and Spring MVC, the
   Actuator will prefer Spring MVC for exposing HTTP endpoints.
2. It adds a how-to describing how to configure Jersey to forward
   requests for which it has no handler on to the rest of the filter
   chain. When Spring MVC is the other framework, this allows them to
   be handled by its dispatcher servlet.
Recommend more overrides when using starter parent
This commit is a continuation of the work done in 987a5f81. In
addition to developers and licenses that are covered in the earlier
commit, a number of other settings are still inherited from the
starter parent. This commit updates the documentation to show them
being overridden as well.
Merge pull request #18884 from dreis2211
* pr/18884:
  Reduce method visibility in EndpointDiscovererTests
Reduce method visibility in EndpointDiscovererTests
See gh-18884,Merge pull request #18808 from markpollack
* pr/18808:
  Polish "Support amqps:// URIs in spring.rabbitmq.addresses"
  Support amqps:// URIs in spring.rabbitmq.addresses
Polish "Support amqps:// URIs in spring.rabbitmq.addresses"
See gh-18808,Support amqps:// URIs in spring.rabbitmq.addresses
See gh-18808
Co-Authored-By: Bryan Kelly <xyloman@gmail.com>,Reduce visibility of test methods,Merge branch '2.1.x'
Honour EndpointFilter configured on an endpoint's superclass
Previously, @EndpointFilter would only have an effect when used as
an annotation or meta-annotation on the endpoint class itself. It
would have no effect when used on a super-class of the endpoint
bean's class.
This commit updates EndpointDiscoverer so that an @EndpointFilter
annotation or meta-annotation on a super-class will be found and
applied to the discovery process. This is achieved by using find…
rather than get… when retrieving the attributes for the EndpointFilter
annotation.
Fixes gh-17866,Merge branch '2.1.x'
Document that JUL is not bridged into SLF4J when deployed to a container
Clarify how to configure a Filter's order
Allow dependsOn relationships created by post-processor to be overridden
Previously, AbstractDependsOnBeanFactoryPostProcessor was unordered
which meant that it was impossible to guarantee that another bean
factory post-processor would run after it. This prevented overriding
of the dependsOn relationships that is creates.
This commit updates AbstractDependsOnBeanFactoryPostProcessor to give
it a default order of zero. This will allow additional bean factory
post-processors to be configured with a lower precedence order (values
greater than 0) so that they run after any
AbstractDependsOnBeanFactoryPostProcessor and can override the
dependencies that it has configured.
Fixes gh-18362,Merge branch '2.1.x'
Recommend overriding licences and developers when using starter parent
Publishing to Maven Central requires spring-boot-starter-parent to
declare its license and developers. When a user then uses
spring-boot-starter-parent as their project's parent, these values
are inherited and this is almost certainly unwanted.
This commit updates the documentation to recommend and demonstrate
overriding the license and developers that are inherited from the
starter parent.
Document security risks of DevTools' remote support more clearly
Previously, the security risks and our recommendations on how to
mitigate them were not documented as clearly as they could have been.
This commit makes some changes to try to address this:
1. The security risk is now noted at the beginning of the section
2. The recommendation to use SSL is now documented more prominently
   and an alternative recommendation to only use remote support on
   a trusted network has been added.
3. The example secret has been removed to prevent copy and paste
4. A recommendation to use a secret that is unique and strong has been
   added
Merge pull request #18864 from dreis2211
* pr/18864:
  Remove non-existent FailureAnalyzer from spring.factories
Remove non-existent FailureAnalyzer from spring.factories
See gh-18864,Merge branch '2.1.x'
Merge pull request #18870 from djarnis73
* pr/18870:
  Polish "Document Settings as jooq supported auto-configuration type"
  Document Settings as jooq supported auto-configuration type
Polish "Document Settings as jooq supported auto-configuration type"
See gh-18870,Document Settings as jooq supported auto-configuration type
See gh-18870,Upgrade to Spring Integration 5.2.1.RELEASE
Upgrade to Spring Security 5.1.7.RELEASE
Upgrade to Spring Security 5.2.1
Upgrade to Micrometer 1.3.1
Upgrade to Spring Kafka 2.3.2.RELEASE
Upgrade to Spring AMQP 2.2.1.RELEASE
Upgrade to Spring Ws 3.0.8.RELEASE
Upgrade to Spring Ws 3.0.8.RELEASE
Enable configuration properties scanning in smoke tests that need it
Upgrade to Slf4j 1.7.29
\gh-18863
Upgrade to Jooq 3.12.3
Upgrade to Rxjava2 2.2.14
Upgrade to Slf4j 1.7.29
Upgrade to Rxjava2 2.2.14
Upgrade to Micrometer 1.1.8
Upgrade to Spring Hateoas 1.0.1.RELEASE
Upgrade to Spring Data Moore-SR1
Do not require aspectjweaver to enable CGLib-based proxies
Previously, AopAutoConfiguration would only enable CGLib-based
proxies if aspectjweaver was on the classpath. The intention was for
CGLib-based proxies to always be used by default so this behaviour
was incorrect.
This commit updates AopAutoConfiguration to force the use of
CGLib-based proxies even in the absence of aspectjweaver.
Clarify what an endpoint needs to be auto-configured
Previously, the endpoint tables in the documentation include an
"Enabled by default" column that listed whether or not an endpoint
was enabled by default. This resulted in some confusion as an endpoint
could be listed as being enabled by default but not actually be
enabled as the requirements for it being auto-configured has not been
met.
This commit removes the "Enabled by default" column and replaces it,
where needed, with some extra information in the "Description"
column that describes what is needed for the endpoint to be
auto-configured.
Do not enable @ConfigurationPropertiesScan be default
In 2.2.0, @ConfigurationPropertiesScan was enabled by default.
Unfortunately, this had the unexpected side-effect of breaking
conditional enablement of a @ConfigurationProperties class via
@EnableConfigurationProperties if the @ConfigurationProperties class
was in a package covered by scanning.
This commit remove @ConfigurationPropertiesScan from
@SpringBootApplication so that it is no longer enabled by default.
2.1.x users who rely upon such conditional enablement of
@ConfigurationProperties classes can now upgrade to 2.2.x without
having to make any changes. Users who do not have such a need and are
in a position to use configuration properties scanning can now opt-in
by adding @ConfigurationPropertiesScan to their main application class
alongside @SpringBootApplication.
Make TypeExcludeFilters public so they can be composed with user's own
Previously, all of the type exclude filters in
spring-boot-test-autoconfigure were package-private. This prevent a
user who was creating their own test slice from composing their own
TypeExcludeFilter with one of Boot's.
This commit updates all of the TypeExcludeFilters in the
test-autoconfigure module to make them public. The intention is only
to allow them to be composed with other type exclude filters when
referenced in a @TypeExcludeFilters annotation. Therefore, each
filter class is declared final and their constructors remain
package-private.
Merge pull request #18847 from wycm
* pr/18847:
  Add missing reference to HazelcastHealthContributorAutoConfiguration
Add missing reference to HazelcastHealthContributorAutoConfiguration
See gh-18847,Merge branch '2.1.x'
Merge pull request #18848 from dreis2211
* pr/18848:
  Drop JDK 12-based CI
Drop JDK 12-based CI
See gh-18848,Merge branch '2.1.x'
Merge pull request #18845 from dreis2211
* pr/18845:
  Test the Gradle Plugin against Gradle 5.6.4
Test the Gradle Plugin against Gradle 5.6.4
See gh-18845,Upgrade to Spring Framework 5.2.1
Migrate release scripts to java
Upgrade to Elasticsearch 6.8.4
Merge pull request #18837 from jaeyeonling
* pr/18837:
  Add reference to Armeria starter
Add reference to Armeria starter
See gh-18837,Merge pull request #18838 from izeye
* pr/18838:
  Polish
Polish
See gh-18838,Merge pull request #18833 from larrywest
* pr/18833:
  Remove unnecessary log4j exclusion
Remove unnecessary log4j exclusion
See gh-18833,Add config property for webflux codec maxInMemorySize
This commit creates a new configuration property
`spring.codec.max-in-memory-size` which configures the maximum
amount of data to be buffered in memory by codecs (both client and
server).
This property has no default value - it will let Spring Framework handle
the default behavior, currently enforcing a 256KB for provided codecs.
Fixes gh-18828,Add "Deploying to Containers" dedicated section
Upgrade to Neo4j Ogm 3.2.2
Upgrade to Flyway 6.0.8
Upgrade to Lettuce 5.2.1.RELEASE
Upgrade to Hazelcast 3.12.4
Upgrade Java 13 version in CI image
Add and adapt reactive health contributors
Update `HealthEndpointConfiguration` to also include adapted reactive
health contributors when project reactor is on the classpath. Prior to
this commit, reactive contributors were only exposed in WebFlux
applications. This was a regression from Spring Boot 2.1 that we didn't
catch because all our own reactive contributors all have non-reactive
equivalents.
Polish,Make sure Web infrastructure uses qualified beans
This commit is a follow-up of a change in Spring Framework[1] to make
sure injection points that are expecting a specific bean by name use
a qualifier.
As a result of this change, MVC uses the dedicated MVC validator again
rather than the general one auto-configured by Spring Boot.
[1] https://github.com/spring-projects/spring-framework/issues/23887
Upgrade to Jooq 3.12.2
Upgrade to Hibernate Validator 6.0.18.Final
Upgrade to Hibernate 5.4.8.Final
Upgrade to Flyway 6.0.7
Upgrade to Jetty 9.4.22.v20191022
Upgrade to Kafka 2.3.1
Upgrade to Byte Buddy 1.10.2
Upgrade to Joda Time 2.10.5
Upgrade to Dropwizard Metrics 4.1.1
Upgrade to Classmate 1.5.1
Upgrade to Mimepull 1.9.12
Upgrade to Hibernate Validator 6.0.18.Final
Upgrade to Hibernate 5.3.13.Final
Upgrade to Jetty 9.4.22.v20191022
Upgrade to Tomcat 9.0.27
Upgrade to Mysql 8.0.18
Upgrade to Joda Time 2.10.5
Upgrade to Undertow 2.0.27.Final
Upgrade to Rxjava2 2.2.13
Upgrade to Dropwizard Metrics 4.0.7
Upgrade to Unboundid Ldapsdk 4.0.12
Upgrade to Gson 2.8.6
Upgrade to Jackson 2.9.10.20191020
Start building against Spring Data Moore-SR1 snapshots
See gh-18744,Merge branch '2.1.x',Start building against Spring Data Lovelace-SR12 snapshots
See gh-18743,Consistently clean actuator endpoint ids
Polish,Merge pull request #18736 from mattisonzhao
* pr/18736:
  Polish contribution
  Polish
Polish contribution
See gh-18736,Polish
See gh-18736,Start building against Spring Kafka 2.3.2 snapshots
See gh-18766,Start building against Spring Integration 5.2.1 snapshots
See gh-18764,Start building against Spring AMQP 2.2.1 snapshots
See gh-18762,Merge branch '2.1.x',Start building against Spring Kafka 2.2.11 snapshots
See gh-18765,Start building against Spring Integration 5.1.9 snapshots
See gh-18763,Start building against Spring AMQP 2.1.12 snapshots
See gh-18761,Upgrade to Reactor Dysprosium-SR1
Make sure Reactive health indicators take precedence
This commit restores the highest precedence of reactive
HealthContributor over imperative one. Previously, both would be
registered, leading to duplicate entries in health output.
Merge pull request #18752 from wwjay9
* pr/18752:
  Fix OAuth2 Client redirect-uri references
Fix OAuth2 Client redirect-uri references
See gh-18752,Merge pull request #18755 from cosminhume
* pr/18755:
  Delete Javadoc references to removed code
Delete Javadoc references to removed code
See gh-18755,Merge pull request #18754 from dreis2211
* pr/18754:
  Remove redundant explicit types
Remove redundant explicit types
See gh-18754,Merge pull request #18727 from wonwoo
* pr/18727:
  Polish OnBeanCondition message
Polish OnBeanCondition message
See gh-18727,Merge pull request #18750 from dreis2211
* pr/18750:
  Fix JsonParser deprecation
Fix JsonParser deprecation
See gh-18750
Fix import,Fix error message when constructor binding fails to create bean
The configuration property is always cleared before bean instantiation
because the problem with bean instantiation might not necessarily be the
last bound property.
Fixes gh-18704,Merge branch '2.1.x'
Remove nulls from description for bean defs with no res description
Previously, if a bean definition had no resource description, the
failure analysis description would state that the been had been
defined in null which was of no use to the user.
This commit updates the failure analysis to omit information about
where the bean was definied when the definition has no resource
description.
Fixes gh-18721,Start building against Reactor Dysprosium-SR1 snapshots
See gh-18741,Upgrade to Netty 4.1.43.Final
See gh-18739,Upgrade to Netty 4.1.43.Final
See gh-18737,Merge branch '2.1.x'
Emphasize need for quotes around YAML bracket notation
Emphasize the need of @Valid on nested configuration properties
Move to Spring Framework 5.2.1 SNAPSHOT
See gh-18733,Merge branch '2.1.x',Remove Jetty BOMR restriction
See gh-18536,Handle constructor bound configuration properties in /configprops
This commit updates the configprops actuator endpoint to detect
configuration properties that are bound using a constructor.
Upgrade to H2 1.4.200
Upgrade to Quartz 2.3.2
Document need for micrometer-jersey2 dependency to get Jersey metrics
Add missing %s to warning message format string
Upgrade to Quartz 2.3.2
Merge pull request #18710 from wycm
* pr/18710:
  Polish "Optimize logger calls"
  Optimize logger calls
Polish "Optimize logger calls"
See gh-18710,Optimize logger calls
Guard logger calls to ensure that they are only made when the
level is set.
See gh-18710,Limit ConfigurationPropertiesBean candidates
Update `ConfigurationPropertiesBean.getAll()` to limit the candidate
beans that will actually need a `getBean()` call. Prior to this commit
calling `getAll()` would trigger a get of every bean in the context,
some of which might fail.
Fixes gh-18714,Merge branch '2.1.x'
Upgrade CI to JDK 8u232-b09
Upgrade CI to use JDK 11.0.5
Merge pull request #18718 from pdeneve
* pr/18718:
  Polish documentation
Polish documentation
* Remove double occurrence of InfluxDbHealthIndicator.
* Fix JUnit 5 `@ExtendWith` references
* Use consistent casing of HtmlUnit.
See gh-18718,Restore AbstractRoutingDataSource health support
Update `DataSourceHealthContributorAutoConfiguration` so that any
`AbstractRoutingDataSource` beans are still included in the overall
health. Prior to this commit, a regression in Spring Boot 2.2 meant
that if a single routing bean was found an `IllegalArgumentException`
would be thrown.
In Spring Boot 2.1 all `AbstractRoutingDataSource` would be filtered
from the results, but if no results existed the following was returned:
  "details": {
    "db": {
      "status": "UNKNOWN"
    },
In Spring Boot 2.2 we now always include routing datasource beans, even
if other non-routing database beans are found. The health details
includes `"routing" : true` to help users disambiguate any results.
Fixes gh-18661,Improve health contributor null support
Update `NamedContributorsMapAdapter` to check for `null` keys or values
during construction. Also update `HealthEndpointSupport` to allow
null component entries.
See gh-18687,Filter empty health contributions
Update `HealthEndpointSupport` so that aggregate elements that don't
ultimately provide a contribution are filtered out. Prior to this
commit an NPE was returned when calculating the aggregate status.
Fixes gh-18687,Merge pull request #18702 from AlexFalappa
* pr/18702:
  Make optimizedLaunch property name more consistent
Make optimizedLaunch property name more consistent
See gh-18702,Merge branch '2.1.x'
Merge pull request #18705 from nkjackzhang
* pr/18705:
  Fix typos
Fix typos
See gh-18705,Merge pull request #18697 from izeye
* pr/18697:
  Polish
Polish
See gh-18697,Merge pull request #18689 from dreis2211
* pr/18689:
  Fix Mockito deprecations
Fix Mockito deprecations
See gh-18689,Merge branch '2.1.x'
Merge pull request #18566 from rhamedy
* pr/18566:
  Rename `max-http-post-size` server property
Rename `max-http-post-size` server property
Rename `max-http-post-size` to `max-http-form-post-size` for Jetty and
Tomcat to make it clearer that they only apply to POSTed form content.
See gh-18566,Cache ModifiedClassPathClassLoaders
Merge pull request #18536 from dreis2211
* pr/18536:
  Polish "Upgrade to Jetty 9.4.21.v20190926"
  Upgrade to Jetty 9.4.21.v20190926
Polish "Upgrade to Jetty 9.4.21.v20190926"
See gh-18536,Upgrade to Jetty 9.4.21.v20190926
See gh-18536,Merge branch '2.1.x'
Clarify Javadoc for ServletContextInitializer
Polish,Fix typo in devtools example
Merge pull request #18673 from nosan
* pr/18673:
  Polish "Apply dependsOn semantic between Liquibase and JPA"
  Apply dependsOn semantic between Liquibase and JPA
Polish "Apply dependsOn semantic between Liquibase and JPA"
See gh-18673,Apply dependsOn semantic between Liquibase and JPA
This commits restores the dependency between Liquibase and the JPA
EntityManager even if a custom `SpringLiquibase` is configured.
See gh-18673,Polish tests,Remove useless attribute override
This commit removes the override proxyBeanMethods as the aliased
attribute is taking precedence.,Merge branch '2.1.x'
Merge pull request #18604 from wycm
* pr/18604:
  Optimize debug level logs
Optimize debug level logs
See gh-18604,Merge pull request #18632 from polarbear567
* pr/18632:
  Polish "Add missing package-info files"
  Add missing package-info files
Polish "Add missing package-info files"
See gh-18632,Add missing package-info files
See gh-18632,Merge pull request #18637 from AlexFalappa
* pr/18637:
  Narrow type for Tomcat 'locale' and 'encoding' properties
Narrow type for Tomcat 'locale' and 'encoding' properties
See gh-18637,Merge pull request #18675 from nosan
* pr/18675:
  Polish "Restore proxying of @Bean methods in @TestConfiguration"
  Restore proxying of @Bean methods in @TestConfiguration
Polish "Restore proxying of @Bean methods in @TestConfiguration"
See gh-18675,Restore proxying of @Bean methods in @TestConfiguration
See gh-18675,Merge branch '2.1.x'
Merge pull request #18665 from xiaokeliu666
* pr/18665:
  Polish
Polish
See gh-18665,Merge branch '2.1.x'
Merge pull request #18648 from dreis2211
* gh-18648:
  Test the Gradle Plugin against Gradle 5.6.3
Test the Gradle Plugin against Gradle 5.6.3
See gh-18648,Next development version (v2.2.1.BUILD-SNAPSHOT),Update bomr config to only suggest upgrades with same minor version
Now that we're in the RC phase and close to release, we only want to
pick up maintenance releases of our managed dependencies. This commit
updates bomr's config accordingly.,Upgrade to Undertow 2.0.27.Final
Upgrade to Spring Session Corn-RELEASE
Add a note to the docs about combining multiple security components
Previously, the documentation did not describe how to combine
multiple security components when one component's
WebSecurityConfigurerAdapter or SecurityWebFilterChain would cause
the other components' beans of the same type to back off.
This commit adds a note that such cases should be handled by the user
defining their own WebSecurityConfigurerAdapter or
SecurityWebFilterChain that configures the use of all of the
components as required.
Rename server.jetty.idle-timeout
This commit renames the `server.jetty.idle-timeout` property to
`server.jetty.thread-idle-timeout`, since there are other timeout
properties that are not tied to the threadpool configuration (e.g. the
connection idle timeout).
We might regroup thread-related properties in a dedicated group in the
future, see gh-18620.
Fixes gh-18615,Merge pull request #18619 from izeye
* gh-18619:
  Remove accidental JavaVersion.current() call in BootRun
Remove accidental JavaVersion.current() call in BootRun
It was added accidentally in d2b28ceb.
See gh-18619,Rename socket factory processor methods on NettyRSocketServerFactory
Previously, the methods were named addServerProcessors and
setServerProcessors which wasn't aligned with them taking
socket factory processors (ServerRSocketFactoryProcessor) as an
argument.
This commit renames the methods to align them more closely with the
type of their arguments.
See gh-18473,Merge branch '2.1.x'
Deprecate server.connection-timeout property
Prior to this commit, all supported servers would share the same
configuration property `server.connection-timeout`. Unfortunately, in
many cases the behavior of this timeout changes depending on the server.
From actual connection setup timeout, to detecting and closing idle
connections, this property cannot be properly translated from one server
implementation to another.
This commit deprecates this configuration property and introduces server
specific properties:
* `server.jetty.connection-idle-timeout`
(Time that the connection can be idle before it is closed.)
* `server.netty.connection-timeout`
(Connection timeout of the Netty channel.)
* `server.tomcat.connection-timeout`
(Amount of time the connector will wait, after accepting a connection,
for the request URI line to be presented.)
* `server.undertow.no-request-timeout`
(Amount of time a connection can sit idle without processing a request,
before it is closed by the server.)
`server.connection-timeout` is now deprecated and will be removed in a
future release.
Fixes gh-18473,Merge branch '2.1.x'
Merge pull request #18612 from contextshuffling
* pr/18612:
  Use LinkedHashSet for deterministic order in test assertion
Use LinkedHashSet for deterministic order in test assertion
See gh-18612
Upgrade to Netty 4.1.42.Final
Remove trailing commas from test SQL scripts
Upgrade to Spring Kafka 2.3.1.RELEASE
Make SAML 2 login configuration back off with user provider config adapter
Previously, a WebSecurityConfigurerAdapter would be configured
irrespective of whether or not the user had provided their own
WebSecurityConfigurerAdapter. This then required them to use ordering
to diambiguate the configuration and made it harder to take complete
control of security configuration.
This commit updates the configuration of the SAML 2 login configurer
adapter to be conditional on missing bean, aligning it with other
security configuration such as the equivalent OAuth 2 configurer
adapter.
Consider possibility of missing @ConstructorBinding in failure analysis
Previously, when a NoSuchBeanDefinitionException was being analyzed,
the possibility of a missing @ConstructorBinding annotation on a
@ConfigurationProperties class was not considered.
This commit updates the failure analysis for failed constructor
injection of an instance of a @ConfigurationProperties-annotated
class. When such a failure occurs, adding @ConstructorBinding is
now suggested as an action.
Upgrade to Mongodb 3.11.1
Upgrade to Mimepull 1.9.12
Upgrade to Flyway 6.0.6
Upgrade to Tomcat 9.0.27
Upgrade to Johnzon Jsonb 1.2.1
Upgrade to Mysql 8.0.18
Upgrade to Rxjava2 2.2.13
Upgrade to Unboundid Ldapsdk 4.0.12
Upgrade to Hazelcast 3.12.3
Upgrade to Gson 2.8.6
Clarify scope of "@SpringBootTest#classes"
See gh-18229,Polish
See gh-18440,Fix @ConfigurationProperties on @Bean methods without metadata caching
Due to a current limitation of Spring Framework, when bean metadata
caching is disabled, a merged bean definition may have a null
resolved factory method that would have been non-null if bean metadata
caching was enabled. Configuration property binding for @Bean methods
annotated with @ConfigurationProperties relied upon the resolved
factory method being enabled to find the @ConfigurationProperties
annotation and trigger property binding. As a result, when bean
metadata caching is disabled on the bean factory, such
@ConfigurationProperties beans would not be bound.
This commit works around the limitation by adding a fallback that
performs a reflection-based search for the factory method when the
resolved factory method on the bean definition is null. This allows
the bean's factory method and any @ConfigurationProperties annotation
on it to be found, ensuring that propoerty binding is then performed.
Fixes gh-18440,Merge pull request #18477 from dsyer
* pr/18477:
  Polish "Add some more notes on running exploded jar files"
  Add some more notes on running exploded jar files
Polish "Add some more notes on running exploded jar files"
See gh-18477,Add some more notes on running exploded jar files
See gh-18477,Merge branch '2.1.x'
Merge pull request #18581 from polarbear567
* pr/18581:
  Polish "Add metadata entry for spring.main.register-shutdown-hook"
  Add metadata entry for spring.main.register-shutdown-hook
Polish "Add metadata entry for spring.main.register-shutdown-hook"
See gh-18581,Add metadata entry for spring.main.register-shutdown-hook
See gh-18581,Merge branch '2.1.x'
Merge pull request #18578 from rhamedy
* pr/18578:
  Polish "Clarify formatting recommendations for configuration property javadoc"
  Clarify formatting recommendations for configuration property javadoc
Polish "Clarify formatting recommendations for configuration property javadoc"
See gh-18578,Clarify formatting recommendations for configuration property javadoc
This commit adds a note to spring-boot-features.adoc to clarify that
using javadoc tags to format configuration property descriptions is not
supported.
See gh-18578,Merge branch '2.1.x'
Merge pull request #18580 from contextshuffling
* pr/18580:
  Use LinkedHashSet for deterministic order in test assertions
Use LinkedHashSet for deterministic order in test assertions
See gh-18580,Merge branch '2.1.x'
Merge pull request #18579 from dreis2211
* pr/18579:
  Rename tests to match Surefire expectations
Rename tests to match Surefire expectations
See gh-18579,Clarify ConfigurationPropertiesBean Javadoc
Update the `ConfigurationPropertiesBean` Javadoc to clarify its purpose.
Isolate the effects of initializing Reactor's debug agent in the tests,Merge branch '2.1.x'
Merge pull request #18575 from wycm
* gh-18575:
  Make the logger static final
Make the logger static final
See gh-18575,Merge pull request #18573 from sdeleuze
* gh-18573:
  Polish "Update Kotlin-related reference documentation"
  Update Kotlin-related reference documentation
Polish "Update Kotlin-related reference documentation"
See gh-18573,Update Kotlin-related reference documentation
See gh-18573,Remove @ImmutableConfigurationProperties
Merge pull request #18571 from dreis2211
* gh-18571:
  Polish "Correct Mono import in LegacyHealthEndpointCompatibilityConfiguration"
  Correct Mono import in LegacyHealthEndpointCompatibilityConfiguration
Polish "Correct Mono import in LegacyHealthEndpointCompatibilityConfiguration"
See gh-18571,Correct Mono import in LegacyHealthEndpointCompatibilityConfiguration
See gh-18571,Fix resource cleanup in test
Merge pull request #18546 from tedyoung
* pr/18546:
  Fix incorrect backslash escape in documentation sample
Fix incorrect backslash escape in documentation sample
See gh-18546,Merge pull request #18558 from jaferkhan
* pr/18558:
  Fix package in AOP pointcut
Fix package in AOP pointcut
See gh-18558,Merge pull request #18557 from dreis2211
* pr/18557:
  Polish
  Remove usage of @InjectMocks
Polish
See gh-18557,Remove usage of @InjectMocks
See gh-18557,Merge pull request #18559 from izeye
* pr/18559:
  Fix matchesNestedConfigurationClassWithoutTestMethodsIfItHasTestable()
Fix matchesNestedConfigurationClassWithoutTestMethodsIfItHasTestable()
See gh-18559,Provide a marker artifact for Boot's Gradle plugin
Polish,Merge pull request #18552 from clove506
* pr/18552:
  Polish "Remove boxing"
  Remove boxing
Polish "Remove boxing"
See gh-18552,Remove boxing
See gh-18552,Merge pull request #18531 from izeye
* pr/18531:
  Polish
Polish
See gh-18531,Merge pull request #18548 from polarbear567
* gh-18548:
  Fix ImmutableConfigurationProperties import statement in ref docs
Fix ImmutableConfigurationProperties import statement in ref docs
See gh-18548,Merge branch '2.1.x'
Merge pull request #18539 from dreis2211
* gh-18539:
  Remove accidental usage of UnsupportedOptionException
Remove accidental usage of UnsupportedOptionException
See gh-18539,Merge pull request #18544 from dreis2211
* pr/18544:
  Fix formatting issue
Fix formatting issue
See gh-18544,Merge pull request #18541 from dreis2211
* gh-18541:
  Fix checkstyle warning
Fix checkstyle warning
See gh-18541,Merge pull request #18538 from michael-simons
* pr/18538:
  Polish "Use dedicated method to turn off authentication"
  Use dedicated method to turn off authentication
Polish "Use dedicated method to turn off authentication"
See gh-18538,Use dedicated method to turn off authentication
See gh-18538,Merge pull request #18534 from OLPMO
* gh-18534:
  Polish "Polish"
  Polish
Polish "Polish"
See gh-18534,Polish
See gh-18534,Merge pull request #18524 from izeye
* pr/18524:
  Remove a duplicate assertion
Remove a duplicate assertion
See gh-18524,Document auditevent and httptrace endpoints' need for repositories
Remove Woodstox dependency management after Jackson upgrade
The upgrade to Jackson 2.10.0 means that the possibility of getting
an incompatible combination of Woodstox and the StAX API when
building with Maven has gone. This commit removes the dependency
management as it was only added to work around the incompatibility
in Jackson's transitive dependencies.
Fix handling of encoded URLs in Class-Path manifest attribute
Fixes gh-18410,Upgrade to Webjars Locator Core 0.41
Upgrade to Mockito 3.1.0
Upgrade to Hibernate 5.4.6.Final
Upgrade to Johnzon Jsonb 1.2.0
Upgrade to Okhttp3 3.14.4
Refine String to File conversion support
Refine the conversion support so that file URLs are support without
reintroducing gh-12163.
Merge pull request #18490 from izeye
* pr/18490:
  Polish
Polish
See gh-18490,Merge pull request #18472 from neiljpowell
* pr/18472:
  Polish 'Support 'New Relic' eventType properties'
  Support 'New Relic' eventType properties
Polish 'Support 'New Relic' eventType properties'
See gh-18472,Support 'New Relic' eventType properties
Update `NewRelicProperties` so that the event type sent with each
metric can be configured. An additional `boolean` property has
also been added if the previous behavior using the "meter-name"
is required.
NewRelic's own agents publish metrics to eventTypes aligned with broader
categories. To align with their recommendation the default behavior is
to publish metrics under a "SpringBootSample" category. When doing so,
additional context is provided by including "metricName" and
"metricType" attributes.
See gh-18472,Add String to File conversion support
Add `String` -> `File` support to the `ApplicationConversionService`
that can support both simple filename as well as file URLs.
This allows Spring Boot application to work in a similar way to vanilla
Spring applications where Spring's `FileEditor` provides similar
support.
\gh-16931
Don't generate @Configuration metadata
Update `AutoConfigureAnnotationProcessor` to no longer store
`@Configuration.value` in the meta-data JSON since we never actually
read it.
Replace depends-on post processor configurations
Replace `AbstractDependsOnBeanFactoryPostProcessor` `@Configuration`
classes with simple `@Import` component classes.
Fix @since tag,Relax @ConstructorBinding member class requirement
Update `@ConfigurationProperties` so that `@ConstructorBinding` classes
no longer need to repeat the annotation for their members.
Add spring security rsocket dependency to docs,Remove accidentally committed debug sysout,Prevent ValueBinder from being incorrectly used
Fix a regression caused by e41c5a43 which incorrectly allowed the
`ValueObjectBinder` to be picked when the `JavaBeanBinder` should
have been used.
Polish,Polish,Add spring security saml dependency to docs,Autoconfigure RSocket Security
Add additional test for reactive security auto-config,Use @ConstructorBinding when generating meta-data
Update the configuration processor to use the newly introduced
`@ConstructorBinding` annotation to determine when meta data
should be generated from constructor parameters.
Prior to this commit, the processor had no good way to tell when
constructor parameters should be used instead of getters/setters.
Validate @ConfigurationProperties bean definitions
Add a bean definition post-processor that throws a better exception
if @ConstructorBinding property beans are being instantiated as
regular Spring beans.
Prior to this commit, a constructor bound properties bean would fail
with an unsatisfied dependency exception which isn't all that helpful.
Add auto-config for Spring Security's SAML support
\gh-18260
Co-authored-by: Phillip Webb <pwebb@pivotal.io>,Rename ServerRSocketFactoryCustomizer
Rename `ServerRSocketFactoryCustomizer` to
`ServerRSocketFactoryProcessor` to better reflect that it is not a
traditional customizer.
Support customization of WebTestClient.Builder when using @SpringBootTest
See b5069a4f8a5afd45c115d58aad2ee00d84954eef,Upgrade to Promethus Pushgateway 0.7.0
Upgrade to Spring Asciidoctor Extensions 0.3.0.RELEASE
Correct SCM URLs in published poms
Previously, Maven's default behaviour was relied up which resulted
in the artifact ID being appended to each URL as it was inherited.
This behaviour can only be disabled in Maven 3.6 and later, a version
that we cannot use due to an incompatibility with the Flatten Plugin.
This commit works around Maven's default behaviour by defining
properties for the SCM URL, connection, and developer connection and
then explicitly defining the settings in each pom using these
properties. The explicit definition of the properties in each pom
prevents them being inherited from the parent, thereby disabling the
unwanted appending of the artifact ID to the URL.
Fixes gh-18328,Upgrade to Spring Batch 4.2.0.RELEASE
Upgrade to Spring Session Corn-RC1
Merge pull request #18438 from 785172550
* pr/18438:
  Polish 'Simplify some code'
  Simplify some code
Polish 'Simplify some code'
See gh-18438,Simplify some code
See gh-18438,Require annotation signal for constructor binding
Update `@ConfigurationProperties` constructor binding support to only
apply when a `@ConstructorBinding` annotation is present on either the
type or the specific constructor to use.
Prior to this commit we didn't have a good way to tell when constructor
binding should be used vs regular autowiring.
For convenience, an `@ImmutableConfigurationProperties` meta-annotation
has also been added which is composed of `@ConfigurationProperties` and
`@ConstructorBinding`.
Polish,Polish,Revert "Upgrade to Spring Session Corn-RC1"
This reverts commit e7e69e2e169b5652c351289c8f150c62db7fa69d.
See gh-18257,Upgrade to Spring Session Corn-RC1
Merge pull request #18470 from vpavic
* gh-18470:
  Align with Spring Session MongoDB deprecations
Align with Spring Session MongoDB deprecations
See gh-18470,Upgrade to Spring Kafka 2.3.0.RELEASE
Upgrade to Spring Integration 5.2.0.RELEASE
Upgrade to Spring AMQP 2.2.0.RELEASE
Update copyright header of changed files,Merge branch '2.1.x',Update copyright header of changed files,Merge branch '2.1.x'
Skip management context ResourceConfigCustomizers
Update `JerseyManagementContextConfiguration` so that customizer beans
are not longer applied. The endpoint resource endpoints are now added
with a registrar bean `@PostConstruct` method.
Prior to this commit, when running the management server on a different
port a `Resource` added by a customizer could be added two different
`ResourceConfig` instance. This breaks the singleton contract expected
by Jersey.
Fixes gh-17801
Co-authored-by: Phillip Webb <pwebb@pivotal.io>,Upgrade to Spring Security 5.2.0.RELEASE
Along the way, this commit also fixes a typo.
Align Spring Asciidoctor Extension dependency with new module names,Merge branch '2.1.x',Upgrade to Spring Session Bom Bean-SR8
Upgrade to Micrometer 1.1.7
Revert to fixed version,Merge branch '2.1.x'
See gh-18316,Revert to Spring Web Services 3.0.7.RELEASE
See gh-18315,Upgrade to Download Maven Plugin 1.4.2
Upgrade to Commons FileUpload 1.4
Upgrade to gmavenplus-plugin 1.8.0
Upgrade to Cargo Maven Plugin 1.7.7
Upgrade to Maven Maven Plugin 3.6.0
Upgrade to plexus-archiver to 3.7.0
Upgrade to maven-plugin-annotations 3.6.0
Upgrade to maven-common-artifact-filters 3.1.0
Upgrade to maven-archiver 3.4.0
Upgrade to Spock 1.3-groovy-2.5
Upgrade to MockK 1.9.3
Remove plugin dependency management for the Sonar plugin,Remove duplicate maven-resources-plugin dependency management,Use Asciidoctor extension to verify documented configuration properties
Upgrade to micrometer 1.3.0
Merge pull request #18442 from dreis2211
* pr/18442:
  Remove prohibited version of Maven Invoker Plugin
Remove prohibited version of Maven Invoker Plugin
See gh-18442,Merge branch '2.1.x',Upgrade to Spring AMQP 2.1.11.RELEASE
Upgrade to Spring AMQP 2.1.11.RELEASE
Upgrade to Spring Integration 5.1.8.RELEASE
Update to Spring Data Moore-RELEASE
Merge pull request #18446 from dreis2211
* pr/18446:
  Upgrade to Testcontainers 1.12.2
Upgrade to Testcontainers 1.12.2
See gh-18446,Merge branch '2.1.x'
Merge pull request #18445 from dreis2211
* pr/18445:
  Fix comment position in ZipHeaderPeekInputStreamTests
Fix comment position in ZipHeaderPeekInputStreamTests
See gh-18445,Upgrade to Spring HATEOAS 1.0.0.RELEASE
Remove endpoint ID hints from metadata
Upgrade to Spring Framework 5.2.0.RELEASE
Upgrade to Spring REST Docs 2.0.4.RELEASE
Add RSocket smoke test,Upgrade to RSocket 1.0.0-RC5
Merge pull request #18378 from dreis2211
* pr/18378:
  Add Mustache to 'Customize ViewResolvers' docs section
Add Mustache to 'Customize ViewResolvers' docs section
See gh-18378,Merge pull request #18435 from dreis2211
* pr/18435:
  Fix default values in metadata for HiddenHttpMethodFilter
Fix default values in metadata for HiddenHttpMethodFilter
See gh-18435,Upgrade to Maven Invoker Plugin 3.2.1
Upgrade to Lombok 1.18.10
Upgrade to Postgresql 42.2.8
Upgrade to Neo4j Ogm 3.2.1
\gh-18426